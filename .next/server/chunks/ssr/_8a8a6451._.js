module.exports=[37936,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"registerServerReference",{enumerable:!0,get:function(){return d.registerServerReference}});let d=a.r(11857)},99870,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={ACTION_SUFFIX:function(){return r},APP_DIR_ALIAS:function(){return N},CACHE_ONE_YEAR:function(){return D},DOT_NEXT_ALIAS:function(){return L},ESLINT_DEFAULT_DIRS:function(){return af},GSP_NO_RETURNED_VALUE:function(){return _},GSSP_COMPONENT_MEMBER_ERROR:function(){return ac},GSSP_NO_RETURNED_VALUE:function(){return aa},HTML_CONTENT_TYPE_HEADER:function(){return g},INFINITE_CACHE:function(){return E},INSTRUMENTATION_HOOK_FILENAME:function(){return J},JSON_CONTENT_TYPE_HEADER:function(){return h},MATCHED_PATH_HEADER:function(){return k},MIDDLEWARE_FILENAME:function(){return F},MIDDLEWARE_LOCATION_REGEXP:function(){return G},NEXT_BODY_SUFFIX:function(){return u},NEXT_CACHE_IMPLICIT_TAG_ID:function(){return C},NEXT_CACHE_REVALIDATED_TAGS_HEADER:function(){return w},NEXT_CACHE_REVALIDATE_TAG_TOKEN_HEADER:function(){return x},NEXT_CACHE_SOFT_TAG_MAX_LENGTH:function(){return B},NEXT_CACHE_TAGS_HEADER:function(){return v},NEXT_CACHE_TAG_MAX_ITEMS:function(){return z},NEXT_CACHE_TAG_MAX_LENGTH:function(){return A},NEXT_DATA_SUFFIX:function(){return s},NEXT_INTERCEPTION_MARKER_PREFIX:function(){return j},NEXT_META_SUFFIX:function(){return t},NEXT_QUERY_PARAM_PREFIX:function(){return i},NEXT_RESUME_HEADER:function(){return y},NON_STANDARD_NODE_ENV:function(){return ad},PAGES_DIR_ALIAS:function(){return K},PRERENDER_REVALIDATE_HEADER:function(){return l},PRERENDER_REVALIDATE_ONLY_GENERATED_HEADER:function(){return m},PROXY_FILENAME:function(){return H},PROXY_LOCATION_REGEXP:function(){return I},PUBLIC_DIR_MIDDLEWARE_CONFLICT:function(){return V},ROOT_DIR_ALIAS:function(){return M},RSC_ACTION_CLIENT_WRAPPER_ALIAS:function(){return U},RSC_ACTION_ENCRYPTION_ALIAS:function(){return T},RSC_ACTION_PROXY_ALIAS:function(){return Q},RSC_ACTION_VALIDATE_ALIAS:function(){return P},RSC_CACHE_WRAPPER_ALIAS:function(){return R},RSC_DYNAMIC_IMPORT_WRAPPER_ALIAS:function(){return S},RSC_MOD_REF_PROXY_ALIAS:function(){return O},RSC_PREFETCH_SUFFIX:function(){return n},RSC_SEGMENTS_DIR_SUFFIX:function(){return o},RSC_SEGMENT_SUFFIX:function(){return p},RSC_SUFFIX:function(){return q},SERVER_PROPS_EXPORT_ERROR:function(){return $},SERVER_PROPS_GET_INIT_PROPS_CONFLICT:function(){return X},SERVER_PROPS_SSG_CONFLICT:function(){return Y},SERVER_RUNTIME:function(){return ag},SSG_FALLBACK_EXPORT_ERROR:function(){return ae},SSG_GET_INITIAL_PROPS_CONFLICT:function(){return W},STATIC_STATUS_PAGE_GET_INITIAL_PROPS_ERROR:function(){return Z},TEXT_PLAIN_CONTENT_TYPE_HEADER:function(){return f},UNSTABLE_REVALIDATE_RENAME_ERROR:function(){return ab},WEBPACK_LAYERS:function(){return aj},WEBPACK_RESOURCE_QUERIES:function(){return ak},WEB_SOCKET_MAX_RECONNECTIONS:function(){return ah}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="text/plain",g="text/html; charset=utf-8",h="application/json; charset=utf-8",i="nxtP",j="nxtI",k="x-matched-path",l="x-prerender-revalidate",m="x-prerender-revalidate-if-generated",n=".prefetch.rsc",o=".segments",p=".segment.rsc",q=".rsc",r=".action",s=".json",t=".meta",u=".body",v="x-next-cache-tags",w="x-next-revalidated-tags",x="x-next-revalidate-tag-token",y="next-resume",z=128,A=256,B=1024,C="_N_T_",D=31536e3,E=0xfffffffe,F="middleware",G=`(?:src/)?${F}`,H="proxy",I=`(?:src/)?${H}`,J="instrumentation",K="private-next-pages",L="private-dot-next",M="private-next-root-dir",N="private-next-app-dir",O="private-next-rsc-mod-ref-proxy",P="private-next-rsc-action-validate",Q="private-next-rsc-server-reference",R="private-next-rsc-cache-wrapper",S="private-next-rsc-track-dynamic-import",T="private-next-rsc-action-encryption",U="private-next-rsc-action-client-wrapper",V="You can not have a '_next' folder inside of your public folder. This conflicts with the internal '/_next' route. https://nextjs.org/docs/messages/public-next-folder-conflict",W="You can not use getInitialProps with getStaticProps. To use SSG, please remove your getInitialProps",X="You can not use getInitialProps with getServerSideProps. Please remove getInitialProps.",Y="You can not use getStaticProps or getStaticPaths with getServerSideProps. To use SSG, please remove getServerSideProps",Z="can not have getInitialProps/getServerSideProps, https://nextjs.org/docs/messages/404-get-initial-props",$="pages with `getServerSideProps` can not be exported. See more info here: https://nextjs.org/docs/messages/gssp-export",_="Your `getStaticProps` function did not return an object. Did you forget to add a `return`?",aa="Your `getServerSideProps` function did not return an object. Did you forget to add a `return`?",ab="The `unstable_revalidate` property is available for general use.\nPlease use `revalidate` instead.",ac="can not be attached to a page's component and must be exported from the page. See more info here: https://nextjs.org/docs/messages/gssp-component-member",ad='You are using a non-standard "NODE_ENV" value in your environment. This creates inconsistencies in the project and is strongly advised against. Read more: https://nextjs.org/docs/messages/non-standard-node-env',ae="Pages with `fallback` enabled in `getStaticPaths` can not be exported. See more info here: https://nextjs.org/docs/messages/ssg-fallback-true-export",af=["app","pages","components","lib","src"],ag={edge:"edge",experimentalEdge:"experimental-edge",nodejs:"nodejs"},ah=12,ai={shared:"shared",reactServerComponents:"rsc",serverSideRendering:"ssr",actionBrowser:"action-browser",apiNode:"api-node",apiEdge:"api-edge",middleware:"middleware",instrument:"instrument",edgeAsset:"edge-asset",appPagesBrowser:"app-pages-browser",pagesDirBrowser:"pages-dir-browser",pagesDirEdge:"pages-dir-edge",pagesDirNode:"pages-dir-node"},aj={...ai,GROUP:{builtinReact:[ai.reactServerComponents,ai.actionBrowser],serverOnly:[ai.reactServerComponents,ai.actionBrowser,ai.instrument,ai.middleware],neutralTarget:[ai.apiNode,ai.apiEdge],clientOnly:[ai.serverSideRendering,ai.appPagesBrowser],bundled:[ai.reactServerComponents,ai.actionBrowser,ai.serverSideRendering,ai.appPagesBrowser,ai.shared,ai.instrument,ai.middleware],appPages:[ai.reactServerComponents,ai.serverSideRendering,ai.appPagesBrowser,ai.actionBrowser]}},ak={edgeSSREntry:"__next_edge_ssr_entry__",metadata:"__next_metadata__",metadataRoute:"__next_metadata_route__",metadataImageMeta:"__next_metadata_image_meta__"}},76391,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e,f,g,h,i,j,k,l,m,n,o,p={AppRenderSpan:function(){return x},AppRouteRouteHandlersSpan:function(){return A},BaseServerSpan:function(){return r},LoadComponentsSpan:function(){return s},LogSpanAllowList:function(){return E},MiddlewareSpan:function(){return C},NextNodeServerSpan:function(){return u},NextServerSpan:function(){return t},NextVanillaSpanAllowlist:function(){return D},NodeSpan:function(){return z},RenderSpan:function(){return w},ResolveMetadataSpan:function(){return B},RouterSpan:function(){return y},StartServerSpan:function(){return v}};for(var q in p)Object.defineProperty(c,q,{enumerable:!0,get:p[q]});var r=((d=r||{}).handleRequest="BaseServer.handleRequest",d.run="BaseServer.run",d.pipe="BaseServer.pipe",d.getStaticHTML="BaseServer.getStaticHTML",d.render="BaseServer.render",d.renderToResponseWithComponents="BaseServer.renderToResponseWithComponents",d.renderToResponse="BaseServer.renderToResponse",d.renderToHTML="BaseServer.renderToHTML",d.renderError="BaseServer.renderError",d.renderErrorToResponse="BaseServer.renderErrorToResponse",d.renderErrorToHTML="BaseServer.renderErrorToHTML",d.render404="BaseServer.render404",d),s=((e=s||{}).loadDefaultErrorComponents="LoadComponents.loadDefaultErrorComponents",e.loadComponents="LoadComponents.loadComponents",e),t=((f=t||{}).getRequestHandler="NextServer.getRequestHandler",f.getRequestHandlerWithMetadata="NextServer.getRequestHandlerWithMetadata",f.getServer="NextServer.getServer",f.getServerRequestHandler="NextServer.getServerRequestHandler",f.createServer="createServer.createServer",f),u=((g=u||{}).compression="NextNodeServer.compression",g.getBuildId="NextNodeServer.getBuildId",g.createComponentTree="NextNodeServer.createComponentTree",g.clientComponentLoading="NextNodeServer.clientComponentLoading",g.getLayoutOrPageModule="NextNodeServer.getLayoutOrPageModule",g.generateStaticRoutes="NextNodeServer.generateStaticRoutes",g.generateFsStaticRoutes="NextNodeServer.generateFsStaticRoutes",g.generatePublicRoutes="NextNodeServer.generatePublicRoutes",g.generateImageRoutes="NextNodeServer.generateImageRoutes.route",g.sendRenderResult="NextNodeServer.sendRenderResult",g.proxyRequest="NextNodeServer.proxyRequest",g.runApi="NextNodeServer.runApi",g.render="NextNodeServer.render",g.renderHTML="NextNodeServer.renderHTML",g.imageOptimizer="NextNodeServer.imageOptimizer",g.getPagePath="NextNodeServer.getPagePath",g.getRoutesManifest="NextNodeServer.getRoutesManifest",g.findPageComponents="NextNodeServer.findPageComponents",g.getFontManifest="NextNodeServer.getFontManifest",g.getServerComponentManifest="NextNodeServer.getServerComponentManifest",g.getRequestHandler="NextNodeServer.getRequestHandler",g.renderToHTML="NextNodeServer.renderToHTML",g.renderError="NextNodeServer.renderError",g.renderErrorToHTML="NextNodeServer.renderErrorToHTML",g.render404="NextNodeServer.render404",g.startResponse="NextNodeServer.startResponse",g.route="route",g.onProxyReq="onProxyReq",g.apiResolver="apiResolver",g.internalFetch="internalFetch",g),v=((h=v||{}).startServer="startServer.startServer",h),w=((i=w||{}).getServerSideProps="Render.getServerSideProps",i.getStaticProps="Render.getStaticProps",i.renderToString="Render.renderToString",i.renderDocument="Render.renderDocument",i.createBodyResult="Render.createBodyResult",i),x=((j=x||{}).renderToString="AppRender.renderToString",j.renderToReadableStream="AppRender.renderToReadableStream",j.getBodyResult="AppRender.getBodyResult",j.fetch="AppRender.fetch",j),y=((k=y||{}).executeRoute="Router.executeRoute",k),z=((l=z||{}).runHandler="Node.runHandler",l),A=((m=A||{}).runHandler="AppRouteRouteHandlers.runHandler",m),B=((n=B||{}).generateMetadata="ResolveMetadata.generateMetadata",n.generateViewport="ResolveMetadata.generateViewport",n),C=((o=C||{}).execute="Middleware.execute",o);let D=["Middleware.execute","BaseServer.handleRequest","Render.getServerSideProps","Render.getStaticProps","AppRender.fetch","AppRender.getBodyResult","Render.renderDocument","Node.runHandler","AppRouteRouteHandlers.runHandler","ResolveMetadata.generateMetadata","ResolveMetadata.generateViewport","NextNodeServer.createComponentTree","NextNodeServer.findPageComponents","NextNodeServer.getLayoutOrPageModule","NextNodeServer.startResponse","NextNodeServer.clientComponentLoading"],E=["NextNodeServer.findPageComponents","NextNodeServer.createComponentTree","NextNodeServer.clientComponentLoading"]},22981,(a,b,c)=>{"use strict";function d(a){return null!==a&&"object"==typeof a&&"then"in a&&"function"==typeof a.then}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"isThenable",{enumerable:!0,get:function(){return d}})},46216,(a,b,c)=>{"use strict";let d,e;Object.defineProperty(c,"__esModule",{value:!0});var f={BubbledError:function(){return p},SpanKind:function(){return n},SpanStatusCode:function(){return m},getTracer:function(){return w},isBubbledError:function(){return q}};for(var g in f)Object.defineProperty(c,g,{enumerable:!0,get:f[g]});let h=a.r(76391),i=a.r(22981);try{d=a.r(70406)}catch(b){d=a.r(62562)}let{context:j,propagation:k,trace:l,SpanStatusCode:m,SpanKind:n,ROOT_CONTEXT:o}=d;class p extends Error{constructor(a,b){super(),this.bubble=a,this.result=b}}function q(a){return"object"==typeof a&&null!==a&&a instanceof p}let r=(a,b)=>{q(b)&&b.bubble?a.setAttribute("next.bubble",!0):(b&&(a.recordException(b),a.setAttribute("error.type",b.name)),a.setStatus({code:m.ERROR,message:null==b?void 0:b.message})),a.end()},s=new Map,t=d.createContextKey("next.rootSpanId"),u=0,v={set(a,b,c){a.push({key:b,value:c})}},w=(e=new class a{getTracerInstance(){return l.getTracer("next.js","0.0.1")}getContext(){return j}getTracePropagationData(){let a=j.active(),b=[];return k.inject(a,b,v),b}getActiveScopeSpan(){return l.getSpan(null==j?void 0:j.active())}withPropagatedContext(a,b,c){let d=j.active();if(l.getSpanContext(d))return b();let e=k.extract(d,a,c);return j.with(e,b)}trace(...a){var b;let[c,d,e]=a,{fn:f,options:g}="function"==typeof d?{fn:d,options:{}}:{fn:e,options:{...d}},k=g.spanName??c;if(!h.NextVanillaSpanAllowlist.includes(c)&&"1"!==process.env.NEXT_OTEL_VERBOSE||g.hideSpan)return f();let m=this.getSpanContext((null==g?void 0:g.parentSpan)??this.getActiveScopeSpan()),n=!1;m?(null==(b=l.getSpanContext(m))?void 0:b.isRemote)&&(n=!0):(m=(null==j?void 0:j.active())??o,n=!0);let p=u++;return g.attributes={"next.span_name":k,"next.span_type":c,...g.attributes},j.with(m.setValue(t,p),()=>this.getTracerInstance().startActiveSpan(k,g,a=>{let b="performance"in globalThis&&"measure"in performance?globalThis.performance.now():void 0,d=()=>{s.delete(p),b&&process.env.NEXT_OTEL_PERFORMANCE_PREFIX&&h.LogSpanAllowList.includes(c||"")&&performance.measure(`${process.env.NEXT_OTEL_PERFORMANCE_PREFIX}:next-${(c.split(".").pop()||"").replace(/[A-Z]/g,a=>"-"+a.toLowerCase())}`,{start:b,end:performance.now()})};n&&s.set(p,new Map(Object.entries(g.attributes??{})));try{if(f.length>1)return f(a,b=>r(a,b));let b=f(a);if((0,i.isThenable)(b))return b.then(b=>(a.end(),b)).catch(b=>{throw r(a,b),b}).finally(d);return a.end(),d(),b}catch(b){throw r(a,b),d(),b}}))}wrap(...a){let b=this,[c,d,e]=3===a.length?a:[a[0],{},a[1]];return h.NextVanillaSpanAllowlist.includes(c)||"1"===process.env.NEXT_OTEL_VERBOSE?function(){let a=d;"function"==typeof a&&"function"==typeof e&&(a=a.apply(this,arguments));let f=arguments.length-1,g=arguments[f];if("function"!=typeof g)return b.trace(c,a,()=>e.apply(this,arguments));{let d=b.getContext().bind(j.active(),g);return b.trace(c,a,(a,b)=>(arguments[f]=function(a){return null==b||b(a),d.apply(this,arguments)},e.apply(this,arguments)))}}:e}startSpan(...a){let[b,c]=a,d=this.getSpanContext((null==c?void 0:c.parentSpan)??this.getActiveScopeSpan());return this.getTracerInstance().startSpan(b,c,d)}getSpanContext(a){return a?l.setSpan(j.active(),a):void 0}getRootSpanAttributes(){let a=j.active().getValue(t);return s.get(a)}setRootSpanAttribute(a,b){let c=j.active().getValue(t),d=s.get(c);d&&!d.has(a)&&d.set(a,b)}},()=>e)},96556,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={DynamicServerError:function(){return g},isDynamicServerError:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="DYNAMIC_SERVER_USAGE";class g extends Error{constructor(a){super(`Dynamic server usage: ${a}`),this.description=a,this.digest=f}}function h(a){return"object"==typeof a&&null!==a&&"digest"in a&&"string"==typeof a.digest&&a.digest===f}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},60312,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={StaticGenBailoutError:function(){return g},isStaticGenBailoutError:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="NEXT_STATIC_GEN_BAILOUT";class g extends Error{constructor(...a){super(...a),this.code=f}}function h(a){return"object"==typeof a&&null!==a&&"code"in a&&a.code===f}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},13091,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={isHangingPromiseRejectionError:function(){return f},makeDevtoolsIOAwarePromise:function(){return l},makeHangingPromise:function(){return j}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(a){return"object"==typeof a&&null!==a&&"digest"in a&&a.digest===g}let g="HANGING_PROMISE_REJECTION";class h extends Error{constructor(a,b){super(`During prerendering, ${b} rejects when the prerender is complete. Typically these errors are handled by React but if you move ${b} to a different context by using \`setTimeout\`, \`after\`, or similar functions you may observe this error and you should handle it in that context. This occurred at route "${a}".`),this.route=a,this.expression=b,this.digest=g}}let i=new WeakMap;function j(a,b,c){if(a.aborted)return Promise.reject(new h(b,c));{let d=new Promise((d,e)=>{let f=e.bind(null,new h(b,c)),g=i.get(a);if(g)g.push(f);else{let b=[f];i.set(a,b),a.addEventListener("abort",()=>{for(let a=0;a<b.length;a++)b[a]()},{once:!0})}});return d.catch(k),d}}function k(){}function l(a,b,c){return b.stagedRendering?b.stagedRendering.delayUntilStage(c,void 0,a):new Promise(b=>{setTimeout(()=>{b(a)},0)})}},17491,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={METADATA_BOUNDARY_NAME:function(){return f},OUTLET_BOUNDARY_NAME:function(){return h},ROOT_LAYOUT_BOUNDARY_NAME:function(){return i},VIEWPORT_BOUNDARY_NAME:function(){return g}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="__next_metadata_boundary__",g="__next_viewport_boundary__",h="__next_outlet_boundary__",i="__next_root_layout_boundary__"},61933,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={atLeastOneTask:function(){return h},scheduleImmediate:function(){return g},scheduleOnNextTick:function(){return f},waitAtLeastOneReactRenderTask:function(){return i}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a=>{Promise.resolve().then(()=>{process.nextTick(a)})},g=a=>{setImmediate(a)};function h(){return new Promise(a=>g(a))}function i(){return new Promise(a=>setImmediate(a))}},49640,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={BailoutToCSRError:function(){return g},isBailoutToCSRError:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="BAILOUT_TO_CLIENT_SIDE_RENDERING";class g extends Error{constructor(a){super(`Bail out to client-side rendering: ${a}`),this.reason=a,this.digest=f}}function h(a){return"object"==typeof a&&null!==a&&"digest"in a&&a.digest===f}},50640,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"InvariantError",{enumerable:!0,get:function(){return d}});class d extends Error{constructor(a,b){super(`Invariant: ${a.endsWith(".")?a:a+"."} This is a bug in Next.js.`,b),this.name="InvariantError"}}},28340,(a,b,c)=>{"use strict";function d(){let a,b,c=new Promise((c,d)=>{a=c,b=d});return{resolve:a,reject:b,promise:c}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"createPromiseWithResolvers",{enumerable:!0,get:function(){return d}})},31382,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e={RenderStage:function(){return i},StagedRenderingController:function(){return j}};for(var f in e)Object.defineProperty(c,f,{enumerable:!0,get:e[f]});let g=a.r(50640),h=a.r(28340);var i=((d={})[d.Static=1]="Static",d[d.Runtime=2]="Runtime",d[d.Dynamic=3]="Dynamic",d);class j{constructor(a=null){this.abortSignal=a,this.currentStage=1,this.runtimeStagePromise=(0,h.createPromiseWithResolvers)(),this.dynamicStagePromise=(0,h.createPromiseWithResolvers)(),a&&a.addEventListener("abort",()=>{let{reason:b}=a;this.currentStage<2&&(this.runtimeStagePromise.promise.catch(k),this.runtimeStagePromise.reject(b)),this.currentStage<3&&(this.dynamicStagePromise.promise.catch(k),this.dynamicStagePromise.reject(b))},{once:!0})}advanceStage(a){!(this.currentStage>=a)&&(this.currentStage=a,a>=2&&this.runtimeStagePromise.resolve(),a>=3&&this.dynamicStagePromise.resolve())}getStagePromise(a){switch(a){case 2:return this.runtimeStagePromise.promise;case 3:return this.dynamicStagePromise.promise;default:throw Object.defineProperty(new g.InvariantError(`Invalid render stage: ${a}`),"__NEXT_ERROR_CODE",{value:"E881",enumerable:!1,configurable:!0})}}waitForStage(a){return this.getStagePromise(a)}delayUntilStage(a,b,c){var d,e,f;let g,h=(d=this.getStagePromise(a),e=b,f=c,g=new Promise((a,b)=>{d.then(a.bind(null,f),b)}),void 0!==e&&(g.displayName=e),g);return this.abortSignal&&h.catch(k),h}}function k(){}},60384,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e,f={Postpone:function(){return D},PreludeState:function(){return Z},abortAndThrowOnSynchronousRequestDataAccess:function(){return C},abortOnSynchronousPlatformIOAccess:function(){return A},accessedDynamicData:function(){return L},annotateDynamicAccess:function(){return Q},consumeDynamicAccess:function(){return M},createDynamicTrackingState:function(){return t},createDynamicValidationState:function(){return u},createHangingInputAbortSignal:function(){return P},createRenderInBrowserAbortSignal:function(){return O},delayUntilRuntimeStage:function(){return aa},formatDynamicAPIAccesses:function(){return N},getFirstDynamicReason:function(){return v},isDynamicPostpone:function(){return G},isPrerenderInterruptedError:function(){return K},logDisallowedDynamicError:function(){return $},markCurrentScopeAsDynamic:function(){return w},postponeWithTracking:function(){return E},throwIfDisallowedDynamic:function(){return _},throwToInterruptStaticGeneration:function(){return x},trackAllowedDynamicAccess:function(){return Y},trackDynamicDataInDynamicRender:function(){return y},trackSynchronousPlatformIOAccessInDev:function(){return B},useDynamicRouteParams:function(){return R},useDynamicSearchParams:function(){return S}};for(var g in f)Object.defineProperty(c,g,{enumerable:!0,get:f[g]});let h=(d=a.r(717))&&d.__esModule?d:{default:d},i=a.r(96556),j=a.r(60312),k=a.r(32319),l=a.r(56704),m=a.r(13091),n=a.r(17491),o=a.r(61933),p=a.r(49640),q=a.r(50640),r=a.r(31382),s="function"==typeof h.default.unstable_postpone;function t(a){return{isDebugDynamicAccesses:a,dynamicAccesses:[],syncDynamicErrorWithStack:null}}function u(){return{hasSuspenseAboveBody:!1,hasDynamicMetadata:!1,hasDynamicViewport:!1,hasAllowedDynamic:!1,dynamicErrors:[]}}function v(a){var b;return null==(b=a.dynamicAccesses[0])?void 0:b.expression}function w(a,b,c){if(b)switch(b.type){case"cache":case"unstable-cache":case"private-cache":return}if(!a.forceDynamic&&!a.forceStatic){if(a.dynamicShouldError)throw Object.defineProperty(new j.StaticGenBailoutError(`Route ${a.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`${c}\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E553",enumerable:!1,configurable:!0});if(b)switch(b.type){case"prerender-ppr":return E(a.route,c,b.dynamicTracking);case"prerender-legacy":b.revalidate=0;let d=Object.defineProperty(new i.DynamicServerError(`Route ${a.route} couldn't be rendered statically because it used ${c}. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E550",enumerable:!1,configurable:!0});throw a.dynamicUsageDescription=c,a.dynamicUsageStack=d.stack,d}}}function x(a,b,c){let d=Object.defineProperty(new i.DynamicServerError(`Route ${b.route} couldn't be rendered statically because it used \`${a}\`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E558",enumerable:!1,configurable:!0});throw c.revalidate=0,b.dynamicUsageDescription=a,b.dynamicUsageStack=d.stack,d}function y(a){switch(a.type){case"cache":case"unstable-cache":case"private-cache":return}}function z(a,b,c){let d=J(`Route ${a} needs to bail out of prerendering at this point because it used ${b}.`);c.controller.abort(d);let e=c.dynamicTracking;e&&e.dynamicAccesses.push({stack:e.isDebugDynamicAccesses?Error().stack:void 0,expression:b})}function A(a,b,c,d){let e=d.dynamicTracking;z(a,b,d),e&&null===e.syncDynamicErrorWithStack&&(e.syncDynamicErrorWithStack=c)}function B(a){a.stagedRendering&&a.stagedRendering.advanceStage(r.RenderStage.Dynamic)}function C(a,b,c,d){if(!1===d.controller.signal.aborted){z(a,b,d);let e=d.dynamicTracking;e&&null===e.syncDynamicErrorWithStack&&(e.syncDynamicErrorWithStack=c)}throw J(`Route ${a} needs to bail out of prerendering at this point because it used ${b}.`)}function D({reason:a,route:b}){let c=k.workUnitAsyncStorage.getStore();E(b,a,c&&"prerender-ppr"===c.type?c.dynamicTracking:null)}function E(a,b,c){(function(){if(!s)throw Object.defineProperty(Error("Invariant: React.unstable_postpone is not defined. This suggests the wrong version of React was loaded. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E224",enumerable:!1,configurable:!0})})(),c&&c.dynamicAccesses.push({stack:c.isDebugDynamicAccesses?Error().stack:void 0,expression:b}),h.default.unstable_postpone(F(a,b))}function F(a,b){return`Route ${a} needs to bail out of prerendering at this point because it used ${b}. React throws this special object to indicate where. It should not be caught by your own try/catch. Learn more: https://nextjs.org/docs/messages/ppr-caught-error`}function G(a){return"object"==typeof a&&null!==a&&"string"==typeof a.message&&H(a.message)}function H(a){return a.includes("needs to bail out of prerendering at this point because it used")&&a.includes("Learn more: https://nextjs.org/docs/messages/ppr-caught-error")}if(!1===H(F("%%%","^^^")))throw Object.defineProperty(Error("Invariant: isDynamicPostpone misidentified a postpone reason. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E296",enumerable:!1,configurable:!0});let I="NEXT_PRERENDER_INTERRUPTED";function J(a){let b=Object.defineProperty(Error(a),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return b.digest=I,b}function K(a){return"object"==typeof a&&null!==a&&a.digest===I&&"name"in a&&"message"in a&&a instanceof Error}function L(a){return a.length>0}function M(a,b){return a.dynamicAccesses.push(...b.dynamicAccesses),a.dynamicAccesses}function N(a){return a.filter(a=>"string"==typeof a.stack&&a.stack.length>0).map(({expression:a,stack:b})=>(b=b.split("\n").slice(4).filter(a=>!(a.includes("node_modules/next/")||a.includes(" (<anonymous>)")||a.includes(" (node:"))).join("\n"),`Dynamic API Usage Debug - ${a}:
${b}`))}function O(){let a=new AbortController;return a.abort(Object.defineProperty(new p.BailoutToCSRError("Render in Browser"),"__NEXT_ERROR_CODE",{value:"E721",enumerable:!1,configurable:!0})),a.signal}function P(a){switch(a.type){case"prerender":case"prerender-runtime":let b=new AbortController;if(a.cacheSignal)a.cacheSignal.inputReady().then(()=>{b.abort()});else{let c=(0,k.getRuntimeStagePromise)(a);c?c.then(()=>(0,o.scheduleOnNextTick)(()=>b.abort())):(0,o.scheduleOnNextTick)(()=>b.abort())}return b.signal;case"prerender-client":case"prerender-ppr":case"prerender-legacy":case"request":case"cache":case"private-cache":case"unstable-cache":return}}function Q(a,b){let c=b.dynamicTracking;c&&c.dynamicAccesses.push({stack:c.isDebugDynamicAccesses?Error().stack:void 0,expression:a})}function R(a){let b=l.workAsyncStorage.getStore(),c=k.workUnitAsyncStorage.getStore();if(b&&c)switch(c.type){case"prerender-client":case"prerender":{let d=c.fallbackRouteParams;d&&d.size>0&&h.default.use((0,m.makeHangingPromise)(c.renderSignal,b.route,a));break}case"prerender-ppr":{let d=c.fallbackRouteParams;if(d&&d.size>0)return E(b.route,a,c.dynamicTracking);break}case"prerender-runtime":throw Object.defineProperty(new q.InvariantError(`\`${a}\` was called during a runtime prerender. Next.js should be preventing ${a} from being included in server components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E771",enumerable:!1,configurable:!0});case"cache":case"private-cache":throw Object.defineProperty(new q.InvariantError(`\`${a}\` was called inside a cache scope. Next.js should be preventing ${a} from being included in server components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E745",enumerable:!1,configurable:!0})}}function S(a){let b=l.workAsyncStorage.getStore(),c=k.workUnitAsyncStorage.getStore();if(b)switch(!c&&(0,k.throwForMissingRequestStore)(a),c.type){case"prerender-client":h.default.use((0,m.makeHangingPromise)(c.renderSignal,b.route,a));break;case"prerender-legacy":case"prerender-ppr":if(b.forceStatic)return;throw Object.defineProperty(new p.BailoutToCSRError(a),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});case"prerender":case"prerender-runtime":throw Object.defineProperty(new q.InvariantError(`\`${a}\` was called from a Server Component. Next.js should be preventing ${a} from being included in server components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E795",enumerable:!1,configurable:!0});case"cache":case"unstable-cache":case"private-cache":throw Object.defineProperty(new q.InvariantError(`\`${a}\` was called inside a cache scope. Next.js should be preventing ${a} from being included in server components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E745",enumerable:!1,configurable:!0});case"request":return}}let T=/\n\s+at Suspense \(<anonymous>\)/,U=RegExp(`\\n\\s+at Suspense \\(<anonymous>\\)(?:(?!\\n\\s+at (?:body|div|main|section|article|aside|header|footer|nav|form|p|span|h1|h2|h3|h4|h5|h6) \\(<anonymous>\\))[\\s\\S])*?\\n\\s+at ${n.ROOT_LAYOUT_BOUNDARY_NAME} \\([^\\n]*\\)`),V=RegExp(`\\n\\s+at ${n.METADATA_BOUNDARY_NAME}[\\n\\s]`),W=RegExp(`\\n\\s+at ${n.VIEWPORT_BOUNDARY_NAME}[\\n\\s]`),X=RegExp(`\\n\\s+at ${n.OUTLET_BOUNDARY_NAME}[\\n\\s]`);function Y(a,b,c,d){if(!X.test(b)){if(V.test(b)){c.hasDynamicMetadata=!0;return}if(W.test(b)){c.hasDynamicViewport=!0;return}if(U.test(b)){c.hasAllowedDynamic=!0,c.hasSuspenseAboveBody=!0;return}else if(T.test(b)){c.hasAllowedDynamic=!0;return}else{var e,f;let g;if(d.syncDynamicErrorWithStack)return void c.dynamicErrors.push(d.syncDynamicErrorWithStack);let h=(e=`Route "${a.route}": Uncached data was accessed outside of <Suspense>. This delays the entire page from rendering, resulting in a slow user experience. Learn more: https://nextjs.org/docs/messages/blocking-route`,f=b,(g=Object.defineProperty(Error(e),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0})).stack=g.name+": "+e+f,g);return void c.dynamicErrors.push(h)}}}var Z=((e={})[e.Full=0]="Full",e[e.Empty=1]="Empty",e[e.Errored=2]="Errored",e);function $(a,b){console.error(b),a.dev||(a.hasReadableErrorStacks?console.error(`To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \`next dev\`, then open "${a.route}" in your browser to investigate the error.`):console.error(`To get a more detailed stack trace and pinpoint the issue, try one of the following:
  - Start the app in development mode by running \`next dev\`, then open "${a.route}" in your browser to investigate the error.
  - Rerun the production build with \`next build --debug-prerender\` to generate better stack traces.`))}function _(a,b,c,d){if(d.syncDynamicErrorWithStack)throw $(a,d.syncDynamicErrorWithStack),new j.StaticGenBailoutError;if(0!==b){if(c.hasSuspenseAboveBody)return;let d=c.dynamicErrors;if(d.length>0){for(let b=0;b<d.length;b++)$(a,d[b]);throw new j.StaticGenBailoutError}if(c.hasDynamicViewport)throw console.error(`Route "${a.route}" has a \`generateViewport\` that depends on Request data (\`cookies()\`, etc...) or uncached external data (\`fetch(...)\`, etc...) without explicitly allowing fully dynamic rendering. See more info here: https://nextjs.org/docs/messages/next-prerender-dynamic-viewport`),new j.StaticGenBailoutError;if(1===b)throw console.error(`Route "${a.route}" did not produce a static shell and Next.js was unable to determine a reason. This is a bug in Next.js.`),new j.StaticGenBailoutError}else if(!1===c.hasAllowedDynamic&&c.hasDynamicMetadata)throw console.error(`Route "${a.route}" has a \`generateMetadata\` that depends on Request data (\`cookies()\`, etc...) or uncached external data (\`fetch(...)\`, etc...) when the rest of the route does not. See more info here: https://nextjs.org/docs/messages/next-prerender-dynamic-metadata`),new j.StaticGenBailoutError}function aa(a,b){return a.runtimeStagePromise?a.runtimeStagePromise.then(()=>b):b}},5723,(a,b,c)=>{"use strict";let d;Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"cloneResponse",{enumerable:!0,get:function(){return f}});let e=()=>{};function f(a){if(!a.body)return[a,a];let[b,c]=a.body.tee(),e=new Response(b,{status:a.status,statusText:a.statusText,headers:a.headers});Object.defineProperty(e,"url",{value:a.url,configurable:!0,enumerable:!0,writable:!1}),d&&e.body&&d.register(e,new WeakRef(e.body));let f=new Response(c,{status:a.status,statusText:a.statusText,headers:a.headers});return Object.defineProperty(f,"url",{value:a.url,configurable:!0,enumerable:!0,writable:!1}),[e,f]}globalThis.FinalizationRegistry&&(d=new FinalizationRegistry(a=>{let b=a.deref();b&&!b.locked&&b.cancel("Response object has been garbage collected").then(e)}))},1786,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"createDedupeFetch",{enumerable:!0,get:function(){return i}});let d=function(a,b){if(a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=g(void 0);if(c&&c.has(a))return c.get(a);var d={__proto__:null},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in a)if("default"!==f&&Object.prototype.hasOwnProperty.call(a,f)){var h=e?Object.getOwnPropertyDescriptor(a,f):null;h&&(h.get||h.set)?Object.defineProperty(d,f,h):d[f]=a[f]}return d.default=a,c&&c.set(a,d),d}(a.r(717)),e=a.r(5723),f=a.r(50640);function g(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(g=function(a){return a?c:b})(a)}let h=new Set(["traceparent","tracestate"]);function i(a){let b=d.cache(a=>[]);return function(c,d){let g,i;if(d&&d.signal)return a(c,d);if("string"!=typeof c||d){let b,e="string"==typeof c||c instanceof URL?new Request(c,d):c;if("GET"!==e.method&&"HEAD"!==e.method||e.keepalive)return a(c,d);b=Array.from(e.headers.entries()).filter(([a])=>!h.has(a.toLowerCase())),i=JSON.stringify([e.method,b,e.mode,e.redirect,e.credentials,e.referrer,e.referrerPolicy,e.integrity]),g=e.url}else i='["GET",[],null,"follow",null,null,null,null]',g=c;let j=b(g);for(let a=0,b=j.length;a<b;a+=1){let[b,c]=j[a];if(b===i)return c.then(()=>{let b=j[a][2];if(!b)throw Object.defineProperty(new f.InvariantError("No cached response"),"__NEXT_ERROR_CODE",{value:"E579",enumerable:!1,configurable:!0});let[c,d]=(0,e.cloneResponse)(b);return j[a][2]=d,c})}let k=a(c,d),l=[i,k,null];return j.push(l),k.then(a=>{let[b,c]=(0,e.cloneResponse)(a);return l[2]=c,b})}}},41733,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e,f={CachedRouteKind:function(){return h},IncrementalCacheKind:function(){return i}};for(var g in f)Object.defineProperty(c,g,{enumerable:!0,get:f[g]});var h=((d={}).APP_PAGE="APP_PAGE",d.APP_ROUTE="APP_ROUTE",d.PAGES="PAGES",d.FETCH="FETCH",d.REDIRECT="REDIRECT",d.IMAGE="IMAGE",d),i=((e={}).APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.PAGES="PAGES",e.FETCH="FETCH",e.IMAGE="IMAGE",e)},96194,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"DetachedPromise",{enumerable:!0,get:function(){return d}});class d{constructor(){let a,b;this.promise=new Promise((c,d)=>{a=c,b=d}),this.resolve=a,this.reject=b}}},88690,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"Batcher",{enumerable:!0,get:function(){return e}});let d=a.r(96194);class e{constructor(a,b=a=>a()){this.cacheKeyFn=a,this.schedulerFn=b,this.pending=new Map}static create(a){return new e(null==a?void 0:a.cacheKeyFn,null==a?void 0:a.schedulerFn)}async batch(a,b){let c=this.cacheKeyFn?await this.cacheKeyFn(a):a;if(null===c)return b({resolve:a=>Promise.resolve(a),key:a});let e=this.pending.get(c);if(e)return e;let{promise:f,resolve:g,reject:h}=new d.DetachedPromise;return this.pending.set(c,f),this.schedulerFn(async()=>{try{let c=await b({resolve:g,key:a});g(c)}catch(a){h(a)}finally{this.pending.delete(c)}}),f}}},96109,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ENCODED_TAGS",{enumerable:!0,get:function(){return d}});let d={OPENING:{HTML:new Uint8Array([60,104,116,109,108]),BODY:new Uint8Array([60,98,111,100,121])},CLOSED:{HEAD:new Uint8Array([60,47,104,101,97,100,62]),BODY:new Uint8Array([60,47,98,111,100,121,62]),HTML:new Uint8Array([60,47,104,116,109,108,62]),BODY_AND_HTML:new Uint8Array([60,47,98,111,100,121,62,60,47,104,116,109,108,62])},META:{ICON_MARK:new Uint8Array([60,109,101,116,97,32,110,97,109,101,61,34,194,171,110,120,116,45,105,99,111,110,194,187,34])}}},68794,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={indexOfUint8Array:function(){return f},isEquivalentUint8Arrays:function(){return g},removeFromUint8Array:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(a,b){if(0===b.length)return 0;if(0===a.length||b.length>a.length)return -1;for(let c=0;c<=a.length-b.length;c++){let d=!0;for(let e=0;e<b.length;e++)if(a[c+e]!==b[e]){d=!1;break}if(d)return c}return -1}function g(a,b){if(a.length!==b.length)return!1;for(let c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}function h(a,b){let c=f(a,b);if(0===c)return a.subarray(b.length);if(!(c>-1))return a;{let d=new Uint8Array(a.length-b.length);return d.set(a.slice(0,c)),d.set(a.slice(c+b.length),c),d}}},68370,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"MISSING_ROOT_TAGS_ERROR",{enumerable:!0,get:function(){return d}});let d="NEXT_MISSING_ROOT_TAGS";("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},42327,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={DOC_PREFETCH_RANGE_HEADER_VALUE:function(){return g},doesExportedHtmlMatchBuildId:function(){return j},insertBuildIdComment:function(){return i}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="<!DOCTYPE html>",g="bytes=0-63";function h(a){return a.slice(0,24).replace(/-/g,"_")}function i(a,b){return b.includes("-->")||!a.startsWith(f)?a:a.replace(f,f+"<!--"+h(b)+"-->")}function j(a,b){return a.startsWith(f+"<!--"+h(b)+"-->")}},24774,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={ACTION_HEADER:function(){return g},FLIGHT_HEADERS:function(){return o},NEXT_ACTION_NOT_FOUND_HEADER:function(){return v},NEXT_DID_POSTPONE_HEADER:function(){return r},NEXT_HMR_REFRESH_HASH_COOKIE:function(){return l},NEXT_HMR_REFRESH_HEADER:function(){return k},NEXT_HTML_REQUEST_ID_HEADER:function(){return x},NEXT_IS_PRERENDER_HEADER:function(){return u},NEXT_REQUEST_ID_HEADER:function(){return w},NEXT_REWRITTEN_PATH_HEADER:function(){return s},NEXT_REWRITTEN_QUERY_HEADER:function(){return t},NEXT_ROUTER_PREFETCH_HEADER:function(){return i},NEXT_ROUTER_SEGMENT_PREFETCH_HEADER:function(){return j},NEXT_ROUTER_STALE_TIME_HEADER:function(){return q},NEXT_ROUTER_STATE_TREE_HEADER:function(){return h},NEXT_RSC_UNION_QUERY:function(){return p},NEXT_URL:function(){return m},RSC_CONTENT_TYPE_HEADER:function(){return n},RSC_HEADER:function(){return f}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="rsc",g="next-action",h="next-router-state-tree",i="next-router-prefetch",j="next-router-segment-prefetch",k="next-hmr-refresh",l="__next_hmr_refresh_hash__",m="next-url",n="text/x-component",o=[f,h,i,k,j],p="_rsc",q="x-nextjs-stale-time",r="x-nextjs-postponed",s="x-nextjs-rewritten-path",t="x-nextjs-rewritten-query",u="x-nextjs-prerender",v="x-nextjs-action-not-found",w="x-nextjs-request-id",x="x-nextjs-html-request-id";("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},37211,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={djb2Hash:function(){return f},hexHash:function(){return g}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(a){let b=5381;for(let c=0;c<a.length;c++)b=(b<<5)+b+a.charCodeAt(c)|0;return b>>>0}function g(a){return f(a).toString(36).slice(0,5)}},50094,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"computeCacheBustingSearchParam",{enumerable:!0,get:function(){return e}});let d=a.r(37211);function e(a,b,c,e){return(void 0===a||"0"===a)&&void 0===b&&void 0===c&&void 0===e?"":(0,d.hexHash)([a||"0",b||"0",c||"0",e||"0"].join(","))}},75406,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={chainStreams:function(){return r},continueDynamicHTMLResume:function(){return J},continueDynamicPrerender:function(){return G},continueFizzStream:function(){return F},continueStaticFallbackPrerender:function(){return I},continueStaticPrerender:function(){return H},createBufferedTransformStream:function(){return w},createDocumentClosingStream:function(){return K},createRootLayoutValidatorStream:function(){return E},renderToInitialFizzStream:function(){return y},streamFromBuffer:function(){return t},streamFromString:function(){return s},streamToBuffer:function(){return u},streamToString:function(){return v}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(46216),g=a.r(76391),h=a.r(96194),i=a.r(61933),j=a.r(96109),k=a.r(68794),l=a.r(68370),m=a.r(42327),n=a.r(24774),o=a.r(50094);function p(){}let q=new TextEncoder;function r(...a){if(0===a.length)return new ReadableStream({start(a){a.close()}});if(1===a.length)return a[0];let{readable:b,writable:c}=new TransformStream,d=a[0].pipeTo(c,{preventClose:!0}),e=1;for(;e<a.length-1;e++){let b=a[e];d=d.then(()=>b.pipeTo(c,{preventClose:!0}))}let f=a[e];return(d=d.then(()=>f.pipeTo(c))).catch(p),b}function s(a){return new ReadableStream({start(b){b.enqueue(q.encode(a)),b.close()}})}function t(a){return new ReadableStream({start(b){b.enqueue(a),b.close()}})}async function u(a){let b=a.getReader(),c=[];for(;;){let{done:a,value:d}=await b.read();if(a)break;c.push(d)}return Buffer.concat(c)}async function v(a,b){let c=new TextDecoder("utf-8",{fatal:!0}),d="";for await(let e of a){if(null==b?void 0:b.aborted)return d;d+=c.decode(e,{stream:!0})}return d+c.decode()}function w(a={}){let b,{maxBufferByteLength:c=1/0}=a,d=[],e=0,f=a=>{try{if(0===d.length)return;let b=new Uint8Array(e),c=0;for(let a=0;a<d.length;a++){let e=d[a];b.set(e,c),c+=e.byteLength}d.length=0,e=0,a.enqueue(b)}catch{}};return new TransformStream({transform(a,g){d.push(a),(e+=a.byteLength)>=c?f(g):(a=>{if(b)return;let c=new h.DetachedPromise;b=c,(0,i.scheduleImmediate)(()=>{try{f(a)}finally{b=void 0,c.resolve()}})})(g)},flush:()=>null==b?void 0:b.promise})}function x(a,b){let c=!1;return new TransformStream({transform(d,e){if(a&&!c){c=!0;let a=new TextDecoder("utf-8",{fatal:!0}).decode(d,{stream:!0}),f=(0,m.insertBuildIdComment)(a,b);e.enqueue(q.encode(f));return}e.enqueue(d)}})}function y({ReactDOMServer:a,element:b,streamOptions:c}){return(0,f.getTracer)().trace(g.AppRenderSpan.renderToReadableStream,async()=>a.renderToReadableStream(b,c))}function z(a){let b=-1,c=!1;return new TransformStream({async transform(d,e){let f=-1,g=-1;if(b++,c)return void e.enqueue(d);let h=0;if(-1===f){if(-1===(f=(0,k.indexOfUint8Array)(d,j.ENCODED_TAGS.META.ICON_MARK)))return void e.enqueue(d);47===d[f+(h=j.ENCODED_TAGS.META.ICON_MARK.length)]?h+=2:h++}if(0===b){if(g=(0,k.indexOfUint8Array)(d,j.ENCODED_TAGS.CLOSED.HEAD),-1!==f){if(f<g){let a=new Uint8Array(d.length-h);a.set(d.subarray(0,f)),a.set(d.subarray(f+h),f),d=a}else{let b=await a(),c=q.encode(b),e=c.length,g=new Uint8Array(d.length-h+e);g.set(d.subarray(0,f)),g.set(c,f),g.set(d.subarray(f+h),f+e),d=g}c=!0}}else{let b=await a(),e=q.encode(b),g=e.length,i=new Uint8Array(d.length-h+g);i.set(d.subarray(0,f)),i.set(e,f),i.set(d.subarray(f+h),f+g),d=i,c=!0}e.enqueue(d)}})}function A(a){let b=!1,c=!1;return new TransformStream({async transform(d,e){c=!0;let f=await a();if(b){if(f){let a=q.encode(f);e.enqueue(a)}e.enqueue(d)}else{let a=(0,k.indexOfUint8Array)(d,j.ENCODED_TAGS.CLOSED.HEAD);if(-1!==a){if(f){let b=q.encode(f),c=new Uint8Array(d.length+b.length);c.set(d.slice(0,a)),c.set(b,a),c.set(d.slice(a),a+b.length),e.enqueue(c)}else e.enqueue(d);b=!0}else f&&e.enqueue(q.encode(f)),e.enqueue(d),b=!0}},async flush(b){if(c){let c=await a();c&&b.enqueue(q.encode(c))}}})}function B(a,b){let c=!1,d=null,e=!1;function f(a){return d||(d=g(a)),d}async function g(d){let f=a.getReader();b&&await (0,i.atLeastOneTask)();try{for(;;){let{done:a,value:g}=await f.read();if(a){e=!0;return}b||c||await (0,i.atLeastOneTask)(),d.enqueue(g)}}catch(a){d.error(a)}}return new TransformStream({start(a){b||f(a)},transform(a,c){c.enqueue(a),b&&f(c)},flush(a){if(c=!0,!e)return f(a)}})}let C="</body></html>";function D(){let a=!1;return new TransformStream({transform(b,c){if(a)return c.enqueue(b);let d=(0,k.indexOfUint8Array)(b,j.ENCODED_TAGS.CLOSED.BODY_AND_HTML);if(d>-1){if(a=!0,b.length===j.ENCODED_TAGS.CLOSED.BODY_AND_HTML.length)return;let e=b.slice(0,d);if(c.enqueue(e),b.length>j.ENCODED_TAGS.CLOSED.BODY_AND_HTML.length+d){let a=b.slice(d+j.ENCODED_TAGS.CLOSED.BODY_AND_HTML.length);c.enqueue(a)}}else c.enqueue(b)},flush(a){a.enqueue(j.ENCODED_TAGS.CLOSED.BODY_AND_HTML)}})}function E(){let a=!1,b=!1;return new TransformStream({async transform(c,d){!a&&(0,k.indexOfUint8Array)(c,j.ENCODED_TAGS.OPENING.HTML)>-1&&(a=!0),!b&&(0,k.indexOfUint8Array)(c,j.ENCODED_TAGS.OPENING.BODY)>-1&&(b=!0),d.enqueue(c)},flush(c){let d=[];a||d.push("html"),b||d.push("body"),d.length&&c.enqueue(q.encode(`<html id="__next_error__">
            <template
              data-next-error-message="Missing ${d.map(a=>`<${a}>`).join(d.length>1?" and ":"")} tags in the root layout.
Read more at https://nextjs.org/docs/messages/missing-root-layout-tags"
              data-next-error-digest="${l.MISSING_ROOT_TAGS_ERROR}"
              data-next-error-stack=""
            ></template>
          `))}})}async function F(a,{suffix:b,inlinedDataStream:c,isStaticGeneration:d,isBuildTimePrerendering:e,buildId:f,getServerInsertedHTML:g,getServerInsertedMetadata:j,validateRootLayout:k}){let l,m,n=b?b.split(C,1)[0]:null;d&&await a.allReady;var o=[w(),x(e,f),z(j),null!=n&&n.length>0?(m=!1,new TransformStream({transform(a,b){if(b.enqueue(a),!m){let a;m=!0,l=a=new h.DetachedPromise,(0,i.scheduleImmediate)(()=>{try{b.enqueue(q.encode(n))}catch{}finally{l=void 0,a.resolve()}})}},flush(a){if(l)return l.promise;m||a.enqueue(q.encode(n))}})):null,c?B(c,!0):null,k?E():null,D(),A(g)];let p=a;for(let a of o)a&&(p=p.pipeThrough(a));return p}async function G(a,{getServerInsertedHTML:b,getServerInsertedMetadata:c}){return a.pipeThrough(w()).pipeThrough(new TransformStream({transform(a,b){(0,k.isEquivalentUint8Arrays)(a,j.ENCODED_TAGS.CLOSED.BODY_AND_HTML)||(0,k.isEquivalentUint8Arrays)(a,j.ENCODED_TAGS.CLOSED.BODY)||(0,k.isEquivalentUint8Arrays)(a,j.ENCODED_TAGS.CLOSED.HTML)||(a=(0,k.removeFromUint8Array)(a,j.ENCODED_TAGS.CLOSED.BODY),a=(0,k.removeFromUint8Array)(a,j.ENCODED_TAGS.CLOSED.HTML),b.enqueue(a))}})).pipeThrough(A(b)).pipeThrough(z(c))}async function H(a,{inlinedDataStream:b,getServerInsertedHTML:c,getServerInsertedMetadata:d,isBuildTimePrerendering:e,buildId:f}){return a.pipeThrough(w()).pipeThrough(x(e,f)).pipeThrough(A(c)).pipeThrough(z(d)).pipeThrough(B(b,!0)).pipeThrough(D())}async function I(a,{inlinedDataStream:b,getServerInsertedHTML:c,getServerInsertedMetadata:d,isBuildTimePrerendering:e,buildId:f}){let g,h,i,l;return a.pipeThrough(w()).pipeThrough(x(e,f)).pipeThrough(A(c)).pipeThrough((g=(0,o.computeCacheBustingSearchParam)("1","/_full",void 0,void 0),h=`${n.NEXT_RSC_UNION_QUERY}=${g}`,i=`<script>__NEXT_CLIENT_RESUME=fetch(location.pathname+'?${h}',{credentials:'same-origin',headers:{'${n.RSC_HEADER}': '1','${n.NEXT_ROUTER_PREFETCH_HEADER}': '1','${n.NEXT_ROUTER_SEGMENT_PREFETCH_HEADER}': '/_full'}})</script>`,l=!1,new TransformStream({transform(a,b){if(l)return void b.enqueue(a);let c=(0,k.indexOfUint8Array)(a,j.ENCODED_TAGS.CLOSED.HEAD);if(-1===c)return void b.enqueue(a);let d=q.encode(i),e=new Uint8Array(a.length+d.length);e.set(a.slice(0,c)),e.set(d,c),e.set(a.slice(c),c+d.length),b.enqueue(e),l=!0}}))).pipeThrough(z(d)).pipeThrough(B(b,!0)).pipeThrough(D())}async function J(a,{delayDataUntilFirstHtmlChunk:b,inlinedDataStream:c,getServerInsertedHTML:d,getServerInsertedMetadata:e}){return a.pipeThrough(w()).pipeThrough(A(d)).pipeThrough(z(e)).pipeThrough(B(c,b)).pipeThrough(D())}function K(){return s(C)}},49697,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={NEXT_REQUEST_META:function(){return f},addRequestMeta:function(){return i},getRequestMeta:function(){return g},removeRequestMeta:function(){return j},setRequestMeta:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=Symbol.for("NextInternalRequestMeta");function g(a,b){let c=a[f]||{};return"string"==typeof b?c[b]:c}function h(a,b){return a[f]=b,b}function i(a,b,c){let d=g(a);return d[b]=c,h(a,d)}function j(a,b){let c=g(a);return delete c[b],h(a,c)}},92273,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={fromNodeOutgoingHttpHeaders:function(){return g},normalizeNextQueryParam:function(){return k},splitCookiesString:function(){return h},toNodeOutgoingHttpHeaders:function(){return i},validateURL:function(){return j}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(99870);function g(a){let b=new Headers;for(let[c,d]of Object.entries(a))for(let a of Array.isArray(d)?d:[d])void 0!==a&&("number"==typeof a&&(a=a.toString()),b.append(c,a));return b}function h(a){var b,c,d,e,f,g=[],h=0;function i(){for(;h<a.length&&/\s/.test(a.charAt(h));)h+=1;return h<a.length}for(;h<a.length;){for(b=h,f=!1;i();)if(","===(c=a.charAt(h))){for(d=h,h+=1,i(),e=h;h<a.length&&"="!==(c=a.charAt(h))&&";"!==c&&","!==c;)h+=1;h<a.length&&"="===a.charAt(h)?(f=!0,h=e,g.push(a.substring(b,d)),b=h):h=d+1}else h+=1;(!f||h>=a.length)&&g.push(a.substring(b,a.length))}return g}function i(a){let b={},c=[];if(a)for(let[d,e]of a.entries())"set-cookie"===d.toLowerCase()?(c.push(...h(e)),b[d]=1===c.length?c[0]:c):b[d]=e;return b}function j(a){try{return String(new URL(String(a)))}catch(b){throw Object.defineProperty(Error(`URL is malformed "${String(a)}". Please use only absolute URLs - https://nextjs.org/docs/messages/middleware-relative-urls`,{cause:b}),"__NEXT_ERROR_CODE",{value:"E61",enumerable:!1,configurable:!0})}}function k(a){for(let b of[f.NEXT_QUERY_PARAM_PREFIX,f.NEXT_INTERCEPTION_MARKER_PREFIX])if(a!==b&&a.startsWith(b))return a.substring(b.length);return null}},92603,(a,b,c)=>{"use strict";function d(a,b,c){if(a){for(let d of(c&&(c=c.toLowerCase()),a))if(b===d.domain?.split(":",1)[0].toLowerCase()||c===d.defaultLocale.toLowerCase()||d.locales?.some(a=>a.toLowerCase()===c))return d}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"detectDomainLocale",{enumerable:!0,get:function(){return d}})},74993,(a,b,c)=>{"use strict";function d(a){return a.replace(/\/$/,"")||"/"}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"removeTrailingSlash",{enumerable:!0,get:function(){return d}})},71442,(a,b,c)=>{"use strict";function d(a){let b=a.indexOf("#"),c=a.indexOf("?"),d=c>-1&&(b<0||c<b);return d||b>-1?{pathname:a.substring(0,d?c:b),query:d?a.substring(c,b>-1?b:void 0):"",hash:b>-1?a.slice(b):""}:{pathname:a,query:"",hash:""}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"parsePath",{enumerable:!0,get:function(){return d}})},91150,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"addPathPrefix",{enumerable:!0,get:function(){return e}});let d=a.r(71442);function e(a,b){if(!a.startsWith("/")||!b)return a;let{pathname:c,query:e,hash:f}=(0,d.parsePath)(a);return`${b}${c}${e}${f}`}},47074,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"addPathSuffix",{enumerable:!0,get:function(){return e}});let d=a.r(71442);function e(a,b){if(!a.startsWith("/")||!b)return a;let{pathname:c,query:e,hash:f}=(0,d.parsePath)(a);return`${c}${b}${e}${f}`}},39481,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"pathHasPrefix",{enumerable:!0,get:function(){return e}});let d=a.r(71442);function e(a,b){if("string"!=typeof a)return!1;let{pathname:c}=(0,d.parsePath)(a);return c===b||c.startsWith(b+"/")}},7700,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"addLocale",{enumerable:!0,get:function(){return f}});let d=a.r(91150),e=a.r(39481);function f(a,b,c,f){if(!b||b===c)return a;let g=a.toLowerCase();return!f&&((0,e.pathHasPrefix)(g,"/api")||(0,e.pathHasPrefix)(g,`/${b.toLowerCase()}`))?a:(0,d.addPathPrefix)(a,`/${b}`)}},97642,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"formatNextPathnameInfo",{enumerable:!0,get:function(){return h}});let d=a.r(74993),e=a.r(91150),f=a.r(47074),g=a.r(7700);function h(a){let b=(0,g.addLocale)(a.pathname,a.locale,a.buildId?void 0:a.defaultLocale,a.ignorePrefix);return(a.buildId||!a.trailingSlash)&&(b=(0,d.removeTrailingSlash)(b)),a.buildId&&(b=(0,f.addPathSuffix)((0,e.addPathPrefix)(b,`/_next/data/${a.buildId}`),"/"===a.pathname?"index.json":".json")),b=(0,e.addPathPrefix)(b,a.basePath),!a.buildId&&a.trailingSlash?b.endsWith("/")?b:(0,f.addPathSuffix)(b,"/"):(0,d.removeTrailingSlash)(b)}},64239,(a,b,c)=>{"use strict";function d(a,b){let c;if(b?.host&&!Array.isArray(b.host))c=b.host.toString().split(":",1)[0];else{if(!a.hostname)return;c=a.hostname}return c.toLowerCase()}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"getHostname",{enumerable:!0,get:function(){return d}})},3885,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"normalizeLocalePath",{enumerable:!0,get:function(){return e}});let d=new WeakMap;function e(a,b){let c;if(!b)return{pathname:a};let e=d.get(b);e||(e=b.map(a=>a.toLowerCase()),d.set(b,e));let f=a.split("/",2);if(!f[1])return{pathname:a};let g=f[1].toLowerCase(),h=e.indexOf(g);return h<0?{pathname:a}:(c=b[h],{pathname:a=a.slice(c.length+1)||"/",detectedLocale:c})}},61601,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"removePathPrefix",{enumerable:!0,get:function(){return e}});let d=a.r(39481);function e(a,b){if(!(0,d.pathHasPrefix)(a,b))return a;let c=a.slice(b.length);return c.startsWith("/")?c:`/${c}`}},94971,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"getNextPathnameInfo",{enumerable:!0,get:function(){return g}});let d=a.r(3885),e=a.r(61601),f=a.r(39481);function g(a,b){let{basePath:c,i18n:g,trailingSlash:h}=b.nextConfig??{},i={pathname:a,trailingSlash:"/"!==a?a.endsWith("/"):h};c&&(0,f.pathHasPrefix)(i.pathname,c)&&(i.pathname=(0,e.removePathPrefix)(i.pathname,c),i.basePath=c);let j=i.pathname;if(i.pathname.startsWith("/_next/data/")&&i.pathname.endsWith(".json")){let a=i.pathname.replace(/^\/_next\/data\//,"").replace(/\.json$/,"").split("/");i.buildId=a[0],j="index"!==a[1]?`/${a.slice(1).join("/")}`:"/",!0===b.parseData&&(i.pathname=j)}if(g){let a=b.i18nProvider?b.i18nProvider.analyze(i.pathname):(0,d.normalizeLocalePath)(i.pathname,g.locales);i.locale=a.detectedLocale,i.pathname=a.pathname??i.pathname,!a.detectedLocale&&i.buildId&&(a=b.i18nProvider?b.i18nProvider.analyze(j):(0,d.normalizeLocalePath)(j,g.locales)).detectedLocale&&(i.locale=a.detectedLocale)}return i}},22670,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"NextURL",{enumerable:!0,get:function(){return k}});let d=a.r(92603),e=a.r(97642),f=a.r(64239),g=a.r(94971),h=/(?!^https?:\/\/)(127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}|\[::1\]|localhost)/;function i(a,b){return new URL(String(a).replace(h,"localhost"),b&&String(b).replace(h,"localhost"))}let j=Symbol("NextURLInternal");class k{constructor(a,b,c){let d,e;"object"==typeof b&&"pathname"in b||"string"==typeof b?(d=b,e=c||{}):e=c||b||{},this[j]={url:i(a,d??e.base),options:e,basePath:""},this.analyze()}analyze(){var a,b,c,e,h;let i=(0,g.getNextPathnameInfo)(this[j].url.pathname,{nextConfig:this[j].options.nextConfig,parseData:!0,i18nProvider:this[j].options.i18nProvider}),k=(0,f.getHostname)(this[j].url,this[j].options.headers);this[j].domainLocale=this[j].options.i18nProvider?this[j].options.i18nProvider.detectDomainLocale(k):(0,d.detectDomainLocale)(null==(b=this[j].options.nextConfig)||null==(a=b.i18n)?void 0:a.domains,k);let l=(null==(c=this[j].domainLocale)?void 0:c.defaultLocale)||(null==(h=this[j].options.nextConfig)||null==(e=h.i18n)?void 0:e.defaultLocale);this[j].url.pathname=i.pathname,this[j].defaultLocale=l,this[j].basePath=i.basePath??"",this[j].buildId=i.buildId,this[j].locale=i.locale??l,this[j].trailingSlash=i.trailingSlash}formatPathname(){return(0,e.formatNextPathnameInfo)({basePath:this[j].basePath,buildId:this[j].buildId,defaultLocale:this[j].options.forceLocale?void 0:this[j].defaultLocale,locale:this[j].locale,pathname:this[j].url.pathname,trailingSlash:this[j].trailingSlash})}formatSearch(){return this[j].url.search}get buildId(){return this[j].buildId}set buildId(a){this[j].buildId=a}get locale(){return this[j].locale??""}set locale(a){var b,c;if(!this[j].locale||!(null==(c=this[j].options.nextConfig)||null==(b=c.i18n)?void 0:b.locales.includes(a)))throw Object.defineProperty(TypeError(`The NextURL configuration includes no locale "${a}"`),"__NEXT_ERROR_CODE",{value:"E597",enumerable:!1,configurable:!0});this[j].locale=a}get defaultLocale(){return this[j].defaultLocale}get domainLocale(){return this[j].domainLocale}get searchParams(){return this[j].url.searchParams}get host(){return this[j].url.host}set host(a){this[j].url.host=a}get hostname(){return this[j].url.hostname}set hostname(a){this[j].url.hostname=a}get port(){return this[j].url.port}set port(a){this[j].url.port=a}get protocol(){return this[j].url.protocol}set protocol(a){this[j].url.protocol=a}get href(){let a=this.formatPathname(),b=this.formatSearch();return`${this.protocol}//${this.host}${a}${b}${this.hash}`}set href(a){this[j].url=i(a),this.analyze()}get origin(){return this[j].url.origin}get pathname(){return this[j].url.pathname}set pathname(a){this[j].url.pathname=a}get hash(){return this[j].url.hash}set hash(a){this[j].url.hash=a}get search(){return this[j].url.search}set search(a){this[j].url.search=a}get password(){return this[j].url.password}set password(a){this[j].url.password=a}get username(){return this[j].url.username}set username(a){this[j].url.username=a}get basePath(){return this[j].basePath}set basePath(a){this[j].basePath=a.startsWith("/")?a:`/${a}`}toString(){return this.href}toJSON(){return this.href}[Symbol.for("edge-runtime.inspect.custom")](){return{href:this.href,origin:this.origin,protocol:this.protocol,username:this.username,password:this.password,host:this.host,hostname:this.hostname,port:this.port,pathname:this.pathname,search:this.search,searchParams:this.searchParams,hash:this.hash}}clone(){return new k(String(this),this[j].options)}}},89753,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={PageSignatureError:function(){return f},RemovedPageError:function(){return g},RemovedUAError:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});class f extends Error{constructor({page:a}){super(`The middleware "${a}" accepts an async API directly with the form:
  
  export function middleware(request, event) {
    return NextResponse.redirect('/new-location')
  }
  
  Read more: https://nextjs.org/docs/messages/middleware-new-signature
  `)}}class g extends Error{constructor(){super(`The request.page has been deprecated in favour of \`URLPattern\`.
  Read more: https://nextjs.org/docs/messages/middleware-request-page
  `)}}class h extends Error{constructor(){super(`The request.ua has been removed in favour of \`userAgent\` function.
  Read more: https://nextjs.org/docs/messages/middleware-parse-user-agent
  `)}}},63681,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={RequestCookies:function(){return f.RequestCookies},ResponseCookies:function(){return f.ResponseCookies},stringifyCookie:function(){return f.stringifyCookie}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(36226)},88491,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={INTERNALS:function(){return j},NextRequest:function(){return k}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(22670),g=a.r(92273),h=a.r(89753),i=a.r(63681),j=Symbol("internal request");class k extends Request{constructor(a,b={}){const c="string"!=typeof a&&"url"in a?a.url:String(a);(0,g.validateURL)(c),b.body&&"half"!==b.duplex&&(b.duplex="half"),a instanceof Request?super(a,b):super(c,b);const d=new f.NextURL(c,{headers:(0,g.toNodeOutgoingHttpHeaders)(this.headers),nextConfig:b.nextConfig});this[j]={cookies:new i.RequestCookies(this.headers),nextUrl:d,url:d.toString()}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,nextUrl:this.nextUrl,url:this.url,bodyUsed:this.bodyUsed,cache:this.cache,credentials:this.credentials,destination:this.destination,headers:Object.fromEntries(this.headers),integrity:this.integrity,keepalive:this.keepalive,method:this.method,mode:this.mode,redirect:this.redirect,referrer:this.referrer,referrerPolicy:this.referrerPolicy,signal:this.signal}}get cookies(){return this[j].cookies}get nextUrl(){return this[j].nextUrl}get page(){throw new h.RemovedPageError}get ua(){throw new h.RemovedUAError}get url(){return this[j].url}}},501,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={isNodeNextRequest:function(){return h},isNodeNextResponse:function(){return i},isWebNextRequest:function(){return f},isWebNextResponse:function(){return g}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a=>!1,g=a=>!1,h=a=>!0,i=a=>!0},17498,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={NextRequestAdapter:function(){return n},ResponseAborted:function(){return k},ResponseAbortedName:function(){return j},createAbortController:function(){return l},signalFromNodeResponse:function(){return m}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(49697),g=a.r(92273),h=a.r(88491),i=a.r(501),j="ResponseAborted";class k extends Error{constructor(...a){super(...a),this.name=j}}function l(a){let b=new AbortController;return a.once("close",()=>{a.writableFinished||b.abort(new k)}),b}function m(a){let{errored:b,destroyed:c}=a;if(b||c)return AbortSignal.abort(b??new k);let{signal:d}=l(a);return d}class n{static fromBaseNextRequest(a,b){if((0,i.isNodeNextRequest)(a))return n.fromNodeNextRequest(a,b);throw Object.defineProperty(Error("Invariant: Unsupported NextRequest type"),"__NEXT_ERROR_CODE",{value:"E345",enumerable:!1,configurable:!0})}static fromNodeNextRequest(a,b){let c,d=null;if("GET"!==a.method&&"HEAD"!==a.method&&a.body&&(d=a.body),a.url.startsWith("http"))c=new URL(a.url);else{let b=(0,f.getRequestMeta)(a,"initURL");c=b&&b.startsWith("http")?new URL(a.url,b):new URL(a.url,"http://n")}return new h.NextRequest(c,{method:a.method,headers:(0,g.fromNodeOutgoingHttpHeaders)(a.headers),duplex:"half",signal:b,...b.aborted?{}:{body:d}})}static fromWebNextRequest(a){let b=null;return"GET"!==a.method&&"HEAD"!==a.method&&(b=a.body),new h.NextRequest(a.url,{method:a.method,headers:(0,g.fromNodeOutgoingHttpHeaders)(a.headers),duplex:"half",signal:a.request.signal,...a.request.signal.aborted?{}:{body:b}})}}},86131,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={getClientComponentLoaderMetrics:function(){return j},wrapClientComponentLoader:function(){return i}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=0,g=0,h=0;function i(a){return"performance"in globalThis?{require:(...b)=>{let c=performance.now();0===f&&(f=c);try{return h+=1,a.__next_app__.require(...b)}finally{g+=performance.now()-c}},loadChunk:(...b)=>{let c=performance.now(),d=a.__next_app__.loadChunk(...b);return d.finally(()=>{g+=performance.now()-c}),d}}:a.__next_app__}function j(a={}){let b=0===f?void 0:{clientComponentLoadStart:f,clientComponentLoadTimes:g,clientComponentLoadCount:h};return a.reset&&(f=0,g=0,h=0),b}},76178,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={isAbortError:function(){return k},pipeToNodeResponse:function(){return l}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(17498),g=a.r(96194),h=a.r(46216),i=a.r(76391),j=a.r(86131);function k(a){return(null==a?void 0:a.name)==="AbortError"||(null==a?void 0:a.name)===f.ResponseAbortedName}async function l(a,b,c){try{let{errored:d,destroyed:e}=b;if(d||e)return;let k=(0,f.createAbortController)(b),l=function(a,b){let c=!1,d=new g.DetachedPromise;function e(){d.resolve()}a.on("drain",e),a.once("close",()=>{a.off("drain",e),d.resolve()});let f=new g.DetachedPromise;return a.once("finish",()=>{f.resolve()}),new WritableStream({write:async b=>{if(!c){if(c=!0,"performance"in globalThis&&process.env.NEXT_OTEL_PERFORMANCE_PREFIX){let a=(0,j.getClientComponentLoaderMetrics)();a&&performance.measure(`${process.env.NEXT_OTEL_PERFORMANCE_PREFIX}:next-client-component-loading`,{start:a.clientComponentLoadStart,end:a.clientComponentLoadStart+a.clientComponentLoadTimes})}a.flushHeaders(),(0,h.getTracer)().trace(i.NextNodeServerSpan.startResponse,{spanName:"start response"},()=>void 0)}try{let c=a.write(b);"flush"in a&&"function"==typeof a.flush&&a.flush(),c||(await d.promise,d=new g.DetachedPromise)}catch(b){throw a.end(),Object.defineProperty(Error("failed to write chunk to response",{cause:b}),"__NEXT_ERROR_CODE",{value:"E321",enumerable:!1,configurable:!0})}},abort:b=>{a.writableFinished||a.destroy(b)},close:async()=>{if(b&&await b,!a.writableFinished)return a.end(),f.promise}})}(b,c);await a.pipeTo(l,{signal:k.signal})}catch(a){if(k(a))return;throw Object.defineProperty(Error("failed to pipe response",{cause:a}),"__NEXT_ERROR_CODE",{value:"E180",enumerable:!1,configurable:!0})}}},25393,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return g}});let d=a.r(75406),e=a.r(76178),f=a.r(50640);class g{static #a=this.EMPTY=new g(null,{metadata:{},contentType:null});static fromStatic(a,b){return new g(a,{metadata:{},contentType:b})}constructor(a,{contentType:b,waitUntil:c,metadata:d}){this.response=a,this.contentType=b,this.metadata=d,this.waitUntil=c}assignMetadata(a){Object.assign(this.metadata,a)}get isNull(){return null===this.response}get isDynamic(){return"string"!=typeof this.response}toUnchunkedString(a=!1){if(null===this.response)return"";if("string"!=typeof this.response){if(!a)throw Object.defineProperty(new f.InvariantError("dynamic responses cannot be unchunked. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E732",enumerable:!1,configurable:!0});return(0,d.streamToString)(this.readable)}return this.response}get readable(){return null===this.response?new ReadableStream({start(a){a.close()}}):"string"==typeof this.response?(0,d.streamFromString)(this.response):Buffer.isBuffer(this.response)?(0,d.streamFromBuffer)(this.response):Array.isArray(this.response)?(0,d.chainStreams)(...this.response):this.response}coerce(){return null===this.response?[]:"string"==typeof this.response?[(0,d.streamFromString)(this.response)]:Array.isArray(this.response)?this.response:Buffer.isBuffer(this.response)?[(0,d.streamFromBuffer)(this.response)]:[this.response]}unshift(a){this.response=this.coerce(),this.response.unshift(a)}push(a){this.response=this.coerce(),this.response.push(a)}async pipeTo(a){try{await this.readable.pipeTo(a,{preventClose:!0}),this.waitUntil&&await this.waitUntil,await a.close()}catch(b){if((0,e.isAbortError)(b))return void await a.abort(b);throw b}}async pipeToNodeResponse(a){await (0,e.pipeToNodeResponse)(this.readable,a,this.waitUntil)}}},29756,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"RouteKind",{enumerable:!0,get:function(){return e}});var d,e=((d={}).PAGES="PAGES",d.PAGES_API="PAGES_API",d.APP_PAGE="APP_PAGE",d.APP_ROUTE="APP_ROUTE",d.IMAGE="IMAGE",d)},41333,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e={fromResponseCacheEntry:function(){return k},routeKindToIncrementalCacheKind:function(){return m},toResponseCacheEntry:function(){return l}};for(var f in e)Object.defineProperty(c,f,{enumerable:!0,get:e[f]});let g=a.r(41733),h=(d=a.r(25393))&&d.__esModule?d:{default:d},i=a.r(29756),j=a.r(99870);async function k(a){var b,c;return{...a,value:(null==(b=a.value)?void 0:b.kind)===g.CachedRouteKind.PAGES?{kind:g.CachedRouteKind.PAGES,html:await a.value.html.toUnchunkedString(!0),pageData:a.value.pageData,headers:a.value.headers,status:a.value.status}:(null==(c=a.value)?void 0:c.kind)===g.CachedRouteKind.APP_PAGE?{kind:g.CachedRouteKind.APP_PAGE,html:await a.value.html.toUnchunkedString(!0),postponed:a.value.postponed,rscData:a.value.rscData,headers:a.value.headers,status:a.value.status,segmentData:a.value.segmentData}:a.value}}async function l(a){var b,c;return a?{isMiss:a.isMiss,isStale:a.isStale,cacheControl:a.cacheControl,value:(null==(b=a.value)?void 0:b.kind)===g.CachedRouteKind.PAGES?{kind:g.CachedRouteKind.PAGES,html:h.default.fromStatic(a.value.html,j.HTML_CONTENT_TYPE_HEADER),pageData:a.value.pageData,headers:a.value.headers,status:a.value.status}:(null==(c=a.value)?void 0:c.kind)===g.CachedRouteKind.APP_PAGE?{kind:g.CachedRouteKind.APP_PAGE,html:h.default.fromStatic(a.value.html,j.HTML_CONTENT_TYPE_HEADER),rscData:a.value.rscData,headers:a.value.headers,status:a.value.status,postponed:a.value.postponed,segmentData:a.value.segmentData}:a.value}:null}function m(a){switch(a){case i.RouteKind.PAGES:return g.IncrementalCacheKind.PAGES;case i.RouteKind.APP_PAGE:return g.IncrementalCacheKind.APP_PAGE;case i.RouteKind.IMAGE:return g.IncrementalCacheKind.IMAGE;case i.RouteKind.APP_ROUTE:return g.IncrementalCacheKind.APP_ROUTE;case i.RouteKind.PAGES_API:throw Object.defineProperty(Error(`Unexpected route kind ${a}`),"__NEXT_ERROR_CODE",{value:"E64",enumerable:!1,configurable:!0});default:return a}}},24653,(a,b,c)=>{"use strict";var d,e;Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return i}});let f=a.r(88690),g=a.r(61933),h=a.r(41333);d=a.r(41733),e=c,Object.keys(d).forEach(function(a){"default"===a||Object.prototype.hasOwnProperty.call(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:function(){return d[a]}})});class i{constructor(a){this.getBatcher=f.Batcher.create({cacheKeyFn:({key:a,isOnDemandRevalidate:b})=>`${a}-${b?"1":"0"}`,schedulerFn:g.scheduleOnNextTick}),this.revalidateBatcher=f.Batcher.create({schedulerFn:g.scheduleOnNextTick}),this.minimal_mode=a}async get(a,b,c){var d;if(!a)return b({hasResolved:!1,previousCacheEntry:null});if(this.minimal_mode&&(null==(d=this.previousCacheItem)?void 0:d.key)===a&&this.previousCacheItem.expiresAt>Date.now())return(0,h.toResponseCacheEntry)(this.previousCacheItem.entry);let{incrementalCache:e,isOnDemandRevalidate:f=!1,isFallback:g=!1,isRoutePPREnabled:i=!1,isPrefetch:j=!1,waitUntil:k,routeKind:l}=c,m=await this.getBatcher.batch({key:a,isOnDemandRevalidate:f},({resolve:c})=>{let d=this.handleGet(a,b,{incrementalCache:e,isOnDemandRevalidate:f,isFallback:g,isRoutePPREnabled:i,isPrefetch:j,routeKind:l},c);return k&&k(d),d});return(0,h.toResponseCacheEntry)(m)}async handleGet(a,b,c,d){let e=null,f=!1;try{if((e=this.minimal_mode?null:await c.incrementalCache.get(a,{kind:(0,h.routeKindToIncrementalCacheKind)(c.routeKind),isRoutePPREnabled:c.isRoutePPREnabled,isFallback:c.isFallback}))&&!c.isOnDemandRevalidate&&(d(e),f=!0,!e.isStale||c.isPrefetch))return e;let g=await this.revalidate(a,c.incrementalCache,c.isRoutePPREnabled,c.isFallback,b,e,null!==e&&!c.isOnDemandRevalidate);if(!g)return this.minimal_mode&&(this.previousCacheItem=void 0),null;return c.isOnDemandRevalidate,g}catch(a){if(f)return console.error(a),null;throw a}}async revalidate(a,b,c,d,e,f,g,h){return this.revalidateBatcher.batch(a,()=>{let i=this.handleRevalidate(a,b,c,d,e,f,g);return h&&h(i),i})}async handleRevalidate(a,b,c,d,e,f,g){try{let i=await e({hasResolved:g,previousCacheEntry:f,isRevalidating:!0});if(!i)return null;let j=await (0,h.fromResponseCacheEntry)({...i,isMiss:!f});return j.cacheControl&&(this.minimal_mode?this.previousCacheItem={key:a,entry:j,expiresAt:Date.now()+1e3}:await b.set(a,j.value,{cacheControl:j.cacheControl,isRoutePPREnabled:c,isFallback:d})),j}catch(e){if(null==f?void 0:f.cacheControl){let e=Math.min(Math.max(f.cacheControl.revalidate||3,3),30),g=void 0===f.cacheControl.expire?void 0:Math.max(e+3,f.cacheControl.expire);await b.set(a,f.value,{cacheControl:{revalidate:e,expire:g},isRoutePPREnabled:c,isFallback:d})}throw e}}}},26095,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={NEXT_PATCH_SYMBOL:function(){return o},createPatchedFetcher:function(){return u},patchFetch:function(){return v},validateRevalidate:function(){return p},validateTags:function(){return q}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(76391),g=a.r(46216),h=a.r(99870),i=a.r(60384),j=a.r(13091),k=a.r(1786),l=a.r(32319),m=a.r(24653),n=a.r(5723);a.r(31382);let o=Symbol.for("next-patch");function p(a,b){try{let c;if(!1===a)c=h.INFINITE_CACHE;else if("number"==typeof a&&!isNaN(a)&&a>-1)c=a;else if(void 0!==a)throw Object.defineProperty(Error(`Invalid revalidate value "${a}" on "${b}", must be a non-negative number or false`),"__NEXT_ERROR_CODE",{value:"E179",enumerable:!1,configurable:!0});return c}catch(a){if(a instanceof Error&&a.message.includes("Invalid revalidate"))throw a;return}}function q(a,b){let c=[],d=[];for(let e=0;e<a.length;e++){let f=a[e];if("string"!=typeof f?d.push({tag:f,reason:"invalid type, must be a string"}):f.length>h.NEXT_CACHE_TAG_MAX_LENGTH?d.push({tag:f,reason:`exceeded max length of ${h.NEXT_CACHE_TAG_MAX_LENGTH}`}):c.push(f),c.length>h.NEXT_CACHE_TAG_MAX_ITEMS){console.warn(`Warning: exceeded max tag count for ${b}, dropped tags:`,a.slice(e).join(", "));break}}if(d.length>0)for(let{tag:a,reason:c}of(console.warn(`Warning: invalid tags passed to ${b}: `),d))console.log(`tag: "${a}" ${c}`);return c}function r(a,b){a.shouldTrackFetchMetrics&&(a.fetchMetrics??=[],a.fetchMetrics.push({...b,end:performance.timeOrigin+performance.now(),idx:a.nextFetchId||0}))}async function s(a,b,c,d,e,f){let g=await a.arrayBuffer(),h={headers:Object.fromEntries(a.headers.entries()),body:Buffer.from(g).toString("base64"),status:a.status,url:a.url};return c&&await d.set(b,{kind:m.CachedRouteKind.FETCH,data:h,revalidate:e},c),await f(),new Response(g,{headers:a.headers,status:a.status,statusText:a.statusText})}async function t(a,b,c,d,e,f,g,h,i){let[j,k]=(0,n.cloneResponse)(b),l=j.arrayBuffer().then(async a=>{let b=Buffer.from(a),h={headers:Object.fromEntries(j.headers.entries()),body:b.toString("base64"),status:j.status,url:j.url};null==f||f.set(c,h),d&&await e.set(c,{kind:m.CachedRouteKind.FETCH,data:h,revalidate:g},d)}).catch(a=>console.warn("Failed to set fetch cache",h,a)).finally(i),o=`cache-set-${c}`;return a.pendingRevalidates??={},o in a.pendingRevalidates&&await a.pendingRevalidates[o],a.pendingRevalidates[o]=l.finally(()=>{var b;(null==(b=a.pendingRevalidates)?void 0:b[o])&&delete a.pendingRevalidates[o]}),k}function u(a,{workAsyncStorage:b,workUnitAsyncStorage:c}){let d=async function(d,e){var k,o;let u;try{(u=new URL(d instanceof Request?d.url:d)).username="",u.password=""}catch{u=void 0}let v=(null==u?void 0:u.href)??"",x=(null==e||null==(k=e.method)?void 0:k.toUpperCase())||"GET",y=(null==e||null==(o=e.next)?void 0:o.internal)===!0,z="1"===process.env.NEXT_OTEL_FETCH_DISABLED,A=y?void 0:performance.timeOrigin+performance.now(),B=b.getStore(),C=c.getStore(),D=C?(0,l.getCacheSignal)(C):null;D&&D.beginRead();let E=(0,g.getTracer)().trace(y?f.NextNodeServerSpan.internalFetch:f.AppRenderSpan.fetch,{hideSpan:z,kind:g.SpanKind.CLIENT,spanName:["fetch",x,v].filter(Boolean).join(" "),attributes:{"http.url":v,"http.method":x,"net.peer.name":null==u?void 0:u.hostname,"net.peer.port":(null==u?void 0:u.port)||void 0}},async()=>{var b;let c,f,g,k,l,o;if(y||!B||B.isDraftMode)return a(d,e);let u=d&&"object"==typeof d&&"string"==typeof d.method,x=a=>(null==e?void 0:e[a])||(u?d[a]:null),z=a=>{var b,c,f;return void 0!==(null==e||null==(b=e.next)?void 0:b[a])?null==e||null==(c=e.next)?void 0:c[a]:u?null==(f=d.next)?void 0:f[a]:void 0},E=z("revalidate"),F=E,G=q(z("tags")||[],`fetch ${d.toString()}`);if(C)switch(C.type){case"prerender":case"prerender-runtime":case"prerender-client":case"prerender-ppr":case"prerender-legacy":case"cache":case"private-cache":c=C}if(c&&Array.isArray(G)){let a=c.tags??(c.tags=[]);for(let b of G)a.includes(b)||a.push(b)}let H=null==C?void 0:C.implicitTags,I=B.fetchCache;C&&"unstable-cache"===C.type&&(I="force-no-store");let J=!!B.isUnstableNoStore,K=x("cache"),L="";"string"==typeof K&&void 0!==F&&("force-cache"===K&&0===F||"no-store"===K&&(F>0||!1===F))&&(f=`Specified "cache: ${K}" and "revalidate: ${F}", only one should be specified.`,K=void 0,F=void 0);let M="no-cache"===K||"no-store"===K||"force-no-store"===I||"only-no-store"===I,N=!I&&!K&&!F&&B.forceDynamic;"force-cache"===K&&void 0===F?F=!1:(M||N)&&(F=0),("no-cache"===K||"no-store"===K)&&(L=`cache: ${K}`),o=p(F,B.route);let O=x("headers"),P="function"==typeof(null==O?void 0:O.get)?O:new Headers(O||{}),Q=P.get("authorization")||P.get("cookie"),R=!["get","head"].includes((null==(b=x("method"))?void 0:b.toLowerCase())||"get"),S=void 0==I&&(void 0==K||"default"===K)&&void 0==F,T=!!((Q||R)&&(null==c?void 0:c.revalidate)===0),U=!1;if(!T&&S&&(B.isBuildTimePrerendering?U=!0:T=!0),S&&void 0!==C)switch(C.type){case"prerender":case"prerender-runtime":case"prerender-client":return D&&(D.endRead(),D=null),(0,j.makeHangingPromise)(C.renderSignal,B.route,"fetch()")}switch(I){case"force-no-store":L="fetchCache = force-no-store";break;case"only-no-store":if("force-cache"===K||void 0!==o&&o>0)throw Object.defineProperty(Error(`cache: 'force-cache' used on fetch for ${v} with 'export const fetchCache = 'only-no-store'`),"__NEXT_ERROR_CODE",{value:"E448",enumerable:!1,configurable:!0});L="fetchCache = only-no-store";break;case"only-cache":if("no-store"===K)throw Object.defineProperty(Error(`cache: 'no-store' used on fetch for ${v} with 'export const fetchCache = 'only-cache'`),"__NEXT_ERROR_CODE",{value:"E521",enumerable:!1,configurable:!0});break;case"force-cache":(void 0===F||0===F)&&(L="fetchCache = force-cache",o=h.INFINITE_CACHE)}if(void 0===o?"default-cache"!==I||J?"default-no-store"===I?(o=0,L="fetchCache = default-no-store"):J?(o=0,L="noStore call"):T?(o=0,L="auto no cache"):(L="auto cache",o=c?c.revalidate:h.INFINITE_CACHE):(o=h.INFINITE_CACHE,L="fetchCache = default-cache"):L||(L=`revalidate: ${o}`),!(B.forceStatic&&0===o)&&!T&&c&&o<c.revalidate){if(0===o){if(C)switch(C.type){case"prerender":case"prerender-client":case"prerender-runtime":return D&&(D.endRead(),D=null),(0,j.makeHangingPromise)(C.renderSignal,B.route,"fetch()")}(0,i.markCurrentScopeAsDynamic)(B,C,`revalidate: 0 fetch ${d} ${B.route}`)}c&&E===o&&(c.revalidate=o)}let V="number"==typeof o&&o>0,{incrementalCache:W}=B,X=!1;if(C)switch(C.type){case"request":case"cache":case"private-cache":X=C.isHmrRefresh??!1,k=C.serverComponentsHmrCache}if(W&&(V||k))try{g=await W.generateCacheKey(v,u?d:e)}catch(a){console.error("Failed to generate cache key for",d)}let Y=B.nextFetchId??1;B.nextFetchId=Y+1;let Z=()=>{},$=async(b,c)=>{let i=["cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","window","duplex",...b?[]:["signal"]];if(u){let a=d,b={body:a._ogBody||a.body};for(let c of i)b[c]=a[c];d=new Request(a.url,b)}else if(e){let{_ogBody:a,body:c,signal:d,...f}=e;e={...f,body:a||c,signal:b?void 0:d}}let j={...e,next:{...null==e?void 0:e.next,fetchType:"origin",fetchIdx:Y}};return a(d,j).then(async a=>{if(!b&&A&&r(B,{start:A,url:v,cacheReason:c||L,cacheStatus:0===o||c?"skip":"miss",cacheWarning:f,status:a.status,method:j.method||"GET"}),200===a.status&&W&&g&&(V||k)){let b=o>=h.INFINITE_CACHE?h.CACHE_ONE_YEAR:o,c=V?{fetchCache:!0,fetchUrl:v,fetchIdx:Y,tags:G,isImplicitBuildTimeCache:U}:void 0;switch(null==C?void 0:C.type){case"prerender":case"prerender-client":case"prerender-runtime":return s(a,g,c,W,b,Z);case"request":case"prerender-ppr":case"prerender-legacy":case"cache":case"private-cache":case"unstable-cache":case void 0:return t(B,a,g,c,W,k,b,d,Z)}}return await Z(),a}).catch(a=>{throw Z(),a})},_=!1,aa=!1;if(g&&W){let a;if(X&&k&&(a=k.get(g),aa=!0),V&&!a){Z=await W.lock(g);let b=B.isOnDemandRevalidate?null:await W.get(g,{kind:m.IncrementalCacheKind.FETCH,revalidate:o,fetchUrl:v,fetchIdx:Y,tags:G,softTags:null==H?void 0:H.tags});if(S&&C)switch(C.type){case"prerender":case"prerender-client":case"prerender-runtime":await (w||(w=new Promise(a=>{setTimeout(()=>{w=null,a()},0)})),w)}if(b?await Z():l="cache-control: no-cache (hard refresh)",(null==b?void 0:b.value)&&b.value.kind===m.CachedRouteKind.FETCH)if(B.isStaticGeneration&&b.isStale)_=!0;else{if(b.isStale&&(B.pendingRevalidates??={},!B.pendingRevalidates[g])){let a=$(!0).then(async a=>({body:await a.arrayBuffer(),headers:a.headers,status:a.status,statusText:a.statusText})).finally(()=>{B.pendingRevalidates??={},delete B.pendingRevalidates[g||""]});a.catch(console.error),B.pendingRevalidates[g]=a}a=b.value.data}}if(a){A&&r(B,{start:A,url:v,cacheReason:L,cacheStatus:aa?"hmr":"hit",cacheWarning:f,status:a.status||200,method:(null==e?void 0:e.method)||"GET"});let b=new Response(Buffer.from(a.body,"base64"),{headers:a.headers,status:a.status});return Object.defineProperty(b,"url",{value:a.url}),b}}if(B.isStaticGeneration&&e&&"object"==typeof e){let{cache:a}=e;if("no-store"===a){if(C)switch(C.type){case"prerender":case"prerender-client":case"prerender-runtime":return D&&(D.endRead(),D=null),(0,j.makeHangingPromise)(C.renderSignal,B.route,"fetch()")}(0,i.markCurrentScopeAsDynamic)(B,C,`no-store fetch ${d} ${B.route}`)}let b="next"in e,{next:f={}}=e;if("number"==typeof f.revalidate&&c&&f.revalidate<c.revalidate){if(0===f.revalidate){if(C)switch(C.type){case"prerender":case"prerender-client":case"prerender-runtime":return(0,j.makeHangingPromise)(C.renderSignal,B.route,"fetch()")}(0,i.markCurrentScopeAsDynamic)(B,C,`revalidate: 0 fetch ${d} ${B.route}`)}B.forceStatic&&0===f.revalidate||(c.revalidate=f.revalidate)}b&&delete e.next}if(!g||!_)return $(!1,l);{let a=g;B.pendingRevalidates??={};let b=B.pendingRevalidates[a];if(b){let a=await b;return new Response(a.body,{headers:a.headers,status:a.status,statusText:a.statusText})}let c=$(!0,l).then(n.cloneResponse);return(b=c.then(async a=>{let b=a[0];return{body:await b.arrayBuffer(),headers:b.headers,status:b.status,statusText:b.statusText}}).finally(()=>{var b;(null==(b=B.pendingRevalidates)?void 0:b[a])&&delete B.pendingRevalidates[a]})).catch(()=>{}),B.pendingRevalidates[a]=b,c.then(a=>a[1])}});if(D)try{return await E}finally{D&&D.endRead()}return E};return d.__nextPatched=!0,d.__nextGetStaticStore=()=>b,d._nextOriginalFetch=a,globalThis[o]=!0,Object.defineProperty(d,"name",{value:"fetch",writable:!1}),d}function v(a){if(!0===globalThis[o])return;let b=(0,k.createDedupeFetch)(globalThis.fetch);globalThis.fetch=u(b,a)}let w=null},71632,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"unstable_cache",{enumerable:!0,get:function(){return k}});let d=a.r(99870),e=a.r(26095),f=a.r(56704),g=a.r(32319),h=a.r(24653),i=0;async function j(a,b,c,e,f,g,i){await b.set(c,{kind:h.CachedRouteKind.FETCH,data:{headers:{},body:JSON.stringify(a),status:200,url:""},revalidate:"number"!=typeof f?d.CACHE_ONE_YEAR:f},{fetchCache:!0,tags:e,fetchIdx:g,fetchUrl:i})}function k(a,b,c={}){if(0===c.revalidate)throw Object.defineProperty(Error(`Invariant revalidate: 0 can not be passed to unstable_cache(), must be "false" or "> 0" ${a.toString()}`),"__NEXT_ERROR_CODE",{value:"E57",enumerable:!1,configurable:!0});let d=c.tags?(0,e.validateTags)(c.tags,`unstable_cache ${a.toString()}`):[];(0,e.validateRevalidate)(c.revalidate,`unstable_cache ${a.name||a.toString()}`);let l=`${a.toString()}-${Array.isArray(b)&&b.join(",")}`;return async(...b)=>{let e=f.workAsyncStorage.getStore(),k=g.workUnitAsyncStorage.getStore(),m=(null==e?void 0:e.incrementalCache)||globalThis.__incrementalCache;if(!m)throw Object.defineProperty(Error(`Invariant: incrementalCache missing in unstable_cache ${a.toString()}`),"__NEXT_ERROR_CODE",{value:"E469",enumerable:!1,configurable:!0});let n=k?(0,g.getCacheSignal)(k):null;n&&n.beginRead();try{let f=e&&k?function(a,b){switch(b.type){case"request":let c=b.url.pathname,d=new URLSearchParams(b.url.search),e=[...d.keys()].sort((a,b)=>a.localeCompare(b)).map(a=>`${a}=${d.get(a)}`).join("&");return`${c}${e.length?"?":""}${e}`;case"prerender":case"prerender-client":case"prerender-runtime":case"prerender-ppr":case"prerender-legacy":case"cache":case"private-cache":case"unstable-cache":return a.route;default:return b}}(e,k):"",n=`${l}-${JSON.stringify(b)}`,o=await m.generateCacheKey(n),p=`unstable_cache ${f} ${a.name?` ${a.name}`:o}`,q=(e?e.nextFetchId:i)??1,r=null==k?void 0:k.implicitTags,s={type:"unstable-cache",phase:"render",implicitTags:r,draftMode:k&&e&&(0,g.getDraftModeProviderForCacheScope)(e,k)};if(e){e.nextFetchId=q+1;let f=!1;if(k)switch(k.type){case"cache":case"private-cache":case"prerender":case"prerender-runtime":case"prerender-ppr":case"prerender-legacy":"number"==typeof c.revalidate&&(k.revalidate<c.revalidate||(k.revalidate=c.revalidate));let i=k.tags;if(null===i)k.tags=d.slice();else for(let a of d)i.includes(a)||i.push(a);break;case"unstable-cache":f=!0}if(!f&&"force-no-store"!==e.fetchCache&&!e.isOnDemandRevalidate&&!m.isOnDemandRevalidate&&!e.isDraftMode){let f=await m.get(o,{kind:h.IncrementalCacheKind.FETCH,revalidate:c.revalidate,tags:d,softTags:null==r?void 0:r.tags,fetchIdx:q,fetchUrl:p});if(f&&f.value)if(f.value.kind!==h.CachedRouteKind.FETCH)console.error(`Invariant invalid cacheEntry returned for ${n}`);else{let h=void 0!==f.value.data.body?JSON.parse(f.value.data.body):void 0;if(f.isStale){if(e.pendingRevalidates||(e.pendingRevalidates={}),!e.pendingRevalidates[n]){let f=g.workUnitAsyncStorage.run(s,a,...b).then(async a=>(await j(a,m,o,d,c.revalidate,q,p),a)).catch(a=>(console.error(`revalidating cache with key: ${n}`,a),h));e.isStaticGeneration&&f.catch(()=>{}),e.pendingRevalidates[n]=f}if(e.isStaticGeneration)return e.pendingRevalidates[n]}return h}}let l=await g.workUnitAsyncStorage.run(s,a,...b);return e.isDraftMode||(e.pendingRevalidates||(e.pendingRevalidates={}),e.pendingRevalidates[n]=j(l,m,o,d,c.revalidate,q,p)),l}{if(i+=1,!m.isOnDemandRevalidate){let a=await m.get(o,{kind:h.IncrementalCacheKind.FETCH,revalidate:c.revalidate,tags:d,fetchIdx:q,fetchUrl:p,softTags:null==r?void 0:r.tags});if(a&&a.value){if(a.value.kind!==h.CachedRouteKind.FETCH)console.error(`Invariant invalid cacheEntry returned for ${n}`);else if(!a.isStale)return void 0!==a.value.data.body?JSON.parse(a.value.data.body):void 0}}let e=await g.workUnitAsyncStorage.run(s,a,...b);return await j(e,m,o,d,c.revalidate,q,p),e}}finally{n&&n.endRead()}}}},46043,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={getSortedRouteObjects:function(){return h},getSortedRoutes:function(){return g}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});class f{insert(a){this._insert(a.split("/").filter(Boolean),[],!1)}smoosh(){return this._smoosh()}_smoosh(a="/"){let b=[...this.children.keys()].sort();null!==this.slugName&&b.splice(b.indexOf("[]"),1),null!==this.restSlugName&&b.splice(b.indexOf("[...]"),1),null!==this.optionalRestSlugName&&b.splice(b.indexOf("[[...]]"),1);let c=b.map(b=>this.children.get(b)._smoosh(`${a}${b}/`)).reduce((a,b)=>[...a,...b],[]);if(null!==this.slugName&&c.push(...this.children.get("[]")._smoosh(`${a}[${this.slugName}]/`)),!this.placeholder){let b="/"===a?"/":a.slice(0,-1);if(null!=this.optionalRestSlugName)throw Object.defineProperty(Error(`You cannot define a route with the same specificity as a optional catch-all route ("${b}" and "${b}[[...${this.optionalRestSlugName}]]").`),"__NEXT_ERROR_CODE",{value:"E458",enumerable:!1,configurable:!0});c.unshift(b)}return null!==this.restSlugName&&c.push(...this.children.get("[...]")._smoosh(`${a}[...${this.restSlugName}]/`)),null!==this.optionalRestSlugName&&c.push(...this.children.get("[[...]]")._smoosh(`${a}[[...${this.optionalRestSlugName}]]/`)),c}_insert(a,b,c){if(0===a.length){this.placeholder=!1;return}if(c)throw Object.defineProperty(Error("Catch-all must be the last part of the URL."),"__NEXT_ERROR_CODE",{value:"E392",enumerable:!1,configurable:!0});let d=a[0];if(d.startsWith("[")&&d.endsWith("]")){let f=d.slice(1,-1),g=!1;if(f.startsWith("[")&&f.endsWith("]")&&(f=f.slice(1,-1),g=!0),f.startsWith(""))throw Object.defineProperty(Error(`Detected a three-dot character ('') at ('${f}'). Did you mean ('...')?`),"__NEXT_ERROR_CODE",{value:"E147",enumerable:!1,configurable:!0});if(f.startsWith("...")&&(f=f.substring(3),c=!0),f.startsWith("[")||f.endsWith("]"))throw Object.defineProperty(Error(`Segment names may not start or end with extra brackets ('${f}').`),"__NEXT_ERROR_CODE",{value:"E421",enumerable:!1,configurable:!0});if(f.startsWith("."))throw Object.defineProperty(Error(`Segment names may not start with erroneous periods ('${f}').`),"__NEXT_ERROR_CODE",{value:"E288",enumerable:!1,configurable:!0});function e(a,c){if(null!==a&&a!==c)throw Object.defineProperty(Error(`You cannot use different slug names for the same dynamic path ('${a}' !== '${c}').`),"__NEXT_ERROR_CODE",{value:"E337",enumerable:!1,configurable:!0});b.forEach(a=>{if(a===c)throw Object.defineProperty(Error(`You cannot have the same slug name "${c}" repeat within a single dynamic path`),"__NEXT_ERROR_CODE",{value:"E247",enumerable:!1,configurable:!0});if(a.replace(/\W/g,"")===d.replace(/\W/g,""))throw Object.defineProperty(Error(`You cannot have the slug names "${a}" and "${c}" differ only by non-word symbols within a single dynamic path`),"__NEXT_ERROR_CODE",{value:"E499",enumerable:!1,configurable:!0})}),b.push(c)}if(c)if(g){if(null!=this.restSlugName)throw Object.defineProperty(Error(`You cannot use both an required and optional catch-all route at the same level ("[...${this.restSlugName}]" and "${a[0]}" ).`),"__NEXT_ERROR_CODE",{value:"E299",enumerable:!1,configurable:!0});e(this.optionalRestSlugName,f),this.optionalRestSlugName=f,d="[[...]]"}else{if(null!=this.optionalRestSlugName)throw Object.defineProperty(Error(`You cannot use both an optional and required catch-all route at the same level ("[[...${this.optionalRestSlugName}]]" and "${a[0]}").`),"__NEXT_ERROR_CODE",{value:"E300",enumerable:!1,configurable:!0});e(this.restSlugName,f),this.restSlugName=f,d="[...]"}else{if(g)throw Object.defineProperty(Error(`Optional route parameters are not yet supported ("${a[0]}").`),"__NEXT_ERROR_CODE",{value:"E435",enumerable:!1,configurable:!0});e(this.slugName,f),this.slugName=f,d="[]"}}this.children.has(d)||this.children.set(d,new f),this.children.get(d)._insert(a.slice(1),b,c)}constructor(){this.placeholder=!0,this.children=new Map,this.slugName=null,this.restSlugName=null,this.optionalRestSlugName=null}}function g(a){let b=new f;return a.forEach(a=>b.insert(a)),b.smoosh()}function h(a,b){let c={},d=[];for(let e=0;e<a.length;e++){let f=b(a[e]);c[f]=e,d[e]=f}return g(d).map(b=>a[c[b]])}},73576,(a,b,c)=>{"use strict";function d(a){return a.startsWith("/")?a:`/${a}`}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureLeadingSlash",{enumerable:!0,get:function(){return d}})},98698,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={DEFAULT_SEGMENT_KEY:function(){return l},PAGE_SEGMENT_KEY:function(){return k},addSearchParamsIfPageSegment:function(){return i},computeSelectedLayoutSegment:function(){return j},getSegmentValue:function(){return f},getSelectedLayoutSegmentPath:function(){return function a(b,c,d=!0,e=[]){let g;if(d)g=b[1][c];else{let a=b[1];g=a.children??Object.values(a)[0]}if(!g)return e;let h=f(g[0]);return!h||h.startsWith(k)?e:(e.push(h),a(g,c,!1,e))}},isGroupSegment:function(){return g},isParallelRouteSegment:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(a){return Array.isArray(a)?a[1]:a}function g(a){return"("===a[0]&&a.endsWith(")")}function h(a){return a.startsWith("@")&&"@children"!==a}function i(a,b){if(a.includes(k)){let a=JSON.stringify(b);return"{}"!==a?k+"?"+a:k}return a}function j(a,b){if(!a||0===a.length)return null;let c="children"===b?a[0]:a[a.length-1];return c===l?null:c}let k="__PAGE__",l="__DEFAULT__"},5847,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={normalizeAppPath:function(){return h},normalizeRscURL:function(){return i}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(73576),g=a.r(98698);function h(a){return(0,f.ensureLeadingSlash)(a.split("/").reduce((a,b,c,d)=>!b||(0,g.isGroupSegment)(b)||"@"===b[0]||("page"===b||"route"===b)&&c===d.length-1?a:`${a}/${b}`,""))}function i(a){return a.replace(/\.rsc($|\?)/,"$1")}},97908,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={INTERCEPTION_ROUTE_MARKERS:function(){return g},extractInterceptionRouteInformation:function(){return i},isInterceptionRouteAppPath:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(5847),g=["(..)(..)","(.)","(..)","(...)"];function h(a){return void 0!==a.split("/").find(a=>g.find(b=>a.startsWith(b)))}function i(a){let b,c,d;for(let e of a.split("/"))if(c=g.find(a=>e.startsWith(a))){[b,d]=a.split(c,2);break}if(!b||!c||!d)throw Object.defineProperty(Error(`Invalid interception route: ${a}. Must be in the format /<intercepting route>/(..|...|..)(..)/<intercepted route>`),"__NEXT_ERROR_CODE",{value:"E269",enumerable:!1,configurable:!0});switch(b=(0,f.normalizeAppPath)(b),c){case"(.)":d="/"===b?`/${d}`:b+"/"+d;break;case"(..)":if("/"===b)throw Object.defineProperty(Error(`Invalid interception route: ${a}. Cannot use (..) marker at the root level, use (.) instead.`),"__NEXT_ERROR_CODE",{value:"E207",enumerable:!1,configurable:!0});d=b.split("/").slice(0,-1).concat(d).join("/");break;case"(...)":d="/"+d;break;case"(..)(..)":let e=b.split("/");if(e.length<=2)throw Object.defineProperty(Error(`Invalid interception route: ${a}. Cannot use (..)(..) marker at the root level or one level up.`),"__NEXT_ERROR_CODE",{value:"E486",enumerable:!1,configurable:!0});d=e.slice(0,-2).concat(d).join("/");break;default:throw Object.defineProperty(Error("Invariant: unexpected marker"),"__NEXT_ERROR_CODE",{value:"E112",enumerable:!1,configurable:!0})}return{interceptingRoute:b,interceptedRoute:d}}},82966,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"isDynamicRoute",{enumerable:!0,get:function(){return g}});let d=a.r(97908),e=/\/[^/]*\[[^/]+\][^/]*(?=\/|$)/,f=/\/\[[^/]+\](?=\/|$)/;function g(a,b=!0){return((0,d.isInterceptionRouteAppPath)(a)&&(a=(0,d.extractInterceptionRouteInformation)(a).interceptedRoute),b)?f.test(a):e.test(a)}},19228,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={getSortedRouteObjects:function(){return f.getSortedRouteObjects},getSortedRoutes:function(){return f.getSortedRoutes},isDynamicRoute:function(){return g.isDynamicRoute}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(46043),g=a.r(82966)},65819,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={refresh:function(){return o},revalidatePath:function(){return p},revalidateTag:function(){return m},updateTag:function(){return n}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(60384),g=a.r(19228),h=a.r(99870),i=a.r(56704),j=a.r(32319),k=a.r(96556),l=a.r(50640);function m(a,b){return b||console.warn('"revalidateTag" without the second argument is now deprecated, add second argument of "max" or use "updateTag". See more info here: https://nextjs.org/docs/messages/revalidate-tag-single-arg'),q([a],`revalidateTag ${a}`,b)}function n(a){let b=i.workAsyncStorage.getStore();if(!b||b.page.endsWith("/route"))throw Object.defineProperty(Error("updateTag can only be called from within a Server Action. To invalidate cache tags in Route Handlers or other contexts, use revalidateTag instead. See more info here: https://nextjs.org/docs/app/api-reference/functions/updateTag"),"__NEXT_ERROR_CODE",{value:"E872",enumerable:!1,configurable:!0});return q([a],`updateTag ${a}`,void 0)}function o(){let a=i.workAsyncStorage.getStore(),b=j.workUnitAsyncStorage.getStore();if(!a||a.page.endsWith("/route")||(null==b?void 0:b.phase)!=="action")throw Object.defineProperty(Error("refresh can only be called from within a Server Action. See more info here: https://nextjs.org/docs/app/api-reference/functions/refresh"),"__NEXT_ERROR_CODE",{value:"E870",enumerable:!1,configurable:!0});a&&(a.pathWasRevalidated=!0)}function p(a,b){if(a.length>h.NEXT_CACHE_SOFT_TAG_MAX_LENGTH)return void console.warn(`Warning: revalidatePath received "${a}" which exceeded max length of ${h.NEXT_CACHE_SOFT_TAG_MAX_LENGTH}. See more info here https://nextjs.org/docs/app/api-reference/functions/revalidatePath`);let c=`${h.NEXT_CACHE_IMPLICIT_TAG_ID}${a||"/"}`;b?c+=`${c.endsWith("/")?"":"/"}${b}`:(0,g.isDynamicRoute)(a)&&console.warn(`Warning: a dynamic page path "${a}" was passed to "revalidatePath", but the "type" parameter is missing. This has no effect by default, see more info here https://nextjs.org/docs/app/api-reference/functions/revalidatePath`);let d=[c];return c===`${h.NEXT_CACHE_IMPLICIT_TAG_ID}/`?d.push(`${h.NEXT_CACHE_IMPLICIT_TAG_ID}/index`):c===`${h.NEXT_CACHE_IMPLICIT_TAG_ID}/index`&&d.push(`${h.NEXT_CACHE_IMPLICIT_TAG_ID}/`),q(d,`revalidatePath ${a}`)}function q(a,b,c){var d;let e=i.workAsyncStorage.getStore();if(!e||!e.incrementalCache)throw Object.defineProperty(Error(`Invariant: static generation store missing in ${b}`),"__NEXT_ERROR_CODE",{value:"E263",enumerable:!1,configurable:!0});let g=j.workUnitAsyncStorage.getStore();if(g){if("render"===g.phase)throw Object.defineProperty(Error(`Route ${e.route} used "${b}" during render which is unsupported. To ensure revalidation is performed consistently it must always happen outside of renders and cached functions. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E7",enumerable:!1,configurable:!0});switch(g.type){case"cache":case"private-cache":throw Object.defineProperty(Error(`Route ${e.route} used "${b}" inside a "use cache" which is unsupported. To ensure revalidation is performed consistently it must always happen outside of renders and cached functions. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E181",enumerable:!1,configurable:!0});case"unstable-cache":throw Object.defineProperty(Error(`Route ${e.route} used "${b}" inside a function cached with "unstable_cache(...)" which is unsupported. To ensure revalidation is performed consistently it must always happen outside of renders and cached functions. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E306",enumerable:!1,configurable:!0});case"prerender":case"prerender-runtime":let a=Object.defineProperty(Error(`Route ${e.route} used ${b} without first calling \`await connection()\`.`),"__NEXT_ERROR_CODE",{value:"E406",enumerable:!1,configurable:!0});return(0,f.abortAndThrowOnSynchronousRequestDataAccess)(e.route,b,a,g);case"prerender-client":throw Object.defineProperty(new l.InvariantError(`${b} must not be used within a client component. Next.js should be preventing ${b} from being included in client components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E693",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,f.postponeWithTracking)(e.route,b,g.dynamicTracking);case"prerender-legacy":g.revalidate=0;let c=Object.defineProperty(new k.DynamicServerError(`Route ${e.route} couldn't be rendered statically because it used \`${b}\`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E558",enumerable:!1,configurable:!0});throw e.dynamicUsageDescription=b,e.dynamicUsageStack=c.stack,c}}for(let b of(e.pendingRevalidatedTags||(e.pendingRevalidatedTags=[]),a))-1===e.pendingRevalidatedTags.findIndex(a=>a.tag===b&&("string"==typeof a.profile&&"string"==typeof c?a.profile===c:"object"==typeof a.profile&&"object"==typeof c?JSON.stringify(a.profile)===JSON.stringify(c):a.profile===c))&&e.pendingRevalidatedTags.push({tag:b,profile:c});let h=c&&"object"==typeof c?c:c&&"string"==typeof c&&(null==e||null==(d=e.cacheLifeProfiles)?void 0:d[c])?e.cacheLifeProfiles[c]:void 0;c&&(null==h?void 0:h.expire)!==0||(e.pathWasRevalidated=!0)}},1247,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"unstable_noStore",{enumerable:!0,get:function(){return g}});let d=a.r(56704),e=a.r(32319),f=a.r(60384);function g(){let a=d.workAsyncStorage.getStore(),b=e.workUnitAsyncStorage.getStore();if(a){if(!a.forceStatic){if(a.isUnstableNoStore=!0,b)switch(b.type){case"prerender":case"prerender-client":case"prerender-runtime":return}(0,f.markCurrentScopeAsDynamic)(a,b,"unstable_noStore()")}}}},32621,(a,b,c)=>{"use strict";function d(a){throw Object.defineProperty(Error("`cacheLife()` is only available with the `cacheComponents` config."),"__NEXT_ERROR_CODE",{value:"E887",enumerable:!1,configurable:!0})}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"cacheLife",{enumerable:!0,get:function(){return d}}),a.r(50640),a.r(56704),a.r(32319)},72835,(a,b,c)=>{"use strict";function d(){throw Object.defineProperty(Error("`cacheTag()` is only available with the `cacheComponents` config."),"__NEXT_ERROR_CODE",{value:"E886",enumerable:!1,configurable:!0})}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"cacheTag",{enumerable:!0,get:function(){return d}}),a.r(32319),a.r(26095)},18558,(a,b,c)=>{let d={unstable_cache:a.r(71632).unstable_cache,updateTag:a.r(65819).updateTag,revalidateTag:a.r(65819).revalidateTag,revalidatePath:a.r(65819).revalidatePath,refresh:a.r(65819).refresh,unstable_noStore:a.r(1247).unstable_noStore,cacheLife:a.r(32621).cacheLife,cacheTag:a.r(72835).cacheTag},e=!1,f=!1;d.unstable_cacheLife=function(){return e||(e=!0,console.error(Error("`unstable_cacheLife` was recently stabilized and should be imported as `cacheLife`. The `unstable` prefixed form will be removed in a future version of Next.js."))),d.cacheLife.apply(this,arguments)},d.unstable_cacheTag=function(){return f||(f=!0,console.error(Error("`unstable_cacheTag` was recently stabilized and should be imported as `cacheTag`. The `unstable` prefixed form will be removed in a future version of Next.js."))),d.cacheTag.apply(this,arguments)},b.exports=d,c.unstable_cache=d.unstable_cache,c.revalidatePath=d.revalidatePath,c.revalidateTag=d.revalidateTag,c.updateTag=d.updateTag,c.unstable_noStore=d.unstable_noStore,c.cacheLife=d.cacheLife,c.unstable_cacheLife=d.unstable_cacheLife,c.cacheTag=d.cacheTag,c.unstable_cacheTag=d.unstable_cacheTag,c.refresh=d.refresh},79398,(a,b,c)=>{"use strict";var d=Object.prototype.hasOwnProperty,e=Object.prototype.toString,f=Object.defineProperty,g=Object.getOwnPropertyDescriptor,h=function(a){return"function"==typeof Array.isArray?Array.isArray(a):"[object Array]"===e.call(a)},i=function(a){if(!a||"[object Object]"!==e.call(a))return!1;var b,c=d.call(a,"constructor"),f=a.constructor&&a.constructor.prototype&&d.call(a.constructor.prototype,"isPrototypeOf");if(a.constructor&&!c&&!f)return!1;for(b in a);return void 0===b||d.call(a,b)},j=function(a,b){f&&"__proto__"===b.name?f(a,b.name,{enumerable:!0,configurable:!0,value:b.newValue,writable:!0}):a[b.name]=b.newValue},k=function(a,b){if("__proto__"===b){if(!d.call(a,b))return;else if(g)return g(a,b).value}return a[b]};b.exports=function a(){var b,c,d,e,f,g,l=arguments[0],m=1,n=arguments.length,o=!1;for("boolean"==typeof l&&(o=l,l=arguments[1]||{},m=2),(null==l||"object"!=typeof l&&"function"!=typeof l)&&(l={});m<n;++m)if(b=arguments[m],null!=b)for(c in b)d=k(l,c),l!==(e=k(b,c))&&(o&&e&&(i(e)||(f=h(e)))?(f?(f=!1,g=d&&h(d)?d:[]):g=d&&i(d)?d:{},j(l,{name:c,newValue:a(o,g,e)})):void 0!==e&&j(l,{name:c,newValue:e}));return l}},3727,(a,b,c)=>{"use strict";b.exports={pkg:a.r(451)}},45219,(a,b,c)=>{"use strict";var d=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0}),c.GaxiosError=c.GAXIOS_ERROR_SYMBOL=void 0,c.defaultErrorRedactor=function a(b){let c="<<REDACTED> - See `errorRedactor` option in `gaxios` for configuration>.";function d(a){a&&a.forEach((b,d)=>{(/^authentication$/i.test(d)||/^authorization$/i.test(d)||/secret/i.test(d))&&a.set(d,c)})}function e(a,b){if("object"==typeof a&&null!==a&&"string"==typeof a[b]){let d=a[b];(/grant_type=/i.test(d)||/assertion=/i.test(d)||/secret/i.test(d))&&(a[b]=c)}}function f(a){!a||"object"!=typeof a||(a instanceof FormData||a instanceof URLSearchParams||"forEach"in a&&"set"in a?a.forEach((b,d)=>{(["grant_type","assertion"].includes(d)||/secret/.test(d))&&a.set(d,c)}):("grant_type"in a&&(a.grant_type=c),"assertion"in a&&(a.assertion=c),"client_secret"in a&&(a.client_secret=c)))}return b.config&&(d(b.config.headers),e(b.config,"data"),f(b.config.data),e(b.config,"body"),f(b.config.body),b.config.url.searchParams.has("token")&&b.config.url.searchParams.set("token",c),b.config.url.searchParams.has("client_secret")&&b.config.url.searchParams.set("client_secret",c)),b.response&&(a({config:b.response.config}),d(b.response.headers),b.response.bodyUsed&&(e(b.response,"data"),f(b.response.data))),b};let e=d(a.r(79398)),f=d(a.r(3727)).default.pkg;c.GAXIOS_ERROR_SYMBOL=Symbol.for(`${f.name}-gaxios-error`);class g extends Error{config;response;code;status;error;[c.GAXIOS_ERROR_SYMBOL]=f.version;static[Symbol.hasInstance](a){return!!a&&"object"==typeof a&&c.GAXIOS_ERROR_SYMBOL in a&&a[c.GAXIOS_ERROR_SYMBOL]===f.version||Function.prototype[Symbol.hasInstance].call(g,a)}constructor(a,b,c,d){if(super(a,{cause:d}),this.config=b,this.response=c,this.error=d instanceof Error?d:void 0,this.config=(0,e.default)(!0,{},b),this.response&&(this.response.config=(0,e.default)(!0,{},this.response.config)),this.response){try{this.response.data=function(a,b){switch(a){case"stream":default:return b;case"json":return JSON.parse(JSON.stringify(b));case"arraybuffer":return JSON.parse(Buffer.from(b).toString("utf8"));case"blob":return JSON.parse(b.text())}}(this.config.responseType,this.response?.bodyUsed?this.response?.data:void 0)}catch{}this.status=this.response.status}d instanceof DOMException?this.code=d.name:d&&"object"==typeof d&&"code"in d&&("string"==typeof d.code||"number"==typeof d.code)&&(this.code=d.code)}static extractAPIErrorFromResponse(a,b="The request failed"){let c=b;if("string"==typeof a.data&&(c=a.data),a.data&&"object"==typeof a.data&&"error"in a.data&&a.data.error&&!a.ok){if("string"==typeof a.data.error)return{message:a.data.error,code:a.status,status:a.statusText};if("object"==typeof a.data.error){c="message"in a.data.error&&"string"==typeof a.data.error.message?a.data.error.message:c;let b="status"in a.data.error&&"string"==typeof a.data.error.status?a.data.error.status:a.statusText,d="code"in a.data.error&&"number"==typeof a.data.error.code?a.data.error.code:a.status;if("errors"in a.data.error&&Array.isArray(a.data.error.errors)){let e=[];for(let b of a.data.error.errors)"object"==typeof b&&"message"in b&&"string"==typeof b.message&&e.push(b.message);return Object.assign({message:e.join("\n")||c,code:d,status:b},a.data.error)}return Object.assign({message:c,code:d,status:b},a.data.error)}}return{message:c,code:a.status,status:a.statusText}}}c.GaxiosError=g},17571,(a,b,c)=>{"use strict";async function d(a){var b;let c=f(a);if(!a||!a.config||!c&&!a.config.retry)return{shouldRetry:!1};(c=c||{}).currentRetryAttempt=c.currentRetryAttempt||0,c.retry=void 0===c.retry||null===c.retry?3:c.retry,c.httpMethodsToRetry=c.httpMethodsToRetry||["GET","HEAD","PUT","OPTIONS","DELETE"],c.noResponseRetries=void 0===c.noResponseRetries||null===c.noResponseRetries?2:c.noResponseRetries,c.retryDelayMultiplier=c.retryDelayMultiplier?c.retryDelayMultiplier:2,c.timeOfFirstRequest=c.timeOfFirstRequest?c.timeOfFirstRequest:Date.now(),c.totalTimeout=c.totalTimeout?c.totalTimeout:Number.MAX_SAFE_INTEGER,c.maxRetryDelay=c.maxRetryDelay?c.maxRetryDelay:Number.MAX_SAFE_INTEGER,c.statusCodesToRetry=c.statusCodesToRetry||[[100,199],[408,408],[429,429],[500,599]],a.config.retryConfig=c;let d=c.shouldRetry||e;if(!await d(a))return{shouldRetry:!1,config:a.config};let g=Math.min(((b=c).currentRetryAttempt?0:b.retryDelay??100)+(Math.pow(b.retryDelayMultiplier,b.currentRetryAttempt)-1)/2*1e3,b.totalTimeout-(Date.now()-b.timeOfFirstRequest),b.maxRetryDelay);a.config.retryConfig.currentRetryAttempt+=1;let h=c.retryBackoff?c.retryBackoff(a,g):new Promise(a=>{setTimeout(a,g)});return c.onRetryAttempt&&await c.onRetryAttempt(a),await h,{shouldRetry:!0,config:a.config}}function e(a){let b=f(a);if(a.config.signal?.aborted&&"TimeoutError"!==a.code||"AbortError"===a.code||!b||0===b.retry||!a.response&&(b.currentRetryAttempt||0)>=b.noResponseRetries||!b.httpMethodsToRetry||!b.httpMethodsToRetry.includes(a.config.method?.toUpperCase()||"GET"))return!1;if(a.response&&a.response.status){let c=!1;for(let[d,e]of b.statusCodesToRetry){let b=a.response.status;if(b>=d&&b<=e){c=!0;break}}if(!c)return!1}return b.currentRetryAttempt=b.currentRetryAttempt||0,!(b.currentRetryAttempt>=b.retry)}function f(a){if(a&&a.config&&a.config.retryConfig)return a.config.retryConfig}Object.defineProperty(c,"__esModule",{value:!0}),c.getRetryConfig=d},38629,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GaxiosInterceptorManager=void 0;class d extends Set{}c.GaxiosInterceptorManager=d},11334,(a,b,c)=>{"use strict";var d,e=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0}),c.Gaxios=void 0;let f=e(a.r(79398)),g=a.r(24836),h=a.r(45219),i=a.r(17571),j=a.r(88947),k=a.r(38629),l=async()=>globalThis.crypto?.randomUUID()||(await a.A(85685)).randomUUID();class m{agentCache=new Map;defaults;interceptors;constructor(a){this.defaults=a||{},this.interceptors={request:new k.GaxiosInterceptorManager,response:new k.GaxiosInterceptorManager}}fetch(...a){let b,c=a[0],e=a[1],f=new Headers;return("string"==typeof c?b=new URL(c):c instanceof URL?b=c:c&&c.url&&(b=new URL(c.url)),c&&"object"==typeof c&&"headers"in c&&d.mergeHeaders(f,c.headers),e&&d.mergeHeaders(f,new Headers(e.headers)),"object"!=typeof c||c instanceof URL)?this.request({...e,headers:f,url:b}):this.request({...e,...c,headers:f,url:b})}async request(a={}){let b=await this.#b(a);return b=await this.#c(b),this.#d(this._request(b))}async _defaultAdapter(a){let b=a.fetchImplementation||this.defaults.fetchImplementation||await d.#e(),c={...a};delete c.data;let e=await b(a.url,c),f=await this.getResponseData(a,e);return Object.getOwnPropertyDescriptor(e,"data")?.configurable||Object.defineProperties(e,{data:{configurable:!0,writable:!0,enumerable:!0,value:f}}),Object.assign(e,{config:a,data:f})}async _request(a){try{let b;if(b=a.adapter?await a.adapter(a,this._defaultAdapter.bind(this)):await this._defaultAdapter(a),!a.validateStatus(b.status)){if("stream"===a.responseType){let a=[];for await(let c of b.data)a.push(c);b.data=a.toString()}let c=h.GaxiosError.extractAPIErrorFromResponse(b,`Request failed with status code ${b.status}`);throw new h.GaxiosError(c?.message,a,b,c)}return b}catch(e){let b;b=e instanceof h.GaxiosError?e:e instanceof Error?new h.GaxiosError(e.message,a,void 0,e):new h.GaxiosError("Unexpected Gaxios Error",a,void 0,e);let{shouldRetry:c,config:d}=await (0,i.getRetryConfig)(b);if(c&&d)return b.config.retryConfig.currentRetryAttempt=d.retryConfig.currentRetryAttempt,a.retryConfig=b.config?.retryConfig,this.#f(a),this._request(a);throw a.errorRedactor&&a.errorRedactor(b),b}}async getResponseData(a,b){if(a.maxContentLength&&b.headers.has("content-length")&&a.maxContentLength<Number.parseInt(b.headers?.get("content-length")||""))throw new h.GaxiosError("Response's `Content-Length` is over the limit.",a,Object.assign(b,{config:a}));switch(a.responseType){case"stream":return b.body;case"json":return b.json();case"arraybuffer":return b.arrayBuffer();case"blob":return b.blob();case"text":return b.text();default:return this.getResponseDataFromContentType(b)}}#g(a,b=[]){let c=new URL(a),d=[...b];for(let a of(process.env.NO_PROXY??process.env.no_proxy)?.split(",")||[])d.push(a.trim());for(let a of d)if(a instanceof RegExp){if(a.test(c.toString()))return!1}else if(a instanceof URL){if(a.origin===c.origin)return!1}else if(a.startsWith("*.")||a.startsWith(".")){let b=a.replace(/^\*\./,".");if(c.hostname.endsWith(b))return!1}else if(a===c.origin||a===c.hostname||a===c.href)return!1;return!0}async #c(a){let b=Promise.resolve(a);for(let a of this.interceptors.request.values())a&&(b=b.then(a.resolved,a.rejected));return b}async #d(a){let b=Promise.resolve(a);for(let a of this.interceptors.response.values())a&&(b=b.then(a.resolved,a.rejected));return b}async #b(a){let b=new Headers(this.defaults.headers);d.mergeHeaders(b,a.headers);let c=(0,f.default)(!0,{},this.defaults,a);if(!c.url)throw Error("URL is required.");if(c.baseURL&&(c.url=new URL(c.url,c.baseURL)),c.url=new URL(c.url),c.params)if(c.paramsSerializer){let a=c.paramsSerializer(c.params);a.startsWith("?")&&(a=a.slice(1));let b=c.url.toString().includes("?")?"&":"?";c.url=c.url+b+a}else{let a=c.url instanceof URL?c.url:new URL(c.url);for(let[b,d]of new URLSearchParams(c.params))a.searchParams.append(b,d);c.url=a}"number"==typeof a.maxContentLength&&(c.size=a.maxContentLength),"number"==typeof a.maxRedirects&&(c.follow=a.maxRedirects);let e="string"==typeof c.data||c.data instanceof ArrayBuffer||c.data instanceof Blob||globalThis.File&&c.data instanceof File||c.data instanceof FormData||c.data instanceof j.Readable||c.data instanceof ReadableStream||c.data instanceof String||c.data instanceof URLSearchParams||ArrayBuffer.isView(c.data)||["Blob","File","FormData"].includes(c.data?.constructor?.name||"");if(c.multipart?.length){let a=await l();b.set("content-type",`multipart/related; boundary=${a}`),c.body=j.Readable.from(this.getMultipartRequest(c.multipart,a))}else e?c.body=c.data:"object"==typeof c.data?"application/x-www-form-urlencoded"===b.get("Content-Type")?c.body=c.paramsSerializer?c.paramsSerializer(c.data):new URLSearchParams(c.data):(b.has("content-type")||b.set("content-type","application/json"),c.body=JSON.stringify(c.data)):c.data&&(c.body=c.data);c.validateStatus=c.validateStatus||this.validateStatus,c.responseType=c.responseType||"unknown",b.has("accept")||"json"!==c.responseType||b.set("accept","application/json");let i=c.proxy||process?.env?.HTTPS_PROXY||process?.env?.https_proxy||process?.env?.HTTP_PROXY||process?.env?.http_proxy;if(c.agent);else if(i&&this.#g(c.url,c.noProxy)){let a=await d.#h();this.agentCache.has(i)?c.agent=this.agentCache.get(i):(c.agent=new a(i,{cert:c.cert,key:c.key}),this.agentCache.set(i,c.agent))}else c.cert&&c.key&&(this.agentCache.has(c.key)?c.agent=this.agentCache.get(c.key):(c.agent=new g.Agent({cert:c.cert,key:c.key}),this.agentCache.set(c.key,c.agent)));return"function"!=typeof c.errorRedactor&&!1!==c.errorRedactor&&(c.errorRedactor=h.defaultErrorRedactor),!c.body||"duplex"in c||(c.duplex="half"),this.#f(c),Object.assign(c,{headers:b,url:c.url instanceof URL?c.url:new URL(c.url)})}#f(a){if(a.timeout){let b=AbortSignal.timeout(a.timeout);a.signal&&!a.signal.aborted?a.signal=AbortSignal.any([a.signal,b]):a.signal=b}}validateStatus(a){return a>=200&&a<300}async getResponseDataFromContentType(a){let b=a.headers.get("Content-Type");if(null===b)return a.text();if((b=b.toLowerCase()).includes("application/json")){let b=await a.text();try{b=JSON.parse(b)}catch{}return b}return b.match(/^text\//)?a.text():a.blob()}async *getMultipartRequest(a,b){let c=`--${b}--`;for(let c of a){let a=c.headers.get("Content-Type")||"application/octet-stream",d=`--${b}\r
Content-Type: ${a}\r
\r
`;yield d,"string"==typeof c.content?yield c.content:yield*c.content,yield"\r\n"}yield c}static #i;static #j;static async #h(){return this.#i||=(await a.A(6179)).HttpsProxyAgent,this.#i}static async #e(){return this.#j||=(await a.A(90407)).default,this.#j}static mergeHeaders(a,...b){for(let c of(a=a instanceof Headers?a:new Headers(a),b))(c instanceof Headers?c:new Headers(c)).forEach((b,c)=>{"set-cookie"===c?a.append(c,b):a.set(c,b)});return a}}c.Gaxios=m,d=m},53683,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),c.instance=c.Gaxios=c.GaxiosError=void 0,c.request=h;let f=a.r(11334);Object.defineProperty(c,"Gaxios",{enumerable:!0,get:function(){return f.Gaxios}});var g=a.r(45219);async function h(a){return c.instance.request(a)}Object.defineProperty(c,"GaxiosError",{enumerable:!0,get:function(){return g.GaxiosError}}),e(a.r(38629),c),c.instance=new f.Gaxios},53255,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GCE_LINUX_BIOS_PATHS=void 0,c.isGoogleCloudServerless=f,c.isGoogleComputeEngineLinux=g,c.isGoogleComputeEngineMACAddress=h,c.isGoogleComputeEngine=i,c.detectGCPResidency=function(){return f()||i()},a.r(22734);let d=a.r(46786);c.GCE_LINUX_BIOS_PATHS={BIOS_DATE:"/sys/class/dmi/id/bios_date",BIOS_VENDOR:"/sys/class/dmi/id/bios_vendor"};let e=/^42:01/;function f(){return!!(process.env.CLOUD_RUN_JOB||process.env.FUNCTION_NAME||process.env.K_SERVICE)}function g(){if("linux"!==(0,d.platform)())return!1}function h(){for(let a of Object.values((0,d.networkInterfaces)()))if(a){for(let{mac:b}of a)if(e.test(b))return!0}return!1}function i(){return g()||h()}},48594,(a,b,c)=>{!function(c){"use strict";var d,e=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,f=Math.ceil,g=Math.floor,h="[BigNumber Error] ",i=h+"Number primitive has more than 15 significant digits: ",j=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13];function k(a){var b=0|a;return a>0||a===b?b:b-1}function l(a){for(var b,c,d=1,e=a.length,f=a[0]+"";d<e;){for(c=14-(b=a[d++]+"").length;c--;b="0"+b);f+=b}for(e=f.length;48===f.charCodeAt(--e););return f.slice(0,e+1||1)}function m(a,b){var c,d,e=a.c,f=b.c,g=a.s,h=b.s,i=a.e,j=b.e;if(!g||!h)return null;if(c=e&&!e[0],d=f&&!f[0],c||d)return c?d?0:-h:g;if(g!=h)return g;if(c=g<0,d=i==j,!e||!f)return d?0:!e^c?1:-1;if(!d)return i>j^c?1:-1;for(g=0,h=(i=e.length)<(j=f.length)?i:j;g<h;g++)if(e[g]!=f[g])return e[g]>f[g]^c?1:-1;return i==j?0:i>j^c?1:-1}function n(a,b,c,d){if(a<b||a>c||a!==g(a))throw Error(h+(d||"Argument")+("number"==typeof a?a<b||a>c?" out of range: ":" not an integer: ":" not a primitive number: ")+String(a))}function o(a){var b=a.c.length-1;return k(a.e/14)==b&&a.c[b]%2!=0}function p(a,b){return(a.length>1?a.charAt(0)+"."+a.slice(1):a)+(b<0?"e":"e+")+b}function q(a,b,c){var d,e;if(b<0){for(e=c+".";++b;e+=c);a=e+a}else if(d=a.length,++b>d){for(e=c,b-=d;--b;e+=c);a+=e}else b<d&&(a=a.slice(0,b)+"."+a.slice(b));return a}if((d=function a(b){var c,d,r,s,t,u,v,w,x,y=M.prototype={constructor:M,toString:null,valueOf:null},z=new M(1),A=20,B=4,C=-7,D=21,E=-1e7,F=1e7,G=!1,H=1,I=0,J={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},K="0123456789abcdefghijklmnopqrstuvwxyz",L=!0;function M(a,b){var c,d,f,h,j,k,l,m,o=this;if(!(o instanceof M))return new M(a,b);if(null==b){if(a&&!0===a._isBigNumber){o.s=a.s,!a.c||a.e>F?o.c=o.e=null:a.e<E?o.c=[o.e=0]:(o.e=a.e,o.c=a.c.slice());return}if((k="number"==typeof a)&&0*a==0){if(o.s=1/a<0?(a=-a,-1):1,a===~~a){for(h=0,j=a;j>=10;j/=10,h++);h>F?o.c=o.e=null:(o.e=h,o.c=[a]);return}m=String(a)}else{if(!e.test(m=String(a)))return x(o,m,k);o.s=45==m.charCodeAt(0)?(m=m.slice(1),-1):1}(h=m.indexOf("."))>-1&&(m=m.replace(".","")),(j=m.search(/e/i))>0?(h<0&&(h=j),h+=+m.slice(j+1),m=m.substring(0,j)):h<0&&(h=m.length)}else{if(n(b,2,K.length,"Base"),10==b&&L)return Q(o=new M(a),A+o.e+1,B);if(m=String(a),k="number"==typeof a){if(0*a!=0)return x(o,m,k,b);if(o.s=1/a<0?(m=m.slice(1),-1):1,M.DEBUG&&m.replace(/^0\.0*|\./,"").length>15)throw Error(i+a)}else o.s=45===m.charCodeAt(0)?(m=m.slice(1),-1):1;for(c=K.slice(0,b),h=j=0,l=m.length;j<l;j++)if(0>c.indexOf(d=m.charAt(j))){if("."==d){if(j>h){h=l;continue}}else if(!f&&(m==m.toUpperCase()&&(m=m.toLowerCase())||m==m.toLowerCase()&&(m=m.toUpperCase()))){f=!0,j=-1,h=0;continue}return x(o,String(a),k,b)}k=!1,(h=(m=w(m,b,10,o.s)).indexOf("."))>-1?m=m.replace(".",""):h=m.length}for(j=0;48===m.charCodeAt(j);j++);for(l=m.length;48===m.charCodeAt(--l););if(m=m.slice(j,++l)){if(l-=j,k&&M.DEBUG&&l>15&&(a>0x1fffffffffffff||a!==g(a)))throw Error(i+o.s*a);if((h=h-j-1)>F)o.c=o.e=null;else if(h<E)o.c=[o.e=0];else{if(o.e=h,o.c=[],j=(h+1)%14,h<0&&(j+=14),j<l){for(j&&o.c.push(+m.slice(0,j)),l-=14;j<l;)o.c.push(+m.slice(j,j+=14));j=14-(m=m.slice(j)).length}else j-=l;for(;j--;m+="0");o.c.push(+m)}}else o.c=[o.e=0]}function N(a,b,c,d){var e,f,g,h,i;if(null==c?c=B:n(c,0,8),!a.c)return a.toString();if(e=a.c[0],g=a.e,null==b)i=l(a.c),i=1==d||2==d&&(g<=C||g>=D)?p(i,g):q(i,g,"0");else if(f=(a=Q(new M(a),b,c)).e,h=(i=l(a.c)).length,1==d||2==d&&(b<=f||f<=C)){for(;h<b;i+="0",h++);i=p(i,f)}else if(b-=g+(2===d&&f>g),i=q(i,f,"0"),f+1>h){if(--b>0)for(i+=".";b--;i+="0");}else if((b+=f-h)>0)for(f+1==h&&(i+=".");b--;i+="0");return a.s<0&&e?"-"+i:i}function O(a,b){for(var c,d,e=1,f=new M(a[0]);e<a.length;e++)(d=new M(a[e])).s&&(c=m(f,d))!==b&&(0!==c||f.s!==b)||(f=d);return f}function P(a,b,c){for(var d=1,e=b.length;!b[--e];b.pop());for(e=b[0];e>=10;e/=10,d++);return(c=d+14*c-1)>F?a.c=a.e=null:c<E?a.c=[a.e=0]:(a.e=c,a.c=b),a}function Q(a,b,c,d){var e,h,i,k,l,m,n,o=a.c;if(o){a:{for(e=1,k=o[0];k>=10;k/=10,e++);if((h=b-e)<0)h+=14,i=b,n=g((l=o[m=0])/j[e-i-1]%10);else if((m=f((h+1)/14))>=o.length)if(d){for(;o.length<=m;o.push(0));l=n=0,e=1,h%=14,i=h-14+1}else break a;else{for(e=1,l=k=o[m];k>=10;k/=10,e++);h%=14,n=(i=h-14+e)<0?0:g(l/j[e-i-1]%10)}if(d=d||b<0||null!=o[m+1]||(i<0?l:l%j[e-i-1]),d=c<4?(n||d)&&(0==c||c==(a.s<0?3:2)):n>5||5==n&&(4==c||d||6==c&&(h>0?i>0?l/j[e-i]:0:o[m-1])%10&1||c==(a.s<0?8:7)),b<1||!o[0])return o.length=0,d?(b-=a.e+1,o[0]=j[(14-b%14)%14],a.e=-b||0):o[0]=a.e=0,a;if(0==h?(o.length=m,k=1,m--):(o.length=m+1,k=j[14-h],o[m]=i>0?g(l/j[e-i]%j[i])*k:0),d)for(;;)if(0==m){for(h=1,i=o[0];i>=10;i/=10,h++);for(i=o[0]+=k,k=1;i>=10;i/=10,k++);h!=k&&(a.e++,1e14==o[0]&&(o[0]=1));break}else{if(o[m]+=k,1e14!=o[m])break;o[m--]=0,k=1}for(h=o.length;0===o[--h];o.pop());}a.e>F?a.c=a.e=null:a.e<E&&(a.c=[a.e=0])}return a}function R(a){var b,c=a.e;return null===c?a.toString():(b=l(a.c),b=c<=C||c>=D?p(b,c):q(b,c,"0"),a.s<0?"-"+b:b)}return M.clone=a,M.ROUND_UP=0,M.ROUND_DOWN=1,M.ROUND_CEIL=2,M.ROUND_FLOOR=3,M.ROUND_HALF_UP=4,M.ROUND_HALF_DOWN=5,M.ROUND_HALF_EVEN=6,M.ROUND_HALF_CEIL=7,M.ROUND_HALF_FLOOR=8,M.EUCLID=9,M.config=M.set=function(a){var b,c;if(null!=a)if("object"==typeof a){if(a.hasOwnProperty(b="DECIMAL_PLACES")&&(n(c=a[b],0,1e9,b),A=c),a.hasOwnProperty(b="ROUNDING_MODE")&&(n(c=a[b],0,8,b),B=c),a.hasOwnProperty(b="EXPONENTIAL_AT")&&((c=a[b])&&c.pop?(n(c[0],-1e9,0,b),n(c[1],0,1e9,b),C=c[0],D=c[1]):(n(c,-1e9,1e9,b),C=-(D=c<0?-c:c))),a.hasOwnProperty(b="RANGE"))if((c=a[b])&&c.pop)n(c[0],-1e9,-1,b),n(c[1],1,1e9,b),E=c[0],F=c[1];else if(n(c,-1e9,1e9,b),c)E=-(F=c<0?-c:c);else throw Error(h+b+" cannot be zero: "+c);if(a.hasOwnProperty(b="CRYPTO"))if(!!(c=a[b])===c)if(c)if("undefined"!=typeof crypto&&crypto&&(crypto.getRandomValues||crypto.randomBytes))G=c;else throw G=!c,Error(h+"crypto unavailable");else G=c;else throw Error(h+b+" not true or false: "+c);if(a.hasOwnProperty(b="MODULO_MODE")&&(n(c=a[b],0,9,b),H=c),a.hasOwnProperty(b="POW_PRECISION")&&(n(c=a[b],0,1e9,b),I=c),a.hasOwnProperty(b="FORMAT"))if("object"==typeof(c=a[b]))J=c;else throw Error(h+b+" not an object: "+c);if(a.hasOwnProperty(b="ALPHABET")){if("string"!=typeof(c=a[b])||/^.?$|[+\-.\s]|(.).*\1/.test(c))throw Error(h+b+" invalid: "+c);L="0123456789"==c.slice(0,10),K=c}}else throw Error(h+"Object expected: "+a);return{DECIMAL_PLACES:A,ROUNDING_MODE:B,EXPONENTIAL_AT:[C,D],RANGE:[E,F],CRYPTO:G,MODULO_MODE:H,POW_PRECISION:I,FORMAT:J,ALPHABET:K}},M.isBigNumber=function(a){if(!a||!0!==a._isBigNumber)return!1;if(!M.DEBUG)return!0;var b,c,d=a.c,e=a.e,f=a.s;a:if("[object Array]"==({}).toString.call(d)){if((1===f||-1===f)&&e>=-1e9&&e<=1e9&&e===g(e)){if(0===d[0]){if(0===e&&1===d.length)return!0;break a}if((b=(e+1)%14)<1&&(b+=14),String(d[0]).length==b){for(b=0;b<d.length;b++)if((c=d[b])<0||c>=1e14||c!==g(c))break a;if(0!==c)return!0}}}else if(null===d&&null===e&&(null===f||1===f||-1===f))return!0;throw Error(h+"Invalid BigNumber: "+a)},M.maximum=M.max=function(){return O(arguments,-1)},M.minimum=M.min=function(){return O(arguments,1)},c=0x20000000000000*Math.random()&2097151?function(){return g(0x20000000000000*Math.random())}:function(){return(0x40000000*Math.random()|0)*8388608+(8388608*Math.random()|0)},M.random=function(a){var b,d,e,i,k,l=0,m=[],o=new M(z);if(null==a?a=A:n(a,0,1e9),i=f(a/14),G)if(crypto.getRandomValues){for(b=crypto.getRandomValues(new Uint32Array(i*=2));l<i;)(k=131072*b[l]+(b[l+1]>>>11))>=9e15?(d=crypto.getRandomValues(new Uint32Array(2)),b[l]=d[0],b[l+1]=d[1]):(m.push(k%1e14),l+=2);l=i/2}else if(crypto.randomBytes){for(b=crypto.randomBytes(i*=7);l<i;)(k=(31&b[l])*0x1000000000000+0x10000000000*b[l+1]+0x100000000*b[l+2]+0x1000000*b[l+3]+(b[l+4]<<16)+(b[l+5]<<8)+b[l+6])>=9e15?crypto.randomBytes(7).copy(b,l):(m.push(k%1e14),l+=7);l=i/7}else throw G=!1,Error(h+"crypto unavailable");if(!G)for(;l<i;)(k=c())<9e15&&(m[l++]=k%1e14);for(i=m[--l],a%=14,i&&a&&(k=j[14-a],m[l]=g(i/k)*k);0===m[l];m.pop(),l--);if(l<0)m=[e=0];else{for(e=-1;0===m[0];m.splice(0,1),e-=14);for(l=1,k=m[0];k>=10;k/=10,l++);l<14&&(e-=14-l)}return o.e=e,o.c=m,o},M.sum=function(){for(var a=1,b=arguments,c=new M(b[0]);a<b.length;)c=c.plus(b[a++]);return c},w=function(){var a="0123456789";function b(a,b,c,d){for(var e,f,g=[0],h=0,i=a.length;h<i;){for(f=g.length;f--;g[f]*=b);for(g[0]+=d.indexOf(a.charAt(h++)),e=0;e<g.length;e++)g[e]>c-1&&(null==g[e+1]&&(g[e+1]=0),g[e+1]+=g[e]/c|0,g[e]%=c)}return g.reverse()}return function(c,d,e,f,g){var h,i,j,k,m,n,o,p,r=c.indexOf("."),s=A,t=B;for(r>=0&&(k=I,I=0,c=c.replace(".",""),n=(p=new M(d)).pow(c.length-r),I=k,p.c=b(q(l(n.c),n.e,"0"),10,e,a),p.e=p.c.length),j=k=(o=b(c,d,e,g?(h=K,a):(h=a,K))).length;0==o[--k];o.pop());if(!o[0])return h.charAt(0);if(r<0?--j:(n.c=o,n.e=j,n.s=f,o=(n=v(n,p,s,t,e)).c,m=n.r,j=n.e),r=o[i=j+s+1],k=e/2,m=m||i<0||null!=o[i+1],m=t<4?(null!=r||m)&&(0==t||t==(n.s<0?3:2)):r>k||r==k&&(4==t||m||6==t&&1&o[i-1]||t==(n.s<0?8:7)),i<1||!o[0])c=m?q(h.charAt(1),-s,h.charAt(0)):h.charAt(0);else{if(o.length=i,m)for(--e;++o[--i]>e;)o[i]=0,i||(++j,o=[1].concat(o));for(k=o.length;!o[--k];);for(r=0,c="";r<=k;c+=h.charAt(o[r++]));c=q(c,j,h.charAt(0))}return c}}(),v=function(){function a(a,b,c){var d,e,f,g,h=0,i=a.length,j=b%1e7,k=b/1e7|0;for(a=a.slice();i--;)d=k*(f=a[i]%1e7)+(g=a[i]/1e7|0)*j,h=((e=j*f+d%1e7*1e7+h)/c|0)+(d/1e7|0)+k*g,a[i]=e%c;return h&&(a=[h].concat(a)),a}function b(a,b,c,d){var e,f;if(c!=d)f=c>d?1:-1;else for(e=f=0;e<c;e++)if(a[e]!=b[e]){f=a[e]>b[e]?1:-1;break}return f}function c(a,b,c,d){for(var e=0;c--;)a[c]-=e,e=+(a[c]<b[c]),a[c]=e*d+a[c]-b[c];for(;!a[0]&&a.length>1;a.splice(0,1));}return function(d,e,f,h,i){var j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B=d.s==e.s?1:-1,C=d.c,D=e.c;if(!C||!C[0]||!D||!D[0])return new M(!d.s||!e.s||(C?D&&C[0]==D[0]:!D)?NaN:C&&0==C[0]||!D?0*B:B/0);for(s=(r=new M(B)).c=[],B=f+(l=d.e-e.e)+1,i||(i=1e14,l=k(d.e/14)-k(e.e/14),B=B/14|0),m=0;D[m]==(C[m]||0);m++);if(D[m]>(C[m]||0)&&l--,B<0)s.push(1),n=!0;else{for(x=C.length,z=D.length,m=0,B+=2,(o=g(i/(D[0]+1)))>1&&(D=a(D,o,i),C=a(C,o,i),z=D.length,x=C.length),w=z,u=(t=C.slice(0,z)).length;u<z;t[u++]=0);A=[0].concat(A=D.slice()),y=D[0],D[1]>=i/2&&y++;do{if(o=0,(j=b(D,t,z,u))<0){if(v=t[0],z!=u&&(v=v*i+(t[1]||0)),(o=g(v/y))>1)for(o>=i&&(o=i-1),q=(p=a(D,o,i)).length,u=t.length;1==b(p,t,q,u);)o--,c(p,z<q?A:D,q,i),q=p.length,j=1;else 0==o&&(j=o=1),q=(p=D.slice()).length;if(q<u&&(p=[0].concat(p)),c(t,p,u,i),u=t.length,-1==j)for(;1>b(D,t,z,u);)o++,c(t,z<u?A:D,u,i),u=t.length}else 0===j&&(o++,t=[0]);s[m++]=o,t[0]?t[u++]=C[w]||0:(t=[C[w]],u=1)}while((w++<x||null!=t[0])&&B--)n=null!=t[0],s[0]||s.splice(0,1)}if(1e14==i){for(m=1,B=s[0];B>=10;B/=10,m++);Q(r,f+(r.e=m+14*l-1)+1,h,n)}else r.e=l,r.r=+n;return r}}(),d=/^(-?)0([xbo])(?=\w[\w.]*$)/i,r=/^([^.]+)\.$/,s=/^\.([^.]+)$/,t=/^-?(Infinity|NaN)$/,u=/^\s*\+(?=[\w.])|^\s+|\s+$/g,x=function(a,b,c,e){var f,g=c?b:b.replace(u,"");if(t.test(g))a.s=isNaN(g)?null:g<0?-1:1;else{if(!c&&(g=g.replace(d,function(a,b,c){return f="x"==(c=c.toLowerCase())?16:"b"==c?2:8,e&&e!=f?a:b}),e&&(f=e,g=g.replace(r,"$1").replace(s,"0.$1")),b!=g))return new M(g,f);if(M.DEBUG)throw Error(h+"Not a"+(e?" base "+e:"")+" number: "+b);a.s=null}a.c=a.e=null},y.absoluteValue=y.abs=function(){var a=new M(this);return a.s<0&&(a.s=1),a},y.comparedTo=function(a,b){return m(this,new M(a,b))},y.decimalPlaces=y.dp=function(a,b){var c,d,e;if(null!=a)return n(a,0,1e9),null==b?b=B:n(b,0,8),Q(new M(this),a+this.e+1,b);if(!(c=this.c))return null;if(d=((e=c.length-1)-k(this.e/14))*14,e=c[e])for(;e%10==0;e/=10,d--);return d<0&&(d=0),d},y.dividedBy=y.div=function(a,b){return v(this,new M(a,b),A,B)},y.dividedToIntegerBy=y.idiv=function(a,b){return v(this,new M(a,b),0,1)},y.exponentiatedBy=y.pow=function(a,b){var c,d,e,i,j,k,l,m,n,p=this;if((a=new M(a)).c&&!a.isInteger())throw Error(h+"Exponent not an integer: "+R(a));if(null!=b&&(b=new M(b)),k=a.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!a.c||!a.c[0])return n=new M(Math.pow(+R(p),k?a.s*(2-o(a)):+R(a))),b?n.mod(b):n;if(l=a.s<0,b){if(b.c?!b.c[0]:!b.s)return new M(NaN);(d=!l&&p.isInteger()&&b.isInteger())&&(p=p.mod(b))}else{if(a.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||k&&p.c[1]>=24e7:p.c[0]<8e13||k&&p.c[0]<=9999975e7)))return i=p.s<0&&o(a)?-0:0,p.e>-1&&(i=1/i),new M(l?1/i:i);I&&(i=f(I/14+2))}for(k?(c=new M(.5),l&&(a.s=1),m=o(a)):m=(e=Math.abs(+R(a)))%2,n=new M(z);;){if(m){if(!(n=n.times(p)).c)break;i?n.c.length>i&&(n.c.length=i):d&&(n=n.mod(b))}if(e){if(0===(e=g(e/2)))break;m=e%2}else if(Q(a=a.times(c),a.e+1,1),a.e>14)m=o(a);else{if(0==(e=+R(a)))break;m=e%2}p=p.times(p),i?p.c&&p.c.length>i&&(p.c.length=i):d&&(p=p.mod(b))}return d?n:(l&&(n=z.div(n)),b?n.mod(b):i?Q(n,I,B,j):n)},y.integerValue=function(a){var b=new M(this);return null==a?a=B:n(a,0,8),Q(b,b.e+1,a)},y.isEqualTo=y.eq=function(a,b){return 0===m(this,new M(a,b))},y.isFinite=function(){return!!this.c},y.isGreaterThan=y.gt=function(a,b){return m(this,new M(a,b))>0},y.isGreaterThanOrEqualTo=y.gte=function(a,b){return 1===(b=m(this,new M(a,b)))||0===b},y.isInteger=function(){return!!this.c&&k(this.e/14)>this.c.length-2},y.isLessThan=y.lt=function(a,b){return 0>m(this,new M(a,b))},y.isLessThanOrEqualTo=y.lte=function(a,b){return -1===(b=m(this,new M(a,b)))||0===b},y.isNaN=function(){return!this.s},y.isNegative=function(){return this.s<0},y.isPositive=function(){return this.s>0},y.isZero=function(){return!!this.c&&0==this.c[0]},y.minus=function(a,b){var c,d,e,f,g=this.s;if(b=(a=new M(a,b)).s,!g||!b)return new M(NaN);if(g!=b)return a.s=-b,this.plus(a);var h=this.e/14,i=a.e/14,j=this.c,l=a.c;if(!h||!i){if(!j||!l)return j?(a.s=-b,a):new M(l?this:NaN);if(!j[0]||!l[0])return l[0]?(a.s=-b,a):new M(j[0]?this:3==B?-0:0)}if(h=k(h),i=k(i),j=j.slice(),g=h-i){for((f=g<0)?(g=-g,e=j):(i=h,e=l),e.reverse(),b=g;b--;e.push(0));e.reverse()}else for(d=(f=(g=j.length)<(b=l.length))?g:b,g=b=0;b<d;b++)if(j[b]!=l[b]){f=j[b]<l[b];break}if(f&&(e=j,j=l,l=e,a.s=-a.s),(b=(d=l.length)-(c=j.length))>0)for(;b--;j[c++]=0);for(b=1e14-1;d>g;){if(j[--d]<l[d]){for(c=d;c&&!j[--c];j[c]=b);--j[c],j[d]+=1e14}j[d]-=l[d]}for(;0==j[0];j.splice(0,1),--i);return j[0]?P(a,j,i):(a.s=3==B?-1:1,a.c=[a.e=0],a)},y.modulo=y.mod=function(a,b){var c,d;return(a=new M(a,b),this.c&&a.s&&(!a.c||a.c[0]))?a.c&&(!this.c||this.c[0])?(9==H?(d=a.s,a.s=1,c=v(this,a,0,3),a.s=d,c.s*=d):c=v(this,a,0,H),(a=this.minus(c.times(a))).c[0]||1!=H||(a.s=this.s),a):new M(this):new M(NaN)},y.multipliedBy=y.times=function(a,b){var c,d,e,f,g,h,i,j,l,m,n,o,p,q=this.c,r=(a=new M(a,b)).c;if(!q||!r||!q[0]||!r[0])return this.s&&a.s&&(!q||q[0]||r)&&(!r||r[0]||q)?(a.s*=this.s,q&&r?(a.c=[0],a.e=0):a.c=a.e=null):a.c=a.e=a.s=null,a;for(d=k(this.e/14)+k(a.e/14),a.s*=this.s,(i=q.length)<(m=r.length)&&(p=q,q=r,r=p,e=i,i=m,m=e),e=i+m,p=[];e--;p.push(0));for(e=m;--e>=0;){for(c=0,n=r[e]%1e7,o=r[e]/1e7|0,f=e+(g=i);f>e;)h=o*(j=q[--g]%1e7)+(l=q[g]/1e7|0)*n,c=((j=n*j+h%1e7*1e7+p[f]+c)/1e14|0)+(h/1e7|0)+o*l,p[f--]=j%1e14;p[f]=c}return c?++d:p.splice(0,1),P(a,p,d)},y.negated=function(){var a=new M(this);return a.s=-a.s||null,a},y.plus=function(a,b){var c,d=this.s;if(b=(a=new M(a,b)).s,!d||!b)return new M(NaN);if(d!=b)return a.s=-b,this.minus(a);var e=this.e/14,f=a.e/14,g=this.c,h=a.c;if(!e||!f){if(!g||!h)return new M(d/0);if(!g[0]||!h[0])return h[0]?a:new M(g[0]?this:0*d)}if(e=k(e),f=k(f),g=g.slice(),d=e-f){for(d>0?(f=e,c=h):(d=-d,c=g),c.reverse();d--;c.push(0));c.reverse()}for((d=g.length)-(b=h.length)<0&&(c=h,h=g,g=c,b=d),d=0;b;)d=(g[--b]=g[b]+h[b]+d)/1e14|0,g[b]=1e14===g[b]?0:g[b]%1e14;return d&&(g=[d].concat(g),++f),P(a,g,f)},y.precision=y.sd=function(a,b){var c,d,e;if(null!=a&&!!a!==a)return n(a,1,1e9),null==b?b=B:n(b,0,8),Q(new M(this),a,b);if(!(c=this.c))return null;if(d=14*(e=c.length-1)+1,e=c[e]){for(;e%10==0;e/=10,d--);for(e=c[0];e>=10;e/=10,d++);}return a&&this.e+1>d&&(d=this.e+1),d},y.shiftedBy=function(a){return n(a,-0x1fffffffffffff,0x1fffffffffffff),this.times("1e"+a)},y.squareRoot=y.sqrt=function(){var a,b,c,d,e,f=this.c,g=this.s,h=this.e,i=A+4,j=new M("0.5");if(1!==g||!f||!f[0])return new M(!g||g<0&&(!f||f[0])?NaN:f?this:1/0);if(0==(g=Math.sqrt(+R(this)))||g==1/0?(((b=l(f)).length+h)%2==0&&(b+="0"),g=Math.sqrt(+b),h=k((h+1)/2)-(h<0||h%2),c=new M(b=g==1/0?"5e"+h:(b=g.toExponential()).slice(0,b.indexOf("e")+1)+h)):c=new M(g+""),c.c[0]){for((g=(h=c.e)+i)<3&&(g=0);;)if(e=c,c=j.times(e.plus(v(this,e,i,1))),l(e.c).slice(0,g)===(b=l(c.c)).slice(0,g)){if(c.e<h&&--g,"9999"!=(b=b.slice(g-3,g+1))&&(d||"4999"!=b)){+b&&(+b.slice(1)||"5"!=b.charAt(0))||(Q(c,c.e+A+2,1),a=!c.times(c).eq(this));break}if(!d&&(Q(e,e.e+A+2,0),e.times(e).eq(this))){c=e;break}i+=4,g+=4,d=1}}return Q(c,c.e+A+1,B,a)},y.toExponential=function(a,b){return null!=a&&(n(a,0,1e9),a++),N(this,a,b,1)},y.toFixed=function(a,b){return null!=a&&(n(a,0,1e9),a=a+this.e+1),N(this,a,b)},y.toFormat=function(a,b,c){var d;if(null==c)null!=a&&b&&"object"==typeof b?(c=b,b=null):a&&"object"==typeof a?(c=a,a=b=null):c=J;else if("object"!=typeof c)throw Error(h+"Argument not an object: "+c);if(d=this.toFixed(a,b),this.c){var e,f=d.split("."),g=+c.groupSize,i=+c.secondaryGroupSize,j=c.groupSeparator||"",k=f[0],l=f[1],m=this.s<0,n=m?k.slice(1):k,o=n.length;if(i&&(e=g,g=i,i=e,o-=e),g>0&&o>0){for(e=o%g||g,k=n.substr(0,e);e<o;e+=g)k+=j+n.substr(e,g);i>0&&(k+=j+n.slice(e)),m&&(k="-"+k)}d=l?k+(c.decimalSeparator||"")+((i=+c.fractionGroupSize)?l.replace(RegExp("\\d{"+i+"}\\B","g"),"$&"+(c.fractionGroupSeparator||"")):l):k}return(c.prefix||"")+d+(c.suffix||"")},y.toFraction=function(a){var b,c,d,e,f,g,i,k,m,n,o,p,q=this.c;if(null!=a&&(!(i=new M(a)).isInteger()&&(i.c||1!==i.s)||i.lt(z)))throw Error(h+"Argument "+(i.isInteger()?"out of range: ":"not an integer: ")+R(i));if(!q)return new M(this);for(b=new M(z),m=c=new M(z),d=k=new M(z),p=l(q),f=b.e=p.length-this.e-1,b.c[0]=j[(g=f%14)<0?14+g:g],a=!a||i.comparedTo(b)>0?f>0?b:m:i,g=F,F=1/0,i=new M(p),k.c[0]=0;n=v(i,b,0,1),1!=(e=c.plus(n.times(d))).comparedTo(a);)c=d,d=e,m=k.plus(n.times(e=m)),k=e,b=i.minus(n.times(e=b)),i=e;return e=v(a.minus(c),d,0,1),k=k.plus(e.times(m)),c=c.plus(e.times(d)),k.s=m.s=this.s,f*=2,o=1>v(m,d,f,B).minus(this).abs().comparedTo(v(k,c,f,B).minus(this).abs())?[m,d]:[k,c],F=g,o},y.toNumber=function(){return+R(this)},y.toPrecision=function(a,b){return null!=a&&n(a,1,1e9),N(this,a,b,2)},y.toString=function(a){var b,c=this,d=c.s,e=c.e;return null===e?d?(b="Infinity",d<0&&(b="-"+b)):b="NaN":(null==a?b=e<=C||e>=D?p(l(c.c),e):q(l(c.c),e,"0"):10===a&&L?b=q(l((c=Q(new M(c),A+e+1,B)).c),c.e,"0"):(n(a,2,K.length,"Base"),b=w(q(l(c.c),e,"0"),10,a,d,!0)),d<0&&c.c[0]&&(b="-"+b)),b},y.valueOf=y.toJSON=function(){return R(this)},y._isBigNumber=!0,null!=b&&M.set(b),M}()).default=d.BigNumber=d,"function"==typeof define&&define.amd)a.r,void 0!==d&&a.v(d);else b.exports?b.exports=d:(c||(c="undefined"!=typeof self&&self?self:window),c.BigNumber=d)}(a.e)},35898,(a,b,c)=>{var d=a.r(48594),e=b.exports;!function(){"use strict";var a,b,c,f=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function h(a){return f.lastIndex=0,f.test(a)?'"'+a.replace(f,function(a){var b=g[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}"function"!=typeof e.stringify&&(e.stringify=function(e,f,g){var i;if(a="",b="","number"==typeof g)for(i=0;i<g;i+=1)b+=" ";else"string"==typeof g&&(b=g);if(c=f,f&&"function"!=typeof f&&("object"!=typeof f||"number"!=typeof f.length))throw Error("JSON.stringify");return function e(f,g){var i,j,k,l,m,n=a,o=g[f],p=null!=o&&(o instanceof d||d.isBigNumber(o));switch(o&&"object"==typeof o&&"function"==typeof o.toJSON&&(o=o.toJSON(f)),"function"==typeof c&&(o=c.call(g,f,o)),typeof o){case"string":if(p)return o;return h(o);case"number":return isFinite(o)?String(o):"null";case"boolean":case"null":case"bigint":return String(o);case"object":if(!o)return"null";if(a+=b,m=[],"[object Array]"===Object.prototype.toString.apply(o)){for(i=0,l=o.length;i<l;i+=1)m[i]=e(i,o)||"null";return k=0===m.length?"[]":a?"[\n"+a+m.join(",\n"+a)+"\n"+n+"]":"["+m.join(",")+"]",a=n,k}if(c&&"object"==typeof c)for(i=0,l=c.length;i<l;i+=1)"string"==typeof c[i]&&(k=e(j=c[i],o))&&m.push(h(j)+(a?": ":":")+k);else Object.keys(o).forEach(function(b){var c=e(b,o);c&&m.push(h(b)+(a?": ":":")+c)});return k=0===m.length?"{}":a?"{\n"+a+m.join(",\n"+a)+"\n"+n+"}":"{"+m.join(",")+"}",a=n,k}}("",{"":e})})}()},42672,(a,b,c)=>{var d=null;let e=/(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])/,f=/(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)/;b.exports=function(b){"use strict";var c={strict:!1,storeAsString:!1,alwaysParseAsBig:!1,useNativeBigInt:!1,protoAction:"error",constructorAction:"error"};if(null!=b){if(!0===b.strict&&(c.strict=!0),!0===b.storeAsString&&(c.storeAsString=!0),c.alwaysParseAsBig=!0===b.alwaysParseAsBig&&b.alwaysParseAsBig,c.useNativeBigInt=!0===b.useNativeBigInt&&b.useNativeBigInt,void 0!==b.constructorAction)if("error"===b.constructorAction||"ignore"===b.constructorAction||"preserve"===b.constructorAction)c.constructorAction=b.constructorAction;else throw Error(`Incorrect value for constructorAction option, must be "error", "ignore" or undefined but passed ${b.constructorAction}`);if(void 0!==b.protoAction)if("error"===b.protoAction||"ignore"===b.protoAction||"preserve"===b.protoAction)c.protoAction=b.protoAction;else throw Error(`Incorrect value for protoAction option, must be "error", "ignore" or undefined but passed ${b.protoAction}`)}var g,h,i,j,k={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},l=function(a){throw{name:"SyntaxError",message:a,at:g,text:i}},m=function(a){return a&&a!==h&&l("Expected '"+a+"' instead of '"+h+"'"),h=i.charAt(g),g+=1,h},n=function(){var b,e="";for("-"===h&&(e="-",m("-"));h>="0"&&h<="9";)e+=h,m();if("."===h)for(e+=".";m()&&h>="0"&&h<="9";)e+=h;if("e"===h||"E"===h)for(e+=h,m(),("-"===h||"+"===h)&&(e+=h,m());h>="0"&&h<="9";)e+=h,m();if(isFinite(b=+e))return(null==d&&(d=a.r(48594)),e.length>15)?c.storeAsString?e:c.useNativeBigInt?BigInt(e):new d(e):c.alwaysParseAsBig?c.useNativeBigInt?BigInt(b):new d(b):b;l("Bad number")},o=function(){var a,b,c,d="";if('"'===h)for(var e=g;m();){if('"'===h)return g-1>e&&(d+=i.substring(e,g-1)),m(),d;if("\\"===h){if(g-1>e&&(d+=i.substring(e,g-1)),m(),"u"===h){for(b=0,c=0;b<4&&isFinite(a=parseInt(m(),16));b+=1)c=16*c+a;d+=String.fromCharCode(c)}else if("string"==typeof k[h])d+=k[h];else break;e=g}}l("Bad string")},p=function(){for(;h&&h<=" ";)m()},q=function(){switch(h){case"t":return m("t"),m("r"),m("u"),m("e"),!0;case"f":return m("f"),m("a"),m("l"),m("s"),m("e"),!1;case"n":return m("n"),m("u"),m("l"),m("l"),null}l("Unexpected '"+h+"'")},r=function(){var a=[];if("["===h){if(m("["),p(),"]"===h)return m("]"),a;for(;h;){if(a.push(j()),p(),"]"===h)return m("]"),a;m(","),p()}}l("Bad array")},s=function(){var a,b=Object.create(null);if("{"===h){if(m("{"),p(),"}"===h)return m("}"),b;for(;h;){if(a=o(),p(),m(":"),!0===c.strict&&Object.hasOwnProperty.call(b,a)&&l('Duplicate key "'+a+'"'),!0===e.test(a)?"error"===c.protoAction?l("Object contains forbidden prototype property"):"ignore"===c.protoAction?j():b[a]=j():!0===f.test(a)?"error"===c.constructorAction?l("Object contains forbidden constructor property"):"ignore"===c.constructorAction?j():b[a]=j():b[a]=j(),p(),"}"===h)return m("}"),b;m(","),p()}}l("Bad object")};return j=function(){switch(p(),h){case"{":return s();case"[":return r();case'"':return o();case"-":return n();default:return h>="0"&&h<="9"?n():q()}},function(a,b){var c;return i=a+"",g=0,h=" ",c=j(),p(),h&&l("Syntax error"),"function"==typeof b?function a(c,d){var e,f=c[d];return f&&"object"==typeof f&&Object.keys(f).forEach(function(b){void 0!==(e=a(f,b))?f[b]=e:delete f[b]}),b.call(c,d,f)}({"":c},""):c}}},82827,(a,b,c)=>{var d=a.r(35898).stringify,e=a.r(42672);b.exports=function(a){return{parse:e(a),stringify:d}},b.exports.parse=e(),b.exports.stringify=d},78494,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Colours=void 0;class d{static isEnabled(a){return a&&a.isTTY&&("function"!=typeof a.getColorDepth||a.getColorDepth()>2)}static refresh(){d.enabled=d.isEnabled(null==process?void 0:process.stderr),this.enabled?(d.reset="\x1b[0m",d.bright="\x1b[1m",d.dim="\x1b[2m",d.red="\x1b[31m",d.green="\x1b[32m",d.yellow="\x1b[33m",d.blue="\x1b[34m",d.magenta="\x1b[35m",d.cyan="\x1b[36m",d.white="\x1b[37m",d.grey="\x1b[90m"):(d.reset="",d.bright="",d.dim="",d.red="",d.green="",d.yellow="",d.blue="",d.magenta="",d.cyan="",d.white="",d.grey="")}}c.Colours=d,d.enabled=!1,d.reset="",d.bright="",d.dim="",d.red="",d.green="",d.yellow="",d.blue="",d.magenta="",d.cyan="",d.white="",d.grey="",d.refresh()},71247,(a,b,c)=>{"use strict";let d;var e,f,g,h=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),i=a.e&&a.e.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:!0,value:b})}:function(a,b){a.default=b}),j=a.e&&a.e.__importStar||(e=function(a){return(e=Object.getOwnPropertyNames||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[b.length]=c);return b})(a)},function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c=e(a),d=0;d<c.length;d++)"default"!==c[d]&&h(b,a,c[d]);return i(b,a),b});Object.defineProperty(c,"__esModule",{value:!0}),c.env=c.DebugLogBackendBase=c.placeholder=c.AdhocDebugLogger=c.LogSeverity=void 0,c.getNodeBackend=r,c.getDebugBackend=function(a){return new s(a)},c.getStructuredBackend=function(a){return new t(a)},c.setBackend=function(a){d=a,u.clear()},c.log=v;let k=a.r(27699),l=j(a.r(5365)),m=j(a.r(24361)),n=a.r(78494);(f=g||(c.LogSeverity=g={})).DEFAULT="DEFAULT",f.DEBUG="DEBUG",f.INFO="INFO",f.WARNING="WARNING",f.ERROR="ERROR";class o extends k.EventEmitter{constructor(a,b){super(),this.namespace=a,this.upstream=b,this.func=Object.assign(this.invoke.bind(this),{instance:this,on:(a,b)=>this.on(a,b)}),this.func.debug=(...a)=>this.invokeSeverity(g.DEBUG,...a),this.func.info=(...a)=>this.invokeSeverity(g.INFO,...a),this.func.warn=(...a)=>this.invokeSeverity(g.WARNING,...a),this.func.error=(...a)=>this.invokeSeverity(g.ERROR,...a),this.func.sublog=a=>v(a,this.func)}invoke(a,...b){if(this.upstream)try{this.upstream(a,...b)}catch(a){}try{this.emit("log",a,b)}catch(a){}}invokeSeverity(a,...b){this.invoke({severity:a},...b)}}c.AdhocDebugLogger=o,c.placeholder=new o("",()=>{}).func;class p{constructor(){var a;this.cached=new Map,this.filters=[],this.filtersSet=!1;let b=null!=(a=l.env[c.env.nodeEnables])?a:"*";"all"===b&&(b="*"),this.filters=b.split(",")}log(a,b,...c){try{this.filtersSet||(this.setFilters(),this.filtersSet=!0);let d=this.cached.get(a);d||(d=this.makeLogger(a),this.cached.set(a,d)),d(b,...c)}catch(a){console.error(a)}}}c.DebugLogBackendBase=p;class q extends p{constructor(){super(...arguments),this.enabledRegexp=/.*/g}isEnabled(a){return this.enabledRegexp.test(a)}makeLogger(a){return this.enabledRegexp.test(a)?(b,...c)=>{var d;let e,f=`${n.Colours.green}${a}${n.Colours.reset}`,h=`${n.Colours.yellow}${l.pid}${n.Colours.reset}`;switch(b.severity){case g.ERROR:e=`${n.Colours.red}${b.severity}${n.Colours.reset}`;break;case g.INFO:e=`${n.Colours.magenta}${b.severity}${n.Colours.reset}`;break;case g.WARNING:e=`${n.Colours.yellow}${b.severity}${n.Colours.reset}`;break;default:e=null!=(d=b.severity)?d:g.DEFAULT}let i=m.formatWithOptions({colors:n.Colours.enabled},...c),j=Object.assign({},b);delete j.severity;let k=Object.getOwnPropertyNames(j).length?JSON.stringify(j):"",o=k?`${n.Colours.grey}${k}${n.Colours.reset}`:"";console.error("%s [%s|%s] %s%s",h,f,e,i,k?` ${o}`:"")}:()=>{}}setFilters(){let a=this.filters.join(",").replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^");this.enabledRegexp=RegExp(`^${a}$`,"i")}}function r(){return new q}class s extends p{constructor(a){super(),this.debugPkg=a}makeLogger(a){let b=this.debugPkg(a);return(a,...c)=>{b(c[0],...c.slice(1))}}setFilters(){var a;let b=null!=(a=l.env.NODE_DEBUG)?a:"";l.env.NODE_DEBUG=`${b}${b?",":""}${this.filters.join(",")}`}}class t extends p{constructor(a){super(),this.upstream=null!=a?a:void 0}makeLogger(a){var b;let c=null==(b=this.upstream)?void 0:b.makeLogger(a);return(a,...b)=>{var d;let e=JSON.stringify(Object.assign({severity:null!=(d=a.severity)?d:g.INFO,message:m.format(...b)},a));c?c(a,e):console.log("%s",e)}}setFilters(){var a;null==(a=this.upstream)||a.setFilters()}}c.env={nodeEnables:"GOOGLE_SDK_NODE_LOGGING"};let u=new Map;function v(a,b){let e;if(!d&&!l.env[c.env.nodeEnables]||!a)return c.placeholder;b&&(a=`${b.instance.namespace}:${a}`);let f=u.get(a);if(f)return f.func;if(null===d)return c.placeholder;void 0===d&&(d=r());let g=new o(a,(b,...c)=>{if(e!==d){if(null===d)return;void 0===d&&(d=r()),e=d}null==d||d.log(a,b,...c)});return u.set(a,g),g.func}},13551,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),e(a.r(71247),c)},76120,(a,b,c)=>{"use strict";let d;var e,f=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),g=a.e&&a.e.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:!0,value:b})}:function(a,b){a.default=b}),h=a.e&&a.e.__importStar||(e=function(a){return(e=Object.getOwnPropertyNames||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[b.length]=c);return b})(a)},function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c=e(a),d=0;d<c.length;d++)"default"!==c[d]&&f(b,a,c[d]);return g(b,a),b}),i=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||f(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),c.gcpResidencyCache=c.METADATA_SERVER_DETECTION=c.HEADERS=c.HEADER_VALUE=c.HEADER_NAME=c.SECONDARY_HOST_ADDRESS=c.HOST_ADDRESS=c.BASE_PATH=void 0,c.instance=function(a){return p("instance",a)},c.project=function(a){return p("project",a)},c.universe=function(a){return p("universe",a)},c.bulk=r,c.isAvailable=s,c.resetIsAvailableCache=function(){d=void 0},c.getGCPResidency=t,c.setGCPResidency=u,c.requestTimeout=v;let j=a.r(53683),k=a.r(82827),l=a.r(53255),m=h(a.r(13551));c.BASE_PATH="/computeMetadata/v1",c.HOST_ADDRESS="http://169.254.169.254",c.SECONDARY_HOST_ADDRESS="http://metadata.google.internal.",c.HEADER_NAME="Metadata-Flavor",c.HEADER_VALUE="Google",c.HEADERS=Object.freeze({[c.HEADER_NAME]:c.HEADER_VALUE});let n=m.log("gcp-metadata");function o(a){return a||(a=process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST||c.HOST_ADDRESS),/^https?:\/\//.test(a)||(a=`http://${a}`),new URL(c.BASE_PATH,a).href}async function p(a,b={},d=3,e=!1){let f=new Headers(c.HEADERS),g="",h={};("object"==typeof a?(new Headers(a.headers).forEach((a,b)=>f.set(b,a)),g=a.metadataKey,h=a.params||h,d=a.noResponseRetries||d,e=a.fastFail||e):g=a,"string"==typeof b)?g+=`/${b}`:(Object.keys(b).forEach(a=>{switch(a){case"params":case"property":case"headers":break;case"qs":throw Error("'qs' is not a valid configuration option. Please use 'params' instead.");default:throw Error(`'${a}' is not a valid configuration option.`)}}),b.property&&(g+=`/${b.property}`),new Headers(b.headers).forEach((a,b)=>f.set(b,a)),h=b.params||h);let i=e?q:j.request,l={url:`${o()}/${g}`,headers:f,retryConfig:{noResponseRetries:d},params:h,responseType:"text",timeout:v()};n.info("instance request %j",l);let m=await i(l);n.info("instance metadata is %s",m.data);let r=m.headers.get(c.HEADER_NAME);if(r!==c.HEADER_VALUE)throw RangeError(`Invalid response from metadata service: incorrect ${c.HEADER_NAME} header. Expected '${c.HEADER_VALUE}', got ${r?`'${r}'`:"no header"}`);if("string"==typeof m.data)try{return k.parse(m.data)}catch{}return m.data}async function q(a){let b={...a,url:a.url?.toString().replace(o(),o(c.SECONDARY_HOST_ADDRESS))};return Promise.any([(0,j.request)(a),(0,j.request)(b)])}async function r(a){let b={};return await Promise.all(a.map(a=>(async()=>{let c=await p(a);b[a.metadataKey]=c})())),b}async function s(){if(process.env.METADATA_SERVER_DETECTION){let a=process.env.METADATA_SERVER_DETECTION.trim().toLocaleLowerCase();if(!(a in c.METADATA_SERVER_DETECTION))throw RangeError(`Unknown \`METADATA_SERVER_DETECTION\` env variable. Got \`${a}\`, but it should be \`${Object.keys(c.METADATA_SERVER_DETECTION).join("`, `")}\`, or unset`);switch(a){case"assume-present":return!0;case"none":return!1;case"bios-only":return t()}}try{return void 0===d&&(d=p("instance",void 0,process.env.DETECT_GCP_RETRIES?Number(process.env.DETECT_GCP_RETRIES):0,!(process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST))),await d,!0}catch(a){if(process.env.DEBUG_AUTH&&console.info(a),"request-timeout"===a.type||a.response&&404===a.response.status)return!1;if(!(a.response&&404===a.response.status)&&(!a.code||!["EHOSTDOWN","EHOSTUNREACH","ENETUNREACH","ENOENT","ENOTFOUND","ECONNREFUSED"].includes(a.code.toString()))){let b="UNKNOWN";a.code&&(b=a.code.toString()),process.emitWarning(`received unexpected error = ${a.message} code = ${b}`,"MetadataLookupWarning")}return!1}}function t(){return null===c.gcpResidencyCache&&u(),c.gcpResidencyCache}function u(a=null){c.gcpResidencyCache=null!==a?a:(0,l.detectGCPResidency)()}function v(){return 3e3*!t()}c.METADATA_SERVER_DETECTION=Object.freeze({"assume-present":"don't try to ping the metadata server, but assume it's present",none:"don't try to ping the metadata server, but don't try to use it either","bios-only":"treat the result of a BIOS probe as canonical (don't fall back to pinging)","ping-only":"skip the BIOS probe, and go straight to pinging"}),c.gcpResidencyCache=null,i(a.r(53255),c)},61283,(a,b,c)=>{"use strict";c.byteLength=function(a){var b=j(a),c=b[0],d=b[1];return(c+d)*3/4-d},c.toByteArray=function(a){var b,c,d=j(a),g=d[0],h=d[1],i=new f((g+h)*3/4-h),k=0,l=h>0?g-4:g;for(c=0;c<l;c+=4)b=e[a.charCodeAt(c)]<<18|e[a.charCodeAt(c+1)]<<12|e[a.charCodeAt(c+2)]<<6|e[a.charCodeAt(c+3)],i[k++]=b>>16&255,i[k++]=b>>8&255,i[k++]=255&b;return 2===h&&(b=e[a.charCodeAt(c)]<<2|e[a.charCodeAt(c+1)]>>4,i[k++]=255&b),1===h&&(b=e[a.charCodeAt(c)]<<10|e[a.charCodeAt(c+1)]<<4|e[a.charCodeAt(c+2)]>>2,i[k++]=b>>8&255,i[k++]=255&b),i},c.fromByteArray=function(a){for(var b,c=a.length,e=c%3,f=[],g=0,h=c-e;g<h;g+=16383)f.push(function(a,b,c){for(var e,f=[],g=b;g<c;g+=3)e=(a[g]<<16&0xff0000)+(a[g+1]<<8&65280)+(255&a[g+2]),f.push(d[e>>18&63]+d[e>>12&63]+d[e>>6&63]+d[63&e]);return f.join("")}(a,g,g+16383>h?h:g+16383));return 1===e?f.push(d[(b=a[c-1])>>2]+d[b<<4&63]+"=="):2===e&&f.push(d[(b=(a[c-2]<<8)+a[c-1])>>10]+d[b>>4&63]+d[b<<2&63]+"="),f.join("")};for(var d=[],e=[],f="undefined"!=typeof Uint8Array?Uint8Array:Array,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,i=g.length;h<i;++h)d[h]=g[h],e[g.charCodeAt(h)]=h;function j(a){var b=a.length;if(b%4>0)throw Error("Invalid string. Length must be a multiple of 4");var c=a.indexOf("=");-1===c&&(c=b);var d=c===b?0:4-c%4;return[c,d]}e[45]=62,e[95]=63},67521,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.fromArrayBufferToHex=function(a){return Array.from(new Uint8Array(a)).map(a=>a.toString(16).padStart(2,"0")).join("")}},16835,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.BrowserCrypto=void 0;let d=a.r(61283),e=a.r(67521);class f{constructor(){throw Error("SubtleCrypto not found. Make sure it's an https:// website.")}async sha256DigestBase64(a){let b=new TextEncoder().encode(a),c=await window.crypto.subtle.digest("SHA-256",b);return d.fromByteArray(new Uint8Array(c))}randomBytesBase64(a){let b=new Uint8Array(a);return window.crypto.getRandomValues(b),d.fromByteArray(b)}static padBase64(a){for(;a.length%4!=0;)a+="=";return a}async verify(a,b,c){let e={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},g=new TextEncoder().encode(b),h=d.toByteArray(f.padBase64(c)),i=await window.crypto.subtle.importKey("jwk",a,e,!0,["verify"]);return await window.crypto.subtle.verify(e,i,h,g)}async sign(a,b){let c={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},e=new TextEncoder().encode(b),f=await window.crypto.subtle.importKey("jwk",a,c,!0,["sign"]),g=await window.crypto.subtle.sign(c,f,e);return d.fromByteArray(new Uint8Array(g))}decodeBase64StringUtf8(a){let b=d.toByteArray(f.padBase64(a));return new TextDecoder().decode(b)}encodeBase64StringUtf8(a){let b=new TextEncoder().encode(a);return d.fromByteArray(b)}async sha256DigestHex(a){let b=new TextEncoder().encode(a),c=await window.crypto.subtle.digest("SHA-256",b);return(0,e.fromArrayBufferToHex)(c)}async signWithHmacSha256(a,b){let c="string"==typeof a?a:String.fromCharCode(...new Uint16Array(a)),d=new TextEncoder,e=await window.crypto.subtle.importKey("raw",d.encode(c),{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);return window.crypto.subtle.sign("HMAC",e,d.encode(b))}}c.BrowserCrypto=f},20664,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.NodeCrypto=void 0;let d=a.r(54799);c.NodeCrypto=class{async sha256DigestBase64(a){return d.createHash("sha256").update(a).digest("base64")}randomBytesBase64(a){return d.randomBytes(a).toString("base64")}async verify(a,b,c){let e=d.createVerify("RSA-SHA256");return e.update(b),e.end(),e.verify(a,c,"base64")}async sign(a,b){let c=d.createSign("RSA-SHA256");return c.update(b),c.end(),c.sign(a,"base64")}decodeBase64StringUtf8(a){return Buffer.from(a,"base64").toString("utf-8")}encodeBase64StringUtf8(a){return Buffer.from(a,"utf-8").toString("base64")}async sha256DigestHex(a){return d.createHash("sha256").update(a).digest("hex")}async signWithHmacSha256(a,b){var c,e;let f="string"==typeof a?a:(c=a,Buffer.from(c));return(e=d.createHmac("sha256",f).update(b).digest()).buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}}},42676,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),c.createCrypto=function(){return function(){;}(),new f.NodeCrypto},c.hasBrowserCrypto=g,a.r(16835);let f=a.r(20664);function g(){return!1}e(a.r(67521),c)},10891,(a,b,c)=>{var d=a.r(874),e=d.Buffer;function f(a,b){for(var c in a)b[c]=a[c]}function g(a,b,c){return e(a,b,c)}e.from&&e.alloc&&e.allocUnsafe&&e.allocUnsafeSlow?b.exports=d:(f(d,c),c.Buffer=g),g.prototype=Object.create(e.prototype),f(e,g),g.from=function(a,b,c){if("number"==typeof a)throw TypeError("Argument must not be a number");return e(a,b,c)},g.alloc=function(a,b,c){if("number"!=typeof a)throw TypeError("Argument must be a number");var d=e(a);return void 0!==b?"string"==typeof c?d.fill(b,c):d.fill(b):d.fill(0),d},g.allocUnsafe=function(a){if("number"!=typeof a)throw TypeError("Argument must be a number");return e(a)},g.allocUnsafeSlow=function(a){if("number"!=typeof a)throw TypeError("Argument must be a number");return d.SlowBuffer(a)}},12940,(a,b,c)=>{"use strict";function d(a){return(a/8|0)+ +(a%8!=0)}var e={ES256:d(256),ES384:d(384),ES512:d(521)};b.exports=function(a){var b=e[a];if(b)return b;throw Error('Unknown algorithm "'+a+'"')}},84020,(a,b,c)=>{"use strict";var d=a.r(10891).Buffer,e=a.r(12940);function f(a){if(d.isBuffer(a))return a;if("string"==typeof a)return d.from(a,"base64");throw TypeError("ECDSA signature must be a Base64 string or a Buffer")}function g(a,b,c){for(var d=0;b+d<c&&0===a[b+d];)++d;return a[b+d]>=128&&--d,d}b.exports={derToJose:function(a,b){a=f(a);var c=e(b),g=c+1,h=a.length,i=0;if(48!==a[i++])throw Error('Could not find expected "seq"');var j=a[i++];if(129===j&&(j=a[i++]),h-i<j)throw Error('"seq" specified length of "'+j+'", only "'+(h-i)+'" remaining');if(2!==a[i++])throw Error('Could not find expected "int" for "r"');var k=a[i++];if(h-i-2<k)throw Error('"r" specified length of "'+k+'", only "'+(h-i-2)+'" available');if(g<k)throw Error('"r" specified length of "'+k+'", max of "'+g+'" is acceptable');var l=i;if(i+=k,2!==a[i++])throw Error('Could not find expected "int" for "s"');var m=a[i++];if(h-i!==m)throw Error('"s" specified length of "'+m+'", expected "'+(h-i)+'"');if(g<m)throw Error('"s" specified length of "'+m+'", max of "'+g+'" is acceptable');var n=i;if((i+=m)!==h)throw Error('Expected to consume entire buffer, but "'+(h-i)+'" bytes remain');var o=c-k,p=c-m,q=d.allocUnsafe(o+k+p+m);for(i=0;i<o;++i)q[i]=0;a.copy(q,i,l+Math.max(-o,0),l+k),i=c;for(var r=i;i<r+p;++i)q[i]=0;return a.copy(q,i,n+Math.max(-p,0),n+m),q=(q=q.toString("base64")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},joseToDer:function(a,b){a=f(a);var c=e(b),h=a.length;if(h!==2*c)throw TypeError('"'+b+'" signatures must be "'+2*c+'" bytes, saw "'+h+'"');var i=g(a,0,c),j=g(a,c,a.length),k=c-i,l=c-j,m=2+k+1+1+l,n=m<128,o=d.allocUnsafe((n?2:3)+m),p=0;return o[p++]=48,n?o[p++]=m:(o[p++]=129,o[p++]=255&m),o[p++]=2,o[p++]=k,i<0?(o[p++]=0,p+=a.copy(o,p,0,c)):p+=a.copy(o,p,i,c),o[p++]=2,o[p++]=l,j<0?(o[p++]=0,a.copy(o,p,c)):a.copy(o,p,c+j),o}}},75701,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.LRUCache=void 0,c.snakeToCamel=h,c.originalOrCamelOptions=function(a){return{get:function(b){let c=a||{};return c[b]??c[h(b)]}}},c.removeUndefinedValuesInObject=function(a){return Object.entries(a).forEach(([b,c])=>{(void 0===c||"undefined"===c)&&delete a[b]}),a},c.isValidFile=j,c.getWellKnownCertificateConfigFileLocation=function(){let a=process.env.CLOUDSDK_CONFIG||(e.platform().startsWith("win")?f.join(process.env.APPDATA||"",g):f.join(process.env.HOME||"",".config",g));return f.join(a,"certificate_config.json")};let d=a.r(22734),e=a.r(46786),f=a.r(14747),g="gcloud";function h(a){return a.replace(/([_][^_])/g,a=>a.slice(1).toUpperCase())}class i{capacity;#k=new Map;maxAge;constructor(a){this.capacity=a.capacity,this.maxAge=a.maxAge}#l(a,b){this.#k.delete(a),this.#k.set(a,{value:b,lastAccessed:Date.now()})}set(a,b){this.#l(a,b),this.#m()}get(a){let b=this.#k.get(a);if(b)return this.#l(a,b.value),this.#m(),b.value}#m(){let a=this.maxAge?Date.now()-this.maxAge:0,b=this.#k.entries().next();for(;!b.done&&(this.#k.size>this.capacity||b.value[1].lastAccessed<a);)this.#k.delete(b.value[0]),b=this.#k.entries().next()}}async function j(a){try{return(await d.promises.lstat(a)).isFile()}catch(a){return!1}}c.LRUCache=i},73116,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.USER_AGENT=c.PRODUCT_NAME=c.pkg=void 0;let d=a.r(91829);c.pkg=d;let e="google-api-nodejs-client";c.PRODUCT_NAME=e,c.USER_AGENT=`${e}/${d.version}`},76378,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.AuthClient=c.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS=c.DEFAULT_UNIVERSE=void 0;let d=a.r(27699),e=a.r(53683),f=a.r(75701),g=a.r(13551),h=a.r(73116);c.DEFAULT_UNIVERSE="googleapis.com",c.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS=3e5;class i extends d.EventEmitter{apiKey;projectId;quotaProjectId;transporter;credentials={};eagerRefreshThresholdMillis=c.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS;forceRefreshOnFailure=!1;universeDomain=c.DEFAULT_UNIVERSE;static RequestMethodNameSymbol=Symbol("request method name");static RequestLogIdSymbol=Symbol("request log id");constructor(a={}){super();const b=(0,f.originalOrCamelOptions)(a);this.apiKey=a.apiKey,this.projectId=b.get("project_id")??null,this.quotaProjectId=b.get("quota_project_id"),this.credentials=b.get("credentials")??{},this.universeDomain=b.get("universe_domain")??c.DEFAULT_UNIVERSE,this.transporter=a.transporter??new e.Gaxios(a.transporterOptions),!1!==b.get("useAuthRequestParameters")&&(this.transporter.interceptors.request.add(i.DEFAULT_REQUEST_INTERCEPTOR),this.transporter.interceptors.response.add(i.DEFAULT_RESPONSE_INTERCEPTOR)),a.eagerRefreshThresholdMillis&&(this.eagerRefreshThresholdMillis=a.eagerRefreshThresholdMillis),this.forceRefreshOnFailure=a.forceRefreshOnFailure??!1}fetch(...a){let b,c=a[0],d=a[1],f=new Headers;return("string"==typeof c?b=new URL(c):c instanceof URL?b=c:c&&c.url&&(b=new URL(c.url)),c&&"object"==typeof c&&"headers"in c&&e.Gaxios.mergeHeaders(f,c.headers),d&&e.Gaxios.mergeHeaders(f,new Headers(d.headers)),"object"!=typeof c||c instanceof URL)?this.request({...d,headers:f,url:b}):this.request({...d,...c,headers:f,url:b})}setCredentials(a){this.credentials=a}addSharedMetadataHeaders(a){return!a.has("x-goog-user-project")&&this.quotaProjectId&&a.set("x-goog-user-project",this.quotaProjectId),a}addUserProjectAndAuthHeaders(a,b){let c=b.get("x-goog-user-project"),d=b.get("authorization");return c&&a.set("x-goog-user-project",c),d&&a.set("authorization",d),a}static log=(0,g.log)("auth");static DEFAULT_REQUEST_INTERCEPTOR={resolved:async a=>{if(!a.headers.has("x-goog-api-client")){let b=process.version.replace(/^v/,"");a.headers.set("x-goog-api-client",`gl-node/${b}`)}let b=a.headers.get("User-Agent");b?b.includes(`${h.PRODUCT_NAME}/`)||a.headers.set("User-Agent",`${b} ${h.USER_AGENT}`):a.headers.set("User-Agent",h.USER_AGENT);try{let b=a[i.RequestMethodNameSymbol],c=`${Math.floor(1e3*Math.random())}`;a[i.RequestLogIdSymbol]=c;let d={url:a.url,headers:a.headers};b?i.log.info("%s [%s] request %j",b,c,d):i.log.info("[%s] request %j",c,d)}catch(a){}return a}};static DEFAULT_RESPONSE_INTERCEPTOR={resolved:async a=>{try{let b=a.config,c=b[i.RequestMethodNameSymbol],d=b[i.RequestLogIdSymbol];c?i.log.info("%s [%s] response %j",c,d,a.data):i.log.info("[%s] response %j",d,a.data)}catch(a){}return a},rejected:async a=>{try{let b=a.config,c=b[i.RequestMethodNameSymbol],d=b[i.RequestLogIdSymbol];c?i.log.info("%s [%s] error %j",c,d,a.response?.data):i.log.error("[%s] error %j",d,a.response?.data)}catch(a){}throw a}};static setMethodName(a,b){try{a[i.RequestMethodNameSymbol]=b}catch(a){}}static get RETRY_CONFIG(){return{retry:!0,retryConfig:{httpMethodsToRetry:["GET","PUT","POST","HEAD","OPTIONS","DELETE"]}}}}c.AuthClient=i},97122,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.LoginTicket=void 0,c.LoginTicket=class{envelope;payload;constructor(a,b){this.envelope=a,this.payload=b}getEnvelope(){return this.envelope}getPayload(){return this.payload}getUserId(){let a=this.getPayload();return a&&a.sub?a.sub:null}getAttributes(){return{envelope:this.getEnvelope(),payload:this.getPayload()}}}},35246,(a,b,c)=>{"use strict";var d,e,f,g,h,i;Object.defineProperty(c,"__esModule",{value:!0}),c.OAuth2Client=c.ClientAuthentication=c.CertificateFormat=c.CodeChallengeMethod=void 0;let j=a.r(53683),k=a.r(45706),l=a.r(88947),m=a.r(84020),n=a.r(75701),o=a.r(42676),p=a.r(76378),q=a.r(97122);(g=d||(c.CodeChallengeMethod=d={})).Plain="plain",g.S256="S256",(h=e||(c.CertificateFormat=e={})).PEM="PEM",h.JWK="JWK",(i=f||(c.ClientAuthentication=f={})).ClientSecretPost="ClientSecretPost",i.ClientSecretBasic="ClientSecretBasic",i.None="None";class r extends p.AuthClient{redirectUri;certificateCache={};certificateExpiry=null;certificateCacheFormat=e.PEM;refreshTokenPromises=new Map;endpoints;issuers;clientAuthentication;_clientId;_clientSecret;refreshHandler;constructor(a={},b,c){super("object"==typeof a?a:{}),"object"!=typeof a&&(a={clientId:a,clientSecret:b,redirectUri:c}),this._clientId=a.clientId||a.client_id,this._clientSecret=a.clientSecret||a.client_secret,this.redirectUri=a.redirectUri||a.redirect_uris?.[0],this.endpoints={tokenInfoUrl:"https://oauth2.googleapis.com/tokeninfo",oauth2AuthBaseUrl:"https://accounts.google.com/o/oauth2/v2/auth",oauth2TokenUrl:"https://oauth2.googleapis.com/token",oauth2RevokeUrl:"https://oauth2.googleapis.com/revoke",oauth2FederatedSignonPemCertsUrl:"https://www.googleapis.com/oauth2/v1/certs",oauth2FederatedSignonJwkCertsUrl:"https://www.googleapis.com/oauth2/v3/certs",oauth2IapPublicKeyUrl:"https://www.gstatic.com/iap/verify/public_key",...a.endpoints},this.clientAuthentication=a.clientAuthentication||f.ClientSecretPost,this.issuers=a.issuers||["accounts.google.com","https://accounts.google.com",this.universeDomain]}static GOOGLE_TOKEN_INFO_URL="https://oauth2.googleapis.com/tokeninfo";static CLOCK_SKEW_SECS_=300;static DEFAULT_MAX_TOKEN_LIFETIME_SECS_=86400;generateAuthUrl(a={}){if(a.code_challenge_method&&!a.code_challenge)throw Error("If a code_challenge_method is provided, code_challenge must be included.");return a.response_type=a.response_type||"code",a.client_id=a.client_id||this._clientId,a.redirect_uri=a.redirect_uri||this.redirectUri,Array.isArray(a.scope)&&(a.scope=a.scope.join(" ")),this.endpoints.oauth2AuthBaseUrl.toString()+"?"+k.stringify(a)}generateCodeVerifier(){throw Error("generateCodeVerifier is removed, please use generateCodeVerifierAsync instead.")}async generateCodeVerifierAsync(){let a=(0,o.createCrypto)(),b=a.randomBytesBase64(96).replace(/\+/g,"~").replace(/=/g,"_").replace(/\//g,"-"),c=(await a.sha256DigestBase64(b)).split("=")[0].replace(/\+/g,"-").replace(/\//g,"_");return{codeVerifier:b,codeChallenge:c}}getToken(a,b){let c="string"==typeof a?{code:a}:a;if(!b)return this.getTokenAsync(c);this.getTokenAsync(c).then(a=>b(null,a.tokens,a.res),a=>b(a,null,a.response))}async getTokenAsync(a){let b=this.endpoints.oauth2TokenUrl.toString(),c=new Headers,d={client_id:a.client_id||this._clientId,code_verifier:a.codeVerifier,code:a.code,grant_type:"authorization_code",redirect_uri:a.redirect_uri||this.redirectUri};if(this.clientAuthentication===f.ClientSecretBasic){let a=Buffer.from(`${this._clientId}:${this._clientSecret}`);c.set("authorization",`Basic ${a.toString("base64")}`)}this.clientAuthentication===f.ClientSecretPost&&(d.client_secret=this._clientSecret);let e={...r.RETRY_CONFIG,method:"POST",url:b,data:new URLSearchParams((0,n.removeUndefinedValuesInObject)(d)),headers:c};p.AuthClient.setMethodName(e,"getTokenAsync");let g=await this.transporter.request(e),h=g.data;return g.data&&g.data.expires_in&&(h.expiry_date=new Date().getTime()+1e3*g.data.expires_in,delete h.expires_in),this.emit("tokens",h),{tokens:h,res:g}}async refreshToken(a){if(!a)return this.refreshTokenNoCache(a);if(this.refreshTokenPromises.has(a))return this.refreshTokenPromises.get(a);let b=this.refreshTokenNoCache(a).then(b=>(this.refreshTokenPromises.delete(a),b),b=>{throw this.refreshTokenPromises.delete(a),b});return this.refreshTokenPromises.set(a,b),b}async refreshTokenNoCache(a){let b;if(!a)throw Error("No refresh token is set.");let c=this.endpoints.oauth2TokenUrl.toString(),d={refresh_token:a,client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token"};try{let a={...r.RETRY_CONFIG,method:"POST",url:c,data:new URLSearchParams((0,n.removeUndefinedValuesInObject)(d))};p.AuthClient.setMethodName(a,"refreshTokenNoCache"),b=await this.transporter.request(a)}catch(a){throw a instanceof j.GaxiosError&&"invalid_grant"===a.message&&a.response?.data&&/ReAuth/i.test(a.response.data.error_description)&&(a.message=JSON.stringify(a.response.data)),a}let e=b.data;return b.data&&b.data.expires_in&&(e.expiry_date=new Date().getTime()+1e3*b.data.expires_in,delete e.expires_in),this.emit("tokens",e),{tokens:e,res:b}}refreshAccessToken(a){if(!a)return this.refreshAccessTokenAsync();this.refreshAccessTokenAsync().then(b=>a(null,b.credentials,b.res),a)}async refreshAccessTokenAsync(){let a=await this.refreshToken(this.credentials.refresh_token),b=a.tokens;return b.refresh_token=this.credentials.refresh_token,this.credentials=b,{credentials:this.credentials,res:a.res}}getAccessToken(a){if(!a)return this.getAccessTokenAsync();this.getAccessTokenAsync().then(b=>a(null,b.token,b.res),a)}async getAccessTokenAsync(){if(!(!this.credentials.access_token||this.isTokenExpiring()))return{token:this.credentials.access_token};{if(!this.credentials.refresh_token)if(this.refreshHandler){let a=await this.processAndValidateRefreshHandler();if(a?.access_token)return this.setCredentials(a),{token:this.credentials.access_token}}else throw Error("No refresh token or refresh handler callback is set.");let a=await this.refreshAccessTokenAsync();if(!a.credentials||a.credentials&&!a.credentials.access_token)throw Error("Could not refresh access token.");return{token:a.credentials.access_token,res:a.res}}}async getRequestHeaders(a){return(await this.getRequestMetadataAsync(a)).headers}async getRequestMetadataAsync(a){let b=this.credentials;if(!b.access_token&&!b.refresh_token&&!this.apiKey&&!this.refreshHandler)throw Error("No access, refresh token, API key or refresh handler callback is set.");if(b.access_token&&!this.isTokenExpiring()){b.token_type=b.token_type||"Bearer";let a=new Headers({authorization:b.token_type+" "+b.access_token});return{headers:this.addSharedMetadataHeaders(a)}}if(this.refreshHandler){let a=await this.processAndValidateRefreshHandler();if(a?.access_token){this.setCredentials(a);let b=new Headers({authorization:"Bearer "+this.credentials.access_token});return{headers:this.addSharedMetadataHeaders(b)}}}if(this.apiKey)return{headers:new Headers({"X-Goog-Api-Key":this.apiKey})};let c=null,d=null;try{d=(c=await this.refreshToken(b.refresh_token)).tokens}catch(a){throw a.response&&(403===a.response.status||404===a.response.status)&&(a.message=`Could not refresh access token: ${a.message}`),a}let e=this.credentials;e.token_type=e.token_type||"Bearer",d.refresh_token=e.refresh_token,this.credentials=d;let f=new Headers({authorization:e.token_type+" "+d.access_token});return{headers:this.addSharedMetadataHeaders(f),res:c.res}}static getRevokeTokenUrl(a){return new r().getRevokeTokenURL(a).toString()}getRevokeTokenURL(a){let b=new URL(this.endpoints.oauth2RevokeUrl);return b.searchParams.append("token",a),b}revokeToken(a,b){let c={...r.RETRY_CONFIG,url:this.getRevokeTokenURL(a).toString(),method:"POST"};if(p.AuthClient.setMethodName(c,"revokeToken"),!b)return this.transporter.request(c);this.transporter.request(c).then(a=>b(null,a),b)}revokeCredentials(a){if(!a)return this.revokeCredentialsAsync();this.revokeCredentialsAsync().then(b=>a(null,b),a)}async revokeCredentialsAsync(){let a=this.credentials.access_token;if(this.credentials={},a)return this.revokeToken(a);throw Error("No access token to revoke.")}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async requestAsync(a,b=!1){try{let b=await this.getRequestMetadataAsync();return a.headers=j.Gaxios.mergeHeaders(a.headers),this.addUserProjectAndAuthHeaders(a.headers,b.headers),this.apiKey&&a.headers.set("X-Goog-Api-Key",this.apiKey),await this.transporter.request(a)}catch(d){let c=d.response;if(c){let d=c.status,e=this.credentials&&this.credentials.access_token&&this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure),f=this.credentials&&this.credentials.access_token&&!this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure)&&this.refreshHandler,g=c.config.data instanceof l.Readable,h=401===d||403===d;if(!b&&h&&!g&&e)return await this.refreshAccessTokenAsync(),this.requestAsync(a,!0);if(!b&&h&&!g&&f){let b=await this.processAndValidateRefreshHandler();return b?.access_token&&this.setCredentials(b),this.requestAsync(a,!0)}}throw d}}verifyIdToken(a,b){if(b&&"function"!=typeof b)throw Error("This method accepts an options object as the first parameter, which includes the idToken, audience, and maxExpiry.");if(!b)return this.verifyIdTokenAsync(a);this.verifyIdTokenAsync(a).then(a=>b(null,a),b)}async verifyIdTokenAsync(a){if(!a.idToken)throw Error("The verifyIdToken method requires an ID Token");let b=await this.getFederatedSignonCertsAsync();return await this.verifySignedJwtWithCertsAsync(a.idToken,b.certs,a.audience,this.issuers,a.maxExpiry)}async getTokenInfo(a){let{data:b}=await this.transporter.request({...r.RETRY_CONFIG,method:"POST",headers:{"content-type":"application/x-www-form-urlencoded;charset=UTF-8",authorization:`Bearer ${a}`},url:this.endpoints.tokenInfoUrl.toString()}),c=Object.assign({expiry_date:new Date().getTime()+1e3*b.expires_in,scopes:b.scope.split(" ")},b);return delete c.expires_in,delete c.scope,c}getFederatedSignonCerts(a){if(!a)return this.getFederatedSignonCertsAsync();this.getFederatedSignonCertsAsync().then(b=>a(null,b.certs,b.res),a)}async getFederatedSignonCertsAsync(){let a,b,c=new Date().getTime(),d=(0,o.hasBrowserCrypto)()?e.JWK:e.PEM;if(this.certificateExpiry&&c<this.certificateExpiry.getTime()&&this.certificateCacheFormat===d)return{certs:this.certificateCache,format:d};switch(d){case e.PEM:b=this.endpoints.oauth2FederatedSignonPemCertsUrl.toString();break;case e.JWK:b=this.endpoints.oauth2FederatedSignonJwkCertsUrl.toString();break;default:throw Error(`Unsupported certificate format ${d}`)}try{let c={...r.RETRY_CONFIG,url:b};p.AuthClient.setMethodName(c,"getFederatedSignonCertsAsync"),a=await this.transporter.request(c)}catch(a){throw a instanceof Error&&(a.message=`Failed to retrieve verification certificates: ${a.message}`),a}let f=a?.headers.get("cache-control"),g=-1;if(f){let a=/max-age=(?<maxAge>[0-9]+)/.exec(f)?.groups?.maxAge;a&&(g=1e3*Number(a))}let h={};switch(d){case e.PEM:h=a.data;break;case e.JWK:for(let b of a.data.keys)h[b.kid]=b;break;default:throw Error(`Unsupported certificate format ${d}`)}let i=new Date;return this.certificateExpiry=-1===g?null:new Date(i.getTime()+g),this.certificateCache=h,this.certificateCacheFormat=d,{certs:h,format:d,res:a}}getIapPublicKeys(a){if(!a)return this.getIapPublicKeysAsync();this.getIapPublicKeysAsync().then(b=>a(null,b.pubkeys,b.res),a)}async getIapPublicKeysAsync(){let a,b=this.endpoints.oauth2IapPublicKeyUrl.toString();try{let c={...r.RETRY_CONFIG,url:b};p.AuthClient.setMethodName(c,"getIapPublicKeysAsync"),a=await this.transporter.request(c)}catch(a){throw a instanceof Error&&(a.message=`Failed to retrieve verification certificates: ${a.message}`),a}return{pubkeys:a.data,res:a}}verifySignedJwtWithCerts(){throw Error("verifySignedJwtWithCerts is removed, please use verifySignedJwtWithCertsAsync instead.")}async verifySignedJwtWithCertsAsync(a,b,c,d,e){let f,g,h=(0,o.createCrypto)();e||(e=r.DEFAULT_MAX_TOKEN_LIFETIME_SECS_);let i=a.split(".");if(3!==i.length)throw Error("Wrong number of segments in token: "+a);let j=i[0]+"."+i[1],k=i[2];try{f=JSON.parse(h.decodeBase64StringUtf8(i[0]))}catch(a){throw a instanceof Error&&(a.message=`Can't parse token envelope: ${i[0]}': ${a.message}`),a}if(!f)throw Error("Can't parse token envelope: "+i[0]);try{g=JSON.parse(h.decodeBase64StringUtf8(i[1]))}catch(a){throw a instanceof Error&&(a.message=`Can't parse token payload '${i[0]}`),a}if(!g)throw Error("Can't parse token payload: "+i[1]);if(!Object.prototype.hasOwnProperty.call(b,f.kid))throw Error("No pem found for envelope: "+JSON.stringify(f));let l=b[f.kid];if("ES256"===f.alg&&(k=m.joseToDer(k,"ES256").toString("base64")),!await h.verify(l,j,k))throw Error("Invalid token signature: "+a);if(!g.iat)throw Error("No issue time in token: "+JSON.stringify(g));if(!g.exp)throw Error("No expiration time in token: "+JSON.stringify(g));let n=Number(g.iat);if(isNaN(n))throw Error("iat field using invalid format");let p=Number(g.exp);if(isNaN(p))throw Error("exp field using invalid format");let s=new Date().getTime()/1e3;if(p>=s+e)throw Error("Expiration time too far in future: "+JSON.stringify(g));let t=n-r.CLOCK_SKEW_SECS_,u=p+r.CLOCK_SKEW_SECS_;if(s<t)throw Error("Token used too early, "+s+" < "+t+": "+JSON.stringify(g));if(s>u)throw Error("Token used too late, "+s+" > "+u+": "+JSON.stringify(g));if(d&&0>d.indexOf(g.iss))throw Error("Invalid issuer, expected one of ["+d+"], but got "+g.iss);if(null!=c){let a=g.aud;if(!(c.constructor===Array?c.indexOf(a)>-1:a===c))throw Error("Wrong recipient, payload audience != requiredAudience")}return new q.LoginTicket(f,g)}async processAndValidateRefreshHandler(){if(this.refreshHandler){let a=await this.refreshHandler();if(!a.access_token)throw Error("No access token is returned by the refreshHandler callback.");return a}}isTokenExpiring(){let a=this.credentials.expiry_date;return!!a&&a<=new Date().getTime()+this.eagerRefreshThresholdMillis}}c.OAuth2Client=r},77078,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Compute=void 0;let d=a.r(53683),e=a.r(76120),f=a.r(35246);class g extends f.OAuth2Client{serviceAccountEmail;scopes;constructor(a={}){super(a),this.credentials={expiry_date:1,refresh_token:"compute-placeholder"},this.serviceAccountEmail=a.serviceAccountEmail||"default",this.scopes=Array.isArray(a.scopes)?a.scopes:a.scopes?[a.scopes]:[]}async refreshTokenNoCache(){let a,b=`service-accounts/${this.serviceAccountEmail}/token`;try{let c={property:b};this.scopes.length>0&&(c.params={scopes:this.scopes.join(",")}),a=await e.instance(c)}catch(a){throw a instanceof d.GaxiosError&&(a.message=`Could not refresh access token: ${a.message}`,this.wrapError(a)),a}let c=a;return a&&a.expires_in&&(c.expiry_date=new Date().getTime()+1e3*a.expires_in,delete c.expires_in),this.emit("tokens",c),{tokens:c,res:null}}async fetchIdToken(a){let b,c=`service-accounts/${this.serviceAccountEmail}/identity?format=full&audience=${a}`;try{b=await e.instance({property:c})}catch(a){throw a instanceof Error&&(a.message=`Could not fetch ID token: ${a.message}`),a}return b}wrapError(a){let b=a.response;b&&b.status&&(a.status=b.status,403===b.status?a.message="A Forbidden error was returned while attempting to retrieve an access token for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have the correct permission scopes specified: "+a.message:404===b.status&&(a.message="A Not Found error was returned while attempting to retrieve an accesstoken for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have any permission scopes specified: "+a.message))}}c.Compute=g},73736,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.IdTokenClient=void 0;let d=a.r(35246);class e extends d.OAuth2Client{targetAudience;idTokenProvider;constructor(a){super(a),this.targetAudience=a.targetAudience,this.idTokenProvider=a.idTokenProvider}async getRequestMetadataAsync(){if(!this.credentials.id_token||!this.credentials.expiry_date||this.isTokenExpiring()){let a=await this.idTokenProvider.fetchIdToken(this.targetAudience);this.credentials={id_token:a,expiry_date:this.getIdTokenExpiryDate(a)}}return{headers:new Headers({authorization:"Bearer "+this.credentials.id_token})}}getIdTokenExpiryDate(a){let b=a.split(".")[1];if(b)return 1e3*JSON.parse(Buffer.from(b,"base64").toString("ascii")).exp}}c.IdTokenClient=e},64783,(a,b,c)=>{"use strict";var d,e;let f;Object.defineProperty(c,"__esModule",{value:!0}),c.GCPEnv=void 0,c.clear=function(){f=void 0},c.getEnv=h;let g=a.r(76120);async function h(){return f||(f=i())}async function i(){d.NONE;return process.env.GAE_SERVICE||process.env.GAE_MODULE_NAME?d.APP_ENGINE:process.env.FUNCTION_NAME||process.env.FUNCTION_TARGET?d.CLOUD_FUNCTIONS:await k()?await j()?d.KUBERNETES_ENGINE:process.env.K_CONFIGURATION?d.CLOUD_RUN:process.env.CLOUD_RUN_JOB?d.CLOUD_RUN_JOBS:d.COMPUTE_ENGINE:d.NONE}async function j(){try{return await g.instance("attributes/cluster-name"),!0}catch(a){return!1}}async function k(){return g.isAvailable()}(e=d||(c.GCPEnv=d={})).APP_ENGINE="APP_ENGINE",e.KUBERNETES_ENGINE="KUBERNETES_ENGINE",e.CLOUD_FUNCTIONS="CLOUD_FUNCTIONS",e.COMPUTE_ENGINE="COMPUTE_ENGINE",e.CLOUD_RUN="CLOUD_RUN",e.CLOUD_RUN_JOBS="CLOUD_RUN_JOBS",e.NONE="NONE"},34380,(a,b,c)=>{var d=a.r(10891).Buffer,e=a.r(88947);function f(a){if(this.buffer=null,this.writable=!0,this.readable=!0,!a)return this.buffer=d.alloc(0),this;if("function"==typeof a.pipe)return this.buffer=d.alloc(0),a.pipe(this),this;if(a.length||"object"==typeof a)return this.buffer=a,this.writable=!1,process.nextTick((function(){this.emit("end",a),this.readable=!1,this.emit("close")}).bind(this)),this;throw TypeError("Unexpected data type ("+typeof a+")")}a.r(24361).inherits(f,e),f.prototype.write=function(a){this.buffer=d.concat([this.buffer,d.from(a)]),this.emit("data",a)},f.prototype.end=function(a){a&&this.write(a),this.emit("end",a),this.emit("close"),this.writable=!1,this.readable=!1},b.exports=f},39887,(a,b,c)=>{"use strict";var d=a.r(874).Buffer,e=a.r(874).SlowBuffer;function f(a,b){if(!d.isBuffer(a)||!d.isBuffer(b)||a.length!==b.length)return!1;for(var c=0,e=0;e<a.length;e++)c|=a[e]^b[e];return 0===c}b.exports=f,f.install=function(){d.prototype.equal=e.prototype.equal=function(a){return f(this,a)}};var g=d.prototype.equal,h=e.prototype.equal;f.restore=function(){d.prototype.equal=g,e.prototype.equal=h}},34024,(a,b,c)=>{var d,e=a.r(10891).Buffer,f=a.r(54799),g=a.r(84020),h=a.r(24361),i="secret must be a string or buffer",j="key must be a string or a buffer",k="function"==typeof f.createPublicKey;function l(a){if(!e.isBuffer(a)&&"string"!=typeof a&&(!k||"object"!=typeof a||"string"!=typeof a.type||"string"!=typeof a.asymmetricKeyType||"function"!=typeof a.export))throw p(j)}function m(a){if(!e.isBuffer(a)&&"string"!=typeof a&&"object"!=typeof a)throw p("key must be a string, a buffer or an object")}function n(a){return a.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function o(a){var b=4-(a=a.toString()).length%4;if(4!==b)for(var c=0;c<b;++c)a+="=";return a.replace(/\-/g,"+").replace(/_/g,"/")}function p(a){var b=[].slice.call(arguments,1);return TypeError(h.format.bind(h,a).apply(null,b))}function q(a){var b;return b=a,e.isBuffer(b)||"string"==typeof b||(a=JSON.stringify(a)),a}function r(a){return function(b,c){!function(a){if(!e.isBuffer(a)){if("string"!=typeof a){if(!k||"object"!=typeof a||"secret"!==a.type||"function"!=typeof a.export)throw p(i)}}}(c),b=q(b);var d=f.createHmac("sha"+a,c);return n((d.update(b),d.digest("base64")))}}k&&(j+=" or a KeyObject",i+="or a KeyObject");var s="timingSafeEqual"in f?function(a,b){return a.byteLength===b.byteLength&&f.timingSafeEqual(a,b)}:function(b,c){return d||(d=a.r(39887)),d(b,c)};function t(a){return function(b,c,d){var f=r(a)(b,d);return s(e.from(c),e.from(f))}}function u(a){return function(b,c){m(c),b=q(b);var d=f.createSign("RSA-SHA"+a);return n((d.update(b),d.sign(c,"base64")))}}function v(a){return function(b,c,d){l(d),b=q(b),c=o(c);var e=f.createVerify("RSA-SHA"+a);return e.update(b),e.verify(d,c,"base64")}}function w(a){return function(b,c){m(c),b=q(b);var d=f.createSign("RSA-SHA"+a);return n((d.update(b),d.sign({key:c,padding:f.constants.RSA_PKCS1_PSS_PADDING,saltLength:f.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function x(a){return function(b,c,d){l(d),b=q(b),c=o(c);var e=f.createVerify("RSA-SHA"+a);return e.update(b),e.verify({key:d,padding:f.constants.RSA_PKCS1_PSS_PADDING,saltLength:f.constants.RSA_PSS_SALTLEN_DIGEST},c,"base64")}}function y(a){var b=u(a);return function(){var c=b.apply(null,arguments);return g.derToJose(c,"ES"+a)}}function z(a){var b=v(a);return function(c,d,e){return b(c,d=g.joseToDer(d,"ES"+a).toString("base64"),e)}}function A(){return function(){return""}}function B(){return function(a,b){return""===b}}b.exports=function(a){var b=a.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/);if(!b)throw p('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',a);var c=(b[1]||b[3]).toLowerCase(),d=b[2];return{sign:({hs:r,rs:u,ps:w,es:y,none:A})[c](d),verify:({hs:t,rs:v,ps:x,es:z,none:B})[c](d)}}},54682,(a,b,c)=>{var d=a.r(874).Buffer;b.exports=function(a){return"string"==typeof a?a:"number"==typeof a||d.isBuffer(a)?a.toString():JSON.stringify(a)}},49511,(a,b,c)=>{var d=a.r(10891).Buffer,e=a.r(34380),f=a.r(34024),g=a.r(88947),h=a.r(54682),i=a.r(24361);function j(a,b){return d.from(a,b).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function k(a){var b,c,d,e=a.header,g=a.payload,k=a.secret||a.privateKey,l=a.encoding,m=f(e.alg),n=(b=(b=l)||"utf8",c=j(h(e),"binary"),d=j(h(g),b),i.format("%s.%s",c,d)),o=m.sign(n,k);return i.format("%s.%s",n,o)}function l(a){var b=new e(a.secret||a.privateKey||a.key);this.readable=!0,this.header=a.header,this.encoding=a.encoding,this.secret=this.privateKey=this.key=b,this.payload=new e(a.payload),this.secret.once("close",(function(){!this.payload.writable&&this.readable&&this.sign()}).bind(this)),this.payload.once("close",(function(){!this.secret.writable&&this.readable&&this.sign()}).bind(this))}i.inherits(l,g),l.prototype.sign=function(){try{var a=k({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",a),this.emit("data",a),this.emit("end"),this.readable=!1,a}catch(a){this.readable=!1,this.emit("error",a),this.emit("close")}},l.sign=k,b.exports=l},75188,(a,b,c)=>{var d=a.r(10891).Buffer,e=a.r(34380),f=a.r(34024),g=a.r(88947),h=a.r(54682),i=a.r(24361),j=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function k(a){var b=a.split(".",1)[0],c=d.from(b,"base64").toString("binary");if("[object Object]"===Object.prototype.toString.call(c))return c;try{return JSON.parse(c)}catch(a){return}}function l(a){return a.split(".")[2]}function m(a){return j.test(a)&&!!k(a)}function n(a,b,c){if(!b){var d=Error("Missing algorithm parameter for jws.verify");throw d.code="MISSING_ALGORITHM",d}var e=l(a=h(a)),g=a.split(".",2).join(".");return f(b).verify(g,e,c)}function o(a,b){if(b=b||{},!m(a=h(a)))return null;var c,e,f=k(a);if(!f)return null;var g=(c=c||"utf8",e=a.split(".")[1],d.from(e,"base64").toString(c));return("JWT"===f.typ||b.json)&&(g=JSON.parse(g,b.encoding)),{header:f,payload:g,signature:l(a)}}function p(a){var b=new e((a=a||{}).secret||a.publicKey||a.key);this.readable=!0,this.algorithm=a.algorithm,this.encoding=a.encoding,this.secret=this.publicKey=this.key=b,this.signature=new e(a.signature),this.secret.once("close",(function(){!this.signature.writable&&this.readable&&this.verify()}).bind(this)),this.signature.once("close",(function(){!this.secret.writable&&this.readable&&this.verify()}).bind(this))}i.inherits(p,g),p.prototype.verify=function(){try{var a=n(this.signature.buffer,this.algorithm,this.key.buffer),b=o(this.signature.buffer,this.encoding);return this.emit("done",a,b),this.emit("data",a),this.emit("end"),this.readable=!1,a}catch(a){this.readable=!1,this.emit("error",a),this.emit("close")}},p.decode=o,p.isValid=m,p.verify=n,b.exports=p},81649,(a,b,c)=>{var d=a.r(49511),e=a.r(75188);c.ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],c.sign=d.sign,c.verify=e.verify,c.decode=e.decode,c.isValid=e.isValid,c.createSign=function(a){return new d(a)},c.createVerify=function(a){return new e(a)}},53191,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GoogleToken=void 0;var d,e=j(a.r(22734)),f=a.r(53683),g=j(a.r(81649)),h=j(a.r(14747)),i=a.r(24361);function j(a,b){if("function"==typeof WeakMap)var c=new WeakMap,d=new WeakMap;return(j=function(a,b){if(!b&&a&&a.__esModule)return a;var e,f,g={__proto__:null,default:a};if(null===a||"object"!=k(a)&&"function"!=typeof a)return g;if(e=b?d:c){if(e.has(a))return e.get(a);e.set(a,g)}for(var h in a)"default"!==h&&({}).hasOwnProperty.call(a,h)&&((f=(e=Object.defineProperty)&&Object.getOwnPropertyDescriptor(a,h))&&(f.get||f.set)?e(g,h,f):g[h]=a[h]);return g})(a,b)}function k(a){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function l(a,b){if(b.has(a))throw TypeError("Cannot initialize the same private elements twice on an object")}function m(a,b,c){return a.set(n(a,b),c),c}function n(a,b,c){if("function"==typeof a?a===b:a.has(b))return arguments.length<3?b:c;throw TypeError("Private element is not present on this object")}function o(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,w(d.key),d)}}function p(a,b,c){return b&&o(a.prototype,b),c&&o(a,c),Object.defineProperty(a,"prototype",{writable:!1}),a}function q(a,b){if(!(a instanceof b))throw TypeError("Cannot call a class as a function")}function r(a){var b="function"==typeof Map?new Map:void 0;return(r=function(a){if(null===a||!function(a){try{return -1!==Function.toString.call(a).indexOf("[native code]")}catch(b){return"function"==typeof a}}(a))return a;if("function"!=typeof a)throw TypeError("Super expression must either be null or a function");if(void 0!==b){if(b.has(a))return b.get(a);b.set(a,c)}function c(){return function(a,b,c){if(s())return Reflect.construct.apply(null,arguments);var d=[null];d.push.apply(d,b);var e=new(a.bind.apply(a,d));return c&&t(e,c.prototype),e}(a,arguments,u(this).constructor)}return c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),t(c,a)})(a)}function s(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(a){}return(s=function(){return!!a})()}function t(a,b){return(t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,b){return a.__proto__=b,a})(a,b)}function u(a){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function v(a,b,c){return(b=w(b))in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function w(a){var b=function(a,b){if("object"!=k(a)||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=k(d))return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(a,"string");return"symbol"==k(b)?b:b+""}function x(){var a,b,c="function"==typeof Symbol?Symbol:{},d=c.iterator||"@@iterator",e=c.toStringTag||"@@toStringTag";function f(c,d,e,f){var i=Object.create((d&&d.prototype instanceof h?d:h).prototype);return y(i,"_invoke",function(c,d,e){var f,h,i,j=0,k=e||[],l=!1,m={p:0,n:0,v:a,a:n,f:n.bind(a,4),d:function(b,c){return f=b,h=0,i=a,m.n=c,g}};function n(c,d){for(h=c,i=d,b=0;!l&&j&&!e&&b<k.length;b++){var e,f=k[b],n=m.p,o=f[2];c>3?(e=o===d)&&(i=f[(h=f[4])?5:(h=3,3)],f[4]=f[5]=a):f[0]<=n&&((e=c<2&&n<f[1])?(h=0,m.v=d,m.n=f[1]):n<o&&(e=c<3||f[0]>d||d>o)&&(f[4]=c,f[5]=d,m.n=o,h=0))}if(e||c>1)return g;throw l=!0,d}return function(e,k,o){if(j>1)throw TypeError("Generator is already running");for(l&&1===k&&n(k,o),h=k,i=o;(b=h<2?a:i)||!l;){f||(h?h<3?(h>1&&(m.n=-1),n(h,i)):m.n=i:m.v=i);try{if(j=2,f){if(h||(e="next"),b=f[e]){if(!(b=b.call(f,i)))throw TypeError("iterator result is not an object");if(!b.done)return b;i=b.value,h<2&&(h=0)}else 1===h&&(b=f.return)&&b.call(f),h<2&&(i=TypeError("The iterator does not provide a '"+e+"' method"),h=1);f=a}else if((b=(l=m.n<0)?i:c.call(d,m))!==g)break}catch(b){f=a,h=1,i=b}finally{j=1}}return{value:b,done:l}}}(c,e,f),!0),i}var g={};function h(){}function i(){}function j(){}b=Object.getPrototypeOf;var k=j.prototype=h.prototype=Object.create([][d]?b(b([][d]())):(y(b={},d,function(){return this}),b));function l(a){return Object.setPrototypeOf?Object.setPrototypeOf(a,j):(a.__proto__=j,y(a,e,"GeneratorFunction")),a.prototype=Object.create(k),a}return i.prototype=j,y(k,"constructor",j),y(j,"constructor",i),i.displayName="GeneratorFunction",y(j,e,"GeneratorFunction"),y(k),y(k,e,"Generator"),y(k,d,function(){return this}),y(k,"toString",function(){return"[object Generator]"}),(x=function(){return{w:f,m:l}})()}function y(a,b,c,d){var e=Object.defineProperty;try{e({},"",{})}catch(a){e=0}(y=function(a,b,c,d){if(b)e?e(a,b,{value:c,enumerable:!d,configurable:!d,writable:!d}):a[b]=c;else{var f=function(b,c){y(a,b,function(a){return this._invoke(b,c,a)})};f("next",0),f("throw",1),f("return",2)}})(a,b,c,d)}function z(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){return void c(a)}h.done?b(i):Promise.resolve(i).then(d,e)}function A(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var f=a.apply(b,c);function g(a){z(f,d,e,g,h,"next",a)}function h(a){z(f,d,e,g,h,"throw",a)}g(void 0)})}}var B=e.readFile?(0,i.promisify)(e.readFile):A(x().m(function a(){return x().w(function(a){for(;;)switch(a.n){case 0:throw new D("use key rather than keyFile.","MISSING_CREDENTIALS");case 1:return a.a(2)}},a)})),C="https://oauth2.googleapis.com/token",D=function(a){function b(a,c){var d,e,f;return q(this,b),e=b,f=[a],e=u(e),v(d=function(a,b){if(b&&("object"==k(b)||"function"==typeof b))return b;if(void 0!==b)throw TypeError("Derived constructors may only return object or undefined");var c=a;if(void 0===c)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(this,s()?Reflect.construct(e,f||[],u(this).constructor):e.apply(this,f)),"code",void 0),d.code=c,d}if("function"!=typeof a&&null!==a)throw TypeError("Super expression must either be null or a function");return b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),Object.defineProperty(b,"prototype",{writable:!1}),a&&t(b,a),p(b)}(r(Error)),E=new WeakMap,F=new WeakSet;function G(a){return H.apply(this,arguments)}function H(){return(H=A(x().m(function a(b){return x().w(function(a){for(;;)switch(a.n){case 0:if(!E.get(n(E,this))||b.forceRefresh){a.n=1;break}return a.a(2,E.get(n(E,this)));case 1:return a.p=1,a.n=2,m(E,this,n(F,this,I).call(this,b));case 2:return a.a(2,a.v);case 3:return a.p=3,m(E,this,void 0),a.f(3);case 4:return a.a(2)}},a,this,[[1,,3,4]])}))).apply(this,arguments)}function I(a){return J.apply(this,arguments)}function J(){return(J=A(x().m(function a(b){var c;return x().w(function(a){for(;;)switch(a.n){case 0:if(!1!==this.isTokenExpiring()||!1!==b.forceRefresh){a.n=1;break}return a.a(2,Promise.resolve(this.rawToken));case 1:if(!(!this.key&&!this.keyFile)){a.n=2;break}throw Error("No key or keyFile set.");case 2:if(!(!this.key&&this.keyFile)){a.n=4;break}return a.n=3,this.getCredentials(this.keyFile);case 3:c=a.v,this.key=c.privateKey,this.iss=c.clientEmail||this.iss,c.clientEmail||n(F,this,K).call(this);case 4:return a.a(2,n(F,this,O).call(this))}},a,this)}))).apply(this,arguments)}function K(){if(!this.iss)throw new D("email is required.","MISSING_CREDENTIALS")}function L(){return M.apply(this,arguments)}function M(){return(M=A(x().m(function a(){var b;return x().w(function(a){for(;;)switch(a.n){case 0:if(this.accessToken){a.n=1;break}throw Error("No token to revoke.");case 1:return b="https://oauth2.googleapis.com/revoke?token="+this.accessToken,a.n=2,this.transporter.request({url:b,retry:!0});case 2:n(F,this,N).call(this,{email:this.iss,sub:this.sub,key:this.key,keyFile:this.keyFile,scope:this.scope,additionalClaims:this.additionalClaims});case 3:return a.a(2)}},a,this)}))).apply(this,arguments)}function N(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.keyFile=a.keyFile,this.key=a.key,this.rawToken=void 0,this.iss=a.email||a.iss,this.sub=a.sub,this.additionalClaims=a.additionalClaims,"object"===k(a.scope)?this.scope=a.scope.join(" "):this.scope=a.scope,this.eagerRefreshThresholdMillis=a.eagerRefreshThresholdMillis,a.transporter&&(this.transporter=a.transporter)}function O(){return P.apply(this,arguments)}function P(){return(P=A(x().m(function a(){var b,c,d,e,f,h,i,j,k,l;return x().w(function(a){for(;;)switch(a.n){case 0:return b=Math.floor(new Date().getTime()/1e3),c=this.additionalClaims||{},d=Object.assign({iss:this.iss,scope:this.scope,aud:C,exp:b+3600,iat:b,sub:this.sub},c),e=g.sign({header:{alg:"RS256"},payload:d,secret:this.key}),a.p=1,a.n=2,this.transporter.request({method:"POST",url:C,data:new URLSearchParams({grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:e}),responseType:"json",retryConfig:{httpMethodsToRetry:["POST"]}});case 2:return f=a.v,this.rawToken=f.data,this.expiresAt=null===f.data.expires_in||void 0===f.data.expires_in?void 0:(b+f.data.expires_in)*1e3,a.a(2,this.rawToken);case 3:throw a.p=3,l=a.v,this.rawToken=void 0,this.tokenExpires=void 0,(j=l.response&&null!=(h=l.response)&&h.data?null==(i=l.response)?void 0:i.data:{}).error&&(k=j.error_description?": ".concat(j.error_description):"",l.message="".concat(j.error).concat(k)),l;case 4:return a.a(2)}},a,this,[[1,3]])}))).apply(this,arguments)}c.GoogleToken=p(function a(b){q(this,a),l(this,F),F.add(this),v(this,"expiresAt",void 0),v(this,"key",void 0),v(this,"keyFile",void 0),v(this,"iss",void 0),v(this,"sub",void 0),v(this,"scope",void 0),v(this,"rawToken",void 0),v(this,"tokenExpires",void 0),v(this,"email",void 0),v(this,"additionalClaims",void 0),v(this,"eagerRefreshThresholdMillis",void 0),v(this,"transporter",{request:function(a){return(0,f.request)(a)}}),l(this,E),E.set(this,void 0),n(F,this,N).call(this,b)},[{key:"accessToken",get:function(){return this.rawToken?this.rawToken.access_token:void 0}},{key:"idToken",get:function(){return this.rawToken?this.rawToken.id_token:void 0}},{key:"tokenType",get:function(){return this.rawToken?this.rawToken.token_type:void 0}},{key:"refreshToken",get:function(){return this.rawToken?this.rawToken.refresh_token:void 0}},{key:"hasExpired",value:function(){var a=new Date().getTime();return!this.rawToken||!this.expiresAt||a>=this.expiresAt}},{key:"isTokenExpiring",value:function(){var a,b=new Date().getTime(),c=null!=(a=this.eagerRefreshThresholdMillis)?a:0;return!this.rawToken||!this.expiresAt||this.expiresAt<=b+c}},{key:"getToken",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"===k(a)&&(b=a,a=void 0),b=Object.assign({forceRefresh:!1},b),a){var c=a;n(F,this,G).call(this,b).then(function(a){return c(null,a)},a);return}return n(F,this,G).call(this,b)}},{key:"getCredentials",value:(d=A(x().m(function a(b){var c,d,e,f,g;return x().w(function(a){for(;;)switch(a.n){case 0:a.n=".json"===(g=h.extname(b))?1:".der"===g||".crt"===g||".pem"===g?4:".p12"===g||".pfx"===g?6:7;break;case 1:return a.n=2,B(b,"utf8");case 2:if(d=(c=JSON.parse(a.v)).private_key,e=c.client_email,!(!d||!e)){a.n=3;break}throw new D("private_key and client_email are required.","MISSING_CREDENTIALS");case 3:return a.a(2,{privateKey:d,clientEmail:e});case 4:return a.n=5,B(b,"utf8");case 5:return f=a.v,a.a(2,{privateKey:f});case 6:throw new D("*.p12 certificates are not supported after v6.1.2. Consider utilizing *.json format or converting *.p12 to *.pem using the OpenSSL CLI.","UNKNOWN_CERTIFICATE_TYPE");case 7:throw new D("Unknown certificate type. Type is determined based on file extension. Current supported extensions are *.json, and *.pem.","UNKNOWN_CERTIFICATE_TYPE");case 8:return a.a(2)}},a)})),function(a){return d.apply(this,arguments)})},{key:"revokeToken",value:function(a){return a?void n(F,this,L).call(this).then(function(){return a()},a):n(F,this,L).call(this)}}])},34414,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.JWTAccess=void 0;let d=a.r(81649),e=a.r(75701),f={alg:"RS256",typ:"JWT"};class g{email;key;keyId;projectId;eagerRefreshThresholdMillis;cache=new e.LRUCache({capacity:500,maxAge:36e5});constructor(a,b,c,d){this.email=a,this.key=b,this.keyId=c,this.eagerRefreshThresholdMillis=d??3e5}getCachedKey(a,b){let c=a;if(b&&Array.isArray(b)&&b.length?c=a?`${a}_${b.join("_")}`:`${b.join("_")}`:"string"==typeof b&&(c=a?`${a}_${b}`:b),!c)throw Error("Scopes or url must be provided");return c}getRequestHeaders(a,b,c){let e,h=this.getCachedKey(a,c),i=this.cache.get(h),j=Date.now();if(i&&i.expiration-j>this.eagerRefreshThresholdMillis)return new Headers(i.headers);let k=Math.floor(Date.now()/1e3),l=g.getExpirationTime(k);if(Array.isArray(c)&&(c=c.join(" ")),e=c?{iss:this.email,sub:this.email,scope:c,exp:l,iat:k}:{iss:this.email,sub:this.email,aud:a,exp:l,iat:k},b){for(let a in e)if(b[a])throw Error(`The '${a}' property is not allowed when passing additionalClaims. This claim is included in the JWT by default.`)}let m=this.keyId?{...f,kid:this.keyId}:f,n=Object.assign(e,b),o=d.sign({header:m,payload:n,secret:this.key}),p=new Headers({authorization:`Bearer ${o}`});return this.cache.set(h,{expiration:1e3*l,headers:p}),p}static getExpirationTime(a){return a+3600}fromJSON(a){if(!a)throw Error("Must pass in a JSON object containing the service account auth settings.");if(!a.client_email)throw Error("The incoming JSON object does not contain a client_email field");if(!a.private_key)throw Error("The incoming JSON object does not contain a private_key field");this.email=a.client_email,this.key=a.private_key,this.keyId=a.private_key_id,this.projectId=a.project_id}fromStream(a,b){if(!b)return this.fromStreamAsync(a);this.fromStreamAsync(a).then(()=>b(),b)}fromStreamAsync(a){return new Promise((b,c)=>{a||c(Error("Must pass in a stream containing the service account auth settings."));let d="";a.setEncoding("utf8").on("data",a=>d+=a).on("error",c).on("end",()=>{try{let a=JSON.parse(d);this.fromJSON(a),b()}catch(a){c(a)}})})}}c.JWTAccess=g},2629,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.JWT=void 0;let d=a.r(53191),e=a.r(34414),f=a.r(35246),g=a.r(76378);class h extends f.OAuth2Client{email;keyFile;key;keyId;defaultScopes;scopes;scope;subject;gtoken;additionalClaims;useJWTAccessWithScope;defaultServicePath;access;constructor(a={}){super(a),this.email=a.email,this.keyFile=a.keyFile,this.key=a.key,this.keyId=a.keyId,this.scopes=a.scopes,this.subject=a.subject,this.additionalClaims=a.additionalClaims,this.credentials={refresh_token:"jwt-placeholder",expiry_date:1}}createScoped(a){let b=new h(this);return b.scopes=a,b}async getRequestMetadataAsync(a){a=this.defaultServicePath?`https://${this.defaultServicePath}/`:a;let b=!this.hasUserScopes()&&a||this.useJWTAccessWithScope&&this.hasAnyScopes()||this.universeDomain!==g.DEFAULT_UNIVERSE;if(this.subject&&this.universeDomain!==g.DEFAULT_UNIVERSE)throw RangeError(`Service Account user is configured for the credential. Domain-wide delegation is not supported in universes other than ${g.DEFAULT_UNIVERSE}`);if(!this.apiKey&&b)if(this.additionalClaims&&this.additionalClaims.target_audience){let{tokens:a}=await this.refreshToken();return{headers:this.addSharedMetadataHeaders(new Headers({authorization:`Bearer ${a.id_token}`}))}}else{let b;this.access||(this.access=new e.JWTAccess(this.email,this.key,this.keyId,this.eagerRefreshThresholdMillis)),this.hasUserScopes()?b=this.scopes:a||(b=this.defaultScopes);let c=this.useJWTAccessWithScope||this.universeDomain!==g.DEFAULT_UNIVERSE,d=await this.access.getRequestHeaders(a??void 0,this.additionalClaims,c?b:void 0);return{headers:this.addSharedMetadataHeaders(d)}}return this.hasAnyScopes()||this.apiKey?super.getRequestMetadataAsync(a):{headers:new Headers}}async fetchIdToken(a){let b=new d.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:{target_audience:a},transporter:this.transporter});if(await b.getToken({forceRefresh:!0}),!b.idToken)throw Error("Unknown error: Failed to fetch ID token");return b.idToken}hasUserScopes(){return!!this.scopes&&this.scopes.length>0}hasAnyScopes(){return!!this.scopes&&!!(this.scopes.length>0)||!!this.defaultScopes&&!!(this.defaultScopes.length>0)}authorize(a){if(!a)return this.authorizeAsync();this.authorizeAsync().then(b=>a(null,b),a)}async authorizeAsync(){let a=await this.refreshToken();if(!a)throw Error("No result returned");return this.credentials=a.tokens,this.credentials.refresh_token="jwt-placeholder",this.key=this.gtoken.key,this.email=this.gtoken.iss,a.tokens}async refreshTokenNoCache(){let a=this.createGToken(),b={access_token:(await a.getToken({forceRefresh:this.isTokenExpiring()})).access_token,token_type:"Bearer",expiry_date:a.expiresAt,id_token:a.idToken};return this.emit("tokens",b),{res:null,tokens:b}}createGToken(){return this.gtoken||(this.gtoken=new d.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:this.additionalClaims,transporter:this.transporter})),this.gtoken}fromJSON(a){if(!a)throw Error("Must pass in a JSON object containing the service account auth settings.");if(!a.client_email)throw Error("The incoming JSON object does not contain a client_email field");if(!a.private_key)throw Error("The incoming JSON object does not contain a private_key field");this.email=a.client_email,this.key=a.private_key,this.keyId=a.private_key_id,this.projectId=a.project_id,this.quotaProjectId=a.quota_project_id,this.universeDomain=a.universe_domain||this.universeDomain}fromStream(a,b){if(!b)return this.fromStreamAsync(a);this.fromStreamAsync(a).then(()=>b(),b)}fromStreamAsync(a){return new Promise((b,c)=>{if(!a)throw Error("Must pass in a stream containing the service account auth settings.");let d="";a.setEncoding("utf8").on("error",c).on("data",a=>d+=a).on("end",()=>{try{let a=JSON.parse(d);this.fromJSON(a),b()}catch(a){c(a)}})})}fromAPIKey(a){if("string"!=typeof a)throw Error("Must provide an API Key string.");this.apiKey=a}async getCredentials(){if(this.key)return{private_key:this.key,client_email:this.email};if(this.keyFile){let a=this.createGToken(),b=await a.getCredentials(this.keyFile);return{private_key:b.privateKey,client_email:b.clientEmail}}throw Error("A key or a keyFile must be provided to getCredentials.")}}c.JWT=h},53904,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.UserRefreshClient=c.USER_REFRESH_ACCOUNT_TYPE=void 0;let d=a.r(35246),e=a.r(76378);c.USER_REFRESH_ACCOUNT_TYPE="authorized_user";class f extends d.OAuth2Client{_refreshToken;constructor(a,b,c,d,e){const f=a&&"object"==typeof a?a:{clientId:a,clientSecret:b,refreshToken:c,eagerRefreshThresholdMillis:d,forceRefreshOnFailure:e};super(f),this._refreshToken=f.refreshToken,this.credentials.refresh_token=f.refreshToken}async refreshTokenNoCache(){return super.refreshTokenNoCache(this._refreshToken)}async fetchIdToken(a){let b={...f.RETRY_CONFIG,url:this.endpoints.oauth2TokenUrl,method:"POST",data:new URLSearchParams({client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token",refresh_token:this._refreshToken,target_audience:a})};return e.AuthClient.setMethodName(b,"fetchIdToken"),(await this.transporter.request(b)).data.id_token}fromJSON(a){if(!a)throw Error("Must pass in a JSON object containing the user refresh token");if("authorized_user"!==a.type)throw Error('The incoming JSON object does not have the "authorized_user" type');if(!a.client_id)throw Error("The incoming JSON object does not contain a client_id field");if(!a.client_secret)throw Error("The incoming JSON object does not contain a client_secret field");if(!a.refresh_token)throw Error("The incoming JSON object does not contain a refresh_token field");this._clientId=a.client_id,this._clientSecret=a.client_secret,this._refreshToken=a.refresh_token,this.credentials.refresh_token=a.refresh_token,this.quotaProjectId=a.quota_project_id,this.universeDomain=a.universe_domain||this.universeDomain}fromStream(a,b){if(!b)return this.fromStreamAsync(a);this.fromStreamAsync(a).then(()=>b(),b)}async fromStreamAsync(a){return new Promise((b,c)=>{if(!a)return c(Error("Must pass in a stream containing the user refresh token."));let d="";a.setEncoding("utf8").on("error",c).on("data",a=>d+=a).on("end",()=>{try{let a=JSON.parse(d);return this.fromJSON(a),b()}catch(a){return c(a)}})})}static fromJSON(a){let b=new f;return b.fromJSON(a),b}}c.UserRefreshClient=f},7064,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Impersonated=c.IMPERSONATED_ACCOUNT_TYPE=void 0;let d=a.r(35246),e=a.r(53683),f=a.r(75701);c.IMPERSONATED_ACCOUNT_TYPE="impersonated_service_account";class g extends d.OAuth2Client{sourceClient;targetPrincipal;targetScopes;delegates;lifetime;endpoint;constructor(a={}){if(super(a),this.credentials={expiry_date:1,refresh_token:"impersonated-placeholder"},this.sourceClient=a.sourceClient??new d.OAuth2Client,this.targetPrincipal=a.targetPrincipal??"",this.delegates=a.delegates??[],this.targetScopes=a.targetScopes??[],this.lifetime=a.lifetime??3600,(0,f.originalOrCamelOptions)(a).get("universe_domain")){if(this.sourceClient.universeDomain!==this.universeDomain)throw RangeError(`Universe domain ${this.sourceClient.universeDomain} in source credentials does not match ${this.universeDomain} universe domain set for impersonated credentials.`)}else this.universeDomain=this.sourceClient.universeDomain;this.endpoint=a.endpoint??`https://iamcredentials.${this.universeDomain}`}async sign(a){await this.sourceClient.getAccessToken();let b=`projects/-/serviceAccounts/${this.targetPrincipal}`,c=`${this.endpoint}/v1/${b}:signBlob`,d={delegates:this.delegates,payload:Buffer.from(a).toString("base64")};return(await this.sourceClient.request({...g.RETRY_CONFIG,url:c,data:d,method:"POST"})).data}getTargetPrincipal(){return this.targetPrincipal}async refreshToken(){try{await this.sourceClient.getAccessToken();let a="projects/-/serviceAccounts/"+this.targetPrincipal,b=`${this.endpoint}/v1/${a}:generateAccessToken`,c={delegates:this.delegates,scope:this.targetScopes,lifetime:this.lifetime+"s"},d=await this.sourceClient.request({...g.RETRY_CONFIG,url:b,data:c,method:"POST"}),e=d.data;return this.credentials.access_token=e.accessToken,this.credentials.expiry_date=Date.parse(e.expireTime),{tokens:this.credentials,res:d}}catch(c){if(!(c instanceof Error))throw c;let a=0,b="";if(c instanceof e.GaxiosError&&(a=c?.response?.data?.error?.status,b=c?.response?.data?.error?.message),a&&b)throw c.message=`${a}: unable to impersonate: ${b}`,c;throw c.message=`unable to impersonate: ${c}`,c}}async fetchIdToken(a,b){await this.sourceClient.getAccessToken();let c=`projects/-/serviceAccounts/${this.targetPrincipal}`,d=`${this.endpoint}/v1/${c}:generateIdToken`,e={delegates:this.delegates,audience:a,includeEmail:b?.includeEmail??!0,useEmailAzp:b?.includeEmail??!0};return(await this.sourceClient.request({...g.RETRY_CONFIG,url:d,data:e,method:"POST"})).data.token}}c.Impersonated=g},61671,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.OAuthClientAuthHandler=void 0,c.getErrorFromOAuthErrorResponse=function(a,b){let c=a.error,d=a.error_description,e=a.error_uri,f=`Error code ${c}`;void 0!==d&&(f+=`: ${d}`),void 0!==e&&(f+=` - ${e}`);let g=Error(f);if(b){let a=Object.keys(b);b.stack&&a.push("stack"),a.forEach(a=>{"message"!==a&&Object.defineProperty(g,a,{value:b[a],writable:!1,enumerable:!0})})}return g};let d=a.r(53683),e=a.r(42676),f=["PUT","POST","PATCH"];class g{#n=(0,e.createCrypto)();#o;transporter;constructor(a){a&&"clientId"in a?(this.#o=a,this.transporter=new d.Gaxios):(this.#o=a?.clientAuthentication,this.transporter=a?.transporter||new d.Gaxios)}applyClientAuthenticationOptions(a,b){a.headers=d.Gaxios.mergeHeaders(a.headers),this.injectAuthenticatedHeaders(a,b),b||this.injectAuthenticatedRequestBody(a)}injectAuthenticatedHeaders(a,b){if(b)a.headers=d.Gaxios.mergeHeaders(a.headers,{authorization:`Bearer ${b}`});else if(this.#o?.confidentialClientType==="basic"){a.headers=d.Gaxios.mergeHeaders(a.headers);let b=this.#o.clientId,c=this.#o.clientSecret||"",e=this.#n.encodeBase64StringUtf8(`${b}:${c}`);d.Gaxios.mergeHeaders(a.headers,{authorization:`Basic ${e}`})}}injectAuthenticatedRequestBody(a){if(this.#o?.confidentialClientType==="request-body"){let b=(a.method||"GET").toUpperCase();if(!f.includes(b))throw Error(`${b} HTTP method does not support ${this.#o.confidentialClientType} client authentication`);let c=new Headers(a.headers).get("content-type");if(c?.startsWith("application/x-www-form-urlencoded")||a.data instanceof URLSearchParams){let b=new URLSearchParams(a.data??"");b.append("client_id",this.#o.clientId),b.append("client_secret",this.#o.clientSecret||""),a.data=b}else if(c?.startsWith("application/json"))a.data=a.data||{},Object.assign(a.data,{client_id:this.#o.clientId,client_secret:this.#o.clientSecret||""});else throw Error(`${c} content-types are not supported with ${this.#o.confidentialClientType} client authentication`)}}static get RETRY_CONFIG(){return{retry:!0,retryConfig:{httpMethodsToRetry:["GET","PUT","POST","HEAD","OPTIONS","DELETE"]}}}}c.OAuthClientAuthHandler=g},89627,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StsCredentials=void 0;let d=a.r(53683),e=a.r(76378),f=a.r(61671),g=a.r(75701);class h extends f.OAuthClientAuthHandler{#p;constructor(a={tokenExchangeEndpoint:""},b){("object"!=typeof a||a instanceof URL)&&(a={tokenExchangeEndpoint:a,clientAuthentication:b}),super(a),this.#p=a.tokenExchangeEndpoint}async exchangeToken(a,b,c){let i={grant_type:a.grantType,resource:a.resource,audience:a.audience,scope:a.scope?.join(" "),requested_token_type:a.requestedTokenType,subject_token:a.subjectToken,subject_token_type:a.subjectTokenType,actor_token:a.actingParty?.actorToken,actor_token_type:a.actingParty?.actorTokenType,options:c&&JSON.stringify(c)},j={...h.RETRY_CONFIG,url:this.#p.toString(),method:"POST",headers:b,data:new URLSearchParams((0,g.removeUndefinedValuesInObject)(i))};e.AuthClient.setMethodName(j,"exchangeToken"),this.applyClientAuthenticationOptions(j);try{let a=await this.transporter.request(j),b=a.data;return b.res=a,b}catch(a){if(a instanceof d.GaxiosError&&a.response)throw(0,f.getErrorFromOAuthErrorResponse)(a.response.data,a);throw a}}}c.StsCredentials=h},74579,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.BaseExternalAccountClient=c.CLOUD_RESOURCE_MANAGER=c.EXTERNAL_ACCOUNT_TYPE=c.EXPIRATION_TIME_OFFSET=void 0;let d=a.r(53683),e=a.r(88947),f=a.r(76378),g=a.r(89627),h=a.r(75701),i=a.r(73116),j="https://www.googleapis.com/auth/cloud-platform";c.EXPIRATION_TIME_OFFSET=3e5,c.EXTERNAL_ACCOUNT_TYPE="external_account",c.CLOUD_RESOURCE_MANAGER="https://cloudresourcemanager.googleapis.com/v1/projects/";class k extends f.AuthClient{scopes;projectNumber;audience;subjectTokenType;stsCredential;clientAuth;credentialSourceType;cachedAccessToken;serviceAccountImpersonationUrl;serviceAccountImpersonationLifetime;workforcePoolUserProject;configLifetimeRequested;tokenUrl;cloudResourceManagerURL;supplierContext;#q=null;constructor(a){super(a);const b=(0,h.originalOrCamelOptions)(a),d=b.get("type");if(d&&d!==c.EXTERNAL_ACCOUNT_TYPE)throw Error(`Expected "${c.EXTERNAL_ACCOUNT_TYPE}" type but received "${a.type}"`);const e=b.get("client_id"),f=b.get("client_secret");this.tokenUrl=b.get("token_url")??"https://sts.{universeDomain}/v1/token".replace("{universeDomain}",this.universeDomain);const i=b.get("subject_token_type"),k=b.get("workforce_pool_user_project"),l=b.get("service_account_impersonation_url"),m=b.get("service_account_impersonation"),n=(0,h.originalOrCamelOptions)(m).get("token_lifetime_seconds");this.cloudResourceManagerURL=new URL(b.get("cloud_resource_manager_url")||`https://cloudresourcemanager.${this.universeDomain}/v1/projects/`),e&&(this.clientAuth={confidentialClientType:"basic",clientId:e,clientSecret:f}),this.stsCredential=new g.StsCredentials({tokenExchangeEndpoint:this.tokenUrl,clientAuthentication:this.clientAuth}),this.scopes=b.get("scopes")||[j],this.cachedAccessToken=null,this.audience=b.get("audience"),this.subjectTokenType=i,this.workforcePoolUserProject=k;const o=RegExp("//iam\\.googleapis\\.com/locations/[^/]+/workforcePools/[^/]+/providers/.+");if(this.workforcePoolUserProject&&!this.audience.match(o))throw Error("workforcePoolUserProject should not be set for non-workforce pool credentials.");this.serviceAccountImpersonationUrl=l,this.serviceAccountImpersonationLifetime=n,this.serviceAccountImpersonationLifetime?this.configLifetimeRequested=!0:(this.configLifetimeRequested=!1,this.serviceAccountImpersonationLifetime=3600),this.projectNumber=this.getProjectNumber(this.audience),this.supplierContext={audience:this.audience,subjectTokenType:this.subjectTokenType,transporter:this.transporter}}getServiceAccountEmail(){if(this.serviceAccountImpersonationUrl){if(this.serviceAccountImpersonationUrl.length>256)throw RangeError(`URL is too long: ${this.serviceAccountImpersonationUrl}`);let a=/serviceAccounts\/(?<email>[^:]+):generateAccessToken$/.exec(this.serviceAccountImpersonationUrl);return a?.groups?.email||null}return null}setCredentials(a){super.setCredentials(a),this.cachedAccessToken=a}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){let a=await this.getAccessToken(),b=new Headers({authorization:`Bearer ${a.token}`});return this.addSharedMetadataHeaders(b)}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async getProjectId(){let a=this.projectNumber||this.workforcePoolUserProject;if(this.projectId)return this.projectId;if(a){let b=await this.getRequestHeaders(),c={...k.RETRY_CONFIG,headers:b,url:`${this.cloudResourceManagerURL.toString()}${a}`};f.AuthClient.setMethodName(c,"getProjectId");let d=await this.transporter.request(c);return this.projectId=d.data.projectId,this.projectId}return null}async requestAsync(a,b=!1){let c;try{let b=await this.getRequestHeaders();a.headers=d.Gaxios.mergeHeaders(a.headers),this.addUserProjectAndAuthHeaders(a.headers,b),c=await this.transporter.request(a)}catch(d){let c=d.response;if(c){let d=c.status,f=c.config.data instanceof e.Readable;if(!b&&(401===d||403===d)&&!f&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(a,!0)}throw d}return c}async refreshAccessTokenAsync(){this.#q=this.#q||this.#r();try{return await this.#q}finally{this.#q=null}}async #r(){let a=await this.retrieveSubjectToken(),b={grantType:"urn:ietf:params:oauth:grant-type:token-exchange",audience:this.audience,requestedTokenType:"urn:ietf:params:oauth:token-type:access_token",subjectToken:a,subjectTokenType:this.subjectTokenType,scope:this.serviceAccountImpersonationUrl?[j]:this.getScopesArray()},c=!this.clientAuth&&this.workforcePoolUserProject?{userProject:this.workforcePoolUserProject}:void 0,d=new Headers({"x-goog-api-client":this.getMetricsHeaderValue()}),e=await this.stsCredential.exchangeToken(b,d,c);return this.serviceAccountImpersonationUrl?this.cachedAccessToken=await this.getImpersonatedAccessToken(e.access_token):e.expires_in?this.cachedAccessToken={access_token:e.access_token,expiry_date:new Date().getTime()+1e3*e.expires_in,res:e.res}:this.cachedAccessToken={access_token:e.access_token,res:e.res},this.credentials={},Object.assign(this.credentials,this.cachedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedAccessToken.expiry_date,access_token:this.cachedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedAccessToken}getProjectNumber(a){let b=a.match(/\/projects\/([^/]+)/);return b?b[1]:null}async getImpersonatedAccessToken(a){let b={...k.RETRY_CONFIG,url:this.serviceAccountImpersonationUrl,method:"POST",headers:{"content-type":"application/json",authorization:`Bearer ${a}`},data:{scope:this.getScopesArray(),lifetime:this.serviceAccountImpersonationLifetime+"s"}};f.AuthClient.setMethodName(b,"getImpersonatedAccessToken");let c=await this.transporter.request(b),d=c.data;return{access_token:d.accessToken,expiry_date:new Date(d.expireTime).getTime(),res:c}}isExpired(a){let b=new Date().getTime();return!!a.expiry_date&&b>=a.expiry_date-this.eagerRefreshThresholdMillis}getScopesArray(){return"string"==typeof this.scopes?[this.scopes]:this.scopes||[j]}getMetricsHeaderValue(){let a=process.version.replace(/^v/,""),b=void 0!==this.serviceAccountImpersonationUrl,c=this.credentialSourceType?this.credentialSourceType:"unknown";return`gl-node/${a} auth/${i.pkg.version} google-byoid-sdk source/${c} sa-impersonation/${b} config-lifetime/${this.configLifetimeRequested}`}getTokenUrl(){return this.tokenUrl}}c.BaseExternalAccountClient=k},42467,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.FileSubjectTokenSupplier=void 0;let d=a.r(24361),e=a.r(22734),f=(0,d.promisify)(e.readFile??(()=>{})),g=(0,d.promisify)(e.realpath??(()=>{})),h=(0,d.promisify)(e.lstat??(()=>{}));c.FileSubjectTokenSupplier=class{filePath;formatType;subjectTokenFieldName;constructor(a){this.filePath=a.filePath,this.formatType=a.formatType,this.subjectTokenFieldName=a.subjectTokenFieldName}async getSubjectToken(){let a,b=this.filePath;try{if(b=await g(b),!(await h(b)).isFile())throw Error()}catch(a){throw a instanceof Error&&(a.message=`The file at ${b} does not exist, or it is not a file. ${a.message}`),a}let c=await f(b,{encoding:"utf8"});if("text"===this.formatType?a=c:"json"===this.formatType&&this.subjectTokenFieldName&&(a=JSON.parse(c)[this.subjectTokenFieldName]),!a)throw Error("Unable to parse the subject_token from the credential_source file");return a}}},61041,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.UrlSubjectTokenSupplier=void 0;let d=a.r(76378);c.UrlSubjectTokenSupplier=class{url;headers;formatType;subjectTokenFieldName;additionalGaxiosOptions;constructor(a){this.url=a.url,this.formatType=a.formatType,this.subjectTokenFieldName=a.subjectTokenFieldName,this.headers=a.headers,this.additionalGaxiosOptions=a.additionalGaxiosOptions}async getSubjectToken(a){let b,c={...this.additionalGaxiosOptions,url:this.url,method:"GET",headers:this.headers};if(d.AuthClient.setMethodName(c,"getSubjectToken"),"text"===this.formatType?b=(await a.transporter.request(c)).data:"json"===this.formatType&&this.subjectTokenFieldName&&(b=(await a.transporter.request(c)).data[this.subjectTokenFieldName]),!b)throw Error("Unable to parse the subject_token from the credential_source URL");return b}}},61264,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.CertificateSubjectTokenSupplier=c.InvalidConfigurationError=c.CertificateSourceUnavailableError=c.CERTIFICATE_CONFIGURATION_ENV_VARIABLE=void 0;let d=a.r(75701),e=a.r(22734),f=a.r(54799),g=a.r(24836);c.CERTIFICATE_CONFIGURATION_ENV_VARIABLE="GOOGLE_API_CERTIFICATE_CONFIG";class h extends Error{constructor(a){super(a),this.name="CertificateSourceUnavailableError"}}c.CertificateSourceUnavailableError=h;class i extends Error{constructor(a){super(a),this.name="InvalidConfigurationError"}}c.InvalidConfigurationError=i,c.CertificateSubjectTokenSupplier=class{certificateConfigPath;trustChainPath;cert;key;constructor(a){if(!a.useDefaultCertificateConfig&&!a.certificateConfigLocation)throw new i("Either `useDefaultCertificateConfig` must be true or a `certificateConfigLocation` must be provided.");if(a.useDefaultCertificateConfig&&a.certificateConfigLocation)throw new i("Both `useDefaultCertificateConfig` and `certificateConfigLocation` cannot be provided.");this.trustChainPath=a.trustChainPath,this.certificateConfigPath=a.certificateConfigLocation??""}async createMtlsHttpsAgent(){if(!this.key||!this.cert)throw new i("Cannot create mTLS Agent with missing certificate or key");return new g.Agent({key:this.key,cert:this.cert})}async getSubjectToken(){this.certificateConfigPath=await this.#s();let{certPath:a,keyPath:b}=await this.#t();return{cert:this.cert,key:this.key}=await this.#u(a,b),await this.#v(this.cert)}async #s(){let a=this.certificateConfigPath;if(a){if(await (0,d.isValidFile)(a))return a;throw new h(`Provided certificate config path is invalid: ${a}`)}let b=process.env[c.CERTIFICATE_CONFIGURATION_ENV_VARIABLE];if(b){if(await (0,d.isValidFile)(b))return b;throw new h(`Path from environment variable "${c.CERTIFICATE_CONFIGURATION_ENV_VARIABLE}" is invalid: ${b}`)}let e=(0,d.getWellKnownCertificateConfigFileLocation)();if(await (0,d.isValidFile)(e))return e;throw new h(`Could not find certificate configuration file. Searched override path, the "${c.CERTIFICATE_CONFIGURATION_ENV_VARIABLE}" env var, and the gcloud path (${e}).`)}async #t(){let a,b=this.certificateConfigPath;try{a=await e.promises.readFile(b,"utf8")}catch(a){throw new h(`Failed to read certificate config file at: ${b}`)}try{let c=JSON.parse(a),d=c?.cert_configs?.workload?.cert_path,e=c?.cert_configs?.workload?.key_path;if(!d||!e)throw new i(`Certificate config file (${b}) is missing required "cert_path" or "key_path" in the workload config.`);return{certPath:d,keyPath:e}}catch(a){if(a instanceof i)throw a;throw new i(`Failed to parse certificate config from ${b}: ${a.message}`)}}async #u(a,b){let c,d;try{c=await e.promises.readFile(a),new f.X509Certificate(c)}catch(c){let b=c instanceof Error?c.message:String(c);throw new h(`Failed to read certificate file at ${a}: ${b}`)}try{d=await e.promises.readFile(b),(0,f.createPrivateKey)(d)}catch(c){let a=c instanceof Error?c.message:String(c);throw new h(`Failed to read private key file at ${b}: ${a}`)}return{cert:c,key:d}}async #v(a){let b=new f.X509Certificate(a);if(!this.trustChainPath)return JSON.stringify([b.raw.toString("base64")]);try{let a,c=((await e.promises.readFile(this.trustChainPath,"utf8")).match(/-----BEGIN CERTIFICATE-----[^-]+-----END CERTIFICATE-----/g)??[]).map((a,b)=>{try{return new f.X509Certificate(a)}catch(c){let a=c instanceof Error?c.message:String(c);throw new i(`Failed to parse certificate at index ${b} in trust chain file ${this.trustChainPath}: ${a}`)}}),d=c.findIndex(a=>b.raw.equals(a.raw));if(-1===d)a=[b,...c];else if(0===d)a=c;else throw new i(`Leaf certificate exists in the trust chain but is not the first entry (found at index ${d}).`);return JSON.stringify(a.map(a=>a.raw.toString("base64")))}catch(b){if(b instanceof i)throw b;let a=b instanceof Error?b.message:String(b);throw new h(`Failed to process certificate chain from ${this.trustChainPath}: ${a}`)}}}},22330,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.IdentityPoolClient=void 0;let d=a.r(74579),e=a.r(75701),f=a.r(42467),g=a.r(61041),h=a.r(61264),i=a.r(89627),j=a.r(53683);class k extends d.BaseExternalAccountClient{subjectTokenSupplier;constructor(a){super(a);const b=(0,e.originalOrCamelOptions)(a),c=b.get("credential_source"),d=b.get("subject_token_supplier");if(!c&&!d)throw Error("A credential source or subject token supplier must be specified.");if(c&&d)throw Error("Only one of credential source or subject token supplier can be specified.");if(d)this.subjectTokenSupplier=d,this.credentialSourceType="programmatic";else{const a=(0,e.originalOrCamelOptions)(c),b=(0,e.originalOrCamelOptions)(a.get("format")),d=b.get("type")||"text",i=b.get("subject_token_field_name");if("json"!==d&&"text"!==d)throw Error(`Invalid credential_source format "${d}"`);if("json"===d&&!i)throw Error("Missing subject_token_field_name for JSON credential_source format");const j=a.get("file"),l=a.get("url"),m=a.get("certificate"),n=a.get("headers");if(j&&l||l&&m||j&&m)throw Error('No valid Identity Pool "credential_source" provided, must be either file, url, or certificate.');if(j)this.credentialSourceType="file",this.subjectTokenSupplier=new f.FileSubjectTokenSupplier({filePath:j,formatType:d,subjectTokenFieldName:i});else if(l)this.credentialSourceType="url",this.subjectTokenSupplier=new g.UrlSubjectTokenSupplier({url:l,formatType:d,subjectTokenFieldName:i,headers:n,additionalGaxiosOptions:k.RETRY_CONFIG});else if(m){this.credentialSourceType="certificate";const a=new h.CertificateSubjectTokenSupplier({useDefaultCertificateConfig:m.use_default_certificate_config,certificateConfigLocation:m.certificate_config_location,trustChainPath:m.trust_chain_path});this.subjectTokenSupplier=a}else throw Error('No valid Identity Pool "credential_source" provided, must be either file, url, or certificate.')}}async retrieveSubjectToken(){let a=await this.subjectTokenSupplier.getSubjectToken(this.supplierContext);if(this.subjectTokenSupplier instanceof h.CertificateSubjectTokenSupplier){let a=await this.subjectTokenSupplier.createMtlsHttpsAgent();this.stsCredential=new i.StsCredentials({tokenExchangeEndpoint:this.getTokenUrl(),clientAuthentication:this.clientAuth,transporter:new j.Gaxios({agent:a})}),this.transporter=new j.Gaxios({...this.transporter.defaults||{},agent:a})}return a}}c.IdentityPoolClient=k},62889,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.AwsRequestSigner=void 0;let d=a.r(53683),e=a.r(42676),f="AWS4-HMAC-SHA256";async function g(a,b,c){return await a.signWithHmacSha256(b,c)}async function h(a,b,c,d,e){let f=await g(a,`AWS4${b}`,c),h=await g(a,f,d),i=await g(a,h,e);return await g(a,i,"aws4_request")}async function i(a){let b=d.Gaxios.mergeHeaders(a.additionalAmzHeaders),c=a.requestPayload||"",i=a.host.split(".")[0],j=new Date,k=j.toISOString().replace(/[-:]/g,"").replace(/\.[0-9]+/,""),l=j.toISOString().replace(/[-]/g,"").replace(/T.*/,"");a.securityCredentials.token&&b.set("x-amz-security-token",a.securityCredentials.token);let m=d.Gaxios.mergeHeaders({host:a.host},b.has("date")?{}:{"x-amz-date":k},b),n="",o=[...m.keys()].sort();o.forEach(a=>{n+=`${a}:${m.get(a)}
`});let p=o.join(";"),q=await a.crypto.sha256DigestHex(c),r=`${a.method.toUpperCase()}
${a.canonicalUri}
${a.canonicalQuerystring}
${n}
${p}
${q}`,s=`${l}/${a.region}/${i}/aws4_request`,t=`${f}
${k}
${s}
`+await a.crypto.sha256DigestHex(r),u=await h(a.crypto,a.securityCredentials.secretAccessKey,l,a.region,i),v=await g(a.crypto,u,t),w=`${f} Credential=${a.securityCredentials.accessKeyId}/${s}, SignedHeaders=${p}, Signature=${(0,e.fromArrayBufferToHex)(v)}`;return{amzDate:b.has("date")?void 0:k,authorizationHeader:w,canonicalQuerystring:a.canonicalQuerystring}}c.AwsRequestSigner=class{getCredentials;region;crypto;constructor(a,b){this.getCredentials=a,this.region=b,this.crypto=(0,e.createCrypto)()}async getRequestOptions(a){if(!a.url)throw RangeError('"url" is required in "amzOptions"');let b="object"==typeof a.data?JSON.stringify(a.data):a.data,c=a.url,e=a.method||"GET",f=a.body||b,g=a.headers,h=await this.getCredentials(),j=new URL(c);if("string"!=typeof f&&void 0!==f)throw TypeError(`'requestPayload' is expected to be a string if provided. Got: ${f}`);let k=await i({crypto:this.crypto,host:j.host,canonicalUri:j.pathname,canonicalQuerystring:j.search.slice(1),method:e,region:this.region,securityCredentials:h,requestPayload:f,additionalAmzHeaders:g}),l=d.Gaxios.mergeHeaders(k.amzDate?{"x-amz-date":k.amzDate}:{},{authorization:k.authorizationHeader,host:j.host},g||{});h.token&&d.Gaxios.mergeHeaders(l,{"x-amz-security-token":h.token});let m={url:c,method:e,headers:l};return void 0!==f&&(m.body=f),m}}},67167,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.DefaultAwsSecurityCredentialsSupplier=void 0;let d=a.r(76378);c.DefaultAwsSecurityCredentialsSupplier=class{regionUrl;securityCredentialsUrl;imdsV2SessionTokenUrl;additionalGaxiosOptions;constructor(a){this.regionUrl=a.regionUrl,this.securityCredentialsUrl=a.securityCredentialsUrl,this.imdsV2SessionTokenUrl=a.imdsV2SessionTokenUrl,this.additionalGaxiosOptions=a.additionalGaxiosOptions}async getAwsRegion(a){if(this.#w)return this.#w;let b=new Headers;if(!this.#w&&this.imdsV2SessionTokenUrl&&b.set("x-aws-ec2-metadata-token",await this.#x(a.transporter)),!this.regionUrl)throw RangeError('Unable to determine AWS region due to missing "options.credential_source.region_url"');let c={...this.additionalGaxiosOptions,url:this.regionUrl,method:"GET",headers:b};d.AuthClient.setMethodName(c,"getAwsRegion");let e=await a.transporter.request(c);return e.data.substr(0,e.data.length-1)}async getAwsSecurityCredentials(a){if(this.#y)return this.#y;let b=new Headers;this.imdsV2SessionTokenUrl&&b.set("x-aws-ec2-metadata-token",await this.#x(a.transporter));let c=await this.#z(b,a.transporter),d=await this.#A(c,b,a.transporter);return{accessKeyId:d.AccessKeyId,secretAccessKey:d.SecretAccessKey,token:d.Token}}async #x(a){let b={...this.additionalGaxiosOptions,url:this.imdsV2SessionTokenUrl,method:"PUT",headers:{"x-aws-ec2-metadata-token-ttl-seconds":"300"}};return d.AuthClient.setMethodName(b,"#getImdsV2SessionToken"),(await a.request(b)).data}async #z(a,b){if(!this.securityCredentialsUrl)throw Error('Unable to determine AWS role name due to missing "options.credential_source.url"');let c={...this.additionalGaxiosOptions,url:this.securityCredentialsUrl,method:"GET",headers:a};return d.AuthClient.setMethodName(c,"#getAwsRoleName"),(await b.request(c)).data}async #A(a,b,c){let e={...this.additionalGaxiosOptions,url:`${this.securityCredentialsUrl}/${a}`,headers:b};return d.AuthClient.setMethodName(e,"#retrieveAwsSecurityCredentials"),(await c.request(e)).data}get #w(){return process.env.AWS_REGION||process.env.AWS_DEFAULT_REGION||null}get #y(){return process.env.AWS_ACCESS_KEY_ID&&process.env.AWS_SECRET_ACCESS_KEY?{accessKeyId:process.env.AWS_ACCESS_KEY_ID,secretAccessKey:process.env.AWS_SECRET_ACCESS_KEY,token:process.env.AWS_SESSION_TOKEN}:null}}},79949,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.AwsClient=void 0;let d=a.r(62889),e=a.r(74579),f=a.r(67167),g=a.r(75701),h=a.r(53683);class i extends e.BaseExternalAccountClient{environmentId;awsSecurityCredentialsSupplier;regionalCredVerificationUrl;awsRequestSigner;region;static #B="https://sts.{region}.amazonaws.com?Action=GetCallerIdentity&Version=2011-06-15";static AWS_EC2_METADATA_IPV4_ADDRESS="169.254.169.254";static AWS_EC2_METADATA_IPV6_ADDRESS="fd00:ec2::254";constructor(a){super(a);const b=(0,g.originalOrCamelOptions)(a),c=b.get("credential_source"),d=b.get("aws_security_credentials_supplier");if(!c&&!d)throw Error("A credential source or AWS security credentials supplier must be specified.");if(c&&d)throw Error("Only one of credential source or AWS security credentials supplier can be specified.");if(d)this.awsSecurityCredentialsSupplier=d,this.regionalCredVerificationUrl=i.#B,this.credentialSourceType="programmatic";else{const a=(0,g.originalOrCamelOptions)(c);this.environmentId=a.get("environment_id");const b=a.get("region_url"),d=a.get("url"),e=a.get("imdsv2_session_token_url");this.awsSecurityCredentialsSupplier=new f.DefaultAwsSecurityCredentialsSupplier({regionUrl:b,securityCredentialsUrl:d,imdsV2SessionTokenUrl:e}),this.regionalCredVerificationUrl=a.get("regional_cred_verification_url"),this.credentialSourceType="aws",this.validateEnvironmentId()}this.awsRequestSigner=null,this.region=""}validateEnvironmentId(){let a=this.environmentId?.match(/^(aws)(\d+)$/);if(a&&this.regionalCredVerificationUrl){if(1!==parseInt(a[2],10))throw Error(`aws version "${a[2]}" is not supported in the current build.`)}else throw Error('No valid AWS "credential_source" provided')}async retrieveSubjectToken(){this.awsRequestSigner||(this.region=await this.awsSecurityCredentialsSupplier.getAwsRegion(this.supplierContext),this.awsRequestSigner=new d.AwsRequestSigner(async()=>this.awsSecurityCredentialsSupplier.getAwsSecurityCredentials(this.supplierContext),this.region));let a=await this.awsRequestSigner.getRequestOptions({...i.RETRY_CONFIG,url:this.regionalCredVerificationUrl.replace("{region}",this.region),method:"POST"}),b=[];return h.Gaxios.mergeHeaders({"x-goog-cloud-target-resource":this.audience},a.headers).forEach((a,c)=>b.push({key:c,value:a})),encodeURIComponent(JSON.stringify({url:a.url,method:a.method,headers:b}))}}c.AwsClient=i},39105,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.InvalidSubjectTokenError=c.InvalidMessageFieldError=c.InvalidCodeFieldError=c.InvalidTokenTypeFieldError=c.InvalidExpirationTimeFieldError=c.InvalidSuccessFieldError=c.InvalidVersionFieldError=c.ExecutableResponseError=c.ExecutableResponse=void 0;let d="urn:ietf:params:oauth:token-type:saml2",e="urn:ietf:params:oauth:token-type:id_token",f="urn:ietf:params:oauth:token-type:jwt";c.ExecutableResponse=class{version;success;expirationTime;tokenType;errorCode;errorMessage;subjectToken;constructor(a){if(!a.version)throw new h("Executable response must contain a 'version' field.");if(void 0===a.success)throw new i("Executable response must contain a 'success' field.");if(this.version=a.version,this.success=a.success,this.success){if(this.expirationTime=a.expiration_time,this.tokenType=a.token_type,this.tokenType!==d&&this.tokenType!==e&&this.tokenType!==f)throw new j(`Executable response must contain a 'token_type' field when successful and it must be one of ${e}, ${f}, or ${d}.`);if(this.tokenType===d){if(!a.saml_response)throw new m(`Executable response must contain a 'saml_response' field when token_type=${d}.`);this.subjectToken=a.saml_response}else{if(!a.id_token)throw new m(`Executable response must contain a 'id_token' field when token_type=${e} or ${f}.`);this.subjectToken=a.id_token}}else{if(!a.code)throw new k("Executable response must contain a 'code' field when unsuccessful.");if(!a.message)throw new l("Executable response must contain a 'message' field when unsuccessful.");this.errorCode=a.code,this.errorMessage=a.message}}isValid(){return!this.isExpired()&&this.success}isExpired(){return void 0!==this.expirationTime&&this.expirationTime<Math.round(Date.now()/1e3)}};class g extends Error{constructor(a){super(a),Object.setPrototypeOf(this,new.target.prototype)}}c.ExecutableResponseError=g;class h extends g{}c.InvalidVersionFieldError=h;class i extends g{}c.InvalidSuccessFieldError=i,c.InvalidExpirationTimeFieldError=class extends g{};class j extends g{}c.InvalidTokenTypeFieldError=j;class k extends g{}c.InvalidCodeFieldError=k;class l extends g{}c.InvalidMessageFieldError=l;class m extends g{}c.InvalidSubjectTokenError=m},1420,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.PluggableAuthHandler=c.ExecutableError=void 0;let d=a.r(39105),e=a.r(33405),f=a.r(22734);class g extends Error{code;constructor(a,b){super(`The executable failed with exit code: ${b} and error message: ${a}.`),this.code=b,Object.setPrototypeOf(this,new.target.prototype)}}c.ExecutableError=g;class h{commandComponents;timeoutMillis;outputFile;constructor(a){if(!a.command)throw Error("No command provided.");if(this.commandComponents=h.parseCommand(a.command),this.timeoutMillis=a.timeoutMillis,!this.timeoutMillis)throw Error("No timeoutMillis provided.");this.outputFile=a.outputFile}retrieveResponseFromExecutable(a){return new Promise((b,c)=>{let f=e.spawn(this.commandComponents[0],this.commandComponents.slice(1),{env:{...process.env,...Object.fromEntries(a)}}),h="";f.stdout.on("data",a=>{h+=a}),f.stderr.on("data",a=>{h+=a});let i=setTimeout(()=>(f.removeAllListeners(),f.kill(),c(Error("The executable failed to finish within the timeout specified."))),this.timeoutMillis);f.on("close",a=>{if(clearTimeout(i),0!==a)return c(new g(h,a.toString()));try{let a=JSON.parse(h),c=new d.ExecutableResponse(a);return b(c)}catch(a){if(a instanceof d.ExecutableResponseError)return c(a);return c(new d.ExecutableResponseError(`The executable returned an invalid response: ${h}`))}})})}async retrieveCachedResponse(){let a;if(!this.outputFile||0===this.outputFile.length)return;try{a=await f.promises.realpath(this.outputFile)}catch{return}if(!(await f.promises.lstat(a)).isFile())return;let b=await f.promises.readFile(a,{encoding:"utf8"});if(""!==b)try{let a=JSON.parse(b);if(new d.ExecutableResponse(a).isValid())return new d.ExecutableResponse(a);return}catch(a){if(a instanceof d.ExecutableResponseError)throw a;throw new d.ExecutableResponseError(`The output file contained an invalid response: ${b}`)}}static parseCommand(a){let b=a.match(/(?:[^\s"]+|"[^"]*")+/g);if(!b)throw Error(`Provided command: "${a}" could not be parsed.`);for(let a=0;a<b.length;a++)'"'===b[a][0]&&'"'===b[a].slice(-1)&&(b[a]=b[a].slice(1,-1));return b}}c.PluggableAuthHandler=h},1064,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.PluggableAuthClient=c.ExecutableError=void 0;let d=a.r(74579),e=a.r(39105),f=a.r(1420);var g=a.r(1420);Object.defineProperty(c,"ExecutableError",{enumerable:!0,get:function(){return g.ExecutableError}});class h extends d.BaseExternalAccountClient{command;timeoutMillis;outputFile;handler;constructor(a){if(super(a),!a.credential_source.executable||(this.command=a.credential_source.executable.command,!this.command))throw Error('No valid Pluggable Auth "credential_source" provided.');if(void 0===a.credential_source.executable.timeout_millis)this.timeoutMillis=3e4;else if(this.timeoutMillis=a.credential_source.executable.timeout_millis,this.timeoutMillis<5e3||this.timeoutMillis>12e4)throw Error("Timeout must be between 5000120000 milliseconds.");this.outputFile=a.credential_source.executable.output_file,this.handler=new f.PluggableAuthHandler({command:this.command,timeoutMillis:this.timeoutMillis,outputFile:this.outputFile}),this.credentialSourceType="executable"}async retrieveSubjectToken(){let a;if("1"!==process.env.GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES)throw Error("Pluggable Auth executables need to be explicitly allowed to run by setting the GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES environment Variable to 1.");if(this.outputFile&&(a=await this.handler.retrieveCachedResponse()),!a){let b=new Map;b.set("GOOGLE_EXTERNAL_ACCOUNT_AUDIENCE",this.audience),b.set("GOOGLE_EXTERNAL_ACCOUNT_TOKEN_TYPE",this.subjectTokenType),b.set("GOOGLE_EXTERNAL_ACCOUNT_INTERACTIVE","0"),this.outputFile&&b.set("GOOGLE_EXTERNAL_ACCOUNT_OUTPUT_FILE",this.outputFile);let c=this.getServiceAccountEmail();c&&b.set("GOOGLE_EXTERNAL_ACCOUNT_IMPERSONATED_EMAIL",c),a=await this.handler.retrieveResponseFromExecutable(b)}if(a.version>1)throw Error("Version of executable is not currently supported, maximum supported version is 1.");if(!a.success)throw new f.ExecutableError(a.errorMessage,a.errorCode);if(this.outputFile&&!a.expirationTime)throw new e.InvalidExpirationTimeFieldError("The executable response must contain the `expiration_time` field for successful responses when an output_file has been specified in the configuration.");if(a.isExpired())throw Error("Executable response is expired.");return a.subjectToken}}c.PluggableAuthClient=h},44686,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ExternalAccountClient=void 0;let d=a.r(74579),e=a.r(22330),f=a.r(79949),g=a.r(1064);c.ExternalAccountClient=class{constructor(){throw Error("ExternalAccountClients should be initialized via: ExternalAccountClient.fromJSON(), directly via explicit constructors, eg. new AwsClient(options), new IdentityPoolClient(options), newPluggableAuthClientOptions, or via new GoogleAuth(options).getClient()")}static fromJSON(a){return a&&a.type===d.EXTERNAL_ACCOUNT_TYPE?a.credential_source?.environment_id?new f.AwsClient(a):a.credential_source?.executable?new g.PluggableAuthClient(a):new e.IdentityPoolClient(a):null}}},69464,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ExternalAccountAuthorizedUserClient=c.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE=void 0;let d=a.r(76378),e=a.r(61671),f=a.r(53683),g=a.r(88947),h=a.r(74579);c.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE="external_account_authorized_user";class i extends e.OAuthClientAuthHandler{#C;constructor(a){super(a),this.#C=a.tokenRefreshEndpoint}async refreshToken(a,b){let c={...i.RETRY_CONFIG,url:this.#C,method:"POST",headers:b,data:new URLSearchParams({grant_type:"refresh_token",refresh_token:a})};d.AuthClient.setMethodName(c,"refreshToken"),this.applyClientAuthenticationOptions(c);try{let a=await this.transporter.request(c),b=a.data;return b.res=a,b}catch(a){if(a instanceof f.GaxiosError&&a.response)throw(0,e.getErrorFromOAuthErrorResponse)(a.response.data,a);throw a}}}class j extends d.AuthClient{cachedAccessToken;externalAccountAuthorizedUserHandler;refreshToken;constructor(a){super(a),a.universe_domain&&(this.universeDomain=a.universe_domain),this.refreshToken=a.refresh_token;const b={confidentialClientType:"basic",clientId:a.client_id,clientSecret:a.client_secret};this.externalAccountAuthorizedUserHandler=new i({tokenRefreshEndpoint:a.token_url??"https://sts.{universeDomain}/v1/oauthtoken".replace("{universeDomain}",this.universeDomain),transporter:this.transporter,clientAuthentication:b}),this.cachedAccessToken=null,this.quotaProjectId=a.quota_project_id,"number"!=typeof a?.eagerRefreshThresholdMillis?this.eagerRefreshThresholdMillis=h.EXPIRATION_TIME_OFFSET:this.eagerRefreshThresholdMillis=a.eagerRefreshThresholdMillis,this.forceRefreshOnFailure=!!a?.forceRefreshOnFailure}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){let a=await this.getAccessToken(),b=new Headers({authorization:`Bearer ${a.token}`});return this.addSharedMetadataHeaders(b)}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async requestAsync(a,b=!1){let c;try{let b=await this.getRequestHeaders();a.headers=f.Gaxios.mergeHeaders(a.headers),this.addUserProjectAndAuthHeaders(a.headers,b),c=await this.transporter.request(a)}catch(d){let c=d.response;if(c){let d=c.status,e=c.config.data instanceof g.Readable;if(!b&&(401===d||403===d)&&!e&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(a,!0)}throw d}return c}async refreshAccessTokenAsync(){let a=await this.externalAccountAuthorizedUserHandler.refreshToken(this.refreshToken);return this.cachedAccessToken={access_token:a.access_token,expiry_date:new Date().getTime()+1e3*a.expires_in,res:a.res},void 0!==a.refresh_token&&(this.refreshToken=a.refresh_token),this.cachedAccessToken}isExpired(a){let b=new Date().getTime();return!!a.expiry_date&&b>=a.expiry_date-this.eagerRefreshThresholdMillis}}c.ExternalAccountAuthorizedUserClient=j},28796,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GoogleAuth=c.GoogleAuthExceptionMessages=void 0;let d=a.r(33405),e=a.r(22734),f=a.r(53683),g=a.r(76120),h=a.r(46786),i=a.r(14747),j=a.r(42676),k=a.r(77078),l=a.r(73736),m=a.r(64783),n=a.r(2629),o=a.r(53904),p=a.r(7064),q=a.r(44686),r=a.r(74579),s=a.r(76378),t=a.r(69464),u=a.r(75701);c.GoogleAuthExceptionMessages={API_KEY_WITH_CREDENTIALS:"API Keys and Credentials are mutually exclusive authentication methods and cannot be used together.",NO_PROJECT_ID_FOUND:"Unable to detect a Project Id in the current environment. \nTo learn more about authentication and Google APIs, visit: \nhttps://cloud.google.com/docs/authentication/getting-started",NO_CREDENTIALS_FOUND:"Unable to find credentials in current environment. \nTo learn more about authentication and Google APIs, visit: \nhttps://cloud.google.com/docs/authentication/getting-started",NO_ADC_FOUND:"Could not load the default credentials. Browse to https://cloud.google.com/docs/authentication/getting-started for more information.",NO_UNIVERSE_DOMAIN_FOUND:"Unable to detect a Universe Domain in the current environment.\nTo learn more about Universe Domain retrieval, visit: \nhttps://cloud.google.com/compute/docs/metadata/predefined-metadata-keys"},c.GoogleAuth=class{checkIsGCE=void 0;useJWTAccessWithScope;defaultServicePath;get isGCE(){return this.checkIsGCE}_findProjectIdPromise;_cachedProjectId;jsonContent=null;apiKey;cachedCredential=null;#D=null;defaultScopes;keyFilename;scopes;clientOptions={};constructor(a={}){if(this._cachedProjectId=a.projectId||null,this.cachedCredential=a.authClient||null,this.keyFilename=a.keyFilename||a.keyFile,this.scopes=a.scopes,this.clientOptions=a.clientOptions||{},this.jsonContent=a.credentials||null,this.apiKey=a.apiKey||this.clientOptions.apiKey||null,this.apiKey&&(this.jsonContent||this.clientOptions.credentials))throw RangeError(c.GoogleAuthExceptionMessages.API_KEY_WITH_CREDENTIALS);a.universeDomain&&(this.clientOptions.universeDomain=a.universeDomain)}setGapicJWTValues(a){a.defaultServicePath=this.defaultServicePath,a.useJWTAccessWithScope=this.useJWTAccessWithScope,a.defaultScopes=this.defaultScopes}getProjectId(a){if(!a)return this.getProjectIdAsync();this.getProjectIdAsync().then(b=>a(null,b),a)}async getProjectIdOptional(){try{return await this.getProjectId()}catch(a){if(a instanceof Error&&a.message===c.GoogleAuthExceptionMessages.NO_PROJECT_ID_FOUND)return null;throw a}}async findAndCacheProjectId(){let a=null;if(a||=await this.getProductionProjectId(),a||=await this.getFileProjectId(),a||=await this.getDefaultServiceProjectId(),a||=await this.getGCEProjectId(),a||=await this.getExternalAccountClientProjectId())return this._cachedProjectId=a,a;throw Error(c.GoogleAuthExceptionMessages.NO_PROJECT_ID_FOUND)}async getProjectIdAsync(){return this._cachedProjectId?this._cachedProjectId:(this._findProjectIdPromise||(this._findProjectIdPromise=this.findAndCacheProjectId()),this._findProjectIdPromise)}async getUniverseDomainFromMetadataServer(){let a;try{a=await g.universe("universe-domain"),a||=s.DEFAULT_UNIVERSE}catch(b){if(b&&b?.response?.status===404)a=s.DEFAULT_UNIVERSE;else throw b}return a}async getUniverseDomain(){let a=(0,u.originalOrCamelOptions)(this.clientOptions).get("universe_domain");try{a??=(await this.getClient()).universeDomain}catch{a??=s.DEFAULT_UNIVERSE}return a}getAnyScopes(){return this.scopes||this.defaultScopes}getApplicationDefault(a={},b){let c;if("function"==typeof a?b=a:c=a,!b)return this.getApplicationDefaultAsync(c);this.getApplicationDefaultAsync(c).then(a=>b(null,a.credential,a.projectId),b)}async getApplicationDefaultAsync(a={}){let b;if(this.cachedCredential)return await this.#E(this.cachedCredential,null);if((b=await this._tryGetApplicationCredentialsFromEnvironmentVariable(a))||(b=await this._tryGetApplicationCredentialsFromWellKnownFile(a)))return b instanceof n.JWT?b.scopes=this.scopes:b instanceof r.BaseExternalAccountClient&&(b.scopes=this.getAnyScopes()),await this.#E(b);if(await this._checkIsGCE())return a.scopes=this.getAnyScopes(),await this.#E(new k.Compute(a));throw Error(c.GoogleAuthExceptionMessages.NO_ADC_FOUND)}async #E(a,b=process.env.GOOGLE_CLOUD_QUOTA_PROJECT||null){let c=await this.getProjectIdOptional();return b&&(a.quotaProjectId=b),this.cachedCredential=a,{credential:a,projectId:c}}async _checkIsGCE(){return void 0===this.checkIsGCE&&(this.checkIsGCE=g.getGCPResidency()||await g.isAvailable()),this.checkIsGCE}async _tryGetApplicationCredentialsFromEnvironmentVariable(a){let b=process.env.GOOGLE_APPLICATION_CREDENTIALS||process.env.google_application_credentials;if(!b||0===b.length)return null;try{return this._getApplicationCredentialsFromFilePath(b,a)}catch(a){throw a instanceof Error&&(a.message=`Unable to read the credential file specified by the GOOGLE_APPLICATION_CREDENTIALS environment variable: ${a.message}`),a}}async _tryGetApplicationCredentialsFromWellKnownFile(a){let b=null;if(this._isWindows())b=process.env.APPDATA;else{let a=process.env.HOME;a&&(b=i.join(a,".config"))}return(b&&(b=i.join(b,"gcloud","application_default_credentials.json"),e.existsSync(b)||(b=null)),b)?await this._getApplicationCredentialsFromFilePath(b,a):null}async _getApplicationCredentialsFromFilePath(a,b={}){if(!a||0===a.length)throw Error("The file path is invalid.");try{if(a=e.realpathSync(a),!e.lstatSync(a).isFile())throw Error()}catch(b){throw b instanceof Error&&(b.message=`The file at ${a} does not exist, or it is not a file. ${b.message}`),b}let c=e.createReadStream(a);return this.fromStream(c,b)}fromImpersonatedJSON(a){if(!a)throw Error("Must pass in a JSON object containing an  impersonated refresh token");if(a.type!==p.IMPERSONATED_ACCOUNT_TYPE)throw Error(`The incoming JSON object does not have the "${p.IMPERSONATED_ACCOUNT_TYPE}" type`);if(!a.source_credentials)throw Error("The incoming JSON object does not contain a source_credentials field");if(!a.service_account_impersonation_url)throw Error("The incoming JSON object does not contain a service_account_impersonation_url field");let b=this.fromJSON(a.source_credentials);if(a.service_account_impersonation_url?.length>256)throw RangeError(`Target principal is too long: ${a.service_account_impersonation_url}`);let c=/(?<target>[^/]+):(generateAccessToken|generateIdToken)$/.exec(a.service_account_impersonation_url)?.groups?.target;if(!c)throw RangeError(`Cannot extract target principal from ${a.service_account_impersonation_url}`);let d=this.getAnyScopes()??[];return new p.Impersonated({...a,sourceClient:b,targetPrincipal:c,targetScopes:Array.isArray(d)?d:[d]})}fromJSON(a,b={}){let c,d=(0,u.originalOrCamelOptions)(b).get("universe_domain");return a.type===o.USER_REFRESH_ACCOUNT_TYPE?(c=new o.UserRefreshClient(b)).fromJSON(a):a.type===p.IMPERSONATED_ACCOUNT_TYPE?c=this.fromImpersonatedJSON(a):a.type===r.EXTERNAL_ACCOUNT_TYPE?(c=q.ExternalAccountClient.fromJSON({...a,...b})).scopes=this.getAnyScopes():a.type===t.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE?c=new t.ExternalAccountAuthorizedUserClient({...a,...b}):(b.scopes=this.scopes,c=new n.JWT(b),this.setGapicJWTValues(c),c.fromJSON(a)),d&&(c.universeDomain=d),c}_cacheClientFromJSON(a,b){let c=this.fromJSON(a,b);return this.jsonContent=a,this.cachedCredential=c,c}fromStream(a,b={},c){let d={};if("function"==typeof b?c=b:d=b,!c)return this.fromStreamAsync(a,d);this.fromStreamAsync(a,d).then(a=>c(null,a),c)}fromStreamAsync(a,b){return new Promise((c,d)=>{if(!a)throw Error("Must pass in a stream containing the Google auth settings.");let e=[];a.setEncoding("utf8").on("error",d).on("data",a=>e.push(a)).on("end",()=>{try{try{let a=JSON.parse(e.join("")),d=this._cacheClientFromJSON(a,b);return c(d)}catch(b){if(!this.keyFilename)throw b;let a=new n.JWT({...this.clientOptions,keyFile:this.keyFilename});return this.cachedCredential=a,this.setGapicJWTValues(a),c(a)}}catch(a){return d(a)}})})}fromAPIKey(a,b={}){return new n.JWT({...b,apiKey:a})}_isWindows(){let a=h.platform();return!!a&&!!(a.length>=3)&&"win"===a.substring(0,3).toLowerCase()}async getDefaultServiceProjectId(){return new Promise(a=>{(0,d.exec)("gcloud config config-helper --format json",(b,c)=>{if(!b&&c)try{let b=JSON.parse(c).configuration.properties.core.project;a(b);return}catch(a){}a(null)})})}getProductionProjectId(){return process.env.GCLOUD_PROJECT||process.env.GOOGLE_CLOUD_PROJECT||process.env.gcloud_project||process.env.google_cloud_project}async getFileProjectId(){if(this.cachedCredential)return this.cachedCredential.projectId;if(this.keyFilename){let a=await this.getClient();if(a&&a.projectId)return a.projectId}let a=await this._tryGetApplicationCredentialsFromEnvironmentVariable();return a?a.projectId:null}async getExternalAccountClientProjectId(){if(!this.jsonContent||this.jsonContent.type!==r.EXTERNAL_ACCOUNT_TYPE)return null;let a=await this.getClient();return await a.getProjectId()}async getGCEProjectId(){try{return await g.project("project-id")}catch(a){return null}}getCredentials(a){if(!a)return this.getCredentialsAsync();this.getCredentialsAsync().then(b=>a(null,b),a)}async getCredentialsAsync(){let a=await this.getClient();if(a instanceof p.Impersonated)return{client_email:a.getTargetPrincipal()};if(a instanceof r.BaseExternalAccountClient){let b=a.getServiceAccountEmail();if(b)return{client_email:b,universe_domain:a.universeDomain}}if(this.jsonContent)return{client_email:this.jsonContent.client_email,private_key:this.jsonContent.private_key,universe_domain:this.jsonContent.universe_domain};if(await this._checkIsGCE()){let[a,b]=await Promise.all([g.instance("service-accounts/default/email"),this.getUniverseDomain()]);return{client_email:a,universe_domain:b}}throw Error(c.GoogleAuthExceptionMessages.NO_CREDENTIALS_FOUND)}async getClient(){if(this.cachedCredential)return this.cachedCredential;this.#D=this.#D||this.#F();try{return await this.#D}finally{this.#D=null}}async #F(){if(this.jsonContent)return this._cacheClientFromJSON(this.jsonContent,this.clientOptions);if(this.keyFilename){let a=i.resolve(this.keyFilename),b=e.createReadStream(a);return await this.fromStreamAsync(b,this.clientOptions)}if(this.apiKey){let a=await this.fromAPIKey(this.apiKey,this.clientOptions);a.scopes=this.scopes;let{credential:b}=await this.#E(a);return b}{let{credential:a}=await this.getApplicationDefaultAsync(this.clientOptions);return a}}async getIdTokenClient(a){let b=await this.getClient();if(!("fetchIdToken"in b))throw Error("Cannot fetch ID token in this environment, use GCE or set the GOOGLE_APPLICATION_CREDENTIALS environment variable to a service account credentials JSON file.");return new l.IdTokenClient({targetAudience:a,idTokenProvider:b})}async getAccessToken(){let a=await this.getClient();return(await a.getAccessToken()).token}async getRequestHeaders(a){return(await this.getClient()).getRequestHeaders(a)}async authorizeRequest(a={}){let b=a.url,c=await this.getClient(),d=await c.getRequestHeaders(b);return a.headers=f.Gaxios.mergeHeaders(a.headers,d),a}async fetch(...a){return(await this.getClient()).fetch(...a)}async request(a){return(await this.getClient()).request(a)}getEnv(){return(0,m.getEnv)()}async sign(a,b){let c=await this.getClient(),d=await this.getUniverseDomain();if(b=b||`https://iamcredentials.${d}/v1/projects/-/serviceAccounts/`,c instanceof p.Impersonated)return(await c.sign(a)).signedBlob;let e=(0,j.createCrypto)();if(c instanceof n.JWT&&c.key)return await e.sign(c.key,a);let f=await this.getCredentials();if(!f.client_email)throw Error("Cannot sign data without `client_email`.");return this.signBlob(e,f.client_email,a,b)}async signBlob(a,b,c,d){let e=new URL(d+`${b}:signBlob`);return(await this.request({method:"POST",url:e.href,data:{payload:a.encodeBase64StringUtf8(c)},retry:!0,retryConfig:{httpMethodsToRetry:["POST"]}})).data.signedBlob}}},10918,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.IAMAuth=void 0,c.IAMAuth=class{selector;token;constructor(a,b){this.selector=a,this.token=b,this.selector=a,this.token=b}getRequestHeaders(){return{"x-goog-iam-authority-selector":this.selector,"x-goog-iam-authorization-token":this.token}}}},23699,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.DownscopedClient=c.EXPIRATION_TIME_OFFSET=c.MAX_ACCESS_BOUNDARY_RULES_COUNT=void 0;let d=a.r(53683),e=a.r(88947),f=a.r(76378),g=a.r(89627);c.MAX_ACCESS_BOUNDARY_RULES_COUNT=10,c.EXPIRATION_TIME_OFFSET=3e5;class h extends f.AuthClient{authClient;credentialAccessBoundary;cachedDownscopedAccessToken;stsCredential;constructor(a,b={accessBoundary:{accessBoundaryRules:[]}}){if(super(a instanceof f.AuthClient?{}:a),a instanceof f.AuthClient?(this.authClient=a,this.credentialAccessBoundary=b):(this.authClient=a.authClient,this.credentialAccessBoundary=a.credentialAccessBoundary),0===this.credentialAccessBoundary.accessBoundary.accessBoundaryRules.length)throw Error("At least one access boundary rule needs to be defined.");if(this.credentialAccessBoundary.accessBoundary.accessBoundaryRules.length>c.MAX_ACCESS_BOUNDARY_RULES_COUNT)throw Error(`The provided access boundary has more than ${c.MAX_ACCESS_BOUNDARY_RULES_COUNT} access boundary rules.`);for(const a of this.credentialAccessBoundary.accessBoundary.accessBoundaryRules)if(0===a.availablePermissions.length)throw Error("At least one permission should be defined in access boundary rules.");this.stsCredential=new g.StsCredentials({tokenExchangeEndpoint:`https://sts.${this.universeDomain}/v1/token`}),this.cachedDownscopedAccessToken=null}setCredentials(a){if(!a.expiry_date)throw Error("The access token expiry_date field is missing in the provided credentials.");super.setCredentials(a),this.cachedDownscopedAccessToken=a}async getAccessToken(){return(!this.cachedDownscopedAccessToken||this.isExpired(this.cachedDownscopedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedDownscopedAccessToken.access_token,expirationTime:this.cachedDownscopedAccessToken.expiry_date,res:this.cachedDownscopedAccessToken.res}}async getRequestHeaders(){let a=await this.getAccessToken(),b=new Headers({authorization:`Bearer ${a.token}`});return this.addSharedMetadataHeaders(b)}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async requestAsync(a,b=!1){let c;try{let b=await this.getRequestHeaders();a.headers=d.Gaxios.mergeHeaders(a.headers),this.addUserProjectAndAuthHeaders(a.headers,b),c=await this.transporter.request(a)}catch(d){let c=d.response;if(c){let d=c.status,f=c.config.data instanceof e.Readable;if(!b&&(401===d||403===d)&&!f&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(a,!0)}throw d}return c}async refreshAccessTokenAsync(){let a=(await this.authClient.getAccessToken()).token,b=await this.stsCredential.exchangeToken({grantType:"urn:ietf:params:oauth:grant-type:token-exchange",requestedTokenType:"urn:ietf:params:oauth:token-type:access_token",subjectToken:a,subjectTokenType:"urn:ietf:params:oauth:token-type:access_token"},void 0,this.credentialAccessBoundary),c=this.authClient.credentials?.expiry_date||null,d=b.expires_in?new Date().getTime()+1e3*b.expires_in:c;return this.cachedDownscopedAccessToken={access_token:b.access_token,expiry_date:d,res:b.res},this.credentials={},Object.assign(this.credentials,this.cachedDownscopedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedDownscopedAccessToken.expiry_date,access_token:this.cachedDownscopedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedDownscopedAccessToken}isExpired(a){let b=new Date().getTime();return!!a.expiry_date&&b>=a.expiry_date-this.eagerRefreshThresholdMillis}}c.DownscopedClient=h},52421,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.PassThroughClient=void 0;let d=a.r(76378);class e extends d.AuthClient{async request(a){return this.transporter.request(a)}async getAccessToken(){return{}}async getRequestHeaders(){return new Headers}}c.PassThroughClient=e},77530,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GoogleAuth=c.auth=c.PassThroughClient=c.ExternalAccountAuthorizedUserClient=c.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE=c.ExecutableError=c.PluggableAuthClient=c.DownscopedClient=c.BaseExternalAccountClient=c.ExternalAccountClient=c.IdentityPoolClient=c.AwsRequestSigner=c.AwsClient=c.UserRefreshClient=c.LoginTicket=c.ClientAuthentication=c.OAuth2Client=c.CodeChallengeMethod=c.Impersonated=c.JWT=c.JWTAccess=c.IdTokenClient=c.IAMAuth=c.GCPEnv=c.Compute=c.DEFAULT_UNIVERSE=c.AuthClient=c.gaxios=c.gcpMetadata=void 0;let d=a.r(28796);Object.defineProperty(c,"GoogleAuth",{enumerable:!0,get:function(){return d.GoogleAuth}}),c.gcpMetadata=a.r(76120),c.gaxios=a.r(53683);var e=a.r(76378);Object.defineProperty(c,"AuthClient",{enumerable:!0,get:function(){return e.AuthClient}}),Object.defineProperty(c,"DEFAULT_UNIVERSE",{enumerable:!0,get:function(){return e.DEFAULT_UNIVERSE}});var f=a.r(77078);Object.defineProperty(c,"Compute",{enumerable:!0,get:function(){return f.Compute}});var g=a.r(64783);Object.defineProperty(c,"GCPEnv",{enumerable:!0,get:function(){return g.GCPEnv}});var h=a.r(10918);Object.defineProperty(c,"IAMAuth",{enumerable:!0,get:function(){return h.IAMAuth}});var i=a.r(73736);Object.defineProperty(c,"IdTokenClient",{enumerable:!0,get:function(){return i.IdTokenClient}});var j=a.r(34414);Object.defineProperty(c,"JWTAccess",{enumerable:!0,get:function(){return j.JWTAccess}});var k=a.r(2629);Object.defineProperty(c,"JWT",{enumerable:!0,get:function(){return k.JWT}});var l=a.r(7064);Object.defineProperty(c,"Impersonated",{enumerable:!0,get:function(){return l.Impersonated}});var m=a.r(35246);Object.defineProperty(c,"CodeChallengeMethod",{enumerable:!0,get:function(){return m.CodeChallengeMethod}}),Object.defineProperty(c,"OAuth2Client",{enumerable:!0,get:function(){return m.OAuth2Client}}),Object.defineProperty(c,"ClientAuthentication",{enumerable:!0,get:function(){return m.ClientAuthentication}});var n=a.r(97122);Object.defineProperty(c,"LoginTicket",{enumerable:!0,get:function(){return n.LoginTicket}});var o=a.r(53904);Object.defineProperty(c,"UserRefreshClient",{enumerable:!0,get:function(){return o.UserRefreshClient}});var p=a.r(79949);Object.defineProperty(c,"AwsClient",{enumerable:!0,get:function(){return p.AwsClient}});var q=a.r(62889);Object.defineProperty(c,"AwsRequestSigner",{enumerable:!0,get:function(){return q.AwsRequestSigner}});var r=a.r(22330);Object.defineProperty(c,"IdentityPoolClient",{enumerable:!0,get:function(){return r.IdentityPoolClient}});var s=a.r(44686);Object.defineProperty(c,"ExternalAccountClient",{enumerable:!0,get:function(){return s.ExternalAccountClient}});var t=a.r(74579);Object.defineProperty(c,"BaseExternalAccountClient",{enumerable:!0,get:function(){return t.BaseExternalAccountClient}});var u=a.r(23699);Object.defineProperty(c,"DownscopedClient",{enumerable:!0,get:function(){return u.DownscopedClient}});var v=a.r(1064);Object.defineProperty(c,"PluggableAuthClient",{enumerable:!0,get:function(){return v.PluggableAuthClient}}),Object.defineProperty(c,"ExecutableError",{enumerable:!0,get:function(){return v.ExecutableError}});var w=a.r(69464);Object.defineProperty(c,"EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE",{enumerable:!0,get:function(){return w.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE}}),Object.defineProperty(c,"ExternalAccountAuthorizedUserClient",{enumerable:!0,get:function(){return w.ExternalAccountAuthorizedUserClient}});var x=a.r(52421);Object.defineProperty(c,"PassThroughClient",{enumerable:!0,get:function(){return x.PassThroughClient}}),c.auth=new d.GoogleAuth},77379,(a,b,c)=>{"use strict";let d=["nodebuffer","arraybuffer","fragments"],e="undefined"!=typeof Blob;e&&d.push("blob"),b.exports={BINARY_TYPES:d,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:e,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},65167,(a,b,c)=>{"use strict";let{EMPTY_BUFFER:d}=a.r(77379),e=Buffer[Symbol.species];function f(a,b,c,d,e){for(let f=0;f<e;f++)c[d+f]=a[f]^b[3&f]}function g(a,b){for(let c=0;c<a.length;c++)a[c]^=b[3&c]}function h(a){let b;return(h.readOnly=!0,Buffer.isBuffer(a))?a:(a instanceof ArrayBuffer?b=new e(a):ArrayBuffer.isView(a)?b=new e(a.buffer,a.byteOffset,a.byteLength):(b=Buffer.from(a),h.readOnly=!1),b)}if(b.exports={concat:function(a,b){if(0===a.length)return d;if(1===a.length)return a[0];let c=Buffer.allocUnsafe(b),f=0;for(let b=0;b<a.length;b++){let d=a[b];c.set(d,f),f+=d.length}return f<b?new e(c.buffer,c.byteOffset,f):c},mask:f,toArrayBuffer:function(a){return a.length===a.buffer.byteLength?a.buffer:a.buffer.slice(a.byteOffset,a.byteOffset+a.length)},toBuffer:h,unmask:g},!process.env.WS_NO_BUFFER_UTIL)try{let a=(()=>{let a=Error("Cannot find module 'bufferutil'");throw a.code="MODULE_NOT_FOUND",a})();b.exports.mask=function(b,c,d,e,g){g<48?f(b,c,d,e,g):a.mask(b,c,d,e,g)},b.exports.unmask=function(b,c){b.length<32?g(b,c):a.unmask(b,c)}}catch(a){}},95973,(a,b,c)=>{"use strict";let d=Symbol("kDone"),e=Symbol("kRun");b.exports=class{constructor(a){this[d]=()=>{this.pending--,this[e]()},this.concurrency=a||1/0,this.jobs=[],this.pending=0}add(a){this.jobs.push(a),this[e]()}[e](){if(this.pending!==this.concurrency&&this.jobs.length){let a=this.jobs.shift();this.pending++,a(this[d])}}}},24191,(a,b,c)=>{"use strict";let d,e=a.r(6461),f=a.r(65167),g=a.r(95973),{kStatusCode:h}=a.r(77379),i=Buffer[Symbol.species],j=Buffer.from([0,0,255,255]),k=Symbol("permessage-deflate"),l=Symbol("total-length"),m=Symbol("callback"),n=Symbol("buffers"),o=Symbol("error");function p(a){this[n].push(a),this[l]+=a.length}function q(a){(this[l]+=a.length,this[k]._maxPayload<1||this[l]<=this[k]._maxPayload)?this[n].push(a):(this[o]=RangeError("Max payload size exceeded"),this[o].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[o][h]=1009,this.removeListener("data",q),this.reset())}function r(a){(this[k]._inflate=null,this[o])?this[m](this[o]):(a[h]=1007,this[m](a))}b.exports=class{constructor(a,b,c){this._maxPayload=0|c,this._options=a||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!b,this._deflate=null,this._inflate=null,this.params=null,d||(d=new g(void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10))}static get extensionName(){return"permessage-deflate"}offer(){let a={};return this._options.serverNoContextTakeover&&(a.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(a.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(a.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?a.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(a.client_max_window_bits=!0),a}accept(a){return a=this.normalizeParams(a),this.params=this._isServer?this.acceptAsServer(a):this.acceptAsClient(a),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let a=this._deflate[m];this._deflate.close(),this._deflate=null,a&&a(Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(a){let b=this._options,c=a.find(a=>(!1!==b.serverNoContextTakeover||!a.server_no_context_takeover)&&(!a.server_max_window_bits||!1!==b.serverMaxWindowBits&&("number"!=typeof b.serverMaxWindowBits||!(b.serverMaxWindowBits>a.server_max_window_bits)))&&("number"!=typeof b.clientMaxWindowBits||!!a.client_max_window_bits));if(!c)throw Error("None of the extension offers can be accepted");return b.serverNoContextTakeover&&(c.server_no_context_takeover=!0),b.clientNoContextTakeover&&(c.client_no_context_takeover=!0),"number"==typeof b.serverMaxWindowBits&&(c.server_max_window_bits=b.serverMaxWindowBits),"number"==typeof b.clientMaxWindowBits?c.client_max_window_bits=b.clientMaxWindowBits:(!0===c.client_max_window_bits||!1===b.clientMaxWindowBits)&&delete c.client_max_window_bits,c}acceptAsClient(a){let b=a[0];if(!1===this._options.clientNoContextTakeover&&b.client_no_context_takeover)throw Error('Unexpected parameter "client_no_context_takeover"');if(b.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&b.client_max_window_bits>this._options.clientMaxWindowBits)throw Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(b.client_max_window_bits=this._options.clientMaxWindowBits);return b}normalizeParams(a){return a.forEach(a=>{Object.keys(a).forEach(b=>{let c=a[b];if(c.length>1)throw Error(`Parameter "${b}" must have only a single value`);if(c=c[0],"client_max_window_bits"===b){if(!0!==c){let a=+c;if(!Number.isInteger(a)||a<8||a>15)throw TypeError(`Invalid value for parameter "${b}": ${c}`);c=a}else if(!this._isServer)throw TypeError(`Invalid value for parameter "${b}": ${c}`)}else if("server_max_window_bits"===b){let a=+c;if(!Number.isInteger(a)||a<8||a>15)throw TypeError(`Invalid value for parameter "${b}": ${c}`);c=a}else if("client_no_context_takeover"===b||"server_no_context_takeover"===b){if(!0!==c)throw TypeError(`Invalid value for parameter "${b}": ${c}`)}else throw Error(`Unknown parameter "${b}"`);a[b]=c})}),a}decompress(a,b,c){d.add(d=>{this._decompress(a,b,(a,b)=>{d(),c(a,b)})})}compress(a,b,c){d.add(d=>{this._compress(a,b,(a,b)=>{d(),c(a,b)})})}_decompress(a,b,c){let d=this._isServer?"client":"server";if(!this._inflate){let a=`${d}_max_window_bits`,b="number"!=typeof this.params[a]?e.Z_DEFAULT_WINDOWBITS:this.params[a];this._inflate=e.createInflateRaw({...this._options.zlibInflateOptions,windowBits:b}),this._inflate[k]=this,this._inflate[l]=0,this._inflate[n]=[],this._inflate.on("error",r),this._inflate.on("data",q)}this._inflate[m]=c,this._inflate.write(a),b&&this._inflate.write(j),this._inflate.flush(()=>{let a=this._inflate[o];if(a){this._inflate.close(),this._inflate=null,c(a);return}let e=f.concat(this._inflate[n],this._inflate[l]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[l]=0,this._inflate[n]=[],b&&this.params[`${d}_no_context_takeover`]&&this._inflate.reset()),c(null,e)})}_compress(a,b,c){let d=this._isServer?"server":"client";if(!this._deflate){let a=`${d}_max_window_bits`,b="number"!=typeof this.params[a]?e.Z_DEFAULT_WINDOWBITS:this.params[a];this._deflate=e.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:b}),this._deflate[l]=0,this._deflate[n]=[],this._deflate.on("data",p)}this._deflate[m]=c,this._deflate.write(a),this._deflate.flush(e.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let a=f.concat(this._deflate[n],this._deflate[l]);b&&(a=new i(a.buffer,a.byteOffset,a.length-4)),this._deflate[m]=null,this._deflate[l]=0,this._deflate[n]=[],b&&this.params[`${d}_no_context_takeover`]&&this._deflate.reset(),c(null,a)})}}},50308,(a,b,c)=>{"use strict";let{isUtf8:d}=a.r(874),{hasBlob:e}=a.r(77379);function f(a){let b=a.length,c=0;for(;c<b;)if((128&a[c])==0)c++;else if((224&a[c])==192){if(c+1===b||(192&a[c+1])!=128||(254&a[c])==192)return!1;c+=2}else if((240&a[c])==224){if(c+2>=b||(192&a[c+1])!=128||(192&a[c+2])!=128||224===a[c]&&(224&a[c+1])==128||237===a[c]&&(224&a[c+1])==160)return!1;c+=3}else{if((248&a[c])!=240||c+3>=b||(192&a[c+1])!=128||(192&a[c+2])!=128||(192&a[c+3])!=128||240===a[c]&&(240&a[c+1])==128||244===a[c]&&a[c+1]>143||a[c]>244)return!1;c+=4}return!0}if(b.exports={isBlob:function(a){return e&&"object"==typeof a&&"function"==typeof a.arrayBuffer&&"string"==typeof a.type&&"function"==typeof a.stream&&("Blob"===a[Symbol.toStringTag]||"File"===a[Symbol.toStringTag])},isValidStatusCode:function(a){return a>=1e3&&a<=1014&&1004!==a&&1005!==a&&1006!==a||a>=3e3&&a<=4999},isValidUTF8:f,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},d)b.exports.isValidUTF8=function(a){return a.length<24?f(a):d(a)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let a=(()=>{let a=Error("Cannot find module 'utf-8-validate'");throw a.code="MODULE_NOT_FOUND",a})();b.exports.isValidUTF8=function(b){return b.length<32?f(b):a(b)}}catch(a){}},23852,(a,b,c)=>{"use strict";let{Writable:d}=a.r(88947),e=a.r(24191),{BINARY_TYPES:f,EMPTY_BUFFER:g,kStatusCode:h,kWebSocket:i}=a.r(77379),{concat:j,toArrayBuffer:k,unmask:l}=a.r(65167),{isValidStatusCode:m,isValidUTF8:n}=a.r(50308),o=Buffer[Symbol.species];b.exports=class extends d{constructor(a={}){super(),this._allowSynchronousEvents=void 0===a.allowSynchronousEvents||a.allowSynchronousEvents,this._binaryType=a.binaryType||f[0],this._extensions=a.extensions||{},this._isServer=!!a.isServer,this._maxPayload=0|a.maxPayload,this._skipUTF8Validation=!!a.skipUTF8Validation,this[i]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(a,b,c){if(8===this._opcode&&0==this._state)return c();this._bufferedBytes+=a.length,this._buffers.push(a),this.startLoop(c)}consume(a){if(this._bufferedBytes-=a,a===this._buffers[0].length)return this._buffers.shift();if(a<this._buffers[0].length){let b=this._buffers[0];return this._buffers[0]=new o(b.buffer,b.byteOffset+a,b.length-a),new o(b.buffer,b.byteOffset,a)}let b=Buffer.allocUnsafe(a);do{let c=this._buffers[0],d=b.length-a;a>=c.length?b.set(this._buffers.shift(),d):(b.set(new Uint8Array(c.buffer,c.byteOffset,a),d),this._buffers[0]=new o(c.buffer,c.byteOffset+a,c.length-a)),a-=c.length}while(a>0)return b}startLoop(a){this._loop=!0;do switch(this._state){case 0:this.getInfo(a);break;case 1:this.getPayloadLength16(a);break;case 2:this.getPayloadLength64(a);break;case 3:this.getMask();break;case 4:this.getData(a);break;case 5:case 6:this._loop=!1;return}while(this._loop)this._errored||a()}getInfo(a){if(this._bufferedBytes<2){this._loop=!1;return}let b=this.consume(2);if((48&b[0])!=0)return void a(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"));let c=(64&b[0])==64;if(c&&!this._extensions[e.extensionName])return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._fin=(128&b[0])==128,this._opcode=15&b[0],this._payloadLength=127&b[1],0===this._opcode){if(c)return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(!this._fragmented)return void a(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"));this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return void a(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));this._compressed=c}else{if(!(this._opcode>7)||!(this._opcode<11))return void a(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));if(!this._fin)return void a(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"));if(c)return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength)return void a(this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"))}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=(128&b[1])==128,this._isServer){if(!this._masked)return void a(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"))}else if(this._masked)return void a(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"));126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(a)}getPayloadLength16(a){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(a)}getPayloadLength64(a){if(this._bufferedBytes<8){this._loop=!1;return}let b=this.consume(8),c=b.readUInt32BE(0);c>2097151?a(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=0x100000000*c+b.readUInt32BE(4),this.haveLength(a))}haveLength(a){this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)?a(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH")):this._masked?this._state=3:this._state=4}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=4}getData(a){let b=g;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}b=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!=0&&l(b,this._mask)}if(this._opcode>7)return void this.controlMessage(b,a);if(this._compressed){this._state=5,this.decompress(b,a);return}b.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(b)),this.dataMessage(a)}decompress(a,b){this._extensions[e.extensionName].decompress(a,this._fin,(a,c)=>{if(a)return b(a);if(c.length){if(this._messageLength+=c.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return void b(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(c)}this.dataMessage(b),0===this._state&&this.startLoop(b)})}dataMessage(a){if(!this._fin){this._state=0;return}let b=this._messageLength,c=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let d;d="nodebuffer"===this._binaryType?j(c,b):"arraybuffer"===this._binaryType?k(j(c,b)):"blob"===this._binaryType?new Blob(c):c,this._allowSynchronousEvents?(this.emit("message",d,!0),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",d,!0),this._state=0,this.startLoop(a)}))}else{let d=j(c,b);if(!this._skipUTF8Validation&&!n(d))return void a(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));5===this._state||this._allowSynchronousEvents?(this.emit("message",d,!1),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",d,!1),this._state=0,this.startLoop(a)}))}}controlMessage(a,b){if(8===this._opcode){if(0===a.length)this._loop=!1,this.emit("conclude",1005,g),this.end();else{let c=a.readUInt16BE(0);if(!m(c))return void b(this.createError(RangeError,`invalid status code ${c}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE"));let d=new o(a.buffer,a.byteOffset+2,a.length-2);if(!this._skipUTF8Validation&&!n(d))return void b(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));this._loop=!1,this.emit("conclude",c,d),this.end()}this._state=0;return}this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",a),this._state=0):(this._state=6,setImmediate(()=>{this.emit(9===this._opcode?"ping":"pong",a),this._state=0,this.startLoop(b)}))}createError(a,b,c,d,e){this._loop=!1,this._errored=!0;let f=new a(c?`Invalid WebSocket frame: ${b}`:b);return Error.captureStackTrace(f,this.createError),f.code=e,f[h]=d,f}}},21819,(a,b,c)=>{"use strict";let d,{Duplex:e}=a.r(88947),{randomFillSync:f}=a.r(54799),g=a.r(24191),{EMPTY_BUFFER:h,kWebSocket:i,NOOP:j}=a.r(77379),{isBlob:k,isValidStatusCode:l}=a.r(50308),{mask:m,toBuffer:n}=a.r(65167),o=Symbol("kByteLength"),p=Buffer.alloc(4),q=8192;class r{constructor(a,b,c){this._extensions=b||{},c&&(this._generateMask=c,this._maskBuffer=Buffer.alloc(4)),this._socket=a,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=0,this.onerror=j,this[i]=void 0}static frame(a,b){let c,e,g=!1,h=2,i=!1;b.mask&&(c=b.maskBuffer||p,b.generateMask?b.generateMask(c):(8192===q&&(void 0===d&&(d=Buffer.alloc(8192)),f(d,0,8192),q=0),c[0]=d[q++],c[1]=d[q++],c[2]=d[q++],c[3]=d[q++]),i=(c[0]|c[1]|c[2]|c[3])==0,h=6),"string"==typeof a?e=(!b.mask||i)&&void 0!==b[o]?b[o]:(a=Buffer.from(a)).length:(e=a.length,g=b.mask&&b.readOnly&&!i);let j=e;e>=65536?(h+=8,j=127):e>125&&(h+=2,j=126);let k=Buffer.allocUnsafe(g?e+h:h);return(k[0]=b.fin?128|b.opcode:b.opcode,b.rsv1&&(k[0]|=64),k[1]=j,126===j?k.writeUInt16BE(e,2):127===j&&(k[2]=k[3]=0,k.writeUIntBE(e,4,6)),b.mask)?(k[1]|=128,k[h-4]=c[0],k[h-3]=c[1],k[h-2]=c[2],k[h-1]=c[3],i)?[k,a]:g?(m(a,c,k,h,e),[k]):(m(a,c,a,0,e),[k,a]):[k,a]}close(a,b,c,d){let e;if(void 0===a)e=h;else if("number"==typeof a&&l(a))if(void 0!==b&&b.length){let c=Buffer.byteLength(b);if(c>123)throw RangeError("The message must not be greater than 123 bytes");(e=Buffer.allocUnsafe(2+c)).writeUInt16BE(a,0),"string"==typeof b?e.write(b,2):e.set(b,2)}else(e=Buffer.allocUnsafe(2)).writeUInt16BE(a,0);else throw TypeError("First argument must be a valid error code number");let f={[o]:e.length,fin:!0,generateMask:this._generateMask,mask:c,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};0!==this._state?this.enqueue([this.dispatch,e,!1,f,d]):this.sendFrame(r.frame(e,f),d)}ping(a,b,c){let d,e;if("string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=n(a)).length,e=n.readOnly),d>125)throw RangeError("The data size must not be greater than 125 bytes");let f={[o]:d,fin:!0,generateMask:this._generateMask,mask:b,maskBuffer:this._maskBuffer,opcode:9,readOnly:e,rsv1:!1};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,!1,f,c]):this.getBlobData(a,!1,f,c):0!==this._state?this.enqueue([this.dispatch,a,!1,f,c]):this.sendFrame(r.frame(a,f),c)}pong(a,b,c){let d,e;if("string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=n(a)).length,e=n.readOnly),d>125)throw RangeError("The data size must not be greater than 125 bytes");let f={[o]:d,fin:!0,generateMask:this._generateMask,mask:b,maskBuffer:this._maskBuffer,opcode:10,readOnly:e,rsv1:!1};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,!1,f,c]):this.getBlobData(a,!1,f,c):0!==this._state?this.enqueue([this.dispatch,a,!1,f,c]):this.sendFrame(r.frame(a,f),c)}send(a,b,c){let d,e,f=this._extensions[g.extensionName],h=b.binary?2:1,i=b.compress;"string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=n(a)).length,e=n.readOnly),this._firstFragment?(this._firstFragment=!1,i&&f&&f.params[f._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(i=d>=f._threshold),this._compress=i):(i=!1,h=0),b.fin&&(this._firstFragment=!0);let j={[o]:d,fin:b.fin,generateMask:this._generateMask,mask:b.mask,maskBuffer:this._maskBuffer,opcode:h,readOnly:e,rsv1:i};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,this._compress,j,c]):this.getBlobData(a,this._compress,j,c):0!==this._state?this.enqueue([this.dispatch,a,this._compress,j,c]):this.dispatch(a,this._compress,j,c)}getBlobData(a,b,c,d){this._bufferedBytes+=c[o],this._state=2,a.arrayBuffer().then(a=>{if(this._socket.destroyed){let a=Error("The socket was closed while the blob was being read");process.nextTick(s,this,a,d);return}this._bufferedBytes-=c[o];let e=n(a);b?this.dispatch(e,b,c,d):(this._state=0,this.sendFrame(r.frame(e,c),d),this.dequeue())}).catch(a=>{process.nextTick(t,this,a,d)})}dispatch(a,b,c,d){if(!b)return void this.sendFrame(r.frame(a,c),d);let e=this._extensions[g.extensionName];this._bufferedBytes+=c[o],this._state=1,e.compress(a,c.fin,(a,b)=>{this._socket.destroyed?s(this,Error("The socket was closed while data was being compressed"),d):(this._bufferedBytes-=c[o],this._state=0,c.readOnly=!1,this.sendFrame(r.frame(b,c),d),this.dequeue())})}dequeue(){for(;0===this._state&&this._queue.length;){let a=this._queue.shift();this._bufferedBytes-=a[3][o],Reflect.apply(a[0],this,a.slice(1))}}enqueue(a){this._bufferedBytes+=a[3][o],this._queue.push(a)}sendFrame(a,b){2===a.length?(this._socket.cork(),this._socket.write(a[0]),this._socket.write(a[1],b),this._socket.uncork()):this._socket.write(a[0],b)}}function s(a,b,c){"function"==typeof c&&c(b);for(let c=0;c<a._queue.length;c++){let d=a._queue[c],e=d[d.length-1];"function"==typeof e&&e(b)}}function t(a,b,c){s(a,b,c),a.onerror(b)}b.exports=r},53447,(a,b,c)=>{"use strict";let{kForOnEventAttribute:d,kListener:e}=a.r(77379),f=Symbol("kCode"),g=Symbol("kData"),h=Symbol("kError"),i=Symbol("kMessage"),j=Symbol("kReason"),k=Symbol("kTarget"),l=Symbol("kType"),m=Symbol("kWasClean");class n{constructor(a){this[k]=null,this[l]=a}get target(){return this[k]}get type(){return this[l]}}Object.defineProperty(n.prototype,"target",{enumerable:!0}),Object.defineProperty(n.prototype,"type",{enumerable:!0});class o extends n{constructor(a,b={}){super(a),this[f]=void 0===b.code?0:b.code,this[j]=void 0===b.reason?"":b.reason,this[m]=void 0!==b.wasClean&&b.wasClean}get code(){return this[f]}get reason(){return this[j]}get wasClean(){return this[m]}}Object.defineProperty(o.prototype,"code",{enumerable:!0}),Object.defineProperty(o.prototype,"reason",{enumerable:!0}),Object.defineProperty(o.prototype,"wasClean",{enumerable:!0});class p extends n{constructor(a,b={}){super(a),this[h]=void 0===b.error?null:b.error,this[i]=void 0===b.message?"":b.message}get error(){return this[h]}get message(){return this[i]}}Object.defineProperty(p.prototype,"error",{enumerable:!0}),Object.defineProperty(p.prototype,"message",{enumerable:!0});class q extends n{constructor(a,b={}){super(a),this[g]=void 0===b.data?null:b.data}get data(){return this[g]}}function r(a,b,c){"object"==typeof a&&a.handleEvent?a.handleEvent.call(a,c):a.call(b,c)}Object.defineProperty(q.prototype,"data",{enumerable:!0}),b.exports={CloseEvent:o,ErrorEvent:p,Event:n,EventTarget:{addEventListener(a,b,c={}){let f;for(let f of this.listeners(a))if(!c[d]&&f[e]===b&&!f[d])return;if("message"===a)f=function(a,c){let d=new q("message",{data:c?a:a.toString()});d[k]=this,r(b,this,d)};else if("close"===a)f=function(a,c){let d=new o("close",{code:a,reason:c.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});d[k]=this,r(b,this,d)};else if("error"===a)f=function(a){let c=new p("error",{error:a,message:a.message});c[k]=this,r(b,this,c)};else{if("open"!==a)return;f=function(){let a=new n("open");a[k]=this,r(b,this,a)}}f[d]=!!c[d],f[e]=b,c.once?this.once(a,f):this.on(a,f)},removeEventListener(a,b){for(let c of this.listeners(a))if(c[e]===b&&!c[d]){this.removeListener(a,c);break}}},MessageEvent:q}},82731,(a,b,c)=>{"use strict";let{tokenChars:d}=a.r(50308);function e(a,b,c){void 0===a[b]?a[b]=[c]:a[b].push(c)}b.exports={format:function(a){return Object.keys(a).map(b=>{let c=a[b];return Array.isArray(c)||(c=[c]),c.map(a=>[b].concat(Object.keys(a).map(b=>{let c=a[b];return Array.isArray(c)||(c=[c]),c.map(a=>!0===a?b:`${b}=${a}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(a){let b,c,f=Object.create(null),g=Object.create(null),h=!1,i=!1,j=!1,k=-1,l=-1,m=-1,n=0;for(;n<a.length;n++)if(l=a.charCodeAt(n),void 0===b)if(-1===m&&1===d[l])-1===k&&(k=n);else if(0!==n&&(32===l||9===l))-1===m&&-1!==k&&(m=n);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${n}`);-1===m&&(m=n);let c=a.slice(k,m);44===l?(e(f,c,g),g=Object.create(null)):b=c,k=m=-1}else throw SyntaxError(`Unexpected character at index ${n}`);else if(void 0===c)if(-1===m&&1===d[l])-1===k&&(k=n);else if(32===l||9===l)-1===m&&-1!==k&&(m=n);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${n}`);-1===m&&(m=n),e(g,a.slice(k,m),!0),44===l&&(e(f,b,g),g=Object.create(null),b=void 0),k=m=-1}else if(61===l&&-1!==k&&-1===m)c=a.slice(k,n),k=m=-1;else throw SyntaxError(`Unexpected character at index ${n}`);else if(i){if(1!==d[l])throw SyntaxError(`Unexpected character at index ${n}`);-1===k?k=n:h||(h=!0),i=!1}else if(j)if(1===d[l])-1===k&&(k=n);else if(34===l&&-1!==k)j=!1,m=n;else if(92===l)i=!0;else throw SyntaxError(`Unexpected character at index ${n}`);else if(34===l&&61===a.charCodeAt(n-1))j=!0;else if(-1===m&&1===d[l])-1===k&&(k=n);else if(-1!==k&&(32===l||9===l))-1===m&&(m=n);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${n}`);-1===m&&(m=n);let d=a.slice(k,m);h&&(d=d.replace(/\\/g,""),h=!1),e(g,c,d),44===l&&(e(f,b,g),g=Object.create(null),b=void 0),c=void 0,k=m=-1}else throw SyntaxError(`Unexpected character at index ${n}`);if(-1===k||j||32===l||9===l)throw SyntaxError("Unexpected end of input");-1===m&&(m=n);let o=a.slice(k,m);return void 0===b?e(f,o,g):(void 0===c?e(g,o,!0):h?e(g,c,o.replace(/\\/g,"")):e(g,c,o),e(f,b,g)),f}}},73253,(a,b,c)=>{"use strict";let d=a.r(27699),e=a.r(24836),f=a.r(21517),g=a.r(4446),h=a.r(55004),{randomBytes:i,createHash:j}=a.r(54799),{Duplex:k,Readable:l}=a.r(88947),{URL:m}=a.r(92509),n=a.r(24191),o=a.r(23852),p=a.r(21819),{isBlob:q}=a.r(50308),{BINARY_TYPES:r,EMPTY_BUFFER:s,GUID:t,kForOnEventAttribute:u,kListener:v,kStatusCode:w,kWebSocket:x,NOOP:y}=a.r(77379),{EventTarget:{addEventListener:z,removeEventListener:A}}=a.r(53447),{format:B,parse:C}=a.r(82731),{toBuffer:D}=a.r(65167),E=Symbol("kAborted"),F=[8,13],G=["CONNECTING","OPEN","CLOSING","CLOSED"],H=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class I extends d{constructor(a,b,c){super(),this._binaryType=r[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=s,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=I.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==a?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===b?b=[]:Array.isArray(b)||("object"==typeof b&&null!==b?(c=b,b=[]):b=[b]),function a(b,c,d,g){let h,k,l,o,p={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:F[1],maxPayload:0x6400000,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...g,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(b._autoPong=p.autoPong,!F.includes(p.protocolVersion))throw RangeError(`Unsupported protocol version: ${p.protocolVersion} (supported versions: ${F.join(", ")})`);if(c instanceof m)h=c;else try{h=new m(c)}catch(a){throw SyntaxError(`Invalid URL: ${c}`)}"http:"===h.protocol?h.protocol="ws:":"https:"===h.protocol&&(h.protocol="wss:"),b._url=h.href;let q="wss:"===h.protocol,r="ws+unix:"===h.protocol;if("ws:"===h.protocol||q||r?r&&!h.pathname?k="The URL's pathname is empty":h.hash&&(k="The URL contains a fragment identifier"):k='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https:", or "ws+unix:"',k){let a=SyntaxError(k);if(0!==b._redirects)return void J(b,a);throw a}let s=q?443:80,u=i(16).toString("base64"),v=q?e.request:f.request,w=new Set;if(p.createConnection=p.createConnection||(q?L:K),p.defaultPort=p.defaultPort||s,p.port=h.port||s,p.host=h.hostname.startsWith("[")?h.hostname.slice(1,-1):h.hostname,p.headers={...p.headers,"Sec-WebSocket-Version":p.protocolVersion,"Sec-WebSocket-Key":u,Connection:"Upgrade",Upgrade:"websocket"},p.path=h.pathname+h.search,p.timeout=p.handshakeTimeout,p.perMessageDeflate&&(l=new n(!0!==p.perMessageDeflate?p.perMessageDeflate:{},!1,p.maxPayload),p.headers["Sec-WebSocket-Extensions"]=B({[n.extensionName]:l.offer()})),d.length){for(let a of d){if("string"!=typeof a||!H.test(a)||w.has(a))throw SyntaxError("An invalid or duplicated subprotocol was specified");w.add(a)}p.headers["Sec-WebSocket-Protocol"]=d.join(",")}if(p.origin&&(p.protocolVersion<13?p.headers["Sec-WebSocket-Origin"]=p.origin:p.headers.Origin=p.origin),(h.username||h.password)&&(p.auth=`${h.username}:${h.password}`),r){let a=p.path.split(":");p.socketPath=a[0],p.path=a[1]}if(p.followRedirects){if(0===b._redirects){b._originalIpc=r,b._originalSecure=q,b._originalHostOrSocketPath=r?p.socketPath:h.host;let a=g&&g.headers;if(g={...g,headers:{}},a)for(let[b,c]of Object.entries(a))g.headers[b.toLowerCase()]=c}else if(0===b.listenerCount("redirect")){let a=r?!!b._originalIpc&&p.socketPath===b._originalHostOrSocketPath:!b._originalIpc&&h.host===b._originalHostOrSocketPath;a&&(!b._originalSecure||q)||(delete p.headers.authorization,delete p.headers.cookie,a||delete p.headers.host,p.auth=void 0)}p.auth&&!g.headers.authorization&&(g.headers.authorization="Basic "+Buffer.from(p.auth).toString("base64")),o=b._req=v(p),b._redirects&&b.emit("redirect",b.url,o)}else o=b._req=v(p);p.timeout&&o.on("timeout",()=>{M(b,o,"Opening handshake has timed out")}),o.on("error",a=>{null===o||o[E]||(o=b._req=null,J(b,a))}),o.on("response",e=>{let f=e.headers.location,h=e.statusCode;if(f&&p.followRedirects&&h>=300&&h<400){let e;if(++b._redirects>p.maxRedirects)return void M(b,o,"Maximum redirects exceeded");o.abort();try{e=new m(f,c)}catch(a){J(b,SyntaxError(`Invalid URL: ${f}`));return}a(b,e,d,g)}else b.emit("unexpected-response",o,e)||M(b,o,`Unexpected server response: ${e.statusCode}`)}),o.on("upgrade",(a,c,d)=>{let e;if(b.emit("upgrade",a),b.readyState!==I.CONNECTING)return;o=b._req=null;let f=a.headers.upgrade;if(void 0===f||"websocket"!==f.toLowerCase())return void M(b,c,"Invalid Upgrade header");let g=j("sha1").update(u+t).digest("base64");if(a.headers["sec-websocket-accept"]!==g)return void M(b,c,"Invalid Sec-WebSocket-Accept header");let h=a.headers["sec-websocket-protocol"];if(void 0!==h?w.size?w.has(h)||(e="Server sent an invalid subprotocol"):e="Server sent a subprotocol but none was requested":w.size&&(e="Server sent no subprotocol"),e)return void M(b,c,e);h&&(b._protocol=h);let i=a.headers["sec-websocket-extensions"];if(void 0!==i){let a;if(!l)return void M(b,c,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");try{a=C(i)}catch(a){M(b,c,"Invalid Sec-WebSocket-Extensions header");return}let d=Object.keys(a);if(1!==d.length||d[0]!==n.extensionName)return void M(b,c,"Server indicated an extension that was not requested");try{l.accept(a[n.extensionName])}catch(a){M(b,c,"Invalid Sec-WebSocket-Extensions header");return}b._extensions[n.extensionName]=l}b.setSocket(c,d,{allowSynchronousEvents:p.allowSynchronousEvents,generateMask:p.generateMask,maxPayload:p.maxPayload,skipUTF8Validation:p.skipUTF8Validation})}),p.finishRequest?p.finishRequest(o,b):o.end()}(this,a,b,c)):(this._autoPong=c.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(a){r.includes(a)&&(this._binaryType=a,this._receiver&&(this._receiver._binaryType=a))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(a,b,c){let d=new o({allowSynchronousEvents:c.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:c.maxPayload,skipUTF8Validation:c.skipUTF8Validation}),e=new p(a,this._extensions,c.generateMask);this._receiver=d,this._sender=e,this._socket=a,d[x]=this,e[x]=this,a[x]=this,d.on("conclude",O),d.on("drain",P),d.on("error",Q),d.on("message",S),d.on("ping",T),d.on("pong",U),e.onerror=W,a.setTimeout&&a.setTimeout(0),a.setNoDelay&&a.setNoDelay(),b.length>0&&a.unshift(b),a.on("close",Y),a.on("data",Z),a.on("end",$),a.on("error",_),this._readyState=I.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=I.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[n.extensionName]&&this._extensions[n.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=I.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(a,b){if(this.readyState!==I.CLOSED){if(this.readyState===I.CONNECTING)return void M(this,this._req,"WebSocket was closed before the connection was established");if(this.readyState===I.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=I.CLOSING,this._sender.close(a,b,!this._isServer,a=>{!a&&(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),X(this)}}pause(){this.readyState!==I.CONNECTING&&this.readyState!==I.CLOSED&&(this._paused=!0,this._socket.pause())}ping(a,b,c){if(this.readyState===I.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");("function"==typeof a?(c=a,a=b=void 0):"function"==typeof b&&(c=b,b=void 0),"number"==typeof a&&(a=a.toString()),this.readyState!==I.OPEN)?N(this,a,c):(void 0===b&&(b=!this._isServer),this._sender.ping(a||s,b,c))}pong(a,b,c){if(this.readyState===I.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");("function"==typeof a?(c=a,a=b=void 0):"function"==typeof b&&(c=b,b=void 0),"number"==typeof a&&(a=a.toString()),this.readyState!==I.OPEN)?N(this,a,c):(void 0===b&&(b=!this._isServer),this._sender.pong(a||s,b,c))}resume(){this.readyState!==I.CONNECTING&&this.readyState!==I.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(a,b,c){if(this.readyState===I.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof b&&(c=b,b={}),"number"==typeof a&&(a=a.toString()),this.readyState!==I.OPEN)return void N(this,a,c);let d={binary:"string"!=typeof a,mask:!this._isServer,compress:!0,fin:!0,...b};this._extensions[n.extensionName]||(d.compress=!1),this._sender.send(a||s,d,c)}terminate(){if(this.readyState!==I.CLOSED){if(this.readyState===I.CONNECTING)return void M(this,this._req,"WebSocket was closed before the connection was established");this._socket&&(this._readyState=I.CLOSING,this._socket.destroy())}}}function J(a,b){a._readyState=I.CLOSING,a._errorEmitted=!0,a.emit("error",b),a.emitClose()}function K(a){return a.path=a.socketPath,g.connect(a)}function L(a){return a.path=void 0,a.servername||""===a.servername||(a.servername=g.isIP(a.host)?"":a.host),h.connect(a)}function M(a,b,c){a._readyState=I.CLOSING;let d=Error(c);Error.captureStackTrace(d,M),b.setHeader?(b[E]=!0,b.abort(),b.socket&&!b.socket.destroyed&&b.socket.destroy(),process.nextTick(J,a,d)):(b.destroy(d),b.once("error",a.emit.bind(a,"error")),b.once("close",a.emitClose.bind(a)))}function N(a,b,c){if(b){let c=q(b)?b.size:D(b).length;a._socket?a._sender._bufferedBytes+=c:a._bufferedAmount+=c}if(c){let b=Error(`WebSocket is not open: readyState ${a.readyState} (${G[a.readyState]})`);process.nextTick(c,b)}}function O(a,b){let c=this[x];c._closeFrameReceived=!0,c._closeMessage=b,c._closeCode=a,void 0!==c._socket[x]&&(c._socket.removeListener("data",Z),process.nextTick(V,c._socket),1005===a?c.close():c.close(a,b))}function P(){let a=this[x];a.isPaused||a._socket.resume()}function Q(a){let b=this[x];void 0!==b._socket[x]&&(b._socket.removeListener("data",Z),process.nextTick(V,b._socket),b.close(a[w])),b._errorEmitted||(b._errorEmitted=!0,b.emit("error",a))}function R(){this[x].emitClose()}function S(a,b){this[x].emit("message",a,b)}function T(a){let b=this[x];b._autoPong&&b.pong(a,!this._isServer,y),b.emit("ping",a)}function U(a){this[x].emit("pong",a)}function V(a){a.resume()}function W(a){let b=this[x];b.readyState!==I.CLOSED&&(b.readyState===I.OPEN&&(b._readyState=I.CLOSING,X(b)),this._socket.end(),b._errorEmitted||(b._errorEmitted=!0,b.emit("error",a)))}function X(a){a._closeTimer=setTimeout(a._socket.destroy.bind(a._socket),3e4)}function Y(){let a,b=this[x];this.removeListener("close",Y),this.removeListener("data",Z),this.removeListener("end",$),b._readyState=I.CLOSING,this._readableState.endEmitted||b._closeFrameReceived||b._receiver._writableState.errorEmitted||null===(a=b._socket.read())||b._receiver.write(a),b._receiver.end(),this[x]=void 0,clearTimeout(b._closeTimer),b._receiver._writableState.finished||b._receiver._writableState.errorEmitted?b.emitClose():(b._receiver.on("error",R),b._receiver.on("finish",R))}function Z(a){this[x]._receiver.write(a)||this.pause()}function $(){let a=this[x];a._readyState=I.CLOSING,a._receiver.end(),this.end()}function _(){let a=this[x];this.removeListener("error",_),this.on("error",y),a&&(a._readyState=I.CLOSING,this.destroy())}Object.defineProperty(I,"CONNECTING",{enumerable:!0,value:G.indexOf("CONNECTING")}),Object.defineProperty(I.prototype,"CONNECTING",{enumerable:!0,value:G.indexOf("CONNECTING")}),Object.defineProperty(I,"OPEN",{enumerable:!0,value:G.indexOf("OPEN")}),Object.defineProperty(I.prototype,"OPEN",{enumerable:!0,value:G.indexOf("OPEN")}),Object.defineProperty(I,"CLOSING",{enumerable:!0,value:G.indexOf("CLOSING")}),Object.defineProperty(I.prototype,"CLOSING",{enumerable:!0,value:G.indexOf("CLOSING")}),Object.defineProperty(I,"CLOSED",{enumerable:!0,value:G.indexOf("CLOSED")}),Object.defineProperty(I.prototype,"CLOSED",{enumerable:!0,value:G.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(a=>{Object.defineProperty(I.prototype,a,{enumerable:!0})}),["open","error","close","message"].forEach(a=>{Object.defineProperty(I.prototype,`on${a}`,{enumerable:!0,get(){for(let b of this.listeners(a))if(b[u])return b[v];return null},set(b){for(let b of this.listeners(a))if(b[u]){this.removeListener(a,b);break}"function"==typeof b&&this.addEventListener(a,b,{[u]:!0})}})}),I.prototype.addEventListener=z,I.prototype.removeEventListener=A,b.exports=I},16816,(a,b,c)=>{"use strict";a.r(73253);let{Duplex:d}=a.r(88947);function e(a){a.emit("close")}function f(){!this.destroyed&&this._writableState.finished&&this.destroy()}function g(a){this.removeListener("error",g),this.destroy(),0===this.listenerCount("error")&&this.emit("error",a)}b.exports=function(a,b){let c=!0,h=new d({...b,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return a.on("message",function(b,c){let d=!c&&h._readableState.objectMode?b.toString():b;h.push(d)||a.pause()}),a.once("error",function(a){h.destroyed||(c=!1,h.destroy(a))}),a.once("close",function(){h.destroyed||h.push(null)}),h._destroy=function(b,d){if(a.readyState===a.CLOSED){d(b),process.nextTick(e,h);return}let f=!1;a.once("error",function(a){f=!0,d(a)}),a.once("close",function(){f||d(b),process.nextTick(e,h)}),c&&a.terminate()},h._final=function(b){a.readyState===a.CONNECTING?a.once("open",function(){h._final(b)}):null!==a._socket&&(a._socket._writableState.finished?(b(),h._readableState.endEmitted&&h.destroy()):(a._socket.once("finish",function(){b()}),a.close()))},h._read=function(){a.isPaused&&a.resume()},h._write=function(b,c,d){a.readyState===a.CONNECTING?a.once("open",function(){h._write(b,c,d)}):a.send(b,d)},h.on("end",f),h.on("error",g),h}},35816,(a,b,c)=>{"use strict";let{tokenChars:d}=a.r(50308);b.exports={parse:function(a){let b=new Set,c=-1,e=-1,f=0;for(;f<a.length;f++){let g=a.charCodeAt(f);if(-1===e&&1===d[g])-1===c&&(c=f);else if(0!==f&&(32===g||9===g))-1===e&&-1!==c&&(e=f);else if(44===g){if(-1===c)throw SyntaxError(`Unexpected character at index ${f}`);-1===e&&(e=f);let d=a.slice(c,e);if(b.has(d))throw SyntaxError(`The "${d}" subprotocol is duplicated`);b.add(d),c=e=-1}else throw SyntaxError(`Unexpected character at index ${f}`)}if(-1===c||-1!==e)throw SyntaxError("Unexpected end of input");let g=a.slice(c,f);if(b.has(g))throw SyntaxError(`The "${g}" subprotocol is duplicated`);return b.add(g),b}}},72513,(a,b,c)=>{"use strict";let d=a.r(27699),e=a.r(21517),{Duplex:f}=a.r(88947),{createHash:g}=a.r(54799),h=a.r(82731),i=a.r(24191),j=a.r(35816),k=a.r(73253),{GUID:l,kWebSocket:m}=a.r(77379),n=/^[+/0-9A-Za-z]{22}==$/;function o(a){a._state=2,a.emit("close")}function p(){this.destroy()}function q(a,b,c,d){c=c||e.STATUS_CODES[b],d={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(c),...d},a.once("finish",a.destroy),a.end(`HTTP/1.1 ${b} ${e.STATUS_CODES[b]}\r
`+Object.keys(d).map(a=>`${a}: ${d[a]}`).join("\r\n")+"\r\n\r\n"+c)}function r(a,b,c,d,e,f){if(a.listenerCount("wsClientError")){let d=Error(e);Error.captureStackTrace(d,r),a.emit("wsClientError",d,c,b)}else q(c,d,e,f)}b.exports=class extends d{constructor(a,b){if(super(),null==(a={allowSynchronousEvents:!0,autoPong:!0,maxPayload:0x6400000,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:k,...a}).port&&!a.server&&!a.noServer||null!=a.port&&(a.server||a.noServer)||a.server&&a.noServer)throw TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=a.port?(this._server=e.createServer((a,b)=>{let c=e.STATUS_CODES[426];b.writeHead(426,{"Content-Length":c.length,"Content-Type":"text/plain"}),b.end(c)}),this._server.listen(a.port,a.host,a.backlog,b)):a.server&&(this._server=a.server),this._server){const a=this.emit.bind(this,"connection");this._removeListeners=function(a,b){for(let c of Object.keys(b))a.on(c,b[c]);return function(){for(let c of Object.keys(b))a.removeListener(c,b[c])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(b,c,d)=>{this.handleUpgrade(b,c,d,a)}})}!0===a.perMessageDeflate&&(a.perMessageDeflate={}),a.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=a,this._state=0}address(){if(this.options.noServer)throw Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(a){if(2===this._state){a&&this.once("close",()=>{a(Error("The server is not running"))}),process.nextTick(o,this);return}if(a&&this.once("close",a),1!==this._state)if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(o,this);else{let a=this._server;this._removeListeners(),this._removeListeners=this._server=null,a.close(()=>{o(this)})}}shouldHandle(a){if(this.options.path){let b=a.url.indexOf("?");if((-1!==b?a.url.slice(0,b):a.url)!==this.options.path)return!1}return!0}handleUpgrade(a,b,c,d){b.on("error",p);let e=a.headers["sec-websocket-key"],f=a.headers.upgrade,g=+a.headers["sec-websocket-version"];if("GET"!==a.method)return void r(this,a,b,405,"Invalid HTTP method");if(void 0===f||"websocket"!==f.toLowerCase())return void r(this,a,b,400,"Invalid Upgrade header");if(void 0===e||!n.test(e))return void r(this,a,b,400,"Missing or invalid Sec-WebSocket-Key header");if(13!==g&&8!==g)return void r(this,a,b,400,"Missing or invalid Sec-WebSocket-Version header",{"Sec-WebSocket-Version":"13, 8"});if(!this.shouldHandle(a))return void q(b,400);let k=a.headers["sec-websocket-protocol"],l=new Set;if(void 0!==k)try{l=j.parse(k)}catch(c){r(this,a,b,400,"Invalid Sec-WebSocket-Protocol header");return}let m=a.headers["sec-websocket-extensions"],o={};if(this.options.perMessageDeflate&&void 0!==m){let c=new i(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let a=h.parse(m);a[i.extensionName]&&(c.accept(a[i.extensionName]),o[i.extensionName]=c)}catch(c){r(this,a,b,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let f={origin:a.headers[`${8===g?"sec-websocket-origin":"origin"}`],secure:!!(a.socket.authorized||a.socket.encrypted),req:a};if(2===this.options.verifyClient.length)return void this.options.verifyClient(f,(f,g,h,i)=>{if(!f)return q(b,g||401,h,i);this.completeUpgrade(o,e,l,a,b,c,d)});if(!this.options.verifyClient(f))return q(b,401)}this.completeUpgrade(o,e,l,a,b,c,d)}completeUpgrade(a,b,c,d,e,f,j){if(!e.readable||!e.writable)return e.destroy();if(e[m])throw Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return q(e,503);let k=g("sha1").update(b+l).digest("base64"),n=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${k}`],r=new this.options.WebSocket(null,void 0,this.options);if(c.size){let a=this.options.handleProtocols?this.options.handleProtocols(c,d):c.values().next().value;a&&(n.push(`Sec-WebSocket-Protocol: ${a}`),r._protocol=a)}if(a[i.extensionName]){let b=a[i.extensionName].params,c=h.format({[i.extensionName]:[b]});n.push(`Sec-WebSocket-Extensions: ${c}`),r._extensions=a}this.emit("headers",n,d),e.write(n.concat("\r\n").join("\r\n")),e.removeListener("error",p),r.setSocket(e,f,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(r),r.on("close",()=>{this.clients.delete(r),this._shouldEmitClose&&!this.clients.size&&process.nextTick(o,this)})),j(r,d)}}},13095,(a,b,c)=>{"use strict";function d(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureServerEntryExports",{enumerable:!0,get:function(){return d}})},56004,a=>{"use strict";let b,c;var d=a.i(37936),e=a.i(18558),f=a.i(77530),g=a.i(22734),h=a.i(81111);a.i(16816),a.i(23852),a.i(21819);var i=a.i(73253);a.i(72513),i.default;var j=a.i(24868);class k{}function l(a,b){return a.replace(/\{([^}]+)\}/g,(a,c)=>{if(Object.prototype.hasOwnProperty.call(b,c)){let a=b[c];return null!=a?String(a):""}throw Error(`Key '${c}' not found in valueMap.`)})}function m(a,b,c){for(let d=0;d<b.length-1;d++){let e=b[d];if(e.endsWith("[]")){let f=e.slice(0,-2);if(!(f in a))if(Array.isArray(c))a[f]=Array.from({length:c.length},()=>({}));else throw Error(`Value must be a list given an array path ${e}`);if(Array.isArray(a[f])){let e=a[f];if(Array.isArray(c))for(let a=0;a<e.length;a++)m(e[a],b.slice(d+1),c[a]);else for(let a of e)m(a,b.slice(d+1),c)}return}if(e.endsWith("[0]")){let f=e.slice(0,-3);f in a||(a[f]=[{}]),m(a[f][0],b.slice(d+1),c);return}a[e]&&"object"==typeof a[e]||(a[e]={}),a=a[e]}let d=b[b.length-1],e=a[d];if(void 0!==e){if(!c||"object"==typeof c&&0===Object.keys(c).length||c===e)return;if("object"==typeof e&&"object"==typeof c&&null!==e&&null!==c)Object.assign(e,c);else throw Error(`Cannot set value for an existing key. Key: ${d}`)}else"_self"!==d||"object"!=typeof c||null===c||Array.isArray(c)?a[d]=c:Object.assign(a,c)}function n(a,b,c){try{if(1===b.length&&"_self"===b[0])return a;for(let d=0;d<b.length;d++){if("object"!=typeof a||null===a)return c;let e=b[d];if(e.endsWith("[]")){let f=e.slice(0,-2);if(!(f in a))return c;{let e=a[f];if(!Array.isArray(e))return c;return e.map(a=>n(a,b.slice(d+1),c))}}a=a[e]}return a}catch(a){if(a instanceof TypeError)return c;throw a}}function o(a){if("string"!=typeof a)throw Error("fromImageBytes must be a string");return a}(bz=cl||(cl={})).OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",bz.OUTCOME_OK="OUTCOME_OK",bz.OUTCOME_FAILED="OUTCOME_FAILED",bz.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED",(bA=cm||(cm={})).LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",bA.PYTHON="PYTHON",(bB=cn||(cn={})).SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",bB.SILENT="SILENT",bB.WHEN_IDLE="WHEN_IDLE",bB.INTERRUPT="INTERRUPT",(bC=co||(co={})).TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",bC.STRING="STRING",bC.NUMBER="NUMBER",bC.INTEGER="INTEGER",bC.BOOLEAN="BOOLEAN",bC.ARRAY="ARRAY",bC.OBJECT="OBJECT",bC.NULL="NULL",(bD=cp||(cp={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",bD.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",bD.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",bD.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",bD.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",bD.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",bD.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",bD.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",bD.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",bD.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",bD.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK",(bE=cq||(cq={})).HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",bE.SEVERITY="SEVERITY",bE.PROBABILITY="PROBABILITY",(bF=cr||(cr={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",bF.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",bF.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",bF.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",bF.BLOCK_NONE="BLOCK_NONE",bF.OFF="OFF",(bG=cs||(cs={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",bG.MODE_DYNAMIC="MODE_DYNAMIC",(bH=ct||(ct={})).AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",bH.NO_AUTH="NO_AUTH",bH.API_KEY_AUTH="API_KEY_AUTH",bH.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",bH.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",bH.OAUTH="OAUTH",bH.OIDC_AUTH="OIDC_AUTH",(bI=cu||(cu={})).API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",bI.SIMPLE_SEARCH="SIMPLE_SEARCH",bI.ELASTIC_SEARCH="ELASTIC_SEARCH",(bJ=cv||(cv={})).URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",bJ.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",bJ.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",bJ.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",bJ.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE",(bK=cw||(cw={})).FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",bK.STOP="STOP",bK.MAX_TOKENS="MAX_TOKENS",bK.SAFETY="SAFETY",bK.RECITATION="RECITATION",bK.LANGUAGE="LANGUAGE",bK.OTHER="OTHER",bK.BLOCKLIST="BLOCKLIST",bK.PROHIBITED_CONTENT="PROHIBITED_CONTENT",bK.SPII="SPII",bK.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",bK.IMAGE_SAFETY="IMAGE_SAFETY",bK.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",bK.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",bK.NO_IMAGE="NO_IMAGE",(bL=cx||(cx={})).HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",bL.NEGLIGIBLE="NEGLIGIBLE",bL.LOW="LOW",bL.MEDIUM="MEDIUM",bL.HIGH="HIGH",(bM=cy||(cy={})).HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",bM.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",bM.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",bM.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",bM.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH",(bN=cz||(cz={})).BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",bN.SAFETY="SAFETY",bN.OTHER="OTHER",bN.BLOCKLIST="BLOCKLIST",bN.PROHIBITED_CONTENT="PROHIBITED_CONTENT",bN.IMAGE_SAFETY="IMAGE_SAFETY",bN.MODEL_ARMOR="MODEL_ARMOR",bN.JAILBREAK="JAILBREAK",(bO=cA||(cA={})).TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",bO.ON_DEMAND="ON_DEMAND",bO.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT",(bP=cB||(cB={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",bP.TEXT="TEXT",bP.IMAGE="IMAGE",bP.AUDIO="AUDIO",(bQ=cC||(cC={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",bQ.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",bQ.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",bQ.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",(bR=cD||(cD={})).JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",bR.JOB_STATE_QUEUED="JOB_STATE_QUEUED",bR.JOB_STATE_PENDING="JOB_STATE_PENDING",bR.JOB_STATE_RUNNING="JOB_STATE_RUNNING",bR.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",bR.JOB_STATE_FAILED="JOB_STATE_FAILED",bR.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",bR.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",bR.JOB_STATE_PAUSED="JOB_STATE_PAUSED",bR.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",bR.JOB_STATE_UPDATING="JOB_STATE_UPDATING",bR.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED",(bS=cE||(cE={})).TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",bS.TUNING_MODE_FULL="TUNING_MODE_FULL",bS.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER",(bT=cF||(cF={})).ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",bT.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",bT.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",bT.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",bT.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",bT.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",bT.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO",(bU=cG||(cG={})).TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",bU.TUNING_TASK_I2V="TUNING_TASK_I2V",bU.TUNING_TASK_T2V="TUNING_TASK_T2V",(bV=cH||(cH={})).FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",bV.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",bV.BALANCED="BALANCED",bV.PRIORITIZE_COST="PRIORITIZE_COST",(bW=cI||(cI={})).UNSPECIFIED="UNSPECIFIED",bW.BLOCKING="BLOCKING",bW.NON_BLOCKING="NON_BLOCKING",(bX=cJ||(cJ={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",bX.MODE_DYNAMIC="MODE_DYNAMIC",(bY=cK||(cK={})).ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",bY.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER",(bZ=cL||(cL={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",bZ.AUTO="AUTO",bZ.ANY="ANY",bZ.NONE="NONE",bZ.VALIDATED="VALIDATED",(b$=cM||(cM={})).BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",b$.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",b$.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",b$.BLOCK_NONE="BLOCK_NONE",(b_=cN||(cN={})).DONT_ALLOW="DONT_ALLOW",b_.ALLOW_ADULT="ALLOW_ADULT",b_.ALLOW_ALL="ALLOW_ALL",(b0=cO||(cO={})).auto="auto",b0.en="en",b0.ja="ja",b0.ko="ko",b0.hi="hi",b0.zh="zh",b0.pt="pt",b0.es="es",(b1=cP||(cP={})).MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",b1.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",b1.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",b1.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",b1.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC",(b2=cQ||(cQ={})).CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",b2.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",b2.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",b2.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH",(b3=cR||(cR={})).SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",b3.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",b3.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",b3.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT",(b4=cS||(cS={})).EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",b4.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",b4.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",b4.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",b4.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",b4.EDIT_MODE_STYLE="EDIT_MODE_STYLE",b4.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",b4.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE",(b5=cT||(cT={})).FOREGROUND="FOREGROUND",b5.BACKGROUND="BACKGROUND",b5.PROMPT="PROMPT",b5.SEMANTIC="SEMANTIC",b5.INTERACTIVE="INTERACTIVE",(b6=cU||(cU={})).ASSET="ASSET",b6.STYLE="STYLE",(b7=cV||(cV={})).INSERT="INSERT",b7.REMOVE="REMOVE",b7.REMOVE_STATIC="REMOVE_STATIC",b7.OUTPAINT="OUTPAINT",(b8=cW||(cW={})).OPTIMIZED="OPTIMIZED",b8.LOSSLESS="LOSSLESS",(b9=cX||(cX={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",b9.PROCESSING="PROCESSING",b9.ACTIVE="ACTIVE",b9.FAILED="FAILED",(ca=cY||(cY={})).SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",ca.UPLOADED="UPLOADED",ca.GENERATED="GENERATED",(cb=cZ||(cZ={})).TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",cb.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",cb.RESPONSE_REJECTED="RESPONSE_REJECTED",cb.NEED_MORE_INPUT="NEED_MORE_INPUT",(cc=c$||(c$={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",cc.TEXT="TEXT",cc.IMAGE="IMAGE",cc.VIDEO="VIDEO",cc.AUDIO="AUDIO",cc.DOCUMENT="DOCUMENT",(cd=c_||(c_={})).START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",cd.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",cd.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW",(ce=c0||(c0={})).END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",ce.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",ce.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW",(cf=c1||(c1={})).ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",cf.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",cf.NO_INTERRUPTION="NO_INTERRUPTION",(cg=c2||(c2={})).TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",cg.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",cg.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT",(ch=c3||(c3={})).SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",ch.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",ch.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",ch.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",ch.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",ch.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",ch.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",ch.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",ch.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",ch.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",ch.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",ch.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",ch.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR",(ci=c4||(c4={})).MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",ci.QUALITY="QUALITY",ci.DIVERSITY="DIVERSITY",ci.VOCALIZATION="VOCALIZATION",(cj=c5||(c5={})).PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",cj.PLAY="PLAY",cj.PAUSE="PAUSE",cj.STOP="STOP",cj.RESET_CONTEXT="RESET_CONTEXT";class p{constructor(a){const b={};for(const c of a.headers.entries())b[c[0]]=c[1];this.headers=b,this.responseInternal=a}json(){return this.responseInternal.json()}}class q{get text(){var a,b,c,d,e,f,g,h;if((null==(d=null==(c=null==(b=null==(a=this.candidates)?void 0:a[0])?void 0:b.content)?void 0:c.parts)?void 0:d.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let i="",j=!1,k=[];for(let a of null!=(h=null==(g=null==(f=null==(e=this.candidates)?void 0:e[0])?void 0:f.content)?void 0:g.parts)?h:[]){for(let[b,c]of Object.entries(a))"text"!==b&&"thought"!==b&&(null!==c||void 0!==c)&&k.push(b);if("string"==typeof a.text){if("boolean"==typeof a.thought&&a.thought)continue;j=!0,i+=a.text}}return k.length>0&&console.warn(`there are non-text parts ${k} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),j?i:void 0}get data(){var a,b,c,d,e,f,g,h;if((null==(d=null==(c=null==(b=null==(a=this.candidates)?void 0:a[0])?void 0:b.content)?void 0:c.parts)?void 0:d.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let i="",j=[];for(let a of null!=(h=null==(g=null==(f=null==(e=this.candidates)?void 0:e[0])?void 0:f.content)?void 0:g.parts)?h:[]){for(let[b,c]of Object.entries(a))"inlineData"!==b&&(null!==c||void 0!==c)&&j.push(b);a.inlineData&&"string"==typeof a.inlineData.data&&(i+=atob(a.inlineData.data))}return j.length>0&&console.warn(`there are non-data parts ${j} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}get functionCalls(){var a,b,c,d,e,f,g,h;if((null==(d=null==(c=null==(b=null==(a=this.candidates)?void 0:a[0])?void 0:b.content)?void 0:c.parts)?void 0:d.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");let i=null==(h=null==(g=null==(f=null==(e=this.candidates)?void 0:e[0])?void 0:f.content)?void 0:g.parts)?void 0:h.filter(a=>a.functionCall).map(a=>a.functionCall).filter(a=>void 0!==a);if((null==i?void 0:i.length)!==0)return i}get executableCode(){var a,b,c,d,e,f,g,h,i;if((null==(d=null==(c=null==(b=null==(a=this.candidates)?void 0:a[0])?void 0:b.content)?void 0:c.parts)?void 0:d.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");let j=null==(h=null==(g=null==(f=null==(e=this.candidates)?void 0:e[0])?void 0:f.content)?void 0:g.parts)?void 0:h.filter(a=>a.executableCode).map(a=>a.executableCode).filter(a=>void 0!==a);if((null==j?void 0:j.length)!==0)return null==(i=null==j?void 0:j[0])?void 0:i.code}get codeExecutionResult(){var a,b,c,d,e,f,g,h,i;if((null==(d=null==(c=null==(b=null==(a=this.candidates)?void 0:a[0])?void 0:b.content)?void 0:c.parts)?void 0:d.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");let j=null==(h=null==(g=null==(f=null==(e=this.candidates)?void 0:e[0])?void 0:f.content)?void 0:g.parts)?void 0:h.filter(a=>a.codeExecutionResult).map(a=>a.codeExecutionResult).filter(a=>void 0!==a);if((null==j?void 0:j.length)!==0)return null==(i=null==j?void 0:j[0])?void 0:i.output}}class r{}class s{}class t{}class u{}class v{}class w{}class x{}class y{}class z{}class A{}class B{_fromAPIResponse({apiResponse:a,isVertexAI:b}){let c,d=new B;if(b){let b,d,e,f,g,h;b={},null!=(d=n(a,["name"]))&&m(b,["name"],d),null!=(e=n(a,["metadata"]))&&m(b,["metadata"],e),null!=(f=n(a,["done"]))&&m(b,["done"],f),null!=(g=n(a,["error"]))&&m(b,["error"],g),null!=(h=n(a,["response"]))&&m(b,["response"],function(a){let b={},c=n(a,["videos"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e,f,g,h;return c={},null!=(d=n(a,["_self"]))&&m(c,["video"],(e={},null!=(f=n(b=d,["gcsUri"]))&&m(e,["uri"],f),null!=(g=n(b,["bytesBase64Encoded"]))&&m(e,["videoBytes"],o(g)),null!=(h=n(b,["mimeType"]))&&m(e,["mimeType"],h),e)),c})),m(b,["generatedVideos"],a)}let d=n(a,["raiMediaFilteredCount"]);null!=d&&m(b,["raiMediaFilteredCount"],d);let e=n(a,["raiMediaFilteredReasons"]);return null!=e&&m(b,["raiMediaFilteredReasons"],e),b}(h)),c=b}else{let b,d,e,f,g,h;b={},null!=(d=n(a,["name"]))&&m(b,["name"],d),null!=(e=n(a,["metadata"]))&&m(b,["metadata"],e),null!=(f=n(a,["done"]))&&m(b,["done"],f),null!=(g=n(a,["error"]))&&m(b,["error"],g),null!=(h=n(a,["response","generateVideoResponse"]))&&m(b,["response"],function(a){let b={},c=n(a,["generatedSamples"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e,f,g,h;return c={},null!=(d=n(a,["video"]))&&m(c,["video"],(e={},null!=(f=n(b=d,["uri"]))&&m(e,["uri"],f),null!=(g=n(b,["encodedVideo"]))&&m(e,["videoBytes"],o(g)),null!=(h=n(b,["encoding"]))&&m(e,["mimeType"],h),e)),c})),m(b,["generatedVideos"],a)}let d=n(a,["raiMediaFilteredCount"]);null!=d&&m(b,["raiMediaFilteredCount"],d);let e=n(a,["raiMediaFilteredReasons"]);return null!=e&&m(b,["raiMediaFilteredReasons"],e),b}(h)),c=b}return Object.assign(d,c),d}}class C{}class D{}class E{}class F{}class G{}class H{}class I{}class J{get text(){var a,b,c;let d="",e=!1,f=[];for(let g of null!=(c=null==(b=null==(a=this.serverContent)?void 0:a.modelTurn)?void 0:b.parts)?c:[]){for(let[a,b]of Object.entries(g))"text"!==a&&"thought"!==a&&null!==b&&f.push(a);if("string"==typeof g.text){if("boolean"==typeof g.thought&&g.thought)continue;e=!0,d+=g.text}}return f.length>0&&console.warn(`there are non-text parts ${f} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),e?d:void 0}get data(){var a,b,c;let d="",e=[];for(let f of null!=(c=null==(b=null==(a=this.serverContent)?void 0:a.modelTurn)?void 0:b.parts)?c:[]){for(let[a,b]of Object.entries(f))"inlineData"!==a&&null!==b&&e.push(a);f.inlineData&&"string"==typeof f.inlineData.data&&(d+=atob(f.inlineData.data))}return e.length>0&&console.warn(`there are non-data parts ${e} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}}class K{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}function L(a,b){if(!b||"string"!=typeof b)throw Error("model is required and must be a string");if(a.isVertexAI())if(b.startsWith("publishers/")||b.startsWith("projects/")||b.startsWith("models/"))return b;else{if(!(b.indexOf("/")>=0))return`publishers/google/models/${b}`;let a=b.split("/",2);return`publishers/${a[0]}/models/${a[1]}`}return b.startsWith("models/")||b.startsWith("tunedModels/")?b:`models/${b}`}function M(a,b){let c=L(a,b);return c?c.startsWith("publishers/")&&a.isVertexAI()?`projects/${a.getProject()}/locations/${a.getLocation()}/${c}`:c.startsWith("models/")&&a.isVertexAI()?`projects/${a.getProject()}/locations/${a.getLocation()}/publishers/google/${c}`:c:""}function N(a){return Array.isArray(a)?a.map(a=>O(a)):[O(a)]}function O(a){if("object"==typeof a&&null!==a)return a;throw Error(`Could not parse input as Blob. Unsupported blob type: ${typeof a}`)}function P(a){let b=O(a);if(b.mimeType&&b.mimeType.startsWith("image/"))return b;throw Error(`Unsupported mime type: ${b.mimeType}`)}function Q(a){let b=O(a);if(b.mimeType&&b.mimeType.startsWith("audio/"))return b;throw Error(`Unsupported mime type: ${b.mimeType}`)}function R(a){if(null==a)throw Error("PartUnion is required");if("object"==typeof a)return a;if("string"==typeof a)return{text:a};throw Error(`Unsupported part type: ${typeof a}`)}function S(a){if(null==a||Array.isArray(a)&&0===a.length)throw Error("PartListUnion is required");return Array.isArray(a)?a.map(a=>R(a)):[R(a)]}function T(a){return null!=a&&"object"==typeof a&&"parts"in a&&Array.isArray(a.parts)}function U(a){return null!=a&&"object"==typeof a&&"functionCall"in a}function V(a){return null!=a&&"object"==typeof a&&"functionResponse"in a}function W(a){if(null==a)throw Error("ContentUnion is required");return T(a)?a:{role:"user",parts:S(a)}}function X(a,b){if(!b)return[];if(a.isVertexAI()&&Array.isArray(b))return b.flatMap(a=>{let b=W(a);return b.parts&&b.parts.length>0&&void 0!==b.parts[0].text?[b.parts[0].text]:[]});if(a.isVertexAI()){let a=W(b);return a.parts&&a.parts.length>0&&void 0!==a.parts[0].text?[a.parts[0].text]:[]}return Array.isArray(b)?b.map(a=>W(a)):[W(b)]}function Y(a){if(null==a||Array.isArray(a)&&0===a.length)throw Error("contents are required");if(!Array.isArray(a)){if(U(a)||V(a))throw Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[W(a)]}let b=[],c=[],d=T(a[0]);for(let e of a){let a=T(e);if(a!=d)throw Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)b.push(e);else if(U(e)||V(e))throw Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");else c.push(e)}return d||b.push({role:"user",parts:S(c)}),b}function Z(a){let b={},c=["items"],d=["anyOf"],e=["properties"];if(a.type&&a.anyOf)throw Error("type and anyOf cannot be both populated.");let f=a.anyOf;for(let[g,h]of(null!=f&&2==f.length&&("null"===f[0].type?(b.nullable=!0,a=f[1]):"null"===f[1].type&&(b.nullable=!0,a=f[0])),a.type instanceof Array&&function(a,b){a.includes("null")&&(b.nullable=!0);let c=a.filter(a=>"null"!==a);if(1===c.length)b.type=Object.values(co).includes(c[0].toUpperCase())?c[0].toUpperCase():co.TYPE_UNSPECIFIED;else for(let a of(b.anyOf=[],c))b.anyOf.push({type:Object.values(co).includes(a.toUpperCase())?a.toUpperCase():co.TYPE_UNSPECIFIED})}(a.type,b),Object.entries(a)))if(null!=h)if("type"==g){if("null"===h)throw Error("type: null can not be the only possible type for the field.");if(h instanceof Array)continue;b.type=Object.values(co).includes(h.toUpperCase())?h.toUpperCase():co.TYPE_UNSPECIFIED}else if(c.includes(g))b[g]=Z(h);else if(d.includes(g)){let a=[];for(let c of h){if("null"==c.type){b.nullable=!0;continue}a.push(Z(c))}b[g]=a}else if(e.includes(g)){let a={};for(let[b,c]of Object.entries(h))a[b]=Z(c);b[g]=a}else{if("additionalProperties"===g)continue;b[g]=h}return b}function $(a){if("object"==typeof a)return a;if("string"==typeof a)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:a}}};throw Error(`Unsupported speechConfig type: ${typeof a}`)}function _(a){if("multiSpeakerVoiceConfig"in a)throw Error("multiSpeakerVoiceConfig is not supported in the live API.");return a}function aa(a){if(a.functionDeclarations)for(let b of a.functionDeclarations)b.parameters&&(Object.keys(b.parameters).includes("$schema")?b.parametersJsonSchema||(b.parametersJsonSchema=b.parameters,delete b.parameters):b.parameters=Z(b.parameters)),b.response&&(Object.keys(b.response).includes("$schema")?b.responseJsonSchema||(b.responseJsonSchema=b.response,delete b.response):b.response=Z(b.response));return a}function ab(a){if(null==a)throw Error("tools is required");if(!Array.isArray(a))throw Error("tools is required and must be an array of Tools");let b=[];for(let c of a)b.push(c);return b}function ac(a,b){if("string"!=typeof b)throw Error("name must be a string");return function(a,b,c,d=1){let e=!b.startsWith(`${c}/`)&&b.split("/").length===d;if(a.isVertexAI())if(b.startsWith("projects/"))return b;else if(b.startsWith("locations/"))return`projects/${a.getProject()}/${b}`;else if(b.startsWith(`${c}/`))return`projects/${a.getProject()}/locations/${a.getLocation()}/${b}`;else if(e)return`projects/${a.getProject()}/locations/${a.getLocation()}/${c}/${b}`;else return b;return e?`${c}/${b}`:b}(a,b,"cachedContents")}function ad(a){switch(a){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return a}}function ae(a){return null!=a&&"object"==typeof a&&"video"in a}function af(a){return null!=a&&"object"==typeof a&&"uri"in a}function ag(a){var b;let c;if(null!=a&&"object"==typeof a&&"name"in a&&(c=a.name),!af(a)||void 0!==(c=a.uri)){if(!ae(a)||void 0!==(c=null==(b=a.video)?void 0:b.uri)){if("string"==typeof a&&(c=a),void 0===c)throw Error("Could not extract file name from the provided input.");if(c.startsWith("https://")){let a=c.split("files/")[1].match(/[a-z0-9]+/);if(null===a)throw Error(`Could not extract file name from URI ${c}`);c=a[0]}else c.startsWith("files/")&&(c=c.split("files/")[1]);return c}}}function ah(a,b){return a.isVertexAI()?b?"publishers/google/models":"models":b?"models":"tunedModels"}function ai(a){for(let d of["models","tunedModels","publisherModels"]){var b,c;if(b=a,c=d,null!==b&&"object"==typeof b&&c in b)return a[d]}return[]}function aj(a,b){let c;if("string"==typeof b)if(a.isVertexAI())if(b.startsWith("gs://"))c={format:"jsonl",gcsUri:[b]};else if(b.startsWith("bq://"))c={format:"bigquery",bigqueryUri:b};else throw Error(`Unsupported string source for Vertex AI: ${b}`);else if(b.startsWith("files/"))c={fileName:b};else throw Error(`Unsupported string source for Gemini API: ${b}`);else if(Array.isArray(b)){if(a.isVertexAI())throw Error("InlinedRequest[] is not supported in Vertex AI.");c={inlinedRequests:b}}else c=b;let d=[c.gcsUri,c.bigqueryUri].filter(Boolean).length,e=[c.inlinedRequests,c.fileName].filter(Boolean).length;if(a.isVertexAI()){if(e>0||1!==d)throw Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(d>0||1!==e)throw Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return c}function ak(a){if("object"!=typeof a||null===a)return{};let b=a.inlinedResponses;if("object"!=typeof b||null===b)return a;let c=b.inlinedResponses;if(!Array.isArray(c)||0===c.length)return a;let d=!1;for(let a of c){if("object"!=typeof a||null===a)continue;let b=a.response;if("object"==typeof b&&null!==b&&void 0!==b.embedding){d=!0;break}}return d&&(a.inlinedEmbedContentResponses=a.inlinedResponses,delete a.inlinedResponses),a}function al(a,b){if(!a.isVertexAI()){if(/batches\/[^/]+$/.test(b))return b.split("/").pop();throw Error(`Invalid batch job name: ${b}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(b))return b.split("/").pop();if(/^\d+$/.test(b))return b;throw Error(`Invalid batch job name: ${b}.`)}function am(a){if("BATCH_STATE_UNSPECIFIED"===a)return"JOB_STATE_UNSPECIFIED";if("BATCH_STATE_PENDING"===a)return"JOB_STATE_PENDING";if("BATCH_STATE_RUNNING"===a)return"JOB_STATE_RUNNING";if("BATCH_STATE_SUCCEEDED"===a)return"JOB_STATE_SUCCEEDED";if("BATCH_STATE_FAILED"===a)return"JOB_STATE_FAILED";else if("BATCH_STATE_CANCELLED"===a)return"JOB_STATE_CANCELLED";else if("BATCH_STATE_EXPIRED"===a)return"JOB_STATE_EXPIRED";else return a}function an(a){let b={},c=n(a,["name"]);null!=c&&m(b,["name"],c);let d=n(a,["metadata","displayName"]);null!=d&&m(b,["displayName"],d);let e=n(a,["metadata","state"]);null!=e&&m(b,["state"],am(e));let f=n(a,["metadata","createTime"]);null!=f&&m(b,["createTime"],f);let g=n(a,["metadata","endTime"]);null!=g&&m(b,["endTime"],g);let h=n(a,["metadata","updateTime"]);null!=h&&m(b,["updateTime"],h);let i=n(a,["metadata","model"]);null!=i&&m(b,["model"],i);let j=n(a,["metadata","output"]);return null!=j&&m(b,["dest"],function(a){let b={},c=n(a,["responsesFile"]);null!=c&&m(b,["fileName"],c);let d=n(a,["inlinedResponses","inlinedResponses"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e;return c={},null!=(d=n(b=a,["response"]))&&m(c,["response"],function(a){let b={},c=n(a,["sdkHttpResponse"]);null!=c&&m(b,["sdkHttpResponse"],c);let d=n(a,["candidates"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=n(a,["content"]);null!=c&&m(b,["content"],c);let d=n(a,["citationMetadata"]);null!=d&&m(b,["citationMetadata"],function(a){let b={},c=n(a,["citationSources"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),m(b,["citations"],a)}return b}(d));let e=n(a,["tokenCount"]);null!=e&&m(b,["tokenCount"],e);let f=n(a,["finishReason"]);null!=f&&m(b,["finishReason"],f);let g=n(a,["urlContextMetadata"]);null!=g&&m(b,["urlContextMetadata"],g);let h=n(a,["avgLogprobs"]);null!=h&&m(b,["avgLogprobs"],h);let i=n(a,["groundingMetadata"]);null!=i&&m(b,["groundingMetadata"],i);let j=n(a,["index"]);null!=j&&m(b,["index"],j);let k=n(a,["logprobsResult"]);null!=k&&m(b,["logprobsResult"],k);let l=n(a,["safetyRatings"]);if(null!=l){let a=l;Array.isArray(a)&&(a=a.map(a=>a)),m(b,["safetyRatings"],a)}return b})(a))),m(b,["candidates"],a)}let e=n(a,["modelVersion"]);null!=e&&m(b,["modelVersion"],e);let f=n(a,["promptFeedback"]);null!=f&&m(b,["promptFeedback"],f);let g=n(a,["responseId"]);null!=g&&m(b,["responseId"],g);let h=n(a,["usageMetadata"]);return null!=h&&m(b,["usageMetadata"],h),b}(d)),null!=(e=n(b,["error"]))&&m(c,["error"],e),c})),m(b,["inlinedResponses"],a)}let e=n(a,["inlinedEmbedContentResponses","inlinedResponses"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>a)),m(b,["inlinedEmbedContentResponses"],a)}return b}(ak(j))),b}function ao(a){var b,c;let d,e,f,g,h,i,j,k,l={},o=n(a,["name"]);null!=o&&m(l,["name"],o);let p=n(a,["displayName"]);null!=p&&m(l,["displayName"],p);let q=n(a,["state"]);null!=q&&m(l,["state"],am(q));let r=n(a,["error"]);null!=r&&m(l,["error"],r);let s=n(a,["createTime"]);null!=s&&m(l,["createTime"],s);let t=n(a,["startTime"]);null!=t&&m(l,["startTime"],t);let u=n(a,["endTime"]);null!=u&&m(l,["endTime"],u);let v=n(a,["updateTime"]);null!=v&&m(l,["updateTime"],v);let w=n(a,["model"]);null!=w&&m(l,["model"],w);let x=n(a,["inputConfig"]);null!=x&&m(l,["src"],(d={},null!=(e=n(c=x,["instancesFormat"]))&&m(d,["format"],e),null!=(f=n(c,["gcsSource","uris"]))&&m(d,["gcsUri"],f),null!=(g=n(c,["bigquerySource","inputUri"]))&&m(d,["bigqueryUri"],g),d));let y=n(a,["outputConfig"]);return null!=y&&m(l,["dest"],(b=ak(y),h={},null!=(i=n(b,["predictionsFormat"]))&&m(h,["format"],i),null!=(j=n(b,["gcsDestination","outputUriPrefix"]))&&m(h,["gcsUri"],j),null!=(k=n(b,["bigqueryDestination","outputUri"]))&&m(h,["bigqueryUri"],k),h)),l}function ap(a){let b={},c=n(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e,f,g,h,i,j,k,l,o;return c={},null!=(d=n(b=a,["videoMetadata"]))&&m(c,["videoMetadata"],d),null!=(e=n(b,["thought"]))&&m(c,["thought"],e),null!=(f=n(b,["inlineData"]))&&m(c,["inlineData"],function(a){let b={};if(void 0!==n(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=n(a,["data"]);null!=c&&m(b,["data"],c);let d=n(a,["mimeType"]);return null!=d&&m(b,["mimeType"],d),b}(f)),null!=(g=n(b,["fileData"]))&&m(c,["fileData"],function(a){let b={};if(void 0!==n(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=n(a,["fileUri"]);null!=c&&m(b,["fileUri"],c);let d=n(a,["mimeType"]);return null!=d&&m(b,["mimeType"],d),b}(g)),null!=(h=n(b,["thoughtSignature"]))&&m(c,["thoughtSignature"],h),null!=(i=n(b,["functionCall"]))&&m(c,["functionCall"],i),null!=(j=n(b,["codeExecutionResult"]))&&m(c,["codeExecutionResult"],j),null!=(k=n(b,["executableCode"]))&&m(c,["executableCode"],k),null!=(l=n(b,["functionResponse"]))&&m(c,["functionResponse"],l),null!=(o=n(b,["text"]))&&m(c,["text"],o),c})),m(b,["parts"],a)}let d=n(a,["role"]);return null!=d&&m(b,["role"],d),b}function aq(a,b){let c={},d=n(b,["model"]);null!=d&&m(c,["_url","model"],L(a,d));let e=n(b,["src"]);null!=e&&m(c,["batch","inputConfig"],function(a,b){let c={};if(void 0!==n(b,["format"]))throw Error("format parameter is not supported in Gemini API.");if(void 0!==n(b,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==n(b,["bigqueryUri"]))throw Error("bigqueryUri parameter is not supported in Gemini API.");let d=n(b,["fileName"]);null!=d&&m(c,["fileName"],d);let e=n(b,["inlinedRequests"]);if(null!=e){let b=e;Array.isArray(b)&&(b=b.map(b=>(function(a,b){let c={},d=n(b,["model"]);null!=d&&m(c,["request","model"],L(a,d));let e=n(b,["contents"]);if(null!=e){let a=Y(e);Array.isArray(a)&&(a=a.map(a=>ap(a))),m(c,["request","contents"],a)}let f=n(b,["metadata"]);null!=f&&m(c,["metadata"],f);let g=n(b,["config"]);return null!=g&&m(c,["request","generationConfig"],function(a,b,c){let d={},e=n(b,["systemInstruction"]);void 0!==c&&null!=e&&m(c,["systemInstruction"],ap(W(e)));let f=n(b,["temperature"]);null!=f&&m(d,["temperature"],f);let g=n(b,["topP"]);null!=g&&m(d,["topP"],g);let h=n(b,["topK"]);null!=h&&m(d,["topK"],h);let i=n(b,["candidateCount"]);null!=i&&m(d,["candidateCount"],i);let j=n(b,["maxOutputTokens"]);null!=j&&m(d,["maxOutputTokens"],j);let k=n(b,["stopSequences"]);null!=k&&m(d,["stopSequences"],k);let l=n(b,["responseLogprobs"]);null!=l&&m(d,["responseLogprobs"],l);let o=n(b,["logprobs"]);null!=o&&m(d,["logprobs"],o);let p=n(b,["presencePenalty"]);null!=p&&m(d,["presencePenalty"],p);let q=n(b,["frequencyPenalty"]);null!=q&&m(d,["frequencyPenalty"],q);let r=n(b,["seed"]);null!=r&&m(d,["seed"],r);let s=n(b,["responseMimeType"]);null!=s&&m(d,["responseMimeType"],s);let t=n(b,["responseSchema"]);null!=t&&m(d,["responseSchema"],Z(t));let u=n(b,["responseJsonSchema"]);if(null!=u&&m(d,["responseJsonSchema"],u),void 0!==n(b,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==n(b,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let v=n(b,["safetySettings"]);if(void 0!==c&&null!=v){let a=v;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={};if(void 0!==n(a,["method"]))throw Error("method parameter is not supported in Gemini API.");let c=n(a,["category"]);null!=c&&m(b,["category"],c);let d=n(a,["threshold"]);return null!=d&&m(b,["threshold"],d),b})(a))),m(c,["safetySettings"],a)}let w=n(b,["tools"]);if(void 0!==c&&null!=w){let a=ab(w);Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=n(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),m(b,["functionDeclarations"],a)}if(void 0!==n(a,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let d=n(a,["googleSearch"]);null!=d&&m(b,["googleSearch"],function(a){let b={},c=n(a,["timeRangeFilter"]);if(null!=c&&m(b,["timeRangeFilter"],c),void 0!==n(a,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return b}(d));let e=n(a,["googleSearchRetrieval"]);if(null!=e&&m(b,["googleSearchRetrieval"],e),void 0!==n(a,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let f=n(a,["googleMaps"]);null!=f&&m(b,["googleMaps"],function(a){let b={};if(void 0!==n(a,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let c=n(a,["enableWidget"]);return null!=c&&m(b,["enableWidget"],c),b}(f));let g=n(a,["urlContext"]);null!=g&&m(b,["urlContext"],g);let h=n(a,["computerUse"]);null!=h&&m(b,["computerUse"],h);let i=n(a,["codeExecution"]);return null!=i&&m(b,["codeExecution"],i),b})(aa(a)))),m(c,["tools"],a)}let x=n(b,["toolConfig"]);if(void 0!==c&&null!=x&&m(c,["toolConfig"],x),void 0!==n(b,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let y=n(b,["cachedContent"]);void 0!==c&&null!=y&&m(c,["cachedContent"],ac(a,y));let z=n(b,["responseModalities"]);null!=z&&m(d,["responseModalities"],z);let A=n(b,["mediaResolution"]);null!=A&&m(d,["mediaResolution"],A);let B=n(b,["speechConfig"]);if(null!=B&&m(d,["speechConfig"],$(B)),void 0!==n(b,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let C=n(b,["thinkingConfig"]);null!=C&&m(d,["thinkingConfig"],C);let D=n(b,["imageConfig"]);return null!=D&&m(d,["imageConfig"],D),d}(a,g,n(c,["request"],{}))),c})(a,b))),m(c,["requests","requests"],b)}return c}(a,aj(a,e)));let f=n(b,["config"]);return null!=f&&function(a,b){let c=n(a,["displayName"]);if(void 0!==b&&null!=c&&m(b,["batch","displayName"],c),void 0!==n(a,["dest"]))throw Error("dest parameter is not supported in Gemini API.")}(f,c),c}(ck=c6||(c6={})).PAGED_ITEM_BATCH_JOBS="batchJobs",ck.PAGED_ITEM_MODELS="models",ck.PAGED_ITEM_TUNING_JOBS="tuningJobs",ck.PAGED_ITEM_FILES="files",ck.PAGED_ITEM_CACHED_CONTENTS="cachedContents";class ar{constructor(a,b,c,d){this.pageInternal=[],this.paramsInternal={},this.requestInternal=b,this.init(a,c,d)}init(a,b,c){var d,e;this.nameInternal=a,this.pageInternal=b[this.nameInternal]||[],this.sdkHttpResponseInternal=null==b?void 0:b.sdkHttpResponse,this.idxInternal=0;let f={config:{}};(f=c&&0!==Object.keys(c).length?"object"==typeof c?Object.assign({},c):c:{config:{}}).config&&(f.config.pageToken=b.nextPageToken),this.paramsInternal=f,this.pageInternalSize=null!=(e=null==(d=f.config)?void 0:d.pageSize)?e:this.pageInternal.length}initNextPage(a){this.init(this.nameInternal,a,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(a){return this.pageInternal[a]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(!this.hasNextPage())return{value:void 0,done:!0};else await this.nextPage();let a=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:a,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw Error("No more pages to fetch.");let a=await this.requestInternal(this.params);return this.initNextPage(a),this.page}hasNextPage(){var a;return(null==(a=this.params.config)?void 0:a.pageToken)!==void 0}}class as extends k{constructor(a){super(),this.apiClient=a,this.create=async a=>(this.apiClient.isVertexAI()&&(a.config=this.formatDestination(a.src,a.config)),this.createInternal(a)),this.createEmbeddings=async a=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(a)},this.list=async(a={})=>new ar(c6.PAGED_ITEM_BATCH_JOBS,a=>this.listInternal(a),await this.listInternal(a),a)}createInlinedGenerateContentRequest(a){let b=aq(this.apiClient,a),c=l("{model}:batchGenerateContent",b._url),d=b.batch.inputConfig.requests,e=d.requests,f=[];for(let a of e){let b=Object.assign({},a);if(b.systemInstruction){let a=b.systemInstruction;delete b.systemInstruction;let c=b.request;c.systemInstruction=a,b.request=c}f.push(b)}return d.requests=f,delete b.config,delete b._url,delete b._query,{path:c,body:b}}getGcsUri(a){return"string"==typeof a?a.startsWith("gs://")?a:void 0:!Array.isArray(a)&&a.gcsUri&&a.gcsUri.length>0?a.gcsUri[0]:void 0}getBigqueryUri(a){return"string"==typeof a?a.startsWith("bq://")?a:void 0:Array.isArray(a)?void 0:a.bigqueryUri}formatDestination(a,b){let c=b?Object.assign({},b):{},d=Date.now().toString();if(c.displayName||(c.displayName=`genaiBatchJob_${d}`),void 0===c.dest){let b=this.getGcsUri(a),e=this.getBigqueryUri(a);if(b)b.endsWith(".jsonl")?c.dest=`${b.slice(0,-6)}/dest`:c.dest=`${b}_dest_${d}`;else if(e)c.dest=`${e}_dest_${d}`;else throw Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return c}async createInternal(a){var b,c,d,e,f;let g="",h={};if(this.apiClient.isVertexAI()){let d,e,i,j,k,o,p=(f=this.apiClient,d={},null!=(e=n(a,["model"]))&&m(d,["model"],L(f,e)),null!=(i=n(a,["src"]))&&m(d,["inputConfig"],function(a){let b={},c=n(a,["format"]);null!=c&&m(b,["instancesFormat"],c);let d=n(a,["gcsUri"]);null!=d&&m(b,["gcsSource","uris"],d);let e=n(a,["bigqueryUri"]);if(null!=e&&m(b,["bigquerySource","inputUri"],e),void 0!==n(a,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==n(a,["inlinedRequests"]))throw Error("inlinedRequests parameter is not supported in Vertex AI.");return b}(aj(f,i))),null!=(j=n(a,["config"]))&&(k=n(j,["displayName"]),void 0!==d&&null!=k&&m(d,["displayName"],k),o=n(j,["dest"]),void 0!==d&&null!=o&&m(d,["outputConfig"],function(a){let b={},c=n(a,["format"]);null!=c&&m(b,["predictionsFormat"],c);let d=n(a,["gcsUri"]);null!=d&&m(b,["gcsDestination","outputUriPrefix"],d);let e=n(a,["bigqueryUri"]);if(null!=e&&m(b,["bigqueryDestination","outputUri"],e),void 0!==n(a,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==n(a,["inlinedResponses"]))throw Error("inlinedResponses parameter is not supported in Vertex AI.");if(void 0!==n(a,["inlinedEmbedContentResponses"]))throw Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return b}(function(a){if("string"!=typeof a)return a;if(a.startsWith("gs://"))return{format:"jsonl",gcsUri:a};if(a.startsWith("bq://"))return{format:"bigquery",bigqueryUri:a};throw Error(`Unsupported destination: ${a}`)}(o)))),d);return g=l("batchPredictionJobs",p._url),h=p._query,delete p._url,delete p._query,this.apiClient.request({path:g,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>ao(a))}{let b=aq(this.apiClient,a);return g=l("{model}:batchGenerateContent",b._url),h=b._query,delete b._url,delete b._query,this.apiClient.request({path:g,queryParams:h,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>an(a))}}async createEmbeddingsInternal(a){var b,c,d,e,f;let g="",h={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let i,j,k,o,p,q,r,s,t=(d=this.apiClient,o={},null!=(p=n(a,["model"]))&&m(o,["_url","model"],L(d,p)),null!=(q=n(a,["src"]))&&m(o,["batch","inputConfig"],(e=d,i={},null!=(j=n(f=q,["fileName"]))&&m(i,["file_name"],j),null!=(k=n(f,["inlinedRequests"]))&&m(i,["requests"],function(a,b){let c={},d=n(b,["contents"]);if(null!=d){let b=X(a,d);Array.isArray(b)&&(b=b.map(a=>a)),m(c,["requests[]","request","content"],b)}let e=n(b,["config"]);return null!=e&&(m(c,["_self"],function(a,b){let c=n(a,["taskType"]);void 0!==b&&null!=c&&m(b,["requests[]","taskType"],c);let d=n(a,["title"]);void 0!==b&&null!=d&&m(b,["requests[]","title"],d);let e=n(a,["outputDimensionality"]);if(void 0!==b&&null!=e&&m(b,["requests[]","outputDimensionality"],e),void 0!==n(a,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==n(a,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.");return{}}(e,c)),!function(a,b){for(let[c,d]of Object.entries(b)){let b=c.split("."),e=d.split("."),f=new Set,g=-1;for(let a=0;a<b.length;a++)if("*"===b[a]){g=a;break}if(-1!==g&&e.length>g)for(let a=g;a<e.length;a++){let b=e[a];"*"===b||b.endsWith("[]")||b.endsWith("[0]")||f.add(b)}!function a(b,c,d,e,f){if(e>=c.length||"object"!=typeof b||null===b)return;let g=c[e];if(g.endsWith("[]")){let h=g.slice(0,-2);if(h in b&&Array.isArray(b[h]))for(let g of b[h])a(g,c,d,e+1,f)}else if("*"===g){if("object"==typeof b&&null!==b&&!Array.isArray(b)){let a=Object.keys(b).filter(a=>!a.startsWith("_")&&!f.has(a)),c={};for(let d of a)c[d]=b[d];for(let[a,f]of Object.entries(c)){let c=[];for(let b of d.slice(e))"*"===b?c.push(a):c.push(b);m(b,c,f)}for(let c of a)delete b[c]}}else g in b&&a(b[g],c,d,e+1,f)}(a,b,e,0,f)}}(c,{"requests[].*":"requests[].request.*"})),c}(e,k)),i)),null!=(r=n(a,["config"]))&&(s=n(r,["displayName"]),void 0!==o&&null!=s&&m(o,["batch","displayName"],s)),o);return g=l("{model}:asyncBatchEmbedContent",t._url),h=t._query,delete t._url,delete t._query,this.apiClient.request({path:g,queryParams:h,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>an(a))}}async get(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g=(f=this.apiClient,d={},null!=(e=n(a,["name"]))&&m(d,["_url","name"],al(f,e)),d);return h=l("batchPredictionJobs/{name}",g._url),i=g._query,delete g._url,delete g._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(g),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>ao(a))}{let b,c,f=(g=this.apiClient,b={},null!=(c=n(a,["name"]))&&m(b,["_url","name"],al(g,c)),b);return h=l("batches/{name}",f._url),i=f._query,delete f._url,delete f._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(f),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>an(a))}}async cancel(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g=(f=this.apiClient,d={},null!=(e=n(a,["name"]))&&m(d,["_url","name"],al(f,e)),d);h=l("batchPredictionJobs/{name}:cancel",g._url),i=g._query,delete g._url,delete g._query,await this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(g),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal})}else{let b,c,f=(g=this.apiClient,b={},null!=(c=n(a,["name"]))&&m(b,["_url","name"],al(g,c)),b);h=l("batches/{name}:cancel",f._url),i=f._query,delete f._url,delete f._query,await this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal})}}async listInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d,e,h,i,j,k=(d={},null!=(e=n(a,["config"]))&&(h=n(e,["pageSize"]),void 0!==d&&null!=h&&m(d,["_query","pageSize"],h),i=n(e,["pageToken"]),void 0!==d&&null!=i&&m(d,["_query","pageToken"],i),j=n(e,["filter"]),void 0!==d&&null!=j&&m(d,["_query","filter"],j)),d);return f=l("batchPredictionJobs",k._url),g=k._query,delete k._url,delete k._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(k),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=n(a,["sdkHttpResponse"]);null!=c&&m(b,["sdkHttpResponse"],c);let d=n(a,["nextPageToken"]);null!=d&&m(b,["nextPageToken"],d);let e=n(a,["batchPredictionJobs"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>ao(a))),m(b,["batchJobs"],a)}return b}(a),c=new I;return Object.assign(c,b),c})}{let b,c,h=(b={},null!=(c=n(a,["config"]))&&function(a,b){let c=n(a,["pageSize"]);void 0!==b&&null!=c&&m(b,["_query","pageSize"],c);let d=n(a,["pageToken"]);if(void 0!==b&&null!=d&&m(b,["_query","pageToken"],d),void 0!==n(a,["filter"]))throw Error("filter parameter is not supported in Gemini API.")}(c,b),b);return f=l("batches",h._url),g=h._query,delete h._url,delete h._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=n(a,["sdkHttpResponse"]);null!=c&&m(b,["sdkHttpResponse"],c);let d=n(a,["nextPageToken"]);null!=d&&m(b,["nextPageToken"],d);let e=n(a,["operations"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>an(a))),m(b,["batchJobs"],a)}return b}(a),c=new I;return Object.assign(c,b),c})}}async delete(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g=(f=this.apiClient,d={},null!=(e=n(a,["name"]))&&m(d,["_url","name"],al(f,e)),d);return h=l("batchPredictionJobs/{name}",g._url),i=g._query,delete g._url,delete g._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(g),httpMethod:"DELETE",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b,c,d,e,f;return b={},null!=(c=n(a,["sdkHttpResponse"]))&&m(b,["sdkHttpResponse"],c),null!=(d=n(a,["name"]))&&m(b,["name"],d),null!=(e=n(a,["done"]))&&m(b,["done"],e),null!=(f=n(a,["error"]))&&m(b,["error"],f),b})}{let b,c,f=(g=this.apiClient,b={},null!=(c=n(a,["name"]))&&m(b,["_url","name"],al(g,c)),b);return h=l("batches/{name}",f._url),i=f._query,delete f._url,delete f._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b,c,d,e,f;return b={},null!=(c=n(a,["sdkHttpResponse"]))&&m(b,["sdkHttpResponse"],c),null!=(d=n(a,["name"]))&&m(b,["name"],d),null!=(e=n(a,["done"]))&&m(b,["done"],e),null!=(f=n(a,["error"]))&&m(b,["error"],f),b})}}}function at(a){let b={},c=n(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e,f,g,h,i,j,k,l,o;return c={},null!=(d=n(b=a,["videoMetadata"]))&&m(c,["videoMetadata"],d),null!=(e=n(b,["thought"]))&&m(c,["thought"],e),null!=(f=n(b,["inlineData"]))&&m(c,["inlineData"],function(a){let b={};if(void 0!==n(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=n(a,["data"]);null!=c&&m(b,["data"],c);let d=n(a,["mimeType"]);return null!=d&&m(b,["mimeType"],d),b}(f)),null!=(g=n(b,["fileData"]))&&m(c,["fileData"],function(a){let b={};if(void 0!==n(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=n(a,["fileUri"]);null!=c&&m(b,["fileUri"],c);let d=n(a,["mimeType"]);return null!=d&&m(b,["mimeType"],d),b}(g)),null!=(h=n(b,["thoughtSignature"]))&&m(c,["thoughtSignature"],h),null!=(i=n(b,["functionCall"]))&&m(c,["functionCall"],i),null!=(j=n(b,["codeExecutionResult"]))&&m(c,["codeExecutionResult"],j),null!=(k=n(b,["executableCode"]))&&m(c,["executableCode"],k),null!=(l=n(b,["functionResponse"]))&&m(c,["functionResponse"],l),null!=(o=n(b,["text"]))&&m(c,["text"],o),c})),m(b,["parts"],a)}let d=n(a,["role"]);return null!=d&&m(b,["role"],d),b}class au extends k{constructor(a){super(),this.apiClient=a,this.list=async(a={})=>new ar(c6.PAGED_ITEM_CACHED_CONTENTS,a=>this.listInternal(a),await this.listInternal(a),a)}async create(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g,j=(f=this.apiClient,d={},null!=(e=n(a,["model"]))&&m(d,["model"],M(f,e)),null!=(g=n(a,["config"]))&&function(a,b){let c=n(a,["ttl"]);void 0!==b&&null!=c&&m(b,["ttl"],c);let d=n(a,["expireTime"]);void 0!==b&&null!=d&&m(b,["expireTime"],d);let e=n(a,["displayName"]);void 0!==b&&null!=e&&m(b,["displayName"],e);let f=n(a,["contents"]);if(void 0!==b&&null!=f){let a=Y(f);Array.isArray(a)&&(a=a.map(a=>a)),m(b,["contents"],a)}let g=n(a,["systemInstruction"]);void 0!==b&&null!=g&&m(b,["systemInstruction"],W(g));let h=n(a,["tools"]);if(void 0!==b&&null!=h){let a=h;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=n(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={};if(void 0!==n(a,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let c=n(a,["description"]);null!=c&&m(b,["description"],c);let d=n(a,["name"]);null!=d&&m(b,["name"],d);let e=n(a,["parameters"]);null!=e&&m(b,["parameters"],e);let f=n(a,["parametersJsonSchema"]);null!=f&&m(b,["parametersJsonSchema"],f);let g=n(a,["response"]);null!=g&&m(b,["response"],g);let h=n(a,["responseJsonSchema"]);return null!=h&&m(b,["responseJsonSchema"],h),b})(a))),m(b,["functionDeclarations"],a)}let d=n(a,["retrieval"]);null!=d&&m(b,["retrieval"],d);let e=n(a,["googleSearch"]);null!=e&&m(b,["googleSearch"],e);let f=n(a,["googleSearchRetrieval"]);null!=f&&m(b,["googleSearchRetrieval"],f);let g=n(a,["enterpriseWebSearch"]);null!=g&&m(b,["enterpriseWebSearch"],g);let h=n(a,["googleMaps"]);null!=h&&m(b,["googleMaps"],h);let i=n(a,["urlContext"]);null!=i&&m(b,["urlContext"],i);let j=n(a,["computerUse"]);null!=j&&m(b,["computerUse"],j);let k=n(a,["codeExecution"]);return null!=k&&m(b,["codeExecution"],k),b})(a))),m(b,["tools"],a)}let i=n(a,["toolConfig"]);void 0!==b&&null!=i&&m(b,["toolConfig"],i);let j=n(a,["kmsKeyName"]);void 0!==b&&null!=j&&m(b,["encryption_spec","kmsKeyName"],j)}(g,d),d);return h=l("cachedContents",j._url),i=j._query,delete j._url,delete j._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(j),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a)}{let b,c,f,j=(g=this.apiClient,b={},null!=(c=n(a,["model"]))&&m(b,["model"],M(g,c)),null!=(f=n(a,["config"]))&&function(a,b){let c=n(a,["ttl"]);void 0!==b&&null!=c&&m(b,["ttl"],c);let d=n(a,["expireTime"]);void 0!==b&&null!=d&&m(b,["expireTime"],d);let e=n(a,["displayName"]);void 0!==b&&null!=e&&m(b,["displayName"],e);let f=n(a,["contents"]);if(void 0!==b&&null!=f){let a=Y(f);Array.isArray(a)&&(a=a.map(a=>at(a))),m(b,["contents"],a)}let g=n(a,["systemInstruction"]);void 0!==b&&null!=g&&m(b,["systemInstruction"],at(W(g)));let h=n(a,["tools"]);if(void 0!==b&&null!=h){let a=h;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=n(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),m(b,["functionDeclarations"],a)}if(void 0!==n(a,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let d=n(a,["googleSearch"]);null!=d&&m(b,["googleSearch"],function(a){let b={},c=n(a,["timeRangeFilter"]);if(null!=c&&m(b,["timeRangeFilter"],c),void 0!==n(a,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return b}(d));let e=n(a,["googleSearchRetrieval"]);if(null!=e&&m(b,["googleSearchRetrieval"],e),void 0!==n(a,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let f=n(a,["googleMaps"]);null!=f&&m(b,["googleMaps"],function(a){let b={};if(void 0!==n(a,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let c=n(a,["enableWidget"]);return null!=c&&m(b,["enableWidget"],c),b}(f));let g=n(a,["urlContext"]);null!=g&&m(b,["urlContext"],g);let h=n(a,["computerUse"]);null!=h&&m(b,["computerUse"],h);let i=n(a,["codeExecution"]);return null!=i&&m(b,["codeExecution"],i),b})(a))),m(b,["tools"],a)}let i=n(a,["toolConfig"]);if(void 0!==b&&null!=i&&m(b,["toolConfig"],i),void 0!==n(a,["kmsKeyName"]))throw Error("kmsKeyName parameter is not supported in Gemini API.")}(f,b),b);return h=l("cachedContents",j._url),i=j._query,delete j._url,delete j._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(j),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>a)}}async get(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g=(f=this.apiClient,d={},null!=(e=n(a,["name"]))&&m(d,["_url","name"],ac(f,e)),d);return h=l("{name}",g._url),i=g._query,delete g._url,delete g._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(g),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a)}{let b,c,f=(g=this.apiClient,b={},null!=(c=n(a,["name"]))&&m(b,["_url","name"],ac(g,c)),b);return h=l("{name}",f._url),i=f._query,delete f._url,delete f._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(f),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>a)}}async delete(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g=(f=this.apiClient,d={},null!=(e=n(a,["name"]))&&m(d,["_url","name"],ac(f,e)),d);return h=l("{name}",g._url),i=g._query,delete g._url,delete g._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(g),httpMethod:"DELETE",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b,c,d=(b={},null!=(c=n(a,["sdkHttpResponse"]))&&m(b,["sdkHttpResponse"],c),b),e=new D;return Object.assign(e,d),e})}{let b,c,f=(g=this.apiClient,b={},null!=(c=n(a,["name"]))&&m(b,["_url","name"],ac(g,c)),b);return h=l("{name}",f._url),i=f._query,delete f._url,delete f._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b,c,d=(b={},null!=(c=n(a,["sdkHttpResponse"]))&&m(b,["sdkHttpResponse"],c),b),e=new D;return Object.assign(e,d),e})}}async update(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g,j,k,o=(f=this.apiClient,d={},null!=(e=n(a,["name"]))&&m(d,["_url","name"],ac(f,e)),null!=(g=n(a,["config"]))&&(j=n(g,["ttl"]),void 0!==d&&null!=j&&m(d,["ttl"],j),k=n(g,["expireTime"]),void 0!==d&&null!=k&&m(d,["expireTime"],k)),d);return h=l("{name}",o._url),i=o._query,delete o._url,delete o._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(o),httpMethod:"PATCH",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a)}{let b,c,f,j,k,o=(g=this.apiClient,b={},null!=(c=n(a,["name"]))&&m(b,["_url","name"],ac(g,c)),null!=(f=n(a,["config"]))&&(j=n(f,["ttl"]),void 0!==b&&null!=j&&m(b,["ttl"],j),k=n(f,["expireTime"]),void 0!==b&&null!=k&&m(b,["expireTime"],k)),b);return h=l("{name}",o._url),i=o._query,delete o._url,delete o._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(o),httpMethod:"PATCH",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>a)}}async listInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d,e,h,i,j=(d={},null!=(e=n(a,["config"]))&&(h=n(e,["pageSize"]),void 0!==d&&null!=h&&m(d,["_query","pageSize"],h),i=n(e,["pageToken"]),void 0!==d&&null!=i&&m(d,["_query","pageToken"],i)),d);return f=l("cachedContents",j._url),g=j._query,delete j._url,delete j._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(j),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=n(a,["sdkHttpResponse"]);null!=c&&m(b,["sdkHttpResponse"],c);let d=n(a,["nextPageToken"]);null!=d&&m(b,["nextPageToken"],d);let e=n(a,["cachedContents"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>a)),m(b,["cachedContents"],a)}return b}(a),c=new E;return Object.assign(c,b),c})}{let b,c,h,i,j=(b={},null!=(c=n(a,["config"]))&&(h=n(c,["pageSize"]),void 0!==b&&null!=h&&m(b,["_query","pageSize"],h),i=n(c,["pageToken"]),void 0!==b&&null!=i&&m(b,["_query","pageToken"],i)),b);return f=l("cachedContents",j._url),g=j._query,delete j._url,delete j._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(j),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=n(a,["sdkHttpResponse"]);null!=c&&m(b,["sdkHttpResponse"],c);let d=n(a,["nextPageToken"]);null!=d&&m(b,["nextPageToken"],d);let e=n(a,["cachedContents"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>a)),m(b,["cachedContents"],a)}return b}(a),c=new E;return Object.assign(c,b),c})}}}function av(a){return this instanceof av?(this.v=a,this):new av(a)}function aw(a,b,c){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var d,e=c.apply(a,b||[]),f=[];return d=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),g("next"),g("throw"),g("return",function(a){return function(b){return Promise.resolve(b).then(a,j)}}),d[Symbol.asyncIterator]=function(){return this},d;function g(a,b){e[a]&&(d[a]=function(b){return new Promise(function(c,d){f.push([a,b,c,d])>1||h(a,b)})},b&&(d[a]=b(d[a])))}function h(a,b){try{var c;(c=e[a](b)).value instanceof av?Promise.resolve(c.value.v).then(i,j):k(f[0][2],c)}catch(a){k(f[0][3],a)}}function i(a){h("next",a)}function j(a){h("throw",a)}function k(a,b){a(b),f.shift(),f.length&&h(f[0][0],f[0][1])}}function ax(a){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var b,c=a[Symbol.asyncIterator];return c?c.call(a):(a=function(a){var b="function"==typeof Symbol&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&"number"==typeof a.length)return{next:function(){return a&&d>=a.length&&(a=void 0),{value:a&&a[d++],done:!a}}};throw TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")}(a),b={},d("next"),d("throw"),d("return"),b[Symbol.asyncIterator]=function(){return this},b);function d(c){b[c]=a[c]&&function(b){return new Promise(function(d,e){var f,g,h;f=d,g=e,h=(b=a[c](b)).done,Promise.resolve(b.value).then(function(a){f({value:a,done:h})},g)})}}}function ay(a){if(void 0===a.parts||0===a.parts.length)return!1;for(let b of a.parts)if(void 0===b||0===Object.keys(b).length)return!1;return!0}function az(a){if(void 0===a||0===a.length)return[];let b=[],c=a.length,d=0;for(;d<c;)if("user"===a[d].role)b.push(a[d]),d++;else{let e=[],f=!0;for(;d<c&&"model"===a[d].role;)e.push(a[d]),f&&!ay(a[d])&&(f=!1),d++;f?b.push(...e):b.pop()}return b}"function"==typeof SuppressedError&&SuppressedError;class aA{constructor(a,b){this.modelsModule=a,this.apiClient=b}create(a){return new aB(this.apiClient,this.modelsModule,a.model,a.config,structuredClone(a.history))}}class aB{constructor(a,b,c,d={},e=[]){this.apiClient=a,this.modelsModule=b,this.model=c,this.config=d,this.history=e,this.sendPromise=Promise.resolve(),function(a){if(0!==a.length){for(let b of a)if("user"!==b.role&&"model"!==b.role)throw Error(`Role must be user or model, but got ${b.role}.`)}}(e)}async sendMessage(a){var b;await this.sendPromise;let c=W(a.message),d=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(c),config:null!=(b=a.config)?b:this.config});return this.sendPromise=(async()=>{var a,b,e;let f=await d,g=null==(b=null==(a=f.candidates)?void 0:a[0])?void 0:b.content,h=f.automaticFunctionCallingHistory,i=this.getHistory(!0).length,j=[];null!=h&&(j=null!=(e=h.slice(i))?e:[]),this.recordHistory(c,g?[g]:[],j)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),d}async sendMessageStream(a){var b;await this.sendPromise;let c=W(a.message),d=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(c),config:null!=(b=a.config)?b:this.config});this.sendPromise=d.then(()=>void 0).catch(()=>void 0);let e=await d;return this.processStreamResponse(e,c)}getHistory(a=!1){return structuredClone(a?az(this.history):this.history)}processStreamResponse(a,b){var c,d;return aw(this,arguments,function*(){var e,f,g,h;let i=[];try{for(var j,k=!0,l=ax(a);!(e=(j=yield av(l.next())).done);k=!0){if(h=j.value,k=!1,function(a){var b;if(void 0==a.candidates||0===a.candidates.length)return!1;let c=null==(b=a.candidates[0])?void 0:b.content;return void 0!==c&&ay(c)}(h)){let a=null==(d=null==(c=h.candidates)?void 0:c[0])?void 0:d.content;void 0!==a&&i.push(a)}yield yield av(h)}}catch(a){f={error:a}}finally{try{!k&&!e&&(g=l.return)&&(yield av(g.call(l)))}finally{if(f)throw f.error}}this.recordHistory(b,i)})}recordHistory(a,b,c){let d=[];b.length>0&&b.every(a=>void 0!==a.role)?d=b:d.push({role:"model",parts:[]}),c&&c.length>0?this.history.push(...az(c)):this.history.push(a),this.history.push(...d)}}class aC extends Error{constructor(a){super(a.message),this.name="ApiError",this.status=a.status,Object.setPrototypeOf(this,aC.prototype)}}class aD extends k{constructor(a){super(),this.apiClient=a,this.list=async(a={})=>new ar(c6.PAGED_ITEM_FILES,a=>this.listInternal(a),await this.listInternal(a),a)}async upload(a){if(this.apiClient.isVertexAI())throw Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(a.file,a.config).then(a=>a)}async download(a){await this.apiClient.downloadFile(a)}async listInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f,g,h,i,j=(f={},null!=(g=n(a,["config"]))&&(h=n(g,["pageSize"]),void 0!==f&&null!=h&&m(f,["_query","pageSize"],h),i=n(g,["pageToken"]),void 0!==f&&null!=i&&m(f,["_query","pageToken"],i)),f);return d=l("files",j._url),e=j._query,delete j._url,delete j._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(j),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=n(a,["sdkHttpResponse"]);null!=c&&m(b,["sdkHttpResponse"],c);let d=n(a,["nextPageToken"]);null!=d&&m(b,["nextPageToken"],d);let e=n(a,["files"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>a)),m(b,["files"],a)}return b}(a),c=new F;return Object.assign(c,b),c})}}async createInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f,g,h=(f={},null!=(g=n(a,["file"]))&&m(f,["file"],g),f);return d=l("upload/v1beta/files",h._url),e=h._query,delete h._url,delete h._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(h),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b,c,d=(b={},null!=(c=n(a,["sdkHttpResponse"]))&&m(b,["sdkHttpResponse"],c),b),e=new G;return Object.assign(e,d),e})}}async get(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f,g,h=(f={},null!=(g=n(a,["name"]))&&m(f,["_url","file"],ag(g)),f);return d=l("files/{file}",h._url),e=h._query,delete h._url,delete h._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(h),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a)}}async delete(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f,g,h=(f={},null!=(g=n(a,["name"]))&&m(f,["_url","file"],ag(g)),f);return d=l("files/{file}",h._url),e=h._query,delete h._url,delete h._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b,c,d=(b={},null!=(c=n(a,["sdkHttpResponse"]))&&m(b,["sdkHttpResponse"],c),b),e=new H;return Object.assign(e,d),e})}}}function aE(a){let b={};if(void 0!==n(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=n(a,["data"]);null!=c&&m(b,["data"],c);let d=n(a,["mimeType"]);return null!=d&&m(b,["mimeType"],d),b}function aF(a){let b={},c=n(a,["voiceConfig"]);if(null!=c&&m(b,["voiceConfig"],c),void 0!==n(a,["multiSpeakerVoiceConfig"]))throw Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");let d=n(a,["languageCode"]);return null!=d&&m(b,["languageCode"],d),b}function aG(a){let b={},c=n(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e,f,g,h,i,j,k,l,o;return c={},null!=(d=n(b=a,["videoMetadata"]))&&m(c,["videoMetadata"],d),null!=(e=n(b,["thought"]))&&m(c,["thought"],e),null!=(f=n(b,["inlineData"]))&&m(c,["inlineData"],function(a){let b={};if(void 0!==n(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=n(a,["data"]);null!=c&&m(b,["data"],c);let d=n(a,["mimeType"]);return null!=d&&m(b,["mimeType"],d),b}(f)),null!=(g=n(b,["fileData"]))&&m(c,["fileData"],function(a){let b={};if(void 0!==n(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=n(a,["fileUri"]);null!=c&&m(b,["fileUri"],c);let d=n(a,["mimeType"]);return null!=d&&m(b,["mimeType"],d),b}(g)),null!=(h=n(b,["thoughtSignature"]))&&m(c,["thoughtSignature"],h),null!=(i=n(b,["functionCall"]))&&m(c,["functionCall"],i),null!=(j=n(b,["codeExecutionResult"]))&&m(c,["codeExecutionResult"],j),null!=(k=n(b,["executableCode"]))&&m(c,["executableCode"],k),null!=(l=n(b,["functionResponse"]))&&m(c,["functionResponse"],l),null!=(o=n(b,["text"]))&&m(c,["text"],o),c})),m(b,["parts"],a)}let d=n(a,["role"]);return null!=d&&m(b,["role"],d),b}function aH(a,b){let c={},d=n(b,["model"]);null!=d&&m(c,["_url","model"],L(a,d));let e=n(b,["contents"]);if(null!=e){let a=Y(e);Array.isArray(a)&&(a=a.map(a=>aG(a))),m(c,["contents"],a)}let f=n(b,["config"]);return null!=f&&m(c,["generationConfig"],function(a,b,c){let d={},e=n(b,["systemInstruction"]);void 0!==c&&null!=e&&m(c,["systemInstruction"],aG(W(e)));let f=n(b,["temperature"]);null!=f&&m(d,["temperature"],f);let g=n(b,["topP"]);null!=g&&m(d,["topP"],g);let h=n(b,["topK"]);null!=h&&m(d,["topK"],h);let i=n(b,["candidateCount"]);null!=i&&m(d,["candidateCount"],i);let j=n(b,["maxOutputTokens"]);null!=j&&m(d,["maxOutputTokens"],j);let k=n(b,["stopSequences"]);null!=k&&m(d,["stopSequences"],k);let l=n(b,["responseLogprobs"]);null!=l&&m(d,["responseLogprobs"],l);let o=n(b,["logprobs"]);null!=o&&m(d,["logprobs"],o);let p=n(b,["presencePenalty"]);null!=p&&m(d,["presencePenalty"],p);let q=n(b,["frequencyPenalty"]);null!=q&&m(d,["frequencyPenalty"],q);let r=n(b,["seed"]);null!=r&&m(d,["seed"],r);let s=n(b,["responseMimeType"]);null!=s&&m(d,["responseMimeType"],s);let t=n(b,["responseSchema"]);null!=t&&m(d,["responseSchema"],Z(t));let u=n(b,["responseJsonSchema"]);if(null!=u&&m(d,["responseJsonSchema"],u),void 0!==n(b,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==n(b,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let v=n(b,["safetySettings"]);if(void 0!==c&&null!=v){let a=v;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={};if(void 0!==n(a,["method"]))throw Error("method parameter is not supported in Gemini API.");let c=n(a,["category"]);null!=c&&m(b,["category"],c);let d=n(a,["threshold"]);return null!=d&&m(b,["threshold"],d),b})(a))),m(c,["safetySettings"],a)}let w=n(b,["tools"]);if(void 0!==c&&null!=w){let a=ab(w);Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=n(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),m(b,["functionDeclarations"],a)}if(void 0!==n(a,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let d=n(a,["googleSearch"]);null!=d&&m(b,["googleSearch"],function(a){let b={},c=n(a,["timeRangeFilter"]);if(null!=c&&m(b,["timeRangeFilter"],c),void 0!==n(a,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return b}(d));let e=n(a,["googleSearchRetrieval"]);if(null!=e&&m(b,["googleSearchRetrieval"],e),void 0!==n(a,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let f=n(a,["googleMaps"]);null!=f&&m(b,["googleMaps"],function(a){let b={};if(void 0!==n(a,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let c=n(a,["enableWidget"]);return null!=c&&m(b,["enableWidget"],c),b}(f));let g=n(a,["urlContext"]);null!=g&&m(b,["urlContext"],g);let h=n(a,["computerUse"]);null!=h&&m(b,["computerUse"],h);let i=n(a,["codeExecution"]);return null!=i&&m(b,["codeExecution"],i),b})(aa(a)))),m(c,["tools"],a)}let x=n(b,["toolConfig"]);if(void 0!==c&&null!=x&&m(c,["toolConfig"],x),void 0!==n(b,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let y=n(b,["cachedContent"]);void 0!==c&&null!=y&&m(c,["cachedContent"],ac(a,y));let z=n(b,["responseModalities"]);null!=z&&m(d,["responseModalities"],z);let A=n(b,["mediaResolution"]);null!=A&&m(d,["mediaResolution"],A);let B=n(b,["speechConfig"]);if(null!=B&&m(d,["speechConfig"],$(B)),void 0!==n(b,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let C=n(b,["thinkingConfig"]);null!=C&&m(d,["thinkingConfig"],C);let D=n(b,["imageConfig"]);return null!=D&&m(d,["imageConfig"],D),d}(a,f,c)),c}function aI(a,b){let c={},d=n(b,["model"]);null!=d&&m(c,["_url","model"],L(a,d));let e=n(b,["contents"]);if(null!=e){let a=Y(e);Array.isArray(a)&&(a=a.map(a=>a)),m(c,["contents"],a)}let f=n(b,["config"]);return null!=f&&m(c,["generationConfig"],function(a,b,c){let d={},e=n(b,["systemInstruction"]);void 0!==c&&null!=e&&m(c,["systemInstruction"],W(e));let f=n(b,["temperature"]);null!=f&&m(d,["temperature"],f);let g=n(b,["topP"]);null!=g&&m(d,["topP"],g);let h=n(b,["topK"]);null!=h&&m(d,["topK"],h);let i=n(b,["candidateCount"]);null!=i&&m(d,["candidateCount"],i);let j=n(b,["maxOutputTokens"]);null!=j&&m(d,["maxOutputTokens"],j);let k=n(b,["stopSequences"]);null!=k&&m(d,["stopSequences"],k);let l=n(b,["responseLogprobs"]);null!=l&&m(d,["responseLogprobs"],l);let o=n(b,["logprobs"]);null!=o&&m(d,["logprobs"],o);let p=n(b,["presencePenalty"]);null!=p&&m(d,["presencePenalty"],p);let q=n(b,["frequencyPenalty"]);null!=q&&m(d,["frequencyPenalty"],q);let r=n(b,["seed"]);null!=r&&m(d,["seed"],r);let s=n(b,["responseMimeType"]);null!=s&&m(d,["responseMimeType"],s);let t=n(b,["responseSchema"]);null!=t&&m(d,["responseSchema"],Z(t));let u=n(b,["responseJsonSchema"]);null!=u&&m(d,["responseJsonSchema"],u);let v=n(b,["routingConfig"]);null!=v&&m(d,["routingConfig"],v);let w=n(b,["modelSelectionConfig"]);null!=w&&m(d,["modelConfig"],w);let x=n(b,["safetySettings"]);if(void 0!==c&&null!=x){let a=x;Array.isArray(a)&&(a=a.map(a=>a)),m(c,["safetySettings"],a)}let y=n(b,["tools"]);if(void 0!==c&&null!=y){let a=ab(y);Array.isArray(a)&&(a=a.map(a=>aU(aa(a)))),m(c,["tools"],a)}let z=n(b,["toolConfig"]);void 0!==c&&null!=z&&m(c,["toolConfig"],z);let A=n(b,["labels"]);void 0!==c&&null!=A&&m(c,["labels"],A);let B=n(b,["cachedContent"]);void 0!==c&&null!=B&&m(c,["cachedContent"],ac(a,B));let C=n(b,["responseModalities"]);null!=C&&m(d,["responseModalities"],C);let D=n(b,["mediaResolution"]);null!=D&&m(d,["mediaResolution"],D);let E=n(b,["speechConfig"]);null!=E&&m(d,["speechConfig"],aT($(E)));let F=n(b,["audioTimestamp"]);null!=F&&m(d,["audioTimestamp"],F);let G=n(b,["thinkingConfig"]);null!=G&&m(d,["thinkingConfig"],G);let H=n(b,["imageConfig"]);return null!=H&&m(d,["imageConfig"],H),d}(a,f,c)),c}function aJ(a){let b={},c=n(a,["sdkHttpResponse"]);null!=c&&m(b,["sdkHttpResponse"],c);let d=n(a,["candidates"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=n(a,["content"]);null!=c&&m(b,["content"],c);let d=n(a,["citationMetadata"]);null!=d&&m(b,["citationMetadata"],function(a){let b={},c=n(a,["citationSources"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),m(b,["citations"],a)}return b}(d));let e=n(a,["tokenCount"]);null!=e&&m(b,["tokenCount"],e);let f=n(a,["finishReason"]);null!=f&&m(b,["finishReason"],f);let g=n(a,["urlContextMetadata"]);null!=g&&m(b,["urlContextMetadata"],g);let h=n(a,["avgLogprobs"]);null!=h&&m(b,["avgLogprobs"],h);let i=n(a,["groundingMetadata"]);null!=i&&m(b,["groundingMetadata"],i);let j=n(a,["index"]);null!=j&&m(b,["index"],j);let k=n(a,["logprobsResult"]);null!=k&&m(b,["logprobsResult"],k);let l=n(a,["safetyRatings"]);if(null!=l){let a=l;Array.isArray(a)&&(a=a.map(a=>a)),m(b,["safetyRatings"],a)}return b})(a))),m(b,["candidates"],a)}let e=n(a,["modelVersion"]);null!=e&&m(b,["modelVersion"],e);let f=n(a,["promptFeedback"]);null!=f&&m(b,["promptFeedback"],f);let g=n(a,["responseId"]);null!=g&&m(b,["responseId"],g);let h=n(a,["usageMetadata"]);return null!=h&&m(b,["usageMetadata"],h),b}function aK(a){let b={},c=n(a,["sdkHttpResponse"]);null!=c&&m(b,["sdkHttpResponse"],c);let d=n(a,["candidates"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>a)),m(b,["candidates"],a)}let e=n(a,["createTime"]);null!=e&&m(b,["createTime"],e);let f=n(a,["modelVersion"]);null!=f&&m(b,["modelVersion"],f);let g=n(a,["promptFeedback"]);null!=g&&m(b,["promptFeedback"],g);let h=n(a,["responseId"]);null!=h&&m(b,["responseId"],h);let i=n(a,["usageMetadata"]);return null!=i&&m(b,["usageMetadata"],i),b}function aL(a){let b={},c=n(a,["_self"]);null!=c&&m(b,["image"],aM(c));let d=n(a,["raiFilteredReason"]);null!=d&&m(b,["raiFilteredReason"],d);let e=n(a,["_self"]);null!=e&&m(b,["safetyAttributes"],aS(e));let f=n(a,["prompt"]);return null!=f&&m(b,["enhancedPrompt"],f),b}function aM(a){let b={},c=n(a,["gcsUri"]);null!=c&&m(b,["gcsUri"],c);let d=n(a,["bytesBase64Encoded"]);null!=d&&m(b,["imageBytes"],o(d));let e=n(a,["mimeType"]);return null!=e&&m(b,["mimeType"],e),b}function aN(a){let b={};if(void 0!==n(a,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");let c=n(a,["imageBytes"]);null!=c&&m(b,["bytesBase64Encoded"],o(c));let d=n(a,["mimeType"]);return null!=d&&m(b,["mimeType"],d),b}function aO(a){let b={},c=n(a,["gcsUri"]);null!=c&&m(b,["gcsUri"],c);let d=n(a,["imageBytes"]);null!=d&&m(b,["bytesBase64Encoded"],o(d));let e=n(a,["mimeType"]);return null!=e&&m(b,["mimeType"],e),b}function aP(a){var b;let c,d,e,f,g={},h=n(a,["name"]);null!=h&&m(g,["name"],h);let i=n(a,["displayName"]);null!=i&&m(g,["displayName"],i);let j=n(a,["description"]);null!=j&&m(g,["description"],j);let k=n(a,["version"]);null!=k&&m(g,["version"],k);let l=n(a,["_self"]);null!=l&&m(g,["tunedModelInfo"],(c={},null!=(d=n(b=l,["baseModel"]))&&m(c,["baseModel"],d),null!=(e=n(b,["createTime"]))&&m(c,["createTime"],e),null!=(f=n(b,["updateTime"]))&&m(c,["updateTime"],f),c));let o=n(a,["inputTokenLimit"]);null!=o&&m(g,["inputTokenLimit"],o);let p=n(a,["outputTokenLimit"]);null!=p&&m(g,["outputTokenLimit"],p);let q=n(a,["supportedGenerationMethods"]);return null!=q&&m(g,["supportedActions"],q),g}function aQ(a){var b;let c,d,e,f,g={},h=n(a,["name"]);null!=h&&m(g,["name"],h);let i=n(a,["displayName"]);null!=i&&m(g,["displayName"],i);let j=n(a,["description"]);null!=j&&m(g,["description"],j);let k=n(a,["versionId"]);null!=k&&m(g,["version"],k);let l=n(a,["deployedModels"]);if(null!=l){let a=l;Array.isArray(a)&&(a=a.map(a=>{let b,c,d;return b={},null!=(c=n(a,["endpoint"]))&&m(b,["name"],c),null!=(d=n(a,["deployedModelId"]))&&m(b,["deployedModelId"],d),b})),m(g,["endpoints"],a)}let o=n(a,["labels"]);null!=o&&m(g,["labels"],o);let p=n(a,["_self"]);null!=p&&m(g,["tunedModelInfo"],(c={},null!=(d=n(b=p,["labels","google-vertex-llm-tuning-base-model-id"]))&&m(c,["baseModel"],d),null!=(e=n(b,["createTime"]))&&m(c,["createTime"],e),null!=(f=n(b,["updateTime"]))&&m(c,["updateTime"],f),c));let q=n(a,["defaultCheckpointId"]);null!=q&&m(g,["defaultCheckpointId"],q);let r=n(a,["checkpoints"]);if(null!=r){let a=r;Array.isArray(a)&&(a=a.map(a=>a)),m(g,["checkpoints"],a)}return g}function aR(a){let b={},c=n(a,["safetyAttributes","categories"]);null!=c&&m(b,["categories"],c);let d=n(a,["safetyAttributes","scores"]);null!=d&&m(b,["scores"],d);let e=n(a,["contentType"]);return null!=e&&m(b,["contentType"],e),b}function aS(a){let b={},c=n(a,["safetyAttributes","categories"]);null!=c&&m(b,["categories"],c);let d=n(a,["safetyAttributes","scores"]);null!=d&&m(b,["scores"],d);let e=n(a,["contentType"]);return null!=e&&m(b,["contentType"],e),b}function aT(a){let b={},c=n(a,["voiceConfig"]);if(null!=c&&m(b,["voiceConfig"],c),void 0!==n(a,["multiSpeakerVoiceConfig"]))throw Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");let d=n(a,["languageCode"]);return null!=d&&m(b,["languageCode"],d),b}function aU(a){let b={},c=n(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={};if(void 0!==n(a,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let c=n(a,["description"]);null!=c&&m(b,["description"],c);let d=n(a,["name"]);null!=d&&m(b,["name"],d);let e=n(a,["parameters"]);null!=e&&m(b,["parameters"],e);let f=n(a,["parametersJsonSchema"]);null!=f&&m(b,["parametersJsonSchema"],f);let g=n(a,["response"]);null!=g&&m(b,["response"],g);let h=n(a,["responseJsonSchema"]);return null!=h&&m(b,["responseJsonSchema"],h),b})(a))),m(b,["functionDeclarations"],a)}let d=n(a,["retrieval"]);null!=d&&m(b,["retrieval"],d);let e=n(a,["googleSearch"]);null!=e&&m(b,["googleSearch"],e);let f=n(a,["googleSearchRetrieval"]);null!=f&&m(b,["googleSearchRetrieval"],f);let g=n(a,["enterpriseWebSearch"]);null!=g&&m(b,["enterpriseWebSearch"],g);let h=n(a,["googleMaps"]);null!=h&&m(b,["googleMaps"],h);let i=n(a,["urlContext"]);null!=i&&m(b,["urlContext"],i);let j=n(a,["computerUse"]);null!=j&&m(b,["computerUse"],j);let k=n(a,["codeExecution"]);return null!=k&&m(b,["codeExecution"],k),b}function aV(a){let b={},c=n(a,["uri"]);null!=c&&m(b,["uri"],c);let d=n(a,["videoBytes"]);null!=d&&m(b,["encodedVideo"],o(d));let e=n(a,["mimeType"]);return null!=e&&m(b,["encoding"],e),b}function aW(a){let b={},c=n(a,["uri"]);null!=c&&m(b,["gcsUri"],c);let d=n(a,["videoBytes"]);null!=d&&m(b,["bytesBase64Encoded"],o(d));let e=n(a,["mimeType"]);return null!=e&&m(b,["mimeType"],e),b}let aX="x-goog-api-client",aY=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class aZ{constructor(a){var b,c;this.clientOptions=Object.assign(Object.assign({},a),{project:a.project,location:a.location,apiKey:a.apiKey,vertexai:a.vertexai});const d={};this.clientOptions.vertexai?(d.apiVersion=null!=(b=this.clientOptions.apiVersion)?b:"v1beta1",d.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(d.apiVersion=null!=(c=this.clientOptions.apiVersion)?c:"v1beta",d.baseUrl="https://generativelanguage.googleapis.com/"),d.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=d,a.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(d,a.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var a;return null!=(a=this.clientOptions.vertexai)&&a}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw Error("Headers are not set.")}getRequestUrlInternal(a){if(!a||void 0===a.baseUrl||void 0===a.apiVersion)throw Error("HTTP options are not correctly set.");let b=[a.baseUrl.endsWith("/")?a.baseUrl.slice(0,-1):a.baseUrl];return a.apiVersion&&""!==a.apiVersion&&b.push(a.apiVersion),b.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){let a=new URL(this.getBaseUrl());return a.protocol="http:"==a.protocol?"ws":"wss",a.toString()}setBaseUrl(a){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=a;else throw Error("HTTP options are not correctly set.")}constructUrl(a,b,c){let d=[this.getRequestUrlInternal(b)];return c&&d.push(this.getBaseResourcePath()),""!==a&&d.push(a),new URL(`${d.join("/")}`)}shouldPrependVertexProjectPath(a){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||a.path.startsWith("projects/")||"GET"===a.httpMethod&&a.path.startsWith("publishers/google/models"))}async request(a){let b=this.clientOptions.httpOptions;a.httpOptions&&(b=this.patchHttpOptions(this.clientOptions.httpOptions,a.httpOptions));let c=this.shouldPrependVertexProjectPath(a),d=this.constructUrl(a.path,b,c);if(a.queryParams)for(let[b,c]of Object.entries(a.queryParams))d.searchParams.append(b,String(c));let e={};if("GET"===a.httpMethod){if(a.body&&"{}"!==a.body)throw Error("Request body should be empty for GET request, but got non empty request body")}else e.body=a.body;return e=await this.includeExtraHttpOptionsToRequestInit(e,b,d.toString(),a.abortSignal),this.unaryApiCall(d,e,a.httpMethod)}patchHttpOptions(a,b){let c=JSON.parse(JSON.stringify(a));for(let[a,d]of Object.entries(b))"object"==typeof d?c[a]=Object.assign(Object.assign({},c[a]),d):void 0!==d&&(c[a]=d);return c}async requestStream(a){let b=this.clientOptions.httpOptions;a.httpOptions&&(b=this.patchHttpOptions(this.clientOptions.httpOptions,a.httpOptions));let c=this.shouldPrependVertexProjectPath(a),d=this.constructUrl(a.path,b,c);d.searchParams.has("alt")&&"sse"===d.searchParams.get("alt")||d.searchParams.set("alt","sse");let e={};return e.body=a.body,e=await this.includeExtraHttpOptionsToRequestInit(e,b,d.toString(),a.abortSignal),this.streamApiCall(d,e,a.httpMethod)}async includeExtraHttpOptionsToRequestInit(a,b,c,d){if(b&&b.timeout||d){let c=new AbortController,e=c.signal;if(b.timeout&&(null==b?void 0:b.timeout)>0){let a=setTimeout(()=>c.abort(),b.timeout);a&&"function"==typeof a.unref&&a.unref()}d&&d.addEventListener("abort",()=>{c.abort()}),a.signal=e}return b&&null!==b.extraBody&&function(a,b){if(!b||0===Object.keys(b).length)return;if(a.body instanceof Blob)return console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");let c={};if("string"==typeof a.body&&a.body.length>0)try{let b=JSON.parse(a.body);if("object"!=typeof b||null===b||Array.isArray(b))return void console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");c=b}catch(a){console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}a.body=JSON.stringify(function a(b,c){let d=Object.assign({},b);for(let b in c)if(Object.prototype.hasOwnProperty.call(c,b)){let e=c[b],f=d[b];e&&"object"==typeof e&&!Array.isArray(e)&&f&&"object"==typeof f&&!Array.isArray(f)?d[b]=a(f,e):(f&&e&&typeof f!=typeof e&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${b}". Original type: ${typeof f}, New type: ${typeof e}. Overwriting.`),d[b]=e)}return d}(c,b))}(a,b.extraBody),a.headers=await this.getHeadersInternal(b,c),a}async unaryApiCall(a,b,c){return this.apiCall(a.toString(),Object.assign(Object.assign({},b),{method:c})).then(async a=>(await a$(a),new p(a))).catch(a=>{if(a instanceof Error)throw a;throw Error(JSON.stringify(a))})}async streamApiCall(a,b,c){return this.apiCall(a.toString(),Object.assign(Object.assign({},b),{method:c})).then(async a=>(await a$(a),this.processStreamResponse(a))).catch(a=>{if(a instanceof Error)throw a;throw Error(JSON.stringify(a))})}processStreamResponse(a){var b;return aw(this,arguments,function*(){let c=null==(b=null==a?void 0:a.body)?void 0:b.getReader(),d=new TextDecoder("utf-8");if(!c)throw Error("Response body is empty");try{let b="";for(;;){let{done:e,value:f}=yield av(c.read());if(e){if(b.trim().length>0)throw Error("Incomplete JSON segment at the end");break}let g=d.decode(f,{stream:!0});try{let a=JSON.parse(g);if("error"in a){let b=JSON.parse(JSON.stringify(a.error)),c=b.status,d=b.code,e=`got status: ${c}. ${JSON.stringify(a)}`;if(d>=400&&d<600)throw new aC({message:e,status:d})}}catch(a){if("ApiError"===a.name)throw a}let h=(b+=g).match(aY);for(;h;){let c=h[1];try{let d=new Response(c,{headers:null==a?void 0:a.headers,status:null==a?void 0:a.status,statusText:null==a?void 0:a.statusText});yield yield av(new p(d)),h=(b=b.slice(h[0].length)).match(aY)}catch(a){throw Error(`exception parsing stream chunk ${c}. ${a}`)}}}}finally{c.releaseLock()}})}async apiCall(a,b){return fetch(a,b).catch(a=>{throw Error(`exception ${a} sending request`)})}getDefaultHeaders(){let a={},b="google-genai-sdk/1.27.0 "+this.clientOptions.userAgentExtra;return a["User-Agent"]=b,a[aX]=b,a["Content-Type"]="application/json",a}async getHeadersInternal(a,b){let c=new Headers;if(a&&a.headers){for(let[b,d]of Object.entries(a.headers))c.append(b,d);a.timeout&&a.timeout>0&&c.append("X-Server-Timeout",String(Math.ceil(a.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(c,b),c}async uploadFile(a,b){var c;let d={};null!=b&&(d.mimeType=b.mimeType,d.name=b.name,d.displayName=b.displayName),d.name&&!d.name.startsWith("files/")&&(d.name=`files/${d.name}`);let e=this.clientOptions.uploader,f=await e.stat(a);d.sizeBytes=String(f.size);let g=null!=(c=null==b?void 0:b.mimeType)?c:f.type;if(void 0===g||""===g)throw Error("Can not determine mimeType. Please provide mimeType in the config.");d.mimeType=g;let h=await this.fetchUploadUrl(d,b);return e.upload(a,h,this)}async downloadFile(a){let b=this.clientOptions.downloader;await b.download(a,this)}async fetchUploadUrl(a,b){var c;let d={};d=(null==b?void 0:b.httpOptions)?b.httpOptions:{apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${a.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${a.mimeType}`}};let e={file:a},f=await this.request({path:l("upload/v1beta/files",e._url),body:JSON.stringify(e),httpMethod:"POST",httpOptions:d});if(!f||!(null==f?void 0:f.headers))throw Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");let g=null==(c=null==f?void 0:f.headers)?void 0:c["x-goog-upload-url"];if(void 0===g)throw Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return g}}async function a$(a){var b;if(void 0===a)throw Error("response is undefined");if(!a.ok){let c=a.status,d=JSON.stringify((null==(b=a.headers.get("content-type"))?void 0:b.includes("application/json"))?await a.json():{error:{message:await a.text(),code:a.status,status:a.statusText}});if(c>=400&&c<600)throw new aC({message:d,status:c});throw Error(d)}}function a_(a){for(let c of a){var b;if(null!==(b=c)&&"object"==typeof b&&b instanceof a1||"object"==typeof c&&"inputSchema"in c)return!0}return!1}function a0(a){var b;let c=null!=(b=a[aX])?b:"";a[aX]=(c+" mcp_used/unknown").trimStart()}class a1{constructor(a=[],b){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=a,this.config=b}static create(a,b){return new a1(a,b)}async initialize(){var a,b,c,d;if(this.mcpTools.length>0)return;let e={},f=[];for(let j of this.mcpClients)try{for(var g,h=!0,i=(b=void 0,ax(function(a,b=100){return aw(this,arguments,function*(){let c,d=0;for(;d<b;){let b=yield av(a.listTools({cursor:c}));for(let a of b.tools)yield yield av(a),d++;if(!b.nextCursor)break;c=b.nextCursor}})}(j)));!(a=(g=await i.next()).done);h=!0){d=g.value,h=!1,f.push(d);let a=d.name;if(e[a])throw Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);e[a]=j}}catch(a){b={error:a}}finally{try{!h&&!a&&(c=i.return)&&await c.call(i)}finally{if(b)throw b.error}}this.mcpTools=f,this.functionNameToMcpClient=e}async tool(){return await this.initialize(),function(a,b={}){let c=[],d=new Set;for(let e of a){let a=e.name;if(d.has(a))throw Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);d.add(a);let f=function(a,b={}){let c={name:a.name,description:a.description,parametersJsonSchema:a.inputSchema};return a.outputSchema&&(c.responseJsonSchema=a.outputSchema),b.behavior&&(c.behavior=b.behavior),{functionDeclarations:[c]}}(e,b);f.functionDeclarations&&c.push(...f.functionDeclarations)}return{functionDeclarations:c}}(this.mcpTools,this.config)}async callTool(a){await this.initialize();let b=[];for(let c of a)if(c.name in this.functionNameToMcpClient){let a,d=this.functionNameToMcpClient[c.name];this.config.timeout&&(a={timeout:this.config.timeout});let e=await d.callTool({name:c.name,arguments:c.args},void 0,a);b.push({functionResponse:{name:c.name,response:e.isError?{error:e}:e}})}return b}}async function a2(a,b,c){let d=new K;Object.assign(d,c.data instanceof Blob?JSON.parse(await c.data.text()):JSON.parse(c.data)),b(d)}class a3{constructor(a,b,c){this.apiClient=a,this.auth=b,this.webSocketFactory=c}async connect(a){var b,c;let d;if(this.apiClient.isVertexAI())throw Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");let e=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion(),g=function(a){let b=new Headers;for(let[c,d]of Object.entries(a))b.append(c,d);return b}(this.apiClient.getDefaultHeaders()),h=this.apiClient.getApiKey(),i=`${e}/ws/google.ai.generativelanguage.${f}.GenerativeService.BidiGenerateMusic?key=${h}`,j=()=>{},k=new Promise(a=>{j=a}),l=a.callbacks,m=this.apiClient,n={onopen:function(){j({})},onmessage:a=>{a2(m,l.onmessage,a)},onerror:null!=(b=null==l?void 0:l.onerror)?b:function(a){},onclose:null!=(c=null==l?void 0:l.onclose)?c:function(a){}},o=this.webSocketFactory.create(i,(d={},g.forEach((a,b)=>{d[b]=a}),d),n);o.connect(),await k;let p=L(this.apiClient,a.model);return o.send(JSON.stringify({setup:{model:p}})),new a4(o,this.apiClient)}}class a4{constructor(a,b){this.conn=a,this.apiClient=b}async setWeightedPrompts(a){if(!a.weightedPrompts||0===Object.keys(a.weightedPrompts).length)throw Error("Weighted prompts must be set and contain at least one entry.");let b=function(a){let b={},c=n(a,["weightedPrompts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),m(b,["weightedPrompts"],a)}return b}(a);this.conn.send(JSON.stringify({clientContent:b}))}async setMusicGenerationConfig(a){let b,c;a.musicGenerationConfig||(a.musicGenerationConfig={});let d=(b={},null!=(c=n(a,["musicGenerationConfig"]))&&m(b,["musicGenerationConfig"],c),b);this.conn.send(JSON.stringify(d))}sendPlaybackControl(a){this.conn.send(JSON.stringify({playbackControl:a}))}play(){this.sendPlaybackControl(c5.PLAY)}pause(){this.sendPlaybackControl(c5.PAUSE)}stop(){this.sendPlaybackControl(c5.STOP)}resetContext(){this.sendPlaybackControl(c5.RESET_CONTEXT)}close(){this.conn.close()}}async function a5(a,b,c){let d=new J,e=JSON.parse(c.data instanceof Blob?await c.data.text():c.data instanceof ArrayBuffer?new TextDecoder().decode(c.data):c.data);if(a.isVertexAI()){let a,b,c,f,g,h,i,j;Object.assign(d,(a={},null!=(b=n(e,["setupComplete"]))&&m(a,["setupComplete"],b),null!=(c=n(e,["serverContent"]))&&m(a,["serverContent"],c),null!=(f=n(e,["toolCall"]))&&m(a,["toolCall"],f),null!=(g=n(e,["toolCallCancellation"]))&&m(a,["toolCallCancellation"],g),null!=(h=n(e,["usageMetadata"]))&&m(a,["usageMetadata"],function(a){let b={},c=n(a,["promptTokenCount"]);null!=c&&m(b,["promptTokenCount"],c);let d=n(a,["cachedContentTokenCount"]);null!=d&&m(b,["cachedContentTokenCount"],d);let e=n(a,["candidatesTokenCount"]);null!=e&&m(b,["responseTokenCount"],e);let f=n(a,["toolUsePromptTokenCount"]);null!=f&&m(b,["toolUsePromptTokenCount"],f);let g=n(a,["thoughtsTokenCount"]);null!=g&&m(b,["thoughtsTokenCount"],g);let h=n(a,["totalTokenCount"]);null!=h&&m(b,["totalTokenCount"],h);let i=n(a,["promptTokensDetails"]);if(null!=i){let a=i;Array.isArray(a)&&(a=a.map(a=>a)),m(b,["promptTokensDetails"],a)}let j=n(a,["cacheTokensDetails"]);if(null!=j){let a=j;Array.isArray(a)&&(a=a.map(a=>a)),m(b,["cacheTokensDetails"],a)}let k=n(a,["candidatesTokensDetails"]);if(null!=k){let a=k;Array.isArray(a)&&(a=a.map(a=>a)),m(b,["responseTokensDetails"],a)}let l=n(a,["toolUsePromptTokensDetails"]);if(null!=l){let a=l;Array.isArray(a)&&(a=a.map(a=>a)),m(b,["toolUsePromptTokensDetails"],a)}let o=n(a,["trafficType"]);return null!=o&&m(b,["trafficType"],o),b}(h)),null!=(i=n(e,["goAway"]))&&m(a,["goAway"],i),null!=(j=n(e,["sessionResumptionUpdate"]))&&m(a,["sessionResumptionUpdate"],j),a))}else Object.assign(d,e);b(d)}class a6{constructor(a,b,c){this.apiClient=a,this.auth=b,this.webSocketFactory=c,this.music=new a3(this.apiClient,this.auth,this.webSocketFactory)}async connect(a){var b,c,d,e,f,g,h,i;let j,k;if(a.config&&a.config.httpOptions)throw Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");let l=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),p=this.apiClient.getHeaders();a.config&&a.config.tools&&a_(a.config.tools)&&a0(p);let q=function(a){let b=new Headers;for(let[c,d]of Object.entries(a))b.append(c,d);return b}(p);if(this.apiClient.isVertexAI())j=`${l}/ws/google.cloud.aiplatform.${o}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(q,j);else{let a=this.apiClient.getApiKey(),b="BidiGenerateContent",c="key";(null==a?void 0:a.startsWith("auth_tokens/"))&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),"v1alpha"!==o&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),b="BidiGenerateContentConstrained",c="access_token"),j=`${l}/ws/google.ai.generativelanguage.${o}.GenerativeService.${b}?${c}=${a}`}let r=()=>{},s=new Promise(a=>{r=a}),t=a.callbacks,u=this.apiClient,v={onopen:function(){var a;null==(a=null==t?void 0:t.onopen)||a.call(t),r({})},onmessage:a=>{a5(u,t.onmessage,a)},onerror:null!=(b=null==t?void 0:t.onerror)?b:function(a){},onclose:null!=(c=null==t?void 0:t.onclose)?c:function(a){}},w=this.webSocketFactory.create(j,(k={},q.forEach((a,b)=>{k[b]=a}),k),v);w.connect(),await s;let x=L(this.apiClient,a.model);if(this.apiClient.isVertexAI()&&x.startsWith("publishers/")){let a=this.apiClient.getProject(),b=this.apiClient.getLocation();x=`projects/${a}/locations/${b}/`+x}let y={};this.apiClient.isVertexAI()&&(null==(d=a.config)?void 0:d.responseModalities)===void 0&&(void 0===a.config?a.config={responseModalities:[cB.AUDIO]}:a.config.responseModalities=[cB.AUDIO]),(null==(e=a.config)?void 0:e.generationConfig)&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");let z=null!=(g=null==(f=a.config)?void 0:f.tools)?g:[],A=[];for(let a of z)this.isCallableTool(a)?A.push(await a.tool()):A.push(a);A.length>0&&(a.config.tools=A);let B={model:x,config:a.config,callbacks:a.callbacks};if(this.apiClient.isVertexAI()){let a,b,c;h=this.apiClient,a={},null!=(b=n(B,["model"]))&&m(a,["setup","model"],L(h,b)),null!=(c=n(B,["config"]))&&m(a,["config"],function(a,b){let c=n(a,["generationConfig"]);void 0!==b&&null!=c&&m(b,["setup","generationConfig"],function(a){let b={},c=n(a,["modelSelectionConfig"]);null!=c&&m(b,["modelConfig"],c);let d=n(a,["audioTimestamp"]);null!=d&&m(b,["audioTimestamp"],d);let e=n(a,["candidateCount"]);null!=e&&m(b,["candidateCount"],e);let f=n(a,["enableAffectiveDialog"]);null!=f&&m(b,["enableAffectiveDialog"],f);let g=n(a,["frequencyPenalty"]);null!=g&&m(b,["frequencyPenalty"],g);let h=n(a,["logprobs"]);null!=h&&m(b,["logprobs"],h);let i=n(a,["maxOutputTokens"]);null!=i&&m(b,["maxOutputTokens"],i);let j=n(a,["mediaResolution"]);null!=j&&m(b,["mediaResolution"],j);let k=n(a,["presencePenalty"]);null!=k&&m(b,["presencePenalty"],k);let l=n(a,["responseJsonSchema"]);null!=l&&m(b,["responseJsonSchema"],l);let o=n(a,["responseLogprobs"]);null!=o&&m(b,["responseLogprobs"],o);let p=n(a,["responseMimeType"]);null!=p&&m(b,["responseMimeType"],p);let q=n(a,["responseModalities"]);null!=q&&m(b,["responseModalities"],q);let r=n(a,["responseSchema"]);null!=r&&m(b,["responseSchema"],r);let s=n(a,["routingConfig"]);null!=s&&m(b,["routingConfig"],s);let t=n(a,["seed"]);null!=t&&m(b,["seed"],t);let u=n(a,["speechConfig"]);null!=u&&m(b,["speechConfig"],aF(u));let v=n(a,["stopSequences"]);null!=v&&m(b,["stopSequences"],v);let w=n(a,["temperature"]);null!=w&&m(b,["temperature"],w);let x=n(a,["thinkingConfig"]);null!=x&&m(b,["thinkingConfig"],x);let y=n(a,["topK"]);null!=y&&m(b,["topK"],y);let z=n(a,["topP"]);if(null!=z&&m(b,["topP"],z),void 0!==n(a,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return b}(c));let d=n(a,["responseModalities"]);void 0!==b&&null!=d&&m(b,["setup","generationConfig","responseModalities"],d);let e=n(a,["temperature"]);void 0!==b&&null!=e&&m(b,["setup","generationConfig","temperature"],e);let f=n(a,["topP"]);void 0!==b&&null!=f&&m(b,["setup","generationConfig","topP"],f);let g=n(a,["topK"]);void 0!==b&&null!=g&&m(b,["setup","generationConfig","topK"],g);let h=n(a,["maxOutputTokens"]);void 0!==b&&null!=h&&m(b,["setup","generationConfig","maxOutputTokens"],h);let i=n(a,["mediaResolution"]);void 0!==b&&null!=i&&m(b,["setup","generationConfig","mediaResolution"],i);let j=n(a,["seed"]);void 0!==b&&null!=j&&m(b,["setup","generationConfig","seed"],j);let k=n(a,["speechConfig"]);void 0!==b&&null!=k&&m(b,["setup","generationConfig","speechConfig"],aF(_(k)));let l=n(a,["thinkingConfig"]);void 0!==b&&null!=l&&m(b,["setup","generationConfig","thinkingConfig"],l);let o=n(a,["enableAffectiveDialog"]);void 0!==b&&null!=o&&m(b,["setup","generationConfig","enableAffectiveDialog"],o);let p=n(a,["systemInstruction"]);void 0!==b&&null!=p&&m(b,["setup","systemInstruction"],W(p));let q=n(a,["tools"]);if(void 0!==b&&null!=q){let a=ab(q);Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=n(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={};if(void 0!==n(a,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let c=n(a,["description"]);null!=c&&m(b,["description"],c);let d=n(a,["name"]);null!=d&&m(b,["name"],d);let e=n(a,["parameters"]);null!=e&&m(b,["parameters"],e);let f=n(a,["parametersJsonSchema"]);null!=f&&m(b,["parametersJsonSchema"],f);let g=n(a,["response"]);null!=g&&m(b,["response"],g);let h=n(a,["responseJsonSchema"]);return null!=h&&m(b,["responseJsonSchema"],h),b})(a))),m(b,["functionDeclarations"],a)}let d=n(a,["retrieval"]);null!=d&&m(b,["retrieval"],d);let e=n(a,["googleSearch"]);null!=e&&m(b,["googleSearch"],e);let f=n(a,["googleSearchRetrieval"]);null!=f&&m(b,["googleSearchRetrieval"],f);let g=n(a,["enterpriseWebSearch"]);null!=g&&m(b,["enterpriseWebSearch"],g);let h=n(a,["googleMaps"]);null!=h&&m(b,["googleMaps"],h);let i=n(a,["urlContext"]);null!=i&&m(b,["urlContext"],i);let j=n(a,["computerUse"]);null!=j&&m(b,["computerUse"],j);let k=n(a,["codeExecution"]);return null!=k&&m(b,["codeExecution"],k),b})(aa(a)))),m(b,["setup","tools"],a)}let r=n(a,["sessionResumption"]);void 0!==b&&null!=r&&m(b,["setup","sessionResumption"],r);let s=n(a,["inputAudioTranscription"]);void 0!==b&&null!=s&&m(b,["setup","inputAudioTranscription"],s);let t=n(a,["outputAudioTranscription"]);void 0!==b&&null!=t&&m(b,["setup","outputAudioTranscription"],t);let u=n(a,["realtimeInputConfig"]);void 0!==b&&null!=u&&m(b,["setup","realtimeInputConfig"],u);let v=n(a,["contextWindowCompression"]);void 0!==b&&null!=v&&m(b,["setup","contextWindowCompression"],v);let w=n(a,["proactivity"]);return void 0!==b&&null!=w&&m(b,["setup","proactivity"],w),{}}(c,a)),y=a}else{let a,b,c;i=this.apiClient,a={},null!=(b=n(B,["model"]))&&m(a,["setup","model"],L(i,b)),null!=(c=n(B,["config"]))&&m(a,["config"],function(a,b){let c=n(a,["generationConfig"]);void 0!==b&&null!=c&&m(b,["setup","generationConfig"],c);let d=n(a,["responseModalities"]);void 0!==b&&null!=d&&m(b,["setup","generationConfig","responseModalities"],d);let e=n(a,["temperature"]);void 0!==b&&null!=e&&m(b,["setup","generationConfig","temperature"],e);let f=n(a,["topP"]);void 0!==b&&null!=f&&m(b,["setup","generationConfig","topP"],f);let g=n(a,["topK"]);void 0!==b&&null!=g&&m(b,["setup","generationConfig","topK"],g);let h=n(a,["maxOutputTokens"]);void 0!==b&&null!=h&&m(b,["setup","generationConfig","maxOutputTokens"],h);let i=n(a,["mediaResolution"]);void 0!==b&&null!=i&&m(b,["setup","generationConfig","mediaResolution"],i);let j=n(a,["seed"]);void 0!==b&&null!=j&&m(b,["setup","generationConfig","seed"],j);let k=n(a,["speechConfig"]);void 0!==b&&null!=k&&m(b,["setup","generationConfig","speechConfig"],_(k));let l=n(a,["thinkingConfig"]);void 0!==b&&null!=l&&m(b,["setup","generationConfig","thinkingConfig"],l);let o=n(a,["enableAffectiveDialog"]);void 0!==b&&null!=o&&m(b,["setup","generationConfig","enableAffectiveDialog"],o);let p=n(a,["systemInstruction"]);void 0!==b&&null!=p&&m(b,["setup","systemInstruction"],function(a){let b={},c=n(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e,f,g,h,i,j,k,l,o;return c={},null!=(d=n(b=a,["videoMetadata"]))&&m(c,["videoMetadata"],d),null!=(e=n(b,["thought"]))&&m(c,["thought"],e),null!=(f=n(b,["inlineData"]))&&m(c,["inlineData"],aE(f)),null!=(g=n(b,["fileData"]))&&m(c,["fileData"],function(a){let b={};if(void 0!==n(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=n(a,["fileUri"]);null!=c&&m(b,["fileUri"],c);let d=n(a,["mimeType"]);return null!=d&&m(b,["mimeType"],d),b}(g)),null!=(h=n(b,["thoughtSignature"]))&&m(c,["thoughtSignature"],h),null!=(i=n(b,["functionCall"]))&&m(c,["functionCall"],i),null!=(j=n(b,["codeExecutionResult"]))&&m(c,["codeExecutionResult"],j),null!=(k=n(b,["executableCode"]))&&m(c,["executableCode"],k),null!=(l=n(b,["functionResponse"]))&&m(c,["functionResponse"],l),null!=(o=n(b,["text"]))&&m(c,["text"],o),c})),m(b,["parts"],a)}let d=n(a,["role"]);return null!=d&&m(b,["role"],d),b}(W(p)));let q=n(a,["tools"]);if(void 0!==b&&null!=q){let a=ab(q);Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=n(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),m(b,["functionDeclarations"],a)}if(void 0!==n(a,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let d=n(a,["googleSearch"]);null!=d&&m(b,["googleSearch"],function(a){let b={},c=n(a,["timeRangeFilter"]);if(null!=c&&m(b,["timeRangeFilter"],c),void 0!==n(a,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return b}(d));let e=n(a,["googleSearchRetrieval"]);if(null!=e&&m(b,["googleSearchRetrieval"],e),void 0!==n(a,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let f=n(a,["googleMaps"]);null!=f&&m(b,["googleMaps"],function(a){let b={};if(void 0!==n(a,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let c=n(a,["enableWidget"]);return null!=c&&m(b,["enableWidget"],c),b}(f));let g=n(a,["urlContext"]);null!=g&&m(b,["urlContext"],g);let h=n(a,["computerUse"]);null!=h&&m(b,["computerUse"],h);let i=n(a,["codeExecution"]);return null!=i&&m(b,["codeExecution"],i),b})(aa(a)))),m(b,["setup","tools"],a)}let r=n(a,["sessionResumption"]);void 0!==b&&null!=r&&m(b,["setup","sessionResumption"],function(a){let b={},c=n(a,["handle"]);if(null!=c&&m(b,["handle"],c),void 0!==n(a,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return b}(r));let s=n(a,["inputAudioTranscription"]);void 0!==b&&null!=s&&m(b,["setup","inputAudioTranscription"],s);let t=n(a,["outputAudioTranscription"]);void 0!==b&&null!=t&&m(b,["setup","outputAudioTranscription"],t);let u=n(a,["realtimeInputConfig"]);void 0!==b&&null!=u&&m(b,["setup","realtimeInputConfig"],u);let v=n(a,["contextWindowCompression"]);void 0!==b&&null!=v&&m(b,["setup","contextWindowCompression"],v);let w=n(a,["proactivity"]);return void 0!==b&&null!=w&&m(b,["setup","proactivity"],w),{}}(c,a)),y=a}return delete y.config,w.send(JSON.stringify(y)),new a8(w,this.apiClient)}isCallableTool(a){return"callTool"in a&&"function"==typeof a.callTool}}let a7={turnComplete:!0};class a8{constructor(a,b){this.conn=a,this.apiClient=b}tLiveClientContent(a,b){if(null!==b.turns&&void 0!==b.turns){let c=[];try{c=Y(b.turns),a.isVertexAI()||(c=c.map(a=>aG(a)))}catch(a){throw Error(`Failed to parse client content "turns", type: '${typeof b.turns}'`)}return{clientContent:{turns:c,turnComplete:b.turnComplete}}}return{clientContent:{turnComplete:b.turnComplete}}}tLiveClienttToolResponse(a,b){let c=[];if(null==b.functionResponses||0===(c=Array.isArray(b.functionResponses)?b.functionResponses:[b.functionResponses]).length)throw Error("functionResponses is required.");for(let b of c){if("object"!=typeof b||null===b||!("name"in b)||!("response"in b))throw Error(`Could not parse function response, type '${typeof b}'.`);if(!a.isVertexAI()&&!("id"in b))throw Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}return{toolResponse:{functionResponses:c}}}sendClientContent(a){a=Object.assign(Object.assign({},a7),a);let b=this.tLiveClientContent(this.apiClient,a);this.conn.send(JSON.stringify(b))}sendRealtimeInput(a){let b={};b=this.apiClient.isVertexAI()?{realtimeInput:function(a){let b={},c=n(a,["media"]);if(null!=c){let a=N(c);Array.isArray(a)&&(a=a.map(a=>a)),m(b,["mediaChunks"],a)}let d=n(a,["audio"]);null!=d&&m(b,["audio"],Q(d));let e=n(a,["audioStreamEnd"]);null!=e&&m(b,["audioStreamEnd"],e);let f=n(a,["video"]);null!=f&&m(b,["video"],P(f));let g=n(a,["text"]);null!=g&&m(b,["text"],g);let h=n(a,["activityStart"]);null!=h&&m(b,["activityStart"],h);let i=n(a,["activityEnd"]);return null!=i&&m(b,["activityEnd"],i),b}(a)}:{realtimeInput:function(a){let b={},c=n(a,["media"]);if(null!=c){let a=N(c);Array.isArray(a)&&(a=a.map(a=>aE(a))),m(b,["mediaChunks"],a)}let d=n(a,["audio"]);null!=d&&m(b,["audio"],aE(Q(d)));let e=n(a,["audioStreamEnd"]);null!=e&&m(b,["audioStreamEnd"],e);let f=n(a,["video"]);null!=f&&m(b,["video"],aE(P(f)));let g=n(a,["text"]);null!=g&&m(b,["text"],g);let h=n(a,["activityStart"]);null!=h&&m(b,["activityStart"],h);let i=n(a,["activityEnd"]);return null!=i&&m(b,["activityEnd"],i),b}(a)},this.conn.send(JSON.stringify(b))}sendToolResponse(a){if(null==a.functionResponses)throw Error("Tool response parameters are required.");let b=this.tLiveClienttToolResponse(this.apiClient,a);this.conn.send(JSON.stringify(b))}close(){this.conn.close()}}function a9(a){var b,c,d;if(null==(b=null==a?void 0:a.automaticFunctionCalling)?void 0:b.disable)return!0;let e=!1;for(let b of null!=(c=null==a?void 0:a.tools)?c:[])if(ba(b)){e=!0;break}if(!e)return!0;let f=null==(d=null==a?void 0:a.automaticFunctionCalling)?void 0:d.maximumRemoteCalls;return(!(!f||!(f<0)&&Number.isInteger(f))||0==f)&&(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",f),!0)}function ba(a){return"callTool"in a&&"function"==typeof a.callTool}function bb(a){var b;return!(null==(b=null==a?void 0:a.automaticFunctionCalling)?void 0:b.ignoreCallHistory)}class bc extends k{constructor(a){super(),this.apiClient=a,this.generateContent=async a=>{var b,c,d,e,f,g,h,i,j,k,l;let m,n,o=await this.processParamsMaybeAddMcpUsage(a);if(this.maybeMoveToResponseJsonSchem(a),!(null!=(i=null==(h=null==(g=a.config)?void 0:g.tools)?void 0:h.some(a=>ba(a)))&&i)||a9(a.config))return await this.generateContentInternal(o);if(null!=(l=null==(k=null==(j=a.config)?void 0:j.tools)?void 0:k.some(a=>!ba(a)))&&l)throw Error("Automatic function calling with CallableTools and Tools is not yet supported.");let p=Y(o.contents),q=null!=(d=null==(c=null==(b=o.config)?void 0:b.automaticFunctionCalling)?void 0:c.maximumRemoteCalls)?d:10,r=0;for(;r<q&&(m=await this.generateContentInternal(o)).functionCalls&&0!==m.functionCalls.length;){let b=m.candidates[0].content,c=[];for(let b of null!=(f=null==(e=a.config)?void 0:e.tools)?f:[])if(ba(b)){let a=await b.callTool(m.functionCalls);c.push(...a)}r++,n={role:"user",parts:c},o.contents=Y(o.contents),o.contents.push(b),o.contents.push(n),bb(o.config)&&(p.push(b),p.push(n))}return bb(o.config)&&(m.automaticFunctionCallingHistory=p),m},this.generateContentStream=async a=>{if(this.maybeMoveToResponseJsonSchem(a),!a9(a.config))return await this.processAfcStream(a);{let b=await this.processParamsMaybeAddMcpUsage(a);return await this.generateContentStreamInternal(b)}},this.generateImages=async a=>await this.generateImagesInternal(a).then(a=>{var b;let c,d=[];if(null==a?void 0:a.generatedImages)for(let e of a.generatedImages)e&&(null==e?void 0:e.safetyAttributes)&&(null==(b=null==e?void 0:e.safetyAttributes)?void 0:b.contentType)==="Positive Prompt"?c=null==e?void 0:e.safetyAttributes:d.push(e);return c?{generatedImages:d,positivePromptSafetyAttributes:c,sdkHttpResponse:a.sdkHttpResponse}:{generatedImages:d,sdkHttpResponse:a.sdkHttpResponse}}),this.list=async a=>{var b;let c={config:Object.assign(Object.assign({},{queryBase:!0}),null==a?void 0:a.config)};if(this.apiClient.isVertexAI()&&!c.config.queryBase)if(null==(b=c.config)?void 0:b.filter)throw Error("Filtering tuned models list for Vertex AI is not currently supported");else c.config.filter="labels.tune-type:*";return new ar(c6.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(c),c)},this.editImage=async a=>{let b={model:a.model,prompt:a.prompt,referenceImages:[],config:a.config};return a.referenceImages&&a.referenceImages&&(b.referenceImages=a.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(b)},this.upscaleImage=async a=>{let b={numberOfImages:1,mode:"upscale"};a.config&&(b=Object.assign(Object.assign({},b),a.config));let c={model:a.model,image:a.image,upscaleFactor:a.upscaleFactor,config:b};return await this.upscaleImageInternal(c)},this.generateVideos=async a=>{var b,c,d,e,f,g;if((a.prompt||a.image||a.video)&&a.source)throw Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return!this.apiClient.isVertexAI()&&((null==(b=a.video)?void 0:b.uri)&&(null==(c=a.video)?void 0:c.videoBytes)?a.video={uri:a.video.uri,mimeType:a.video.mimeType}:(null==(e=null==(d=a.source)?void 0:d.video)?void 0:e.uri)&&(null==(g=null==(f=a.source)?void 0:f.video)?void 0:g.videoBytes)&&(a.source.video={uri:a.source.video.uri,mimeType:a.source.video.mimeType})),await this.generateVideosInternal(a)}}maybeMoveToResponseJsonSchem(a){a.config&&a.config.responseSchema&&!a.config.responseJsonSchema&&Object.keys(a.config.responseSchema).includes("$schema")&&(a.config.responseJsonSchema=a.config.responseSchema,delete a.config.responseSchema)}async processParamsMaybeAddMcpUsage(a){var b,c,d;let e=null==(b=a.config)?void 0:b.tools;if(!e)return a;let f=await Promise.all(e.map(async a=>ba(a)?await a.tool():a)),g={model:a.model,contents:a.contents,config:Object.assign(Object.assign({},a.config),{tools:f})};if(g.config.tools=f,a.config&&a.config.tools&&a_(a.config.tools)){let b=Object.assign({},null!=(d=null==(c=a.config.httpOptions)?void 0:c.headers)?d:{});0===Object.keys(b).length&&(b=this.apiClient.getDefaultHeaders()),a0(b),g.config.httpOptions=Object.assign(Object.assign({},a.config.httpOptions),{headers:b})}return g}async initAfcToolsMap(a){var b,c,d;let e=new Map;for(let f of null!=(c=null==(b=a.config)?void 0:b.tools)?c:[])if(ba(f))for(let a of null!=(d=(await f.tool()).functionDeclarations)?d:[]){if(!a.name)throw Error("Function declaration name is required.");if(e.has(a.name))throw Error(`Duplicate tool declaration name: ${a.name}`);e.set(a.name,f)}return e}async processAfcStream(a){var b,c,d;let e=null!=(d=null==(c=null==(b=a.config)?void 0:b.automaticFunctionCalling)?void 0:c.maximumRemoteCalls)?d:10,f=!1,g=0;return function(a,b,c){var d,h;return aw(this,arguments,function*(){for(var i,j,k,l;g<e;){f&&(g++,f=!1);let p=yield av(a.processParamsMaybeAddMcpUsage(c)),r=yield av(a.generateContentStreamInternal(p)),s=[],t=[];try{for(var m,n=!0,o=(j=void 0,ax(r));!(i=(m=yield av(o.next())).done);n=!0)if(l=m.value,n=!1,yield yield av(l),l.candidates&&(null==(d=l.candidates[0])?void 0:d.content)){for(let a of(t.push(l.candidates[0].content),null!=(h=l.candidates[0].content.parts)?h:[]))if(g<e&&a.functionCall){if(!a.functionCall.name)throw Error("Function call name was not returned by the model.");if(b.has(a.functionCall.name)){let c=yield av(b.get(a.functionCall.name).callTool([a.functionCall]));s.push(...c)}else throw Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${b.keys()}, mising tool: ${a.functionCall.name}`)}}}catch(a){j={error:a}}finally{try{!n&&!i&&(k=o.return)&&(yield av(k.call(o)))}finally{if(j)throw j.error}}if(s.length>0){f=!0;let a=new q;a.candidates=[{content:{role:"user",parts:s}}],yield yield av(a);let b=[];b.push(...t),b.push({role:"user",parts:s});let d=Y(c.contents).concat(b);c.contents=d}else break}})}(this,await this.initAfcToolsMap(a),a)}async generateContentInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=aI(this.apiClient,a);return f=l("{model}:generateContent",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=aK(a),c=new q;return Object.assign(c,b),c})}{let b=aH(this.apiClient,a);return f=l("{model}:generateContent",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=aJ(a),c=new q;return Object.assign(c,b),c})}}async generateContentStreamInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=aI(this.apiClient,a);return f=l("{model}:streamGenerateContent?alt=sse",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.requestStream({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(function(a){return aw(this,arguments,function*(){var b,c,d,e;try{for(var f,g=!0,h=ax(a);!(b=(f=yield av(h.next())).done);g=!0){e=f.value,g=!1;let a=aK((yield av(e.json())));a.sdkHttpResponse={headers:e.headers};let b=new q;Object.assign(b,a),yield yield av(b)}}catch(a){c={error:a}}finally{try{!g&&!b&&(d=h.return)&&(yield av(d.call(h)))}finally{if(c)throw c.error}}})})}{let b=aH(this.apiClient,a);return f=l("{model}:streamGenerateContent?alt=sse",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.requestStream({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(function(a){return aw(this,arguments,function*(){var b,c,d,e;try{for(var f,g=!0,h=ax(a);!(b=(f=yield av(h.next())).done);g=!0){e=f.value,g=!1;let a=aJ((yield av(e.json())));a.sdkHttpResponse={headers:e.headers};let b=new q;Object.assign(b,a),yield yield av(b)}}catch(a){c={error:a}}finally{try{!g&&!b&&(d=h.return)&&(yield av(d.call(h)))}finally{if(c)throw c.error}}})})}}async embedContent(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c,d,e,f,g,h={},i=n(b,["model"]);null!=i&&m(h,["_url","model"],L(a,i));let j=n(b,["contents"]);if(null!=j){let b=X(a,j);Array.isArray(b)&&(b=b.map(a=>a)),m(h,["instances[]","content"],b)}let k=n(b,["config"]);return null!=k&&(c=n(k,["taskType"]),void 0!==h&&null!=c&&m(h,["instances[]","task_type"],c),d=n(k,["title"]),void 0!==h&&null!=d&&m(h,["instances[]","title"],d),e=n(k,["outputDimensionality"]),void 0!==h&&null!=e&&m(h,["parameters","outputDimensionality"],e),f=n(k,["mimeType"]),void 0!==h&&null!=f&&m(h,["instances[]","mimeType"],f),g=n(k,["autoTruncate"]),void 0!==h&&null!=g&&m(h,["parameters","autoTruncate"],g)),h}(this.apiClient,a);return f=l("{model}:predict",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=n(a,["sdkHttpResponse"]);null!=c&&m(b,["sdkHttpResponse"],c);let d=n(a,["predictions[]","embeddings"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e,f,g,h;return c={},null!=(d=n(a,["values"]))&&m(c,["values"],d),null!=(e=n(a,["statistics"]))&&m(c,["statistics"],(f={},null!=(g=n(b=e,["truncated"]))&&m(f,["truncated"],g),null!=(h=n(b,["token_count"]))&&m(f,["tokenCount"],h),f)),c})),m(b,["embeddings"],a)}let e=n(a,["metadata"]);return null!=e&&m(b,["metadata"],e),b}(a),c=new r;return Object.assign(c,b),c})}{let b=function(a,b){let c={},d=n(b,["model"]);null!=d&&m(c,["_url","model"],L(a,d));let e=n(b,["contents"]);if(null!=e){let b=X(a,e);Array.isArray(b)&&(b=b.map(a=>a)),m(c,["requests[]","content"],b)}let f=n(b,["config"]);null!=f&&function(a,b){let c=n(a,["taskType"]);void 0!==b&&null!=c&&m(b,["requests[]","taskType"],c);let d=n(a,["title"]);void 0!==b&&null!=d&&m(b,["requests[]","title"],d);let e=n(a,["outputDimensionality"]);if(void 0!==b&&null!=e&&m(b,["requests[]","outputDimensionality"],e),void 0!==n(a,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==n(a,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.")}(f,c);let g=n(b,["model"]);return void 0!==g&&m(c,["requests[]","model"],L(a,g)),c}(this.apiClient,a);return f=l("{model}:batchEmbedContents",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=n(a,["sdkHttpResponse"]);null!=c&&m(b,["sdkHttpResponse"],c);let d=n(a,["embeddings"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>a)),m(b,["embeddings"],a)}let e=n(a,["metadata"]);return null!=e&&m(b,["metadata"],e),b}(a),c=new r;return Object.assign(c,b),c})}}async generateImagesInternal(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g,j,k,o,p,q,r,t,u,v,w,x,y,z,A,B,C,D,E,F=(f=this.apiClient,d={},null!=(e=n(a,["model"]))&&m(d,["_url","model"],L(f,e)),null!=(g=n(a,["prompt"]))&&m(d,["instances[0]","prompt"],g),null!=(j=n(a,["config"]))&&(k=n(j,["outputGcsUri"]),void 0!==d&&null!=k&&m(d,["parameters","storageUri"],k),o=n(j,["negativePrompt"]),void 0!==d&&null!=o&&m(d,["parameters","negativePrompt"],o),p=n(j,["numberOfImages"]),void 0!==d&&null!=p&&m(d,["parameters","sampleCount"],p),q=n(j,["aspectRatio"]),void 0!==d&&null!=q&&m(d,["parameters","aspectRatio"],q),r=n(j,["guidanceScale"]),void 0!==d&&null!=r&&m(d,["parameters","guidanceScale"],r),t=n(j,["seed"]),void 0!==d&&null!=t&&m(d,["parameters","seed"],t),u=n(j,["safetyFilterLevel"]),void 0!==d&&null!=u&&m(d,["parameters","safetySetting"],u),v=n(j,["personGeneration"]),void 0!==d&&null!=v&&m(d,["parameters","personGeneration"],v),w=n(j,["includeSafetyAttributes"]),void 0!==d&&null!=w&&m(d,["parameters","includeSafetyAttributes"],w),x=n(j,["includeRaiReason"]),void 0!==d&&null!=x&&m(d,["parameters","includeRaiReason"],x),y=n(j,["language"]),void 0!==d&&null!=y&&m(d,["parameters","language"],y),z=n(j,["outputMimeType"]),void 0!==d&&null!=z&&m(d,["parameters","outputOptions","mimeType"],z),A=n(j,["outputCompressionQuality"]),void 0!==d&&null!=A&&m(d,["parameters","outputOptions","compressionQuality"],A),B=n(j,["addWatermark"]),void 0!==d&&null!=B&&m(d,["parameters","addWatermark"],B),C=n(j,["labels"]),void 0!==d&&null!=C&&m(d,["labels"],C),D=n(j,["imageSize"]),void 0!==d&&null!=D&&m(d,["parameters","sampleImageSize"],D),E=n(j,["enhancePrompt"]),void 0!==d&&null!=E&&m(d,["parameters","enhancePrompt"],E)),d);return h=l("{model}:predict",F._url),i=F._query,delete F._url,delete F._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(F),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=n(a,["sdkHttpResponse"]);null!=c&&m(b,["sdkHttpResponse"],c);let d=n(a,["predictions"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>aL(a))),m(b,["generatedImages"],a)}let e=n(a,["positivePromptSafetyAttributes"]);return null!=e&&m(b,["positivePromptSafetyAttributes"],aS(e)),b}(a),c=new s;return Object.assign(c,b),c})}{let b,c,f,j,k=(g=this.apiClient,b={},null!=(c=n(a,["model"]))&&m(b,["_url","model"],L(g,c)),null!=(f=n(a,["prompt"]))&&m(b,["instances[0]","prompt"],f),null!=(j=n(a,["config"]))&&function(a,b){if(void 0!==n(a,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==n(a,["negativePrompt"]))throw Error("negativePrompt parameter is not supported in Gemini API.");let c=n(a,["numberOfImages"]);void 0!==b&&null!=c&&m(b,["parameters","sampleCount"],c);let d=n(a,["aspectRatio"]);void 0!==b&&null!=d&&m(b,["parameters","aspectRatio"],d);let e=n(a,["guidanceScale"]);if(void 0!==b&&null!=e&&m(b,["parameters","guidanceScale"],e),void 0!==n(a,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let f=n(a,["safetyFilterLevel"]);void 0!==b&&null!=f&&m(b,["parameters","safetySetting"],f);let g=n(a,["personGeneration"]);void 0!==b&&null!=g&&m(b,["parameters","personGeneration"],g);let h=n(a,["includeSafetyAttributes"]);void 0!==b&&null!=h&&m(b,["parameters","includeSafetyAttributes"],h);let i=n(a,["includeRaiReason"]);void 0!==b&&null!=i&&m(b,["parameters","includeRaiReason"],i);let j=n(a,["language"]);void 0!==b&&null!=j&&m(b,["parameters","language"],j);let k=n(a,["outputMimeType"]);void 0!==b&&null!=k&&m(b,["parameters","outputOptions","mimeType"],k);let l=n(a,["outputCompressionQuality"]);if(void 0!==b&&null!=l&&m(b,["parameters","outputOptions","compressionQuality"],l),void 0!==n(a,["addWatermark"]))throw Error("addWatermark parameter is not supported in Gemini API.");if(void 0!==n(a,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let o=n(a,["imageSize"]);if(void 0!==b&&null!=o&&m(b,["parameters","sampleImageSize"],o),void 0!==n(a,["enhancePrompt"]))throw Error("enhancePrompt parameter is not supported in Gemini API.")}(j,b),b);return h=l("{model}:predict",k._url),i=k._query,delete k._url,delete k._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(k),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=n(a,["sdkHttpResponse"]);null!=c&&m(b,["sdkHttpResponse"],c);let d=n(a,["predictions"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>{var b,c;let d,e,f,g,h,i,j;return d={},null!=(e=n(b=a,["_self"]))&&m(d,["image"],(f={},null!=(g=n(c=e,["bytesBase64Encoded"]))&&m(f,["imageBytes"],o(g)),null!=(h=n(c,["mimeType"]))&&m(f,["mimeType"],h),f)),null!=(i=n(b,["raiFilteredReason"]))&&m(d,["raiFilteredReason"],i),null!=(j=n(b,["_self"]))&&m(d,["safetyAttributes"],aR(j)),d})),m(b,["generatedImages"],a)}let e=n(a,["positivePromptSafetyAttributes"]);return null!=e&&m(b,["positivePromptSafetyAttributes"],aR(e)),b}(a),c=new s;return Object.assign(c,b),c})}}async editImageInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI()){let f=function(a,b){let c,d,e,f,g,h,i,j,k,l,o,p,q,r,s,t,u,v={},w=n(b,["model"]);null!=w&&m(v,["_url","model"],L(a,w));let x=n(b,["prompt"]);null!=x&&m(v,["instances[0]","prompt"],x);let y=n(b,["referenceImages"]);if(null!=y){let a=y;Array.isArray(a)&&(a=a.map(a=>(function(a){let b,c,d,e,f,g,h,i={},j=n(a,["referenceImage"]);null!=j&&m(i,["referenceImage"],aO(j));let k=n(a,["referenceId"]);null!=k&&m(i,["referenceId"],k);let l=n(a,["referenceType"]);null!=l&&m(i,["referenceType"],l);let o=n(a,["maskImageConfig"]);null!=o&&m(i,["maskImageConfig"],(b={},null!=(c=n(o,["maskMode"]))&&m(b,["maskMode"],c),null!=(d=n(o,["segmentationClasses"]))&&m(b,["maskClasses"],d),null!=(e=n(o,["maskDilation"]))&&m(b,["dilation"],e),b));let p=n(a,["controlImageConfig"]);null!=p&&m(i,["controlImageConfig"],(f={},null!=(g=n(p,["controlType"]))&&m(f,["controlType"],g),null!=(h=n(p,["enableControlImageComputation"]))&&m(f,["computeControl"],h),f));let q=n(a,["styleImageConfig"]);null!=q&&m(i,["styleImageConfig"],q);let r=n(a,["subjectImageConfig"]);return null!=r&&m(i,["subjectImageConfig"],r),i})(a))),m(v,["instances[0]","referenceImages"],a)}let z=n(b,["config"]);return null!=z&&(c=n(z,["outputGcsUri"]),void 0!==v&&null!=c&&m(v,["parameters","storageUri"],c),d=n(z,["negativePrompt"]),void 0!==v&&null!=d&&m(v,["parameters","negativePrompt"],d),e=n(z,["numberOfImages"]),void 0!==v&&null!=e&&m(v,["parameters","sampleCount"],e),f=n(z,["aspectRatio"]),void 0!==v&&null!=f&&m(v,["parameters","aspectRatio"],f),g=n(z,["guidanceScale"]),void 0!==v&&null!=g&&m(v,["parameters","guidanceScale"],g),h=n(z,["seed"]),void 0!==v&&null!=h&&m(v,["parameters","seed"],h),i=n(z,["safetyFilterLevel"]),void 0!==v&&null!=i&&m(v,["parameters","safetySetting"],i),j=n(z,["personGeneration"]),void 0!==v&&null!=j&&m(v,["parameters","personGeneration"],j),k=n(z,["includeSafetyAttributes"]),void 0!==v&&null!=k&&m(v,["parameters","includeSafetyAttributes"],k),l=n(z,["includeRaiReason"]),void 0!==v&&null!=l&&m(v,["parameters","includeRaiReason"],l),o=n(z,["language"]),void 0!==v&&null!=o&&m(v,["parameters","language"],o),p=n(z,["outputMimeType"]),void 0!==v&&null!=p&&m(v,["parameters","outputOptions","mimeType"],p),q=n(z,["outputCompressionQuality"]),void 0!==v&&null!=q&&m(v,["parameters","outputOptions","compressionQuality"],q),r=n(z,["addWatermark"]),void 0!==v&&null!=r&&m(v,["parameters","addWatermark"],r),s=n(z,["labels"]),void 0!==v&&null!=s&&m(v,["labels"],s),t=n(z,["editMode"]),void 0!==v&&null!=t&&m(v,["parameters","editMode"],t),u=n(z,["baseSteps"]),void 0!==v&&null!=u&&m(v,["parameters","editConfig","baseSteps"],u)),v}(this.apiClient,a);return d=l("{model}:predict",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=n(a,["sdkHttpResponse"]);null!=c&&m(b,["sdkHttpResponse"],c);let d=n(a,["predictions"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>aL(a))),m(b,["generatedImages"],a)}return b}(a),c=new t;return Object.assign(c,b),c})}throw Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(a){var b,c,d;let e="",f={};if(this.apiClient.isVertexAI()){let g,h,i,j,k,o,p,q,r,s,t,v,w,x,y=(d=this.apiClient,g={},null!=(h=n(a,["model"]))&&m(g,["_url","model"],L(d,h)),null!=(i=n(a,["image"]))&&m(g,["instances[0]","image"],aO(i)),null!=(j=n(a,["upscaleFactor"]))&&m(g,["parameters","upscaleConfig","upscaleFactor"],j),null!=(k=n(a,["config"]))&&(o=n(k,["outputGcsUri"]),void 0!==g&&null!=o&&m(g,["parameters","storageUri"],o),p=n(k,["includeRaiReason"]),void 0!==g&&null!=p&&m(g,["parameters","includeRaiReason"],p),q=n(k,["outputMimeType"]),void 0!==g&&null!=q&&m(g,["parameters","outputOptions","mimeType"],q),r=n(k,["outputCompressionQuality"]),void 0!==g&&null!=r&&m(g,["parameters","outputOptions","compressionQuality"],r),s=n(k,["enhanceInputImage"]),void 0!==g&&null!=s&&m(g,["parameters","upscaleConfig","enhanceInputImage"],s),t=n(k,["imagePreservationFactor"]),void 0!==g&&null!=t&&m(g,["parameters","upscaleConfig","imagePreservationFactor"],t),v=n(k,["labels"]),void 0!==g&&null!=v&&m(g,["labels"],v),w=n(k,["numberOfImages"]),void 0!==g&&null!=w&&m(g,["parameters","sampleCount"],w),x=n(k,["mode"]),void 0!==g&&null!=x&&m(g,["parameters","mode"],x)),g);return e=l("{model}:predict",y._url),f=y._query,delete y._url,delete y._query,this.apiClient.request({path:e,queryParams:f,body:JSON.stringify(y),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=n(a,["sdkHttpResponse"]);null!=c&&m(b,["sdkHttpResponse"],c);let d=n(a,["predictions"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>aL(a))),m(b,["generatedImages"],a)}return b}(a),c=new u;return Object.assign(c,b),c})}throw Error("This method is only supported by the Vertex AI.")}async recontextImage(a){var b,c,d;let e="",f={};if(this.apiClient.isVertexAI()){let g,h,i,j,k,o,p,q,r,s,t,u,w,x,y,z=(d=this.apiClient,g={},null!=(h=n(a,["model"]))&&m(g,["_url","model"],L(d,h)),null!=(i=n(a,["source"]))&&function(a,b){let c=n(a,["prompt"]);void 0!==b&&null!=c&&m(b,["instances[0]","prompt"],c);let d=n(a,["personImage"]);void 0!==b&&null!=d&&m(b,["instances[0]","personImage","image"],aO(d));let e=n(a,["productImages"]);if(void 0!==b&&null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>{let b,c;return b={},null!=(c=n(a,["productImage"]))&&m(b,["image"],aO(c)),b})),m(b,["instances[0]","productImages"],a)}}(i,g),null!=(j=n(a,["config"]))&&(k=n(j,["numberOfImages"]),void 0!==g&&null!=k&&m(g,["parameters","sampleCount"],k),o=n(j,["baseSteps"]),void 0!==g&&null!=o&&m(g,["parameters","editConfig","baseSteps"],o),p=n(j,["outputGcsUri"]),void 0!==g&&null!=p&&m(g,["parameters","storageUri"],p),q=n(j,["seed"]),void 0!==g&&null!=q&&m(g,["parameters","seed"],q),r=n(j,["safetyFilterLevel"]),void 0!==g&&null!=r&&m(g,["parameters","safetySetting"],r),s=n(j,["personGeneration"]),void 0!==g&&null!=s&&m(g,["parameters","personGeneration"],s),t=n(j,["addWatermark"]),void 0!==g&&null!=t&&m(g,["parameters","addWatermark"],t),u=n(j,["outputMimeType"]),void 0!==g&&null!=u&&m(g,["parameters","outputOptions","mimeType"],u),w=n(j,["outputCompressionQuality"]),void 0!==g&&null!=w&&m(g,["parameters","outputOptions","compressionQuality"],w),x=n(j,["enhancePrompt"]),void 0!==g&&null!=x&&m(g,["parameters","enhancePrompt"],x),y=n(j,["labels"]),void 0!==g&&null!=y&&m(g,["labels"],y)),g);return e=l("{model}:predict",z._url),f=z._query,delete z._url,delete z._query,this.apiClient.request({path:e,queryParams:f,body:JSON.stringify(z),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b=function(a){let b={},c=n(a,["predictions"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>aL(a))),m(b,["generatedImages"],a)}return b}(a),c=new v;return Object.assign(c,b),c})}throw Error("This method is only supported by the Vertex AI.")}async segmentImage(a){var b,c,d,e,f;let g="",h={};if(this.apiClient.isVertexAI()){let i,j,k,o,p,q,r,s,t,u,v,x,y,z,A,B=(d=this.apiClient,q={},null!=(r=n(a,["model"]))&&m(q,["_url","model"],L(d,r)),null!=(s=n(a,["source"]))&&(e=s,f=q,k=n(e,["prompt"]),void 0!==f&&null!=k&&m(f,["instances[0]","prompt"],k),o=n(e,["image"]),void 0!==f&&null!=o&&m(f,["instances[0]","image"],aO(o)),p=n(e,["scribbleImage"]),void 0!==f&&null!=p&&m(f,["instances[0]","scribble"],(i={},null!=(j=n(p,["image"]))&&m(i,["image"],aO(j)),i))),null!=(t=n(a,["config"]))&&(u=n(t,["mode"]),void 0!==q&&null!=u&&m(q,["parameters","mode"],u),v=n(t,["maxPredictions"]),void 0!==q&&null!=v&&m(q,["parameters","maxPredictions"],v),x=n(t,["confidenceThreshold"]),void 0!==q&&null!=x&&m(q,["parameters","confidenceThreshold"],x),y=n(t,["maskDilation"]),void 0!==q&&null!=y&&m(q,["parameters","maskDilation"],y),z=n(t,["binaryColorThreshold"]),void 0!==q&&null!=z&&m(q,["parameters","binaryColorThreshold"],z),A=n(t,["labels"]),void 0!==q&&null!=A&&m(q,["labels"],A)),q);return g=l("{model}:predict",B._url),h=B._query,delete B._url,delete B._query,this.apiClient.request({path:g,queryParams:h,body:JSON.stringify(B),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b=function(a){let b={},c=n(a,["predictions"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=n(a,["_self"]);null!=c&&m(b,["mask"],aM(c));let d=n(a,["labels"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>a)),m(b,["labels"],a)}return b})(a))),m(b,["generatedMasks"],a)}return b}(a),c=new w;return Object.assign(c,b),c})}throw Error("This method is only supported by the Vertex AI.")}async get(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g=(f=this.apiClient,d={},null!=(e=n(a,["model"]))&&m(d,["_url","name"],L(f,e)),d);return h=l("{name}",g._url),i=g._query,delete g._url,delete g._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(g),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>aQ(a))}{let b,c,f=(g=this.apiClient,b={},null!=(c=n(a,["model"]))&&m(b,["_url","name"],L(g,c)),b);return h=l("{name}",f._url),i=f._query,delete f._url,delete f._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(f),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>aP(a))}}async listInternal(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g,j,k,o,p=(f=this.apiClient,d={},null!=(e=n(a,["config"]))&&(g=n(e,["pageSize"]),void 0!==d&&null!=g&&m(d,["_query","pageSize"],g),j=n(e,["pageToken"]),void 0!==d&&null!=j&&m(d,["_query","pageToken"],j),k=n(e,["filter"]),void 0!==d&&null!=k&&m(d,["_query","filter"],k),o=n(e,["queryBase"]),void 0!==d&&null!=o&&m(d,["_url","models_url"],ah(f,o))),d);return h=l("{models_url}",p._url),i=p._query,delete p._url,delete p._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(p),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=n(a,["sdkHttpResponse"]);null!=c&&m(b,["sdkHttpResponse"],c);let d=n(a,["nextPageToken"]);null!=d&&m(b,["nextPageToken"],d);let e=n(a,["_self"]);if(null!=e){let a=ai(e);Array.isArray(a)&&(a=a.map(a=>aQ(a))),m(b,["models"],a)}return b}(a),c=new x;return Object.assign(c,b),c})}{let b,c,f,j,k,o,p=(g=this.apiClient,b={},null!=(c=n(a,["config"]))&&(f=n(c,["pageSize"]),void 0!==b&&null!=f&&m(b,["_query","pageSize"],f),j=n(c,["pageToken"]),void 0!==b&&null!=j&&m(b,["_query","pageToken"],j),k=n(c,["filter"]),void 0!==b&&null!=k&&m(b,["_query","filter"],k),o=n(c,["queryBase"]),void 0!==b&&null!=o&&m(b,["_url","models_url"],ah(g,o))),b);return h=l("{models_url}",p._url),i=p._query,delete p._url,delete p._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(p),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=n(a,["sdkHttpResponse"]);null!=c&&m(b,["sdkHttpResponse"],c);let d=n(a,["nextPageToken"]);null!=d&&m(b,["nextPageToken"],d);let e=n(a,["_self"]);if(null!=e){let a=ai(e);Array.isArray(a)&&(a=a.map(a=>aP(a))),m(b,["models"],a)}return b}(a),c=new x;return Object.assign(c,b),c})}}async update(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g,j,k,o,p=(f=this.apiClient,d={},null!=(e=n(a,["model"]))&&m(d,["_url","model"],L(f,e)),null!=(g=n(a,["config"]))&&(j=n(g,["displayName"]),void 0!==d&&null!=j&&m(d,["displayName"],j),k=n(g,["description"]),void 0!==d&&null!=k&&m(d,["description"],k),o=n(g,["defaultCheckpointId"]),void 0!==d&&null!=o&&m(d,["defaultCheckpointId"],o)),d);return h=l("{model}",p._url),i=p._query,delete p._url,delete p._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>aQ(a))}{let b,c,f,j,k,o,p=(g=this.apiClient,b={},null!=(c=n(a,["model"]))&&m(b,["_url","name"],L(g,c)),null!=(f=n(a,["config"]))&&(j=n(f,["displayName"]),void 0!==b&&null!=j&&m(b,["displayName"],j),k=n(f,["description"]),void 0!==b&&null!=k&&m(b,["description"],k),o=n(f,["defaultCheckpointId"]),void 0!==b&&null!=o&&m(b,["defaultCheckpointId"],o)),b);return h=l("{name}",p._url),i=p._query,delete p._url,delete p._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>aP(a))}}async delete(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g=(f=this.apiClient,d={},null!=(e=n(a,["model"]))&&m(d,["_url","name"],L(f,e)),d);return h=l("{name}",g._url),i=g._query,delete g._url,delete g._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(g),httpMethod:"DELETE",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b,c,d=(b={},null!=(c=n(a,["sdkHttpResponse"]))&&m(b,["sdkHttpResponse"],c),b),e=new y;return Object.assign(e,d),e})}{let b,c,f=(g=this.apiClient,b={},null!=(c=n(a,["model"]))&&m(b,["_url","name"],L(g,c)),b);return h=l("{name}",f._url),i=f._query,delete f._url,delete f._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b,c,d=(b={},null!=(c=n(a,["sdkHttpResponse"]))&&m(b,["sdkHttpResponse"],c),b),e=new y;return Object.assign(e,d),e})}}async countTokens(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=n(b,["model"]);null!=d&&m(c,["_url","model"],L(a,d));let e=n(b,["contents"]);if(null!=e){let a=Y(e);Array.isArray(a)&&(a=a.map(a=>a)),m(c,["contents"],a)}let f=n(b,["config"]);return null!=f&&function(a,b){let c=n(a,["systemInstruction"]);void 0!==b&&null!=c&&m(b,["systemInstruction"],W(c));let d=n(a,["tools"]);if(void 0!==b&&null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>aU(a))),m(b,["tools"],a)}let e=n(a,["generationConfig"]);void 0!==b&&null!=e&&m(b,["generationConfig"],function(a){let b={},c=n(a,["modelSelectionConfig"]);null!=c&&m(b,["modelConfig"],c);let d=n(a,["audioTimestamp"]);null!=d&&m(b,["audioTimestamp"],d);let e=n(a,["candidateCount"]);null!=e&&m(b,["candidateCount"],e);let f=n(a,["enableAffectiveDialog"]);null!=f&&m(b,["enableAffectiveDialog"],f);let g=n(a,["frequencyPenalty"]);null!=g&&m(b,["frequencyPenalty"],g);let h=n(a,["logprobs"]);null!=h&&m(b,["logprobs"],h);let i=n(a,["maxOutputTokens"]);null!=i&&m(b,["maxOutputTokens"],i);let j=n(a,["mediaResolution"]);null!=j&&m(b,["mediaResolution"],j);let k=n(a,["presencePenalty"]);null!=k&&m(b,["presencePenalty"],k);let l=n(a,["responseJsonSchema"]);null!=l&&m(b,["responseJsonSchema"],l);let o=n(a,["responseLogprobs"]);null!=o&&m(b,["responseLogprobs"],o);let p=n(a,["responseMimeType"]);null!=p&&m(b,["responseMimeType"],p);let q=n(a,["responseModalities"]);null!=q&&m(b,["responseModalities"],q);let r=n(a,["responseSchema"]);null!=r&&m(b,["responseSchema"],r);let s=n(a,["routingConfig"]);null!=s&&m(b,["routingConfig"],s);let t=n(a,["seed"]);null!=t&&m(b,["seed"],t);let u=n(a,["speechConfig"]);null!=u&&m(b,["speechConfig"],aT(u));let v=n(a,["stopSequences"]);null!=v&&m(b,["stopSequences"],v);let w=n(a,["temperature"]);null!=w&&m(b,["temperature"],w);let x=n(a,["thinkingConfig"]);null!=x&&m(b,["thinkingConfig"],x);let y=n(a,["topK"]);null!=y&&m(b,["topK"],y);let z=n(a,["topP"]);if(null!=z&&m(b,["topP"],z),void 0!==n(a,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return b}(e))}(f,c),c}(this.apiClient,a);return f=l("{model}:countTokens",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b,c,d,e=(b={},null!=(c=n(a,["sdkHttpResponse"]))&&m(b,["sdkHttpResponse"],c),null!=(d=n(a,["totalTokens"]))&&m(b,["totalTokens"],d),b),f=new z;return Object.assign(f,e),f})}{let b=function(a,b){let c={},d=n(b,["model"]);null!=d&&m(c,["_url","model"],L(a,d));let e=n(b,["contents"]);if(null!=e){let a=Y(e);Array.isArray(a)&&(a=a.map(a=>aG(a))),m(c,["contents"],a)}let f=n(b,["config"]);return null!=f&&function(a){if(void 0!==n(a,["systemInstruction"]))throw Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==n(a,["tools"]))throw Error("tools parameter is not supported in Gemini API.");if(void 0!==n(a,["generationConfig"]))throw Error("generationConfig parameter is not supported in Gemini API.")}(f),c}(this.apiClient,a);return f=l("{model}:countTokens",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b,c,d,e,f=(b={},null!=(c=n(a,["sdkHttpResponse"]))&&m(b,["sdkHttpResponse"],c),null!=(d=n(a,["totalTokens"]))&&m(b,["totalTokens"],d),null!=(e=n(a,["cachedContentTokenCount"]))&&m(b,["cachedContentTokenCount"],e),b),g=new z;return Object.assign(g,f),g})}}async computeTokens(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI()){let f=function(a,b){let c={},d=n(b,["model"]);null!=d&&m(c,["_url","model"],L(a,d));let e=n(b,["contents"]);if(null!=e){let a=Y(e);Array.isArray(a)&&(a=a.map(a=>a)),m(c,["contents"],a)}return c}(this.apiClient,a);return d=l("{model}:computeTokens",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=n(a,["sdkHttpResponse"]);null!=c&&m(b,["sdkHttpResponse"],c);let d=n(a,["tokensInfo"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>a)),m(b,["tokensInfo"],a)}return b}(a),c=new A;return Object.assign(c,b),c})}throw Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(a){var b,c,d,e,f,g,h,i,j,k;let p="",q={};if(this.apiClient.isVertexAI()){let d,e,g,j,k,r,s,t,u,v,w=(f=this.apiClient,j={},null!=(k=n(a,["model"]))&&m(j,["_url","model"],L(f,k)),null!=(r=n(a,["prompt"]))&&m(j,["instances[0]","prompt"],r),null!=(s=n(a,["image"]))&&m(j,["instances[0]","image"],aO(s)),null!=(t=n(a,["video"]))&&m(j,["instances[0]","video"],aW(t)),null!=(u=n(a,["source"]))&&(h=u,i=j,d=n(h,["prompt"]),void 0!==i&&null!=d&&m(i,["instances[0]","prompt"],d),e=n(h,["image"]),void 0!==i&&null!=e&&m(i,["instances[0]","image"],aO(e)),g=n(h,["video"]),void 0!==i&&null!=g&&m(i,["instances[0]","video"],aW(g))),null!=(v=n(a,["config"]))&&function(a,b){var c;let d,e,f,g=n(a,["numberOfVideos"]);void 0!==b&&null!=g&&m(b,["parameters","sampleCount"],g);let h=n(a,["outputGcsUri"]);void 0!==b&&null!=h&&m(b,["parameters","storageUri"],h);let i=n(a,["fps"]);void 0!==b&&null!=i&&m(b,["parameters","fps"],i);let j=n(a,["durationSeconds"]);void 0!==b&&null!=j&&m(b,["parameters","durationSeconds"],j);let k=n(a,["seed"]);void 0!==b&&null!=k&&m(b,["parameters","seed"],k);let l=n(a,["aspectRatio"]);void 0!==b&&null!=l&&m(b,["parameters","aspectRatio"],l);let o=n(a,["resolution"]);void 0!==b&&null!=o&&m(b,["parameters","resolution"],o);let p=n(a,["personGeneration"]);void 0!==b&&null!=p&&m(b,["parameters","personGeneration"],p);let q=n(a,["pubsubTopic"]);void 0!==b&&null!=q&&m(b,["parameters","pubsubTopic"],q);let r=n(a,["negativePrompt"]);void 0!==b&&null!=r&&m(b,["parameters","negativePrompt"],r);let s=n(a,["enhancePrompt"]);void 0!==b&&null!=s&&m(b,["parameters","enhancePrompt"],s);let t=n(a,["generateAudio"]);void 0!==b&&null!=t&&m(b,["parameters","generateAudio"],t);let u=n(a,["lastFrame"]);void 0!==b&&null!=u&&m(b,["instances[0]","lastFrame"],aO(u));let v=n(a,["referenceImages"]);if(void 0!==b&&null!=v){let a=v;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e;return c={},null!=(d=n(b=a,["image"]))&&m(c,["image"],aO(d)),null!=(e=n(b,["referenceType"]))&&m(c,["referenceType"],e),c})),m(b,["instances[0]","referenceImages"],a)}let w=n(a,["mask"]);void 0!==b&&null!=w&&m(b,["instances[0]","mask"],(d={},null!=(e=n(c=w,["image"]))&&m(d,["_self"],aO(e)),null!=(f=n(c,["maskMode"]))&&m(d,["maskMode"],f),d));let x=n(a,["compressionQuality"]);void 0!==b&&null!=x&&m(b,["parameters","compressionQuality"],x)}(v,j),j);return p=l("{model}:predictLongRunning",w._url),q=w._query,delete w._url,delete w._query,this.apiClient.request({path:p,queryParams:q,body:JSON.stringify(w),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b,c,d,e,f,g,h=(b={},null!=(c=n(a,["name"]))&&m(b,["name"],c),null!=(d=n(a,["metadata"]))&&m(b,["metadata"],d),null!=(e=n(a,["done"]))&&m(b,["done"],e),null!=(f=n(a,["error"]))&&m(b,["error"],f),null!=(g=n(a,["response"]))&&m(b,["response"],function(a){let b={},c=n(a,["videos"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e,f,g,h;return c={},null!=(d=n(a,["_self"]))&&m(c,["video"],(e={},null!=(f=n(b=d,["gcsUri"]))&&m(e,["uri"],f),null!=(g=n(b,["bytesBase64Encoded"]))&&m(e,["videoBytes"],o(g)),null!=(h=n(b,["mimeType"]))&&m(e,["mimeType"],h),e)),c})),m(b,["generatedVideos"],a)}let d=n(a,["raiMediaFilteredCount"]);null!=d&&m(b,["raiMediaFilteredCount"],d);let e=n(a,["raiMediaFilteredReasons"]);return null!=e&&m(b,["raiMediaFilteredReasons"],e),b}(g)),b),i=new B;return Object.assign(i,h),i})}{let b,c,f,h,i,r,s,t,u,v,w=(g=this.apiClient,h={},null!=(i=n(a,["model"]))&&m(h,["_url","model"],L(g,i)),null!=(r=n(a,["prompt"]))&&m(h,["instances[0]","prompt"],r),null!=(s=n(a,["image"]))&&m(h,["instances[0]","image"],aN(s)),null!=(t=n(a,["video"]))&&m(h,["instances[0]","video"],aV(t)),null!=(u=n(a,["source"]))&&(j=u,k=h,b=n(j,["prompt"]),void 0!==k&&null!=b&&m(k,["instances[0]","prompt"],b),c=n(j,["image"]),void 0!==k&&null!=c&&m(k,["instances[0]","image"],aN(c)),f=n(j,["video"]),void 0!==k&&null!=f&&m(k,["instances[0]","video"],aV(f))),null!=(v=n(a,["config"]))&&function(a,b){let c=n(a,["numberOfVideos"]);if(void 0!==b&&null!=c&&m(b,["parameters","sampleCount"],c),void 0!==n(a,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==n(a,["fps"]))throw Error("fps parameter is not supported in Gemini API.");let d=n(a,["durationSeconds"]);if(void 0!==b&&null!=d&&m(b,["parameters","durationSeconds"],d),void 0!==n(a,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let e=n(a,["aspectRatio"]);void 0!==b&&null!=e&&m(b,["parameters","aspectRatio"],e);let f=n(a,["resolution"]);void 0!==b&&null!=f&&m(b,["parameters","resolution"],f);let g=n(a,["personGeneration"]);if(void 0!==b&&null!=g&&m(b,["parameters","personGeneration"],g),void 0!==n(a,["pubsubTopic"]))throw Error("pubsubTopic parameter is not supported in Gemini API.");let h=n(a,["negativePrompt"]);void 0!==b&&null!=h&&m(b,["parameters","negativePrompt"],h);let i=n(a,["enhancePrompt"]);if(void 0!==b&&null!=i&&m(b,["parameters","enhancePrompt"],i),void 0!==n(a,["generateAudio"]))throw Error("generateAudio parameter is not supported in Gemini API.");let j=n(a,["lastFrame"]);void 0!==b&&null!=j&&m(b,["instances[0]","lastFrame"],aN(j));let k=n(a,["referenceImages"]);if(void 0!==b&&null!=k){let a=k;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e;return c={},null!=(d=n(b=a,["image"]))&&m(c,["image"],aN(d)),null!=(e=n(b,["referenceType"]))&&m(c,["referenceType"],e),c})),m(b,["instances[0]","referenceImages"],a)}if(void 0!==n(a,["mask"]))throw Error("mask parameter is not supported in Gemini API.");if(void 0!==n(a,["compressionQuality"]))throw Error("compressionQuality parameter is not supported in Gemini API.")}(v,h),h);return p=l("{model}:predictLongRunning",w._url),q=w._query,delete w._url,delete w._query,this.apiClient.request({path:p,queryParams:q,body:JSON.stringify(w),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>{let b,c,d,e,f,g,h=(b={},null!=(c=n(a,["name"]))&&m(b,["name"],c),null!=(d=n(a,["metadata"]))&&m(b,["metadata"],d),null!=(e=n(a,["done"]))&&m(b,["done"],e),null!=(f=n(a,["error"]))&&m(b,["error"],f),null!=(g=n(a,["response","generateVideoResponse"]))&&m(b,["response"],function(a){let b={},c=n(a,["generatedSamples"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e,f,g,h;return c={},null!=(d=n(a,["video"]))&&m(c,["video"],(e={},null!=(f=n(b=d,["uri"]))&&m(e,["uri"],f),null!=(g=n(b,["encodedVideo"]))&&m(e,["videoBytes"],o(g)),null!=(h=n(b,["encoding"]))&&m(e,["mimeType"],h),e)),c})),m(b,["generatedVideos"],a)}let d=n(a,["raiMediaFilteredCount"]);null!=d&&m(b,["raiMediaFilteredCount"],d);let e=n(a,["raiMediaFilteredReasons"]);return null!=e&&m(b,["raiMediaFilteredReasons"],e),b}(g)),b),i=new B;return Object.assign(i,h),i})}}}class bd extends k{constructor(a){super(),this.apiClient=a}async getVideosOperation(a){let b=a.operation,c=a.config;if(void 0===b.name||""===b.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let a,d=b.name.split("/operations/")[0];c&&"httpOptions"in c&&(a=c.httpOptions);let e=await this.fetchPredictVideosOperationInternal({operationName:b.name,resourceName:d,config:{httpOptions:a}});return b._fromAPIResponse({apiResponse:e,isVertexAI:!0})}{let a=await this.getVideosOperationInternal({operationName:b.name,config:c});return b._fromAPIResponse({apiResponse:a,isVertexAI:!1})}}async get(a){let b=a.operation,c=a.config;if(void 0===b.name||""===b.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let a,d=b.name.split("/operations/")[0];c&&"httpOptions"in c&&(a=c.httpOptions);let e=await this.fetchPredictVideosOperationInternal({operationName:b.name,resourceName:d,config:{httpOptions:a}});return b._fromAPIResponse({apiResponse:e,isVertexAI:!0})}{let a=await this.getVideosOperationInternal({operationName:b.name,config:c});return b._fromAPIResponse({apiResponse:a,isVertexAI:!1})}}async getVideosOperationInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d,e,h=(d={},null!=(e=n(a,["operationName"]))&&m(d,["_url","operationName"],e),d);return f=l("{operationName}",h._url),g=h._query,delete h._url,delete h._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json())}{let b,c,h=(b={},null!=(c=n(a,["operationName"]))&&m(b,["_url","operationName"],c),b);return f=l("{operationName}",h._url),g=h._query,delete h._url,delete h._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json())}}async fetchPredictVideosOperationInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI()){let f,g,h,i=(f={},null!=(g=n(a,["operationName"]))&&m(f,["operationName"],g),null!=(h=n(a,["resourceName"]))&&m(f,["_url","resourceName"],h),f);return d=l("{resourceName}:fetchPredictOperation",i._url),e=i._query,delete i._url,delete i._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json())}throw Error("This method is only supported by the Vertex AI.")}}class be extends k{constructor(a){super(),this.apiClient=a}async create(a){var b,c,d,e,f;let g="",h={};if(this.apiClient.isVertexAI())throw Error("The client.tokens.create method is only supported by the Gemini Developer API.");{let i,j,k,o,p,q,r,s,t,u,v=(d=this.apiClient,o={},null!=(p=n(a,["config"]))&&m(o,["config"],(q=n(p,["expireTime"]),void 0!==o&&null!=q&&m(o,["expireTime"],q),r=n(p,["newSessionExpireTime"]),void 0!==o&&null!=r&&m(o,["newSessionExpireTime"],r),s=n(p,["uses"]),void 0!==o&&null!=s&&m(o,["uses"],s),t=n(p,["liveConnectConstraints"]),void 0!==o&&null!=t&&m(o,["bidiGenerateContentSetup"],(e=d,i={},null!=(j=n(f=t,["model"]))&&m(i,["setup","model"],L(e,j)),null!=(k=n(f,["config"]))&&m(i,["config"],function(a,b){let c=n(a,["generationConfig"]);void 0!==b&&null!=c&&m(b,["setup","generationConfig"],c);let d=n(a,["responseModalities"]);void 0!==b&&null!=d&&m(b,["setup","generationConfig","responseModalities"],d);let e=n(a,["temperature"]);void 0!==b&&null!=e&&m(b,["setup","generationConfig","temperature"],e);let f=n(a,["topP"]);void 0!==b&&null!=f&&m(b,["setup","generationConfig","topP"],f);let g=n(a,["topK"]);void 0!==b&&null!=g&&m(b,["setup","generationConfig","topK"],g);let h=n(a,["maxOutputTokens"]);void 0!==b&&null!=h&&m(b,["setup","generationConfig","maxOutputTokens"],h);let i=n(a,["mediaResolution"]);void 0!==b&&null!=i&&m(b,["setup","generationConfig","mediaResolution"],i);let j=n(a,["seed"]);void 0!==b&&null!=j&&m(b,["setup","generationConfig","seed"],j);let k=n(a,["speechConfig"]);void 0!==b&&null!=k&&m(b,["setup","generationConfig","speechConfig"],_(k));let l=n(a,["thinkingConfig"]);void 0!==b&&null!=l&&m(b,["setup","generationConfig","thinkingConfig"],l);let o=n(a,["enableAffectiveDialog"]);void 0!==b&&null!=o&&m(b,["setup","generationConfig","enableAffectiveDialog"],o);let p=n(a,["systemInstruction"]);void 0!==b&&null!=p&&m(b,["setup","systemInstruction"],function(a){let b={},c=n(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e,f,g,h,i,j,k,l,o;return c={},null!=(d=n(b=a,["videoMetadata"]))&&m(c,["videoMetadata"],d),null!=(e=n(b,["thought"]))&&m(c,["thought"],e),null!=(f=n(b,["inlineData"]))&&m(c,["inlineData"],function(a){let b={};if(void 0!==n(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=n(a,["data"]);null!=c&&m(b,["data"],c);let d=n(a,["mimeType"]);return null!=d&&m(b,["mimeType"],d),b}(f)),null!=(g=n(b,["fileData"]))&&m(c,["fileData"],function(a){let b={};if(void 0!==n(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=n(a,["fileUri"]);null!=c&&m(b,["fileUri"],c);let d=n(a,["mimeType"]);return null!=d&&m(b,["mimeType"],d),b}(g)),null!=(h=n(b,["thoughtSignature"]))&&m(c,["thoughtSignature"],h),null!=(i=n(b,["functionCall"]))&&m(c,["functionCall"],i),null!=(j=n(b,["codeExecutionResult"]))&&m(c,["codeExecutionResult"],j),null!=(k=n(b,["executableCode"]))&&m(c,["executableCode"],k),null!=(l=n(b,["functionResponse"]))&&m(c,["functionResponse"],l),null!=(o=n(b,["text"]))&&m(c,["text"],o),c})),m(b,["parts"],a)}let d=n(a,["role"]);return null!=d&&m(b,["role"],d),b}(W(p)));let q=n(a,["tools"]);if(void 0!==b&&null!=q){let a=ab(q);Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=n(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),m(b,["functionDeclarations"],a)}if(void 0!==n(a,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let d=n(a,["googleSearch"]);null!=d&&m(b,["googleSearch"],function(a){let b={},c=n(a,["timeRangeFilter"]);if(null!=c&&m(b,["timeRangeFilter"],c),void 0!==n(a,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return b}(d));let e=n(a,["googleSearchRetrieval"]);if(null!=e&&m(b,["googleSearchRetrieval"],e),void 0!==n(a,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let f=n(a,["googleMaps"]);null!=f&&m(b,["googleMaps"],function(a){let b={};if(void 0!==n(a,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let c=n(a,["enableWidget"]);return null!=c&&m(b,["enableWidget"],c),b}(f));let g=n(a,["urlContext"]);null!=g&&m(b,["urlContext"],g);let h=n(a,["computerUse"]);null!=h&&m(b,["computerUse"],h);let i=n(a,["codeExecution"]);return null!=i&&m(b,["codeExecution"],i),b})(aa(a)))),m(b,["setup","tools"],a)}let r=n(a,["sessionResumption"]);void 0!==b&&null!=r&&m(b,["setup","sessionResumption"],function(a){let b={},c=n(a,["handle"]);if(null!=c&&m(b,["handle"],c),void 0!==n(a,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return b}(r));let s=n(a,["inputAudioTranscription"]);void 0!==b&&null!=s&&m(b,["setup","inputAudioTranscription"],s);let t=n(a,["outputAudioTranscription"]);void 0!==b&&null!=t&&m(b,["setup","outputAudioTranscription"],t);let u=n(a,["realtimeInputConfig"]);void 0!==b&&null!=u&&m(b,["setup","realtimeInputConfig"],u);let v=n(a,["contextWindowCompression"]);void 0!==b&&null!=v&&m(b,["setup","contextWindowCompression"],v);let w=n(a,["proactivity"]);return void 0!==b&&null!=w&&m(b,["setup","proactivity"],w),{}}(k,i)),i)),u=n(p,["lockAdditionalFields"]),void 0!==o&&null!=u&&m(o,["fieldMask"],u),{})),o);g=l("auth_tokens",v._url),h=v._query,delete v.config,delete v._url,delete v._query;let w=function(a,b){let c=null,d=a.bidiGenerateContentSetup;if("object"==typeof d&&null!==d&&"setup"in d){let b=d.setup;"object"==typeof b&&null!==b?(a.bidiGenerateContentSetup=b,c=b):delete a.bidiGenerateContentSetup}else void 0!==d&&delete a.bidiGenerateContentSetup;let e=a.fieldMask;if(c){let d=function(a){let b=[];for(let c in a)if(Object.prototype.hasOwnProperty.call(a,c)){let d=a[c];if("object"==typeof d&&null!=d&&Object.keys(d).length>0){let a=Object.keys(d).map(a=>`${c}.${a}`);b.push(...a)}else b.push(c)}return b.join(",")}(c);if(Array.isArray(null==b?void 0:b.lockAdditionalFields)&&(null==b?void 0:b.lockAdditionalFields.length)===0)d?a.fieldMask=d:delete a.fieldMask;else if((null==b?void 0:b.lockAdditionalFields)&&b.lockAdditionalFields.length>0&&null!==e&&Array.isArray(e)&&e.length>0){let b=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"],c=[];e.length>0&&(c=e.map(a=>b.includes(a)?`generationConfig.${a}`:a));let f=[];d&&f.push(d),c.length>0&&f.push(...c),f.length>0?a.fieldMask=f.join(","):delete a.fieldMask}else delete a.fieldMask}else null!==e&&Array.isArray(e)&&e.length>0?a.fieldMask=e.join(","):delete a.fieldMask;return a}(v,a.config);return this.apiClient.request({path:g,queryParams:h,body:JSON.stringify(w),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a)}}}let bf="x-goog-api-key",bg="https://www.googleapis.com/auth/cloud-platform";class bh{constructor(a){if(void 0!==a.apiKey){this.apiKey=a.apiKey;return}const b=function(a){let b;if(!a)return{scopes:[bg]};if((b=a).scopes){if("string"==typeof b.scopes&&b.scopes!==bg||Array.isArray(b.scopes)&&0>b.scopes.indexOf(bg))throw Error(`Invalid auth scopes. Scopes must include: ${bg}`)}else b.scopes=[bg];return b}(a.googleAuthOptions);this.googleAuth=new f.GoogleAuth(b)}async addAuthHeaders(a,b){if(void 0!==this.apiKey){if(this.apiKey.startsWith("auth_tokens/"))throw Error("Ephemeral tokens are only supported by the live API.");this.addKeyHeader(a);return}return this.addGoogleAuthHeaders(a,b)}addKeyHeader(a){if(null===a.get(bf)){if(void 0===this.apiKey)throw Error("Trying to set API key header but apiKey is not set");a.append(bf,this.apiKey)}}async addGoogleAuthHeaders(a,b){if(void 0===this.googleAuth)throw Error("Trying to set google-auth headers but googleAuth is unset");for(let[c,d]of(await this.googleAuth.getRequestHeaders(b)))null===a.get(c)&&a.append(c,d)}}class bi{async download(a,b){if(a.downloadPath){let c=await bj(a,b);if(c instanceof p){let b=(0,g.createWriteStream)(a.downloadPath);h.Readable.fromWeb(c.responseInternal.body).pipe(b)}else(0,g.writeFile)(a.downloadPath,c,{encoding:"base64"},b=>{if(b)throw Error(`Failed to write file to ${a.downloadPath}: ${b}`)})}}}async function bj(a,b){var c,d,e;let f=ag(a.file);if(void 0!==f)return await b.request({path:`files/${f}:download`,httpMethod:"GET",queryParams:{alt:"media"},httpOptions:null==(c=a.config)?void 0:c.httpOptions,abortSignal:null==(d=a.config)?void 0:d.abortSignal});if(ae(a.file)){let b=null==(e=a.file.video)?void 0:e.videoBytes;if("string"==typeof b)return b;throw Error("Failed to download generated video, Uri or videoBytes not found.")}if(af(a.file)){let b=a.file.videoBytes;if("string"==typeof b)return b;throw Error("Failed to download video, Uri or videoBytes not found.")}throw Error("Unsupported file type")}class bk{create(a,b,c){return new bl(a,b,c)}}class bl{constructor(a,b,c){this.url=a,this.headers=b,this.callbacks=c}connect(){this.ws=new i.default(this.url,{headers:this.headers}),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(a){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.send(a)}close(){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.close()}}function bm(a,b){let c,d,e,f={},g=n(a,["sdkHttpResponse"]);null!=g&&m(f,["sdkHttpResponse"],g);let h=n(a,["name"]);null!=h&&m(f,["name"],h);let i=n(a,["state"]);null!=i&&m(f,["state"],ad(i));let j=n(a,["createTime"]);null!=j&&m(f,["createTime"],j);let k=n(a,["tuningTask","startTime"]);null!=k&&m(f,["startTime"],k);let l=n(a,["tuningTask","completeTime"]);null!=l&&m(f,["endTime"],l);let o=n(a,["updateTime"]);null!=o&&m(f,["updateTime"],o);let p=n(a,["description"]);null!=p&&m(f,["description"],p);let q=n(a,["baseModel"]);null!=q&&m(f,["baseModel"],q);let r=n(a,["_self"]);return null!=r&&m(f,["tunedModel"],(c={},null!=(d=n(r,["name"]))&&m(c,["model"],d),null!=(e=n(r,["name"]))&&m(c,["endpoint"],e),c)),f}function bn(a,b){let c={},d=n(a,["sdkHttpResponse"]);null!=d&&m(c,["sdkHttpResponse"],d);let e=n(a,["name"]);null!=e&&m(c,["name"],e);let f=n(a,["state"]);null!=f&&m(c,["state"],ad(f));let g=n(a,["createTime"]);null!=g&&m(c,["createTime"],g);let h=n(a,["startTime"]);null!=h&&m(c,["startTime"],h);let i=n(a,["endTime"]);null!=i&&m(c,["endTime"],i);let j=n(a,["updateTime"]);null!=j&&m(c,["updateTime"],j);let k=n(a,["error"]);null!=k&&m(c,["error"],k);let l=n(a,["description"]);null!=l&&m(c,["description"],l);let o=n(a,["baseModel"]);null!=o&&m(c,["baseModel"],o);let p=n(a,["tunedModel"]);null!=p&&m(c,["tunedModel"],p);let q=n(a,["preTunedModel"]);null!=q&&m(c,["preTunedModel"],q);let r=n(a,["supervisedTuningSpec"]);null!=r&&m(c,["supervisedTuningSpec"],r);let s=n(a,["tuningDataStats"]);null!=s&&m(c,["tuningDataStats"],s);let t=n(a,["encryptionSpec"]);null!=t&&m(c,["encryptionSpec"],t);let u=n(a,["partnerModelTuningSpec"]);null!=u&&m(c,["partnerModelTuningSpec"],u);let v=n(a,["customBaseModel"]);null!=v&&m(c,["customBaseModel"],v);let w=n(a,["experiment"]);null!=w&&m(c,["experiment"],w);let x=n(a,["labels"]);null!=x&&m(c,["labels"],x);let y=n(a,["outputUri"]);null!=y&&m(c,["outputUri"],y);let z=n(a,["pipelineJob"]);null!=z&&m(c,["pipelineJob"],z);let A=n(a,["serviceAccount"]);null!=A&&m(c,["serviceAccount"],A);let B=n(a,["tunedModelDisplayName"]);null!=B&&m(c,["tunedModelDisplayName"],B);let C=n(a,["veoTuningSpec"]);return null!=C&&m(c,["veoTuningSpec"],C),c}class bo extends k{constructor(a){super(),this.apiClient=a,this.get=async a=>await this.getInternal(a),this.list=async(a={})=>new ar(c6.PAGED_ITEM_TUNING_JOBS,a=>this.listInternal(a),await this.listInternal(a),a),this.tune=async a=>{var b;if(this.apiClient.isVertexAI())if(a.baseModel.startsWith("projects/")){let c={tunedModelName:a.baseModel};(null==(b=a.config)?void 0:b.preTunedModelCheckpointId)&&(c.checkpointId=a.config.preTunedModelCheckpointId);let d=Object.assign(Object.assign({},a),{preTunedModel:c});return d.baseModel=void 0,await this.tuneInternal(d)}else{let b=Object.assign({},a);return await this.tuneInternal(b)}{let b=Object.assign({},a),c=await this.tuneMldevInternal(b),d="";return void 0!==c.metadata&&void 0!==c.metadata.tunedModel?d=c.metadata.tunedModel:void 0!==c.name&&c.name.includes("/operations/")&&(d=c.name.split("/operations/")[0]),{name:d,state:cD.JOB_STATE_QUEUED}}}}async getInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d,e,h=(d={},null!=(e=n(a,["name"]))&&m(d,["_url","name"],e),d);return f=l("{name}",h._url),g=h._query,delete h._url,delete h._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>bn(a))}{let b,c,h=(b={},null!=(c=n(a,["name"]))&&m(b,["_url","name"],c),b);return f=l("{name}",h._url),g=h._query,delete h._url,delete h._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>bm(a))}}async listInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d,e,h,i,j,k=(d={},null!=(e=n(a,["config"]))&&(h=n(e,["pageSize"]),void 0!==d&&null!=h&&m(d,["_query","pageSize"],h),i=n(e,["pageToken"]),void 0!==d&&null!=i&&m(d,["_query","pageToken"],i),j=n(e,["filter"]),void 0!==d&&null!=j&&m(d,["_query","filter"],j)),d);return f=l("tuningJobs",k._url),g=k._query,delete k._url,delete k._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(k),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a,b){let c={},d=n(a,["sdkHttpResponse"]);null!=d&&m(c,["sdkHttpResponse"],d);let e=n(a,["nextPageToken"]);null!=e&&m(c,["nextPageToken"],e);let f=n(a,["tuningJobs"]);if(null!=f){let a=f;Array.isArray(a)&&(a=a.map(a=>bn(a))),m(c,["tuningJobs"],a)}return c}(a),c=new C;return Object.assign(c,b),c})}{let b,c,h,i,j,k=(b={},null!=(c=n(a,["config"]))&&(h=n(c,["pageSize"]),void 0!==b&&null!=h&&m(b,["_query","pageSize"],h),i=n(c,["pageToken"]),void 0!==b&&null!=i&&m(b,["_query","pageToken"],i),j=n(c,["filter"]),void 0!==b&&null!=j&&m(b,["_query","filter"],j)),b);return f=l("tunedModels",k._url),g=k._query,delete k._url,delete k._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(k),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a,b){let c={},d=n(a,["sdkHttpResponse"]);null!=d&&m(c,["sdkHttpResponse"],d);let e=n(a,["nextPageToken"]);null!=e&&m(c,["nextPageToken"],e);let f=n(a,["tunedModels"]);if(null!=f){let a=f;Array.isArray(a)&&(a=a.map(a=>bm(a))),m(c,["tuningJobs"],a)}return c}(a),c=new C;return Object.assign(c,b),c})}}async cancel(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d,e,h=(d={},null!=(e=n(a,["name"]))&&m(d,["_url","name"],e),d);f=l("{name}:cancel",h._url),g=h._query,delete h._url,delete h._query,await this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal})}else{let b,c,h=(b={},null!=(c=n(a,["name"]))&&m(b,["_url","name"],c),b);f=l("{name}:cancel",h._url),g=h._query,delete h._url,delete h._query,await this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal})}}async tuneInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI()){let f,g,h,i,j,k=(f={},null!=(g=n(a,["baseModel"]))&&m(f,["baseModel"],g),null!=(h=n(a,["preTunedModel"]))&&m(f,["preTunedModel"],h),null!=(i=n(a,["trainingDataset"]))&&function(a,b,c){let d=n(a,["gcsUri"]);void 0!==b&&null!=d&&m(b,["supervisedTuningSpec","trainingDatasetUri"],d);let e=n(a,["vertexDatasetResource"]);if(void 0!==b&&null!=e&&m(b,["supervisedTuningSpec","trainingDatasetUri"],e),void 0!==n(a,["examples"]))throw Error("examples parameter is not supported in Vertex AI.")}(i,f),null!=(j=n(a,["config"]))&&function(a,b,c){var d;let e,f,g,h=n(a,["validationDataset"]);void 0!==b&&null!=h&&m(b,["supervisedTuningSpec"],(e={},null!=(f=n(d=h,["gcsUri"]))&&m(e,["validationDatasetUri"],f),null!=(g=n(d,["vertexDatasetResource"]))&&m(e,["validationDatasetUri"],g),e));let i=n(a,["tunedModelDisplayName"]);void 0!==b&&null!=i&&m(b,["tunedModelDisplayName"],i);let j=n(a,["description"]);void 0!==b&&null!=j&&m(b,["description"],j);let k=n(a,["epochCount"]);void 0!==b&&null!=k&&m(b,["supervisedTuningSpec","hyperParameters","epochCount"],k);let l=n(a,["learningRateMultiplier"]);void 0!==b&&null!=l&&m(b,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],l);let o=n(a,["exportLastCheckpointOnly"]);void 0!==b&&null!=o&&m(b,["supervisedTuningSpec","exportLastCheckpointOnly"],o);let p=n(a,["adapterSize"]);if(void 0!==b&&null!=p&&m(b,["supervisedTuningSpec","hyperParameters","adapterSize"],p),void 0!==n(a,["batchSize"]))throw Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==n(a,["learningRate"]))throw Error("learningRate parameter is not supported in Vertex AI.");let q=n(a,["labels"]);void 0!==b&&null!=q&&m(b,["labels"],q)}(j,f),f);return d=l("tuningJobs",k._url),e=k._query,delete k._url,delete k._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(k),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>bn(a))}throw Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f,g,h,i,j,k=(f={},null!=(g=n(a,["baseModel"]))&&m(f,["baseModel"],g),null!=(h=n(a,["preTunedModel"]))&&m(f,["preTunedModel"],h),null!=(i=n(a,["trainingDataset"]))&&m(f,["tuningTask","trainingData"],function(a,b){let c={};if(void 0!==n(a,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==n(a,["vertexDatasetResource"]))throw Error("vertexDatasetResource parameter is not supported in Gemini API.");let d=n(a,["examples"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>a)),m(c,["examples","examples"],a)}return c}(i)),null!=(j=n(a,["config"]))&&function(a,b,c){if(void 0!==n(a,["validationDataset"]))throw Error("validationDataset parameter is not supported in Gemini API.");let d=n(a,["tunedModelDisplayName"]);if(void 0!==b&&null!=d&&m(b,["displayName"],d),void 0!==n(a,["description"]))throw Error("description parameter is not supported in Gemini API.");let e=n(a,["epochCount"]);void 0!==b&&null!=e&&m(b,["tuningTask","hyperparameters","epochCount"],e);let f=n(a,["learningRateMultiplier"]);if(null!=f&&m({},["tuningTask","hyperparameters","learningRateMultiplier"],f),void 0!==n(a,["exportLastCheckpointOnly"]))throw Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==n(a,["preTunedModelCheckpointId"]))throw Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(void 0!==n(a,["adapterSize"]))throw Error("adapterSize parameter is not supported in Gemini API.");let g=n(a,["batchSize"]);void 0!==b&&null!=g&&m(b,["tuningTask","hyperparameters","batchSize"],g);let h=n(a,["learningRate"]);if(void 0!==b&&null!=h&&m(b,["tuningTask","hyperparameters","learningRate"],h),void 0!==n(a,["labels"]))throw Error("labels parameter is not supported in Gemini API.")}(j,f),f);return d=l("tunedModels",k._url),e=k._query,delete k._url,delete k._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(k),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b,c,d,e,f,g;return b={},null!=(c=n(a,["sdkHttpResponse"]))&&m(b,["sdkHttpResponse"],c),null!=(d=n(a,["name"]))&&m(b,["name"],d),null!=(e=n(a,["metadata"]))&&m(b,["metadata"],e),null!=(f=n(a,["done"]))&&m(b,["done"],f),null!=(g=n(a,["error"]))&&m(b,["error"],g),b})}}}let bp="x-goog-upload-status";async function bq(a,b,c){var d,e,f;let g=0,h=0,i=new p(new Response),j="upload";for(g=a.size;h<g;){let f=Math.min(8388608,g-h),k=a.slice(h,h+f);h+f>=g&&(j+=", finalize");let l=0,m=1e3;for(;l<3&&(null==(d=null==(i=await c.request({path:"",body:k,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:b,headers:{"X-Goog-Upload-Command":j,"X-Goog-Upload-Offset":String(h),"Content-Length":String(f)}}}))?void 0:i.headers)||!d[bp]);)l++,await bs(m),m*=2;if(h+=f,(null==(e=null==i?void 0:i.headers)?void 0:e[bp])!=="active")break;if(g<=h)throw Error("All content has been uploaded, but the upload status is not finalized.")}let k=await (null==i?void 0:i.json());if((null==(f=null==i?void 0:i.headers)?void 0:f[bp])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");return k.file}async function br(a){return{size:a.size,type:a.type}}function bs(a){return new Promise(b=>setTimeout(b,a))}class bt{async stat(a){let b={size:0,type:void 0};return"string"==typeof a?(b.size=(await j.stat(a)).size,b.type=this.inferMimeType(a),b):await br(a)}async upload(a,b,c){return"string"==typeof a?await this.uploadFileFromPath(a,b,c):bq(a,b,c)}inferMimeType(a){return({aac:"audio/aac",abw:"application/x-abiword",arc:"application/x-freearc",avi:"video/x-msvideo",azw:"application/vnd.amazon.ebook",bin:"application/octet-stream",bmp:"image/bmp",bz:"application/x-bzip",bz2:"application/x-bzip2",csh:"application/x-csh",css:"text/css",csv:"text/csv",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",eot:"application/vnd.ms-fontobject",epub:"application/epub+zip",gz:"application/gzip",gif:"image/gif",htm:"text/html",html:"text/html",ico:"image/vnd.microsoft.icon",ics:"text/calendar",jar:"application/java-archive",jpeg:"image/jpeg",jpg:"image/jpeg",js:"text/javascript",json:"application/json",jsonld:"application/ld+json",kml:"application/vnd.google-earth.kml+xml",kmz:"application/vnd.google-earth.kmz+xml",mjs:"text/javascript",mp3:"audio/mpeg",mp4:"video/mp4",mpeg:"video/mpeg",mpkg:"application/vnd.apple.installer+xml",odt:"application/vnd.oasis.opendocument.text",oga:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",opus:"audio/opus",otf:"font/otf",png:"image/png",pdf:"application/pdf",php:"application/x-httpd-php",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",rar:"application/vnd.rar",rtf:"application/rtf",sh:"application/x-sh",svg:"image/svg+xml",swf:"application/x-shockwave-flash",tar:"application/x-tar",tif:"image/tiff",tiff:"image/tiff",ts:"video/mp2t",ttf:"font/ttf",txt:"text/plain",vsd:"application/vnd.visio",wav:"audio/wav",weba:"audio/webm",webm:"video/webm",webp:"image/webp",woff:"font/woff",woff2:"font/woff2",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml:"application/xml",xul:"application/vnd.mozilla.xul+xml",zip:"application/zip","3gp":"video/3gpp","3g2":"video/3gpp2","7z":"application/x-7z-compressed"})[a.slice(a.lastIndexOf(".")+1).toLowerCase()]}async uploadFileFromPath(a,b,c){var d,e,f;let g,h=0,i=0,k=new p(new Response),l="upload";try{if(!(g=await j.open(a,"r")))throw Error("Failed to open file");for(h=(await g.stat()).size;i<h;){let a=Math.min(8388608,h-i);i+a>=h&&(l+=", finalize");let f=new Uint8Array(a),{bytesRead:j}=await g.read(f,0,a,i);if(j!==a)throw Error(`Failed to read ${a} bytes from file at offset ${i}. bytes actually read: ${j}`);let m=new Blob([f]),n=0,o=1e3;for(;n<3&&(null==(d=null==(k=await c.request({path:"",body:m,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:b,headers:{"X-Goog-Upload-Command":l,"X-Goog-Upload-Offset":String(i),"Content-Length":String(j)}}}))?void 0:k.headers)||!d[bp]);)n++,await bs(o),o*=2;if(i+=j,(null==(e=null==k?void 0:k.headers)?void 0:e[bp])!=="active")break;if(h<=i)throw Error("All content has been uploaded, but the upload status is not finalized.")}let m=await (null==k?void 0:k.json());if((null==(f=null==k?void 0:k.headers)?void 0:f[bp])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");return m.file}finally{g&&await g.close()}}}function bu(a){var b,c,d;return null!=(d=null==(c=null==(b=null==process?void 0:process.env)?void 0:b[a])?void 0:c.trim())?d:void 0}process.env.GEMINI_API_KEY?console.log(" [GeminiService] GEMINI_API_KEY detectada com sucesso."):console.error(" [GeminiService] Varivel de ambiente GEMINI_API_KEY no configurada!");let bv=new class{constructor(a){var d,e,f,g,h,i;if((a.project||a.location)&&a.apiKey)throw Error("Project/location and API key are mutually exclusive in the client initializer.");this.vertexai=null!=(e=null!=(d=a.vertexai)?d:function(a){var b;return void 0!==(b=bu(a))&&"true"===b.toLowerCase()}("GOOGLE_GENAI_USE_VERTEXAI"))&&e;const j=function(){let a=bu("GOOGLE_API_KEY"),b=bu("GEMINI_API_KEY");return a&&b&&console.warn("Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY."),a||b||void 0}(),k=bu("GOOGLE_CLOUD_PROJECT"),l=bu("GOOGLE_CLOUD_LOCATION");this.apiKey=null!=(f=a.apiKey)?f:j,this.project=null!=(g=a.project)?g:k,this.location=null!=(h=a.location)?h:l,a.vertexai&&((null==(i=a.googleAuthOptions)?void 0:i.credentials)&&(console.debug("The user provided Google Cloud credentials will take precedence over the API key from the environment variable."),this.apiKey=void 0),(k||l)&&a.apiKey?(console.debug("The user provided Vertex AI API key will take precedence over the project/location from the environment variables."),this.project=void 0,this.location=void 0):(a.project||a.location)&&j?(console.debug("The user provided project/location will take precedence over the API key from the environment variables."),this.apiKey=void 0):(k||l)&&j&&(console.debug("The project/location from the environment variables will take precedence over the API key from the environment variables."),this.apiKey=void 0));const m=function(a,d,e,f){return(null==a?void 0:a.baseUrl)?a.baseUrl:d?null!=c?c:e:null!=b?b:f}(a.httpOptions,a.vertexai,bu("GOOGLE_VERTEX_BASE_URL"),bu("GOOGLE_GEMINI_BASE_URL"));m&&(a.httpOptions?a.httpOptions.baseUrl=m:a.httpOptions={baseUrl:m}),this.apiVersion=a.apiVersion;const n=new bh({apiKey:this.apiKey,googleAuthOptions:a.googleAuthOptions});this.apiClient=new aZ({auth:n,project:this.project,location:this.location,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:a.httpOptions,userAgentExtra:"gl-node/"+process.version,uploader:new bt,downloader:new bi}),this.models=new bc(this.apiClient),this.live=new a6(this.apiClient,n,new bk),this.batches=new as(this.apiClient),this.chats=new aA(this.models,this.apiClient),this.caches=new au(this.apiClient),this.files=new aD(this.apiClient),this.operations=new bd(this.apiClient),this.authTokens=new be(this.apiClient),this.tunings=new bo(this.apiClient)}}({apiKey:process.env.GEMINI_API_KEY});process.env.REMOTE_POST_URL,process.env.REMOTE_POST_API_KEY;let bw=async(a,b,c)=>{console.log(" [writeNewsArticle] Iniciando gerao do artigo..."),console.log(`[writeNewsArticle] Tema: ${a}`),console.log(`[writeNewsArticle] Idioma: ${b}`),console.log(`[writeNewsArticle] Palavras-chave: ${c}`);try{let d=`
Voc\xea \xe9 um jornalista cat\xf3lico de aproximadamente 25 anos, com um dom especial para contar hist\xf3rias inspiradoras sobre os Santos da Igreja Cat\xf3lica. 
Voc\xea escreve para o Blog Tio Ben  um blog cat\xf3lico jovem e envolvente, que busca evangelizar e inspirar seus leitores atrav\xe9s da vida dos Santos. 

Seu estilo \xe9 leve, natural e empolgante  como um amigo que sabe muito sobre a f\xe9 e compartilha hist\xf3rias de forma calorosa e verdadeira. 
N\xe3o use g\xedrias ou express\xf5es populares demais, mas evite tamb\xe9m a linguagem excessivamente formal. 
Seu texto deve soar aut\xeantico, humano e profundamente cat\xf3lico. 

 **Fontes e Verdade Doutrinal:**
- Suas refer\xeancias principais s\xe3o documentos e fontes oficiais da Igreja Cat\xf3lica, especialmente o site do Vaticano (vatican.va), o Missal Romano e o Diret\xf3rio dos Santos.
- Nunca invente fatos. Se n\xe3o houver informa\xe7\xe3o sobre algum aspecto, apenas omita. 
- Toda a narrativa deve estar em plena comunh\xe3o com o Magist\xe9rio e a Tradi\xe7\xe3o da Igreja.

 **Estrutura do Artigo (SEO e Conte\xfado):**
O artigo deve ter:
1. **T\xedtulo** criativo e inspirador.
2. **Subt\xedtulo** curto e cativante.
3. **Se\xe7\xe3o do Dia de Celebra\xe7\xe3o**  contendo a **Liturgia do Dia** (1\xaa Leitura, 2\xaa Leitura  se houver , Salmo e Evangelho).
4. **Introdu\xe7\xe3o envolvente**, que desperte a curiosidade do leitor e o conecte espiritualmente com o Santo.
5. **Corpo do texto** dividido em se\xe7\xf5es com subt\xedtulos claros:
   -  *Origem e nascimento*: onde e quando nasceu, contexto hist\xf3rico.
   -  *Caminho de f\xe9 e miss\xe3o*: principais fatos da vida, voca\xe7\xe3o, virtudes.
   -  *Milagres e testemunhos*: fatos reconhecidos pela Igreja ou pela tradi\xe7\xe3o.
   -  *Dia de celebra\xe7\xe3o*: data lit\xfargica e sentido espiritual.
   -  *Padroeiro e devo\xe7\xf5es*: se for padroeiro de algo, explique com clareza.
   -  *Ora\xe7\xe3o ao Santo* (caso exista oficialmente na tradi\xe7\xe3o).
   -  *Li\xe7\xe3o de vida*: o que sua hist\xf3ria ensina para os crist\xe3os de hoje, especialmente os jovens.
6. **Conclus\xe3o inspiradora**, que motive o leitor a buscar uma vida mais santa e pr\xf3xima de Deus.

 **Recursos estil\xedsticos:**
- Use **emojis** com modera\xe7\xe3o para dar leveza e simpatia ao texto (ex: , , , , , ).
- Use **listas e t\xf3picos** quando fizer sentido.
- Destaque palavras-chave importantes com **negrito**.
- Os subt\xedtulos devem ser marcados com '##' (Markdown) para SEO e clareza visual.
- O texto deve ter uma **densidade equilibrada de palavras-chave** e uma **meta description natural**.

 **SEO e Palavras-chave:**
Durante a escrita, tente incorporar de forma natural e relevante as seguintes palavras-chave: ${c}. 
N\xe3o force a inclus\xe3o se n\xe3o parecer natural; priorize a fluidez e o sentido espiritual do texto.

 **Instru\xe7\xe3o de Escrita:**
Escreva um artigo cativante e detalhado sobre "${a}". 
O artigo deve ter um t\xedtulo claro, uma introdu\xe7\xe3o envolvente, subt\xedtulos tem\xe1ticos, corpo bem estruturado e uma conclus\xe3o edificante. 
O tom deve ser inspirador e pr\xf3ximo, adequado para jovens cat\xf3licos que buscam crescer na f\xe9. 
O idioma do artigo deve ser: ${b}.
`;console.log(" [writeNewsArticle] Enviando prompt para o modelo gemini-2.5-pro...");let e=await bv.models.generateContent({model:"gemini-2.0-flash",contents:[{parts:[{text:d}]}]});return console.log(" [writeNewsArticle] Artigo gerado com sucesso."),e.text}catch(a){throw console.error(" [writeNewsArticle] Erro:",a),Error("Falha ao gerar o artigo de notcia pela IA.")}},bx=async a=>{console.log(" [formatArticleToHtml] Iniciando formatao do artigo..."),console.log("[formatArticleToHtml] Tamanho do texto recebido:",a.length);try{let b=`
Voc\xea \xe9 um assistente editorial e web designer cat\xf3lico especializado em formata\xe7\xe3o de artigos para o Blog Tio Ben. 
Seu papel \xe9 receber um texto em linguagem natural  uma mat\xe9ria sobre a vida de um santo  e convert\xea-la em um artigo HTML completo, elegante e semanticamente otimizado para SEO e responsividade.

O texto da mat\xe9ria chega no seguinte par\xe2metro:  
${a}

 **Contexto:**
O artigo original foi escrito por outro agente (um jornalista cat\xf3lico) e j\xe1 segue as tradi\xe7\xf5es da Igreja e o tom espiritual do Blog Tio Ben. 
Sua tarefa N\xc3O \xe9 reescrever o conte\xfado, mas format\xe1-lo em HTML conforme o modelo abaixo, adaptando t\xedtulos, subt\xedtulos e se\xe7\xf5es com estrutura sem\xe2ntica e estiliza\xe7\xe3o coerente com TailwindCSS, conforme o padr\xe3o do site.

---

 **ESTRUTURA BASE (modelo obrigat\xf3rio):**
O HTML deve sempre seguir este esqueleto principal:

<article class="post-santo max-w-3xl mx-auto p-4 sm lg bg-white font-sans text-gray-800 leading-relaxed min-h-screen">

  <!--  Bloco SEO: Data da Celebra\xe7\xe3o e Link para Liturgia -->
  <section id="data-celebracao" class="mb-8 p-4 bg-indigo-50 border border-indigo-100 rounded-lg">
    <h1 class="text-3xl font-extrabold text-indigo-700 mb-2">[Nome do Santo]  [Data de Celebra\xe7\xe3o]</h1>
    <p class="text-gray-700 text-base mb-3">
      No dia <time datetime="[aaaa-mm-dd]">[data por extenso]</time>, a Igreja celebra 
      <strong class="text-indigo-600">[Nome do Santo]</strong>. 
      [Breve resumo sobre o santo e o significado do dia.]
      Acompanhe tamb\xe9m a 
      <a href="https://www.iatioben.com.br/liturgia-diaria/[dd-mm-yyyy]" 
         class="text-indigo-600 font-semibold hover:underline" 
         target="_blank" 
         rel="noopener noreferrer">
        Liturgia Di\xe1ria de [data]
      </a>.
    </p>
  </section>

  <header class="mb-10 border-b border-indigo-200 pb-4">
    <h2 class="text-3xl sm font-extrabold text-indigo-700 mb-2 leading-tight">[T\xedtulo principal do artigo]</h2>
    <p class="introducao text-lg text-gray-600 italic">[Par\xe1grafo introdut\xf3rio]</p>
  </header>

  <!-- Se\xe7\xf5es tem\xe1ticas -->
  <section id="[slug-secao]" aria-labelledby="[titulo-secao]" class="mb-10 pt-4 border-b border-gray-100 pb-6">
    <h3 id="[titulo-secao]" class="dia-liturgia text-2xl font-bold text-gray-900 mb-3 sm">
      <span class="text-indigo-500 mr-2">[emoji]</span> [T\xedtulo da se\xe7\xe3o]
    </h3>
    <p class="mb-4">[Par\xe1grafo 1]</p>
    <p class="mb-4">[Par\xe1grafo 2]</p>
  </section>

  <!-- Se\xe7\xf5es finais -->
  <section id="resumo-seo" aria-labelledby="titulo-resumo" class="resumo-post p-5 border border-indigo-100 rounded-lg mb-10 bg-indigo-50">
    <h3 id="titulo-resumo" class="text-xl font-bold text-indigo-700 mb-3"> Ficha T\xe9cnica (SEO)</h3>
    <ul class="lista-resumo space-y-2 text-sm">
      <li><strong class="font-semibold text-gray-700">Tema central:</strong> [resumo do tema]</li>
      <li><strong class="font-semibold text-gray-700">Foco:</strong> [descri\xe7\xe3o resumida do foco]</li>
    </ul>
  </section>

  <footer class="rodape-post mt-10 pt-6 border-t border-gray-200">
    <h3 class="chamada-acao text-xl font-bold text-gray-900 mb-3"> Conecte F\xe9 e Humanismo</h3>
    <p class="text-gray-600">
      Inspire-se em <strong class="text-indigo-600">[Nome do Santo]</strong> e viva sua f\xe9 com coragem, esperan\xe7a e amor.
    </p>
  </footer>
</article>

---

 **INSTRU\xc7\xd5ES DE CONVERS\xc3O E FORMATA\xc7\xc3O:**

1. Use o conte\xfado recebido em \`${a}\` para preencher todas as se\xe7\xf5es do modelo.
2. Identifique automaticamente introdu\xe7\xe3o, corpo e conclus\xe3o e distribua em se\xe7\xf5es coerentes.
3. Utilize **emojis tem\xe1ticos cat\xf3licos** nos t\xedtulos ().
4. Gere **IDs sem\xe2nticos** para cada se\xe7\xe3o (ex: infancia-formacao, milagres, legado, oracao, li\xe7\xe3o-de-vida etc.).
5. As classes Tailwind devem ser **mantidas exatamente como no modelo.**
6. O HTML deve ser **responsivo, mobile first e semanticamente estruturado.**
7. Todos os links externos devem usar **target="_blank" e rel="noopener noreferrer".**
8. Formate datas com o atributo \`datetime="yyyy-mm-dd"\`.
9. Destaque termos importantes com **<strong>** e **<em>**.
10. Crie uma se\xe7\xe3o **"Ficha T\xe9cnica (SEO)"** ao final com resumo e foco do texto.

---

 **LINKS DE CONTEXTO INTELIGENTES (IA Tio Ben):**
Durante a formata\xe7\xe3o, **identifique express\xf5es, nomes ou fatos que possam despertar curiosidade** e converta-os em links que direcionem para a pesquisa na IA Tio Ben.  
Use o formato:

<a href="https://www.iatioben.com.br/?texto=[texto%20codificado]" 
   class="text-indigo-600 hover:underline font-medium" 
   target="_blank" 
   rel="noopener noreferrer">
   [express\xe3o clic\xe1vel]
</a>

Exemplo:  
Transforme Conc\xedlio Vaticano II em  
<a href="https://www.iatioben.com.br/?texto=Conc\xedlio%20Vaticano%20II" ...>Conc\xedlio Vaticano II</a>

Crie **entre 3 e 5 links** desse tipo por artigo, de forma natural e fluida, sem quebrar o contexto.

---

 **Boas pr\xe1ticas de SEO:**
- T\xedtulo principal \xfanico e envolvente (\`<h1>\`).  
- Subt\xedtulos hier\xe1rquicos (\`<h2>\`, \`<h3>\`).  
- Tags sem\xe2nticas corretas (\`<strong>\`, \`<em>\`, \`<time>\`, \`<a>\`).  
- Estrutura HTML limpa e validada.  
- Par\xe1grafos curtos e escane\xe1veis.  
- Palavras-chave mantidas naturalmente.

---

 **Instru\xe7\xe3o final:**
Receba o conte\xfado no par\xe2metro \`${a}\` e retorne **somente o HTML final completo e formatado** no padr\xe3o acima, pronto para publica\xe7\xe3o no site www.iatioben.com.br.  
N\xe3o adicione explica\xe7\xf5es nem coment\xe1rios  apenas gere o HTML final.
`,c=(await bv.models.generateContent({model:"gemini-2.0-flash",contents:[{parts:[{text:b}]}]})).text||"";return c.startsWith("```html")&&(c=c.slice(7)),c.endsWith("```")&&(c=c.slice(0,-3)),console.log(" [formatArticleToHtml] HTML gerado com sucesso. Tamanho:",c.length),c.trim()}catch(a){throw console.error(" [formatArticleToHtml] Erro ao gerar HTML:",a),Error("Falha ao formatar o artigo para HTML.")}},by=async(a,b)=>{console.log(" [analyzeSeoAndExtractMetadata] Iniciando anlise SEO...");try{let c=`
Voc\xea \xe9 um editor cat\xf3lico do Blog Tio Ben, respons\xe1vel por revisar artigos espirituais sobre a vida dos Santos e otimizar seu conte\xfado para SEO  sem jamais perder o tom humano, devocional e inspirador do texto original.

 Sua miss\xe3o \xe9 analisar o artigo abaixo e gerar um **objeto JSON** com duas chaves:
- "keywords": uma lista com 5 a 10 palavras-chave que melhor representam o artigo e sua espiritualidade, valorizando temas cat\xf3licos e express\xf5es de f\xe9.
- "metaDescription": uma breve descri\xe7\xe3o (m\xe1x. 160 caracteres) que resuma a ess\xeancia do artigo de forma cativante, fiel \xe0 mensagem e ao estilo do texto, como se fosse o resumo que aparece no Google.  
  Ela deve soar natural, acolhedora e levemente po\xe9tica  como uma frase que desperta f\xe9 e curiosidade, sem parecer comercial.

 Dicas de estilo:
- Mantenha o mesmo tom usado no artigo: devocional, alegre, pr\xf3ximo e cheio de esperan\xe7a.
- Prefira frases que transmitam luz, f\xe9, virtude e exemplo de vida.
- N\xe3o use linguagem t\xe9cnica ou publicit\xe1ria.
- Inspire o leitor a clicar, mas sem perder a rever\xeancia e autenticidade.

Palavras-chave foco do blog: ${b}

 Artigo a analisar:
---
${a}
---

Retorne **somente o JSON** no formato:
{
  "keywords": ["palavra1", "palavra2", ...],
  "metaDescription": "texto descritivo cativante"
}
`,d=await bv.models.generateContent({model:"gemini-2.0-flash",contents:[{parts:[{text:c}]}],config:{responseMimeType:"application/json",responseSchema:{type:co.OBJECT,properties:{keywords:{type:co.ARRAY,items:{type:co.STRING}},metaDescription:{type:co.STRING}}}}}),e=JSON.parse(d.text);return console.log(" [analyzeSeoAndExtractMetadata] SEO extrado:",e),{keywords:e.keywords||[],metaDescription:e.metaDescription||""}}catch(a){return console.error(" [analyzeSeoAndExtractMetadata] Erro SEO:",a),{keywords:[],metaDescription:"No foi possvel gerar a meta descrio."}}};var bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b$,b_,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK,cL,cM,cN,cO,cP,cQ,cR,cS,cT,cU,cV,cW,cX,cY,cZ,c$,c_,c0,c1,c2,c3,c4,c5,c6,c7,c8,c9,da,db,dc=Object.create,dd=Object.defineProperty,de=Object.getOwnPropertyDescriptor,df=Object.getOwnPropertyNames,dg=Object.getPrototypeOf,dh=Object.prototype.hasOwnProperty,di=(a,b)=>dd(a,"name",{value:b,configurable:!0}),dj=(a,b)=>()=>(a&&(b=a(a=0)),b),dk=(a,b)=>()=>(b||a((b={exports:{}}).exports,b),b.exports),dl=(a,b)=>{for(var c in b)dd(a,c,{get:b[c],enumerable:!0})},dm=(a,b,c,d)=>{if(b&&"object"==typeof b||"function"==typeof b)for(let e of df(b))dh.call(a,e)||e===c||dd(a,e,{get:()=>b[e],enumerable:!(d=de(b,e))||d.enumerable});return a},dn=(a,b,c)=>(c=null!=a?dc(dg(a)):{},dm(!b&&a&&a.__esModule?c:dd(c,"default",{value:a,enumerable:!0}),a)),dp=a=>dm(dd({},"__esModule",{value:!0}),a),dq=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?dd(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c},dr=dk(a=>{du(),a.byteLength=i,a.toByteArray=k,a.fromByteArray=n;var b,c,d=[],e=[],f="u">typeof Uint8Array?Uint8Array:Array,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(b=0,c=g.length;b<c;++b)d[b]=g[b],e[g.charCodeAt(b)]=b;function h(a){var b=a.length;if(b%4>0)throw Error("Invalid string. Length must be a multiple of 4");var c=a.indexOf("=");-1===c&&(c=b);var d=c===b?0:4-c%4;return[c,d]}function i(a){var b=h(a),c=b[0],d=b[1];return(c+d)*3/4-d}function j(a,b,c){return(b+c)*3/4-c}function k(a){var b,c,d=h(a),g=d[0],i=d[1],k=new f(j(a,g,i)),l=0,m=i>0?g-4:g;for(c=0;c<m;c+=4)b=e[a.charCodeAt(c)]<<18|e[a.charCodeAt(c+1)]<<12|e[a.charCodeAt(c+2)]<<6|e[a.charCodeAt(c+3)],k[l++]=b>>16&255,k[l++]=b>>8&255,k[l++]=255&b;return 2===i&&(b=e[a.charCodeAt(c)]<<2|e[a.charCodeAt(c+1)]>>4,k[l++]=255&b),1===i&&(b=e[a.charCodeAt(c)]<<10|e[a.charCodeAt(c+1)]<<4|e[a.charCodeAt(c+2)]>>2,k[l++]=b>>8&255,k[l++]=255&b),k}function l(a){return d[a>>18&63]+d[a>>12&63]+d[a>>6&63]+d[63&a]}function m(a,b,c){for(var d=[],e=b;e<c;e+=3)d.push(l((a[e]<<16&0xff0000)+(a[e+1]<<8&65280)+(255&a[e+2])));return d.join("")}function n(a){for(var b,c=a.length,e=c%3,f=[],g=0,h=c-e;g<h;g+=16383)f.push(m(a,g,g+16383>h?h:g+16383));return 1===e?f.push(d[(b=a[c-1])>>2]+d[b<<4&63]+"=="):2===e&&f.push(d[(b=(a[c-2]<<8)+a[c-1])>>10]+d[b>>4&63]+d[b<<2&63]+"="),f.join("")}e[45]=62,e[95]=63,di(h,"getLens"),di(i,"byteLength"),di(j,"_byteLength"),di(k,"toByteArray"),di(l,"tripletToBase64"),di(m,"encodeChunk"),di(n,"fromByteArray")}),ds=dk(a=>{du(),a.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:1/0*(n?-1:1);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},a.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=5960464477539062e-23*(23===e),n=d?0:f-1,o=d?1:-1,p=+(b<0||0===b&&1/b<0);for(isNaN(b=Math.abs(b))||b===1/0?(h=+!!isNaN(b),g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),g+l>=1?b+=m/i:b+=m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}}),dt=dk(a=>{du();var b=dr(),c=ds(),d="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function e(){try{let a=new Uint8Array(1),b={foo:di(function(){return 42},"foo")};return Object.setPrototypeOf(b,Uint8Array.prototype),Object.setPrototypeOf(a,b),42===a.foo()}catch{return!1}}function f(a){if(a>0x7fffffff)throw RangeError('The value "'+a+'" is invalid for option "size"');let b=new Uint8Array(a);return Object.setPrototypeOf(b,g.prototype),b}function g(a,b,c){if("number"==typeof a){if("string"==typeof b)throw TypeError('The "string" argument must be of type string. Received type number');return k(a)}return h(a,b,c)}function h(a,b,c){if("string"==typeof a)return l(a,b);if(ArrayBuffer.isView(a))return n(a);if(null==a)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a);if(ac(a,ArrayBuffer)||a&&ac(a.buffer,ArrayBuffer)||"u">typeof SharedArrayBuffer&&(ac(a,SharedArrayBuffer)||a&&ac(a.buffer,SharedArrayBuffer)))return o(a,b,c);if("number"==typeof a)throw TypeError('The "value" argument must not be of type number. Received type number');let d=a.valueOf&&a.valueOf();if(null!=d&&d!==a)return g.from(d,b,c);let e=p(a);if(e)return e;if("u">typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof a[Symbol.toPrimitive])return g.from(a[Symbol.toPrimitive]("string"),b,c);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a)}function i(a){if("number"!=typeof a)throw TypeError('"size" argument must be of type number');if(a<0)throw RangeError('The value "'+a+'" is invalid for option "size"')}function j(a,b,c){return i(a),a<=0?f(a):void 0!==b?"string"==typeof c?f(a).fill(b,c):f(a).fill(b):f(a)}function k(a){return i(a),f(a<0?0:0|q(a))}function l(a,b){if(("string"!=typeof b||""===b)&&(b="utf8"),!g.isEncoding(b))throw TypeError("Unknown encoding: "+b);let c=0|s(a,b),d=f(c),e=d.write(a,b);return e!==c&&(d=d.slice(0,e)),d}function m(a){let b=a.length<0?0:0|q(a.length),c=f(b);for(let d=0;d<b;d+=1)c[d]=255&a[d];return c}function n(a){if(ac(a,Uint8Array)){let b=new Uint8Array(a);return o(b.buffer,b.byteOffset,b.byteLength)}return m(a)}function o(a,b,c){let d;if(b<0||a.byteLength<b)throw RangeError('"offset" is outside of buffer bounds');if(a.byteLength<b+(c||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(d=void 0===b&&void 0===c?new Uint8Array(a):void 0===c?new Uint8Array(a,b):new Uint8Array(a,b,c),g.prototype),d}function p(a){if(g.isBuffer(a)){let b=0|q(a.length),c=f(b);return 0===c.length||a.copy(c,0,0,b),c}return void 0!==a.length?"number"!=typeof a.length||ad(a.length)?f(0):m(a):"Buffer"===a.type&&Array.isArray(a.data)?m(a.data):void 0}function q(a){if(a>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|a}function r(a){return+a!=a&&(a=0),g.alloc(+a)}function s(a,b){if(g.isBuffer(a))return a.length;if(ArrayBuffer.isView(a)||ac(a,ArrayBuffer))return a.byteLength;if("string"!=typeof a)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof a);let c=a.length,d=arguments.length>2&&!0===arguments[2];if(!d&&0===c)return 0;let e=!1;for(;;)switch(b){case"ascii":case"latin1":case"binary":return c;case"utf8":case"utf-8":return Z(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return aa(a).length;default:if(e)return d?-1:Z(a).length;b=(""+b).toLowerCase(),e=!0}}function t(a,b,c){let d=!1;if((void 0===b||b<0)&&(b=0),b>this.length||((void 0===c||c>this.length)&&(c=this.length),c<=0)||(c>>>=0)<=(b>>>=0))return"";for(a||(a="utf8");;)switch(a){case"hex":return H(this,b,c);case"utf8":case"utf-8":return D(this,b,c);case"ascii":return F(this,b,c);case"latin1":case"binary":return G(this,b,c);case"base64":return C(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,b,c);default:if(d)throw TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}}function u(a,b,c){let d=a[b];a[b]=a[c],a[c]=d}function v(a,b,c,d,e){if(0===a.length)return -1;if("string"==typeof c?(d=c,c=0):c>0x7fffffff?c=0x7fffffff:c<-0x80000000&&(c=-0x80000000),ad(c*=1)&&(c=e?0:a.length-1),c<0&&(c=a.length+c),c>=a.length){if(e)return -1;c=a.length-1}else if(c<0)if(!e)return -1;else c=0;if("string"==typeof b&&(b=g.from(b,d)),g.isBuffer(b))return 0===b.length?-1:w(a,b,c,d,e);if("number"==typeof b)return b&=255,"function"==typeof Uint8Array.prototype.indexOf?e?Uint8Array.prototype.indexOf.call(a,b,c):Uint8Array.prototype.lastIndexOf.call(a,b,c):w(a,[b],c,d,e);throw TypeError("val must be string, number or Buffer")}function w(a,b,c,d,e){let f,g=1,h=a.length,i=b.length;if(void 0!==d&&("ucs2"===(d=String(d).toLowerCase())||"ucs-2"===d||"utf16le"===d||"utf-16le"===d)){if(a.length<2||b.length<2)return -1;g=2,h/=2,i/=2,c/=2}function j(a,b){return 1===g?a[b]:a.readUInt16BE(b*g)}if(di(j,"read"),e){let d=-1;for(f=c;f<h;f++)if(j(a,f)===j(b,-1===d?0:f-d)){if(-1===d&&(d=f),f-d+1===i)return d*g}else -1!==d&&(f-=f-d),d=-1}else for(c+i>h&&(c=h-i),f=c;f>=0;f--){let c=!0;for(let d=0;d<i;d++)if(j(a,f+d)!==j(b,d)){c=!1;break}if(c)return f}return -1}function x(a,b,c,d){let e;c=Number(c)||0;let f=a.length-c;d?(d=Number(d))>f&&(d=f):d=f;let g=b.length;for(d>g/2&&(d=g/2),e=0;e<d;++e){let d=parseInt(b.substr(2*e,2),16);if(ad(d))break;a[c+e]=d}return e}function y(a,b,c,d){return ab(Z(b,a.length-c),a,c,d)}function z(a,b,c,d){return ab($(b),a,c,d)}function A(a,b,c,d){return ab(aa(b),a,c,d)}function B(a,b,c,d){return ab(_(b,a.length-c),a,c,d)}function C(a,c,d){return 0===c&&d===a.length?b.fromByteArray(a):b.fromByteArray(a.slice(c,d))}function D(a,b,c){c=Math.min(a.length,c);let d=[],e=b;for(;e<c;){let b=a[e],f=null,g=b>239?4:b>223?3:b>191?2:1;if(e+g<=c){let c,d,h,i;switch(g){case 1:b<128&&(f=b);break;case 2:(192&(c=a[e+1]))==128&&(i=(31&b)<<6|63&c)>127&&(f=i);break;case 3:c=a[e+1],d=a[e+2],(192&c)==128&&(192&d)==128&&(i=(15&b)<<12|(63&c)<<6|63&d)>2047&&(i<55296||i>57343)&&(f=i);break;case 4:c=a[e+1],d=a[e+2],h=a[e+3],(192&c)==128&&(192&d)==128&&(192&h)==128&&(i=(15&b)<<18|(63&c)<<12|(63&d)<<6|63&h)>65535&&i<1114112&&(f=i)}}null===f?(f=65533,g=1):f>65535&&(f-=65536,d.push(f>>>10&1023|55296),f=56320|1023&f),d.push(f),e+=g}return E(d)}function E(a){let b=a.length;if(b<=4096)return String.fromCharCode.apply(String,a);let c="",d=0;for(;d<b;)c+=String.fromCharCode.apply(String,a.slice(d,d+=4096));return c}function F(a,b,c){let d="";c=Math.min(a.length,c);for(let e=b;e<c;++e)d+=String.fromCharCode(127&a[e]);return d}function G(a,b,c){let d="";c=Math.min(a.length,c);for(let e=b;e<c;++e)d+=String.fromCharCode(a[e]);return d}function H(a,b,c){let d=a.length;(!b||b<0)&&(b=0),(!c||c<0||c>d)&&(c=d);let e="";for(let d=b;d<c;++d)e+=ae[a[d]];return e}function I(a,b,c){let d=a.slice(b,c),e="";for(let a=0;a<d.length-1;a+=2)e+=String.fromCharCode(d[a]+256*d[a+1]);return e}function J(a,b,c){if(a%1!=0||a<0)throw RangeError("offset is not uint");if(a+b>c)throw RangeError("Trying to access beyond buffer length")}function K(a,b,c,d,e,f){if(!g.isBuffer(a))throw TypeError('"buffer" argument must be a Buffer instance');if(b>e||b<f)throw RangeError('"value" argument is out of bounds');if(c+d>a.length)throw RangeError("Index out of range")}function L(a,b,c,d,e){U(b,d,e,a,c,7);let f=Number(b&BigInt(0xffffffff));a[c++]=f,f>>=8,a[c++]=f,f>>=8,a[c++]=f,f>>=8,a[c++]=f;let g=Number(b>>BigInt(32)&BigInt(0xffffffff));return a[c++]=g,g>>=8,a[c++]=g,g>>=8,a[c++]=g,g>>=8,a[c++]=g,c}function M(a,b,c,d,e){U(b,d,e,a,c,7);let f=Number(b&BigInt(0xffffffff));a[c+7]=f,f>>=8,a[c+6]=f,f>>=8,a[c+5]=f,f>>=8,a[c+4]=f;let g=Number(b>>BigInt(32)&BigInt(0xffffffff));return a[c+3]=g,g>>=8,a[c+2]=g,g>>=8,a[c+1]=g,g>>=8,a[c]=g,c+8}function N(a,b,c,d,e,f){if(c+d>a.length||c<0)throw RangeError("Index out of range")}function O(a,b,d,e,f){return b*=1,d>>>=0,f||N(a,b,d,4,34028234663852886e22,-34028234663852886e22),c.write(a,b,d,e,23,4),d+4}function P(a,b,d,e,f){return b*=1,d>>>=0,f||N(a,b,d,8,17976931348623157e292,-17976931348623157e292),c.write(a,b,d,e,52,8),d+8}a.Buffer=g,a.SlowBuffer=r,a.INSPECT_MAX_BYTES=50,a.kMaxLength=0x7fffffff,g.TYPED_ARRAY_SUPPORT=e(),!g.TYPED_ARRAY_SUPPORT&&"u">typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),di(e,"typedArraySupport"),Object.defineProperty(g.prototype,"parent",{enumerable:!0,get:di(function(){if(g.isBuffer(this))return this.buffer},"get")}),Object.defineProperty(g.prototype,"offset",{enumerable:!0,get:di(function(){if(g.isBuffer(this))return this.byteOffset},"get")}),di(f,"createBuffer"),di(g,"Buffer"),g.poolSize=8192,di(h,"from"),g.from=function(a,b,c){return h(a,b,c)},Object.setPrototypeOf(g.prototype,Uint8Array.prototype),Object.setPrototypeOf(g,Uint8Array),di(i,"assertSize"),di(j,"alloc"),g.alloc=function(a,b,c){return j(a,b,c)},di(k,"allocUnsafe"),g.allocUnsafe=function(a){return k(a)},g.allocUnsafeSlow=function(a){return k(a)},di(l,"fromString"),di(m,"fromArrayLike"),di(n,"fromArrayView"),di(o,"fromArrayBuffer"),di(p,"fromObject"),di(q,"checked"),di(r,"SlowBuffer"),g.isBuffer=di(function(a){return null!=a&&!0===a._isBuffer&&a!==g.prototype},"isBuffer"),g.compare=di(function(a,b){if(ac(a,Uint8Array)&&(a=g.from(a,a.offset,a.byteLength)),ac(b,Uint8Array)&&(b=g.from(b,b.offset,b.byteLength)),!g.isBuffer(a)||!g.isBuffer(b))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(a===b)return 0;let c=a.length,d=b.length;for(let e=0,f=Math.min(c,d);e<f;++e)if(a[e]!==b[e]){c=a[e],d=b[e];break}return c<d?-1:+(d<c)},"compare"),g.isEncoding=di(function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},"isEncoding"),g.concat=di(function(a,b){let c;if(!Array.isArray(a))throw TypeError('"list" argument must be an Array of Buffers');if(0===a.length)return g.alloc(0);if(void 0===b)for(b=0,c=0;c<a.length;++c)b+=a[c].length;let d=g.allocUnsafe(b),e=0;for(c=0;c<a.length;++c){let b=a[c];if(ac(b,Uint8Array))e+b.length>d.length?(g.isBuffer(b)||(b=g.from(b)),b.copy(d,e)):Uint8Array.prototype.set.call(d,b,e);else if(g.isBuffer(b))b.copy(d,e);else throw TypeError('"list" argument must be an Array of Buffers');e+=b.length}return d},"concat"),di(s,"byteLength"),g.byteLength=s,di(t,"slowToString"),g.prototype._isBuffer=!0,di(u,"swap"),g.prototype.swap16=di(function(){let a=this.length;if(a%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(let b=0;b<a;b+=2)u(this,b,b+1);return this},"swap16"),g.prototype.swap32=di(function(){let a=this.length;if(a%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(let b=0;b<a;b+=4)u(this,b,b+3),u(this,b+1,b+2);return this},"swap32"),g.prototype.swap64=di(function(){let a=this.length;if(a%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(let b=0;b<a;b+=8)u(this,b,b+7),u(this,b+1,b+6),u(this,b+2,b+5),u(this,b+3,b+4);return this},"swap64"),g.prototype.toString=di(function(){let a=this.length;return 0===a?"":0==arguments.length?D(this,0,a):t.apply(this,arguments)},"toString"),g.prototype.toLocaleString=g.prototype.toString,g.prototype.equals=di(function(a){if(!g.isBuffer(a))throw TypeError("Argument must be a Buffer");return this===a||0===g.compare(this,a)},"equals"),g.prototype.inspect=di(function(){let b="",c=a.INSPECT_MAX_BYTES;return b=this.toString("hex",0,c).replace(/(.{2})/g,"$1 ").trim(),this.length>c&&(b+=" ... "),"<Buffer "+b+">"},"inspect"),d&&(g.prototype[d]=g.prototype.inspect),g.prototype.compare=di(function(a,b,c,d,e){if(ac(a,Uint8Array)&&(a=g.from(a,a.offset,a.byteLength)),!g.isBuffer(a))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof a);if(void 0===b&&(b=0),void 0===c&&(c=a?a.length:0),void 0===d&&(d=0),void 0===e&&(e=this.length),b<0||c>a.length||d<0||e>this.length)throw RangeError("out of range index");if(d>=e&&b>=c)return 0;if(d>=e)return -1;if(b>=c)return 1;if(b>>>=0,c>>>=0,d>>>=0,e>>>=0,this===a)return 0;let f=e-d,h=c-b,i=Math.min(f,h),j=this.slice(d,e),k=a.slice(b,c);for(let a=0;a<i;++a)if(j[a]!==k[a]){f=j[a],h=k[a];break}return f<h?-1:+(h<f)},"compare"),di(v,"bidirectionalIndexOf"),di(w,"arrayIndexOf"),g.prototype.includes=di(function(a,b,c){return -1!==this.indexOf(a,b,c)},"includes"),g.prototype.indexOf=di(function(a,b,c){return v(this,a,b,c,!0)},"indexOf"),g.prototype.lastIndexOf=di(function(a,b,c){return v(this,a,b,c,!1)},"lastIndexOf"),di(x,"hexWrite"),di(y,"utf8Write"),di(z,"asciiWrite"),di(A,"base64Write"),di(B,"ucs2Write"),g.prototype.write=di(function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"==typeof b)d=b,c=this.length,b=0;else if(isFinite(b))b>>>=0,isFinite(c)?(c>>>=0,void 0===d&&(d="utf8")):(d=c,c=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let e=this.length-b;if((void 0===c||c>e)&&(c=e),a.length>0&&(c<0||b<0)||b>this.length)throw RangeError("Attempt to write outside buffer bounds");d||(d="utf8");let f=!1;for(;;)switch(d){case"hex":return x(this,a,b,c);case"utf8":case"utf-8":return y(this,a,b,c);case"ascii":case"latin1":case"binary":return z(this,a,b,c);case"base64":return A(this,a,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,a,b,c);default:if(f)throw TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),f=!0}},"write"),g.prototype.toJSON=di(function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},"toJSON"),di(C,"base64Slice"),di(D,"utf8Slice"),di(E,"decodeCodePointsArray"),di(F,"asciiSlice"),di(G,"latin1Slice"),di(H,"hexSlice"),di(I,"utf16leSlice"),g.prototype.slice=di(function(a,b){let c=this.length;a=~~a,b=void 0===b?c:~~b,a<0?(a+=c)<0&&(a=0):a>c&&(a=c),b<0?(b+=c)<0&&(b=0):b>c&&(b=c),b<a&&(b=a);let d=this.subarray(a,b);return Object.setPrototypeOf(d,g.prototype),d},"slice"),di(J,"checkOffset"),g.prototype.readUintLE=g.prototype.readUIntLE=di(function(a,b,c){a>>>=0,b>>>=0,c||J(a,b,this.length);let d=this[a],e=1,f=0;for(;++f<b&&(e*=256);)d+=this[a+f]*e;return d},"readUIntLE"),g.prototype.readUintBE=g.prototype.readUIntBE=di(function(a,b,c){a>>>=0,b>>>=0,c||J(a,b,this.length);let d=this[a+--b],e=1;for(;b>0&&(e*=256);)d+=this[a+--b]*e;return d},"readUIntBE"),g.prototype.readUint8=g.prototype.readUInt8=di(function(a,b){return a>>>=0,b||J(a,1,this.length),this[a]},"readUInt8"),g.prototype.readUint16LE=g.prototype.readUInt16LE=di(function(a,b){return a>>>=0,b||J(a,2,this.length),this[a]|this[a+1]<<8},"readUInt16LE"),g.prototype.readUint16BE=g.prototype.readUInt16BE=di(function(a,b){return a>>>=0,b||J(a,2,this.length),this[a]<<8|this[a+1]},"readUInt16BE"),g.prototype.readUint32LE=g.prototype.readUInt32LE=di(function(a,b){return a>>>=0,b||J(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+0x1000000*this[a+3]},"readUInt32LE"),g.prototype.readUint32BE=g.prototype.readUInt32BE=di(function(a,b){return a>>>=0,b||J(a,4,this.length),0x1000000*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},"readUInt32BE"),g.prototype.readBigUInt64LE=af(di(function(a){V(a>>>=0,"offset");let b=this[a],c=this[a+7];(void 0===b||void 0===c)&&W(a,this.length-8);let d=b+256*this[++a]+65536*this[++a]+0x1000000*this[++a],e=this[++a]+256*this[++a]+65536*this[++a]+0x1000000*c;return BigInt(d)+(BigInt(e)<<BigInt(32))},"readBigUInt64LE")),g.prototype.readBigUInt64BE=af(di(function(a){V(a>>>=0,"offset");let b=this[a],c=this[a+7];(void 0===b||void 0===c)&&W(a,this.length-8);let d=0x1000000*b+65536*this[++a]+256*this[++a]+this[++a],e=0x1000000*this[++a]+65536*this[++a]+256*this[++a]+c;return(BigInt(d)<<BigInt(32))+BigInt(e)},"readBigUInt64BE")),g.prototype.readIntLE=di(function(a,b,c){a>>>=0,b>>>=0,c||J(a,b,this.length);let d=this[a],e=1,f=0;for(;++f<b&&(e*=256);)d+=this[a+f]*e;return d>=(e*=128)&&(d-=Math.pow(2,8*b)),d},"readIntLE"),g.prototype.readIntBE=di(function(a,b,c){a>>>=0,b>>>=0,c||J(a,b,this.length);let d=b,e=1,f=this[a+--d];for(;d>0&&(e*=256);)f+=this[a+--d]*e;return f>=(e*=128)&&(f-=Math.pow(2,8*b)),f},"readIntBE"),g.prototype.readInt8=di(function(a,b){return a>>>=0,b||J(a,1,this.length),128&this[a]?-((255-this[a]+1)*1):this[a]},"readInt8"),g.prototype.readInt16LE=di(function(a,b){a>>>=0,b||J(a,2,this.length);let c=this[a]|this[a+1]<<8;return 32768&c?0xffff0000|c:c},"readInt16LE"),g.prototype.readInt16BE=di(function(a,b){a>>>=0,b||J(a,2,this.length);let c=this[a+1]|this[a]<<8;return 32768&c?0xffff0000|c:c},"readInt16BE"),g.prototype.readInt32LE=di(function(a,b){return a>>>=0,b||J(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},"readInt32LE"),g.prototype.readInt32BE=di(function(a,b){return a>>>=0,b||J(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},"readInt32BE"),g.prototype.readBigInt64LE=af(di(function(a){V(a>>>=0,"offset");let b=this[a],c=this[a+7];return(void 0===b||void 0===c)&&W(a,this.length-8),(BigInt(this[a+4]+256*this[a+5]+65536*this[a+6]+(c<<24))<<BigInt(32))+BigInt(b+256*this[++a]+65536*this[++a]+0x1000000*this[++a])},"readBigInt64LE")),g.prototype.readBigInt64BE=af(di(function(a){V(a>>>=0,"offset");let b=this[a],c=this[a+7];return(void 0===b||void 0===c)&&W(a,this.length-8),(BigInt((b<<24)+65536*this[++a]+256*this[++a]+this[++a])<<BigInt(32))+BigInt(0x1000000*this[++a]+65536*this[++a]+256*this[++a]+c)},"readBigInt64BE")),g.prototype.readFloatLE=di(function(a,b){return a>>>=0,b||J(a,4,this.length),c.read(this,a,!0,23,4)},"readFloatLE"),g.prototype.readFloatBE=di(function(a,b){return a>>>=0,b||J(a,4,this.length),c.read(this,a,!1,23,4)},"readFloatBE"),g.prototype.readDoubleLE=di(function(a,b){return a>>>=0,b||J(a,8,this.length),c.read(this,a,!0,52,8)},"readDoubleLE"),g.prototype.readDoubleBE=di(function(a,b){return a>>>=0,b||J(a,8,this.length),c.read(this,a,!1,52,8)},"readDoubleBE"),di(K,"checkInt"),g.prototype.writeUintLE=g.prototype.writeUIntLE=di(function(a,b,c,d){if(a*=1,b>>>=0,c>>>=0,!d){let d=Math.pow(2,8*c)-1;K(this,a,b,c,d,0)}let e=1,f=0;for(this[b]=255&a;++f<c&&(e*=256);)this[b+f]=a/e&255;return b+c},"writeUIntLE"),g.prototype.writeUintBE=g.prototype.writeUIntBE=di(function(a,b,c,d){if(a*=1,b>>>=0,c>>>=0,!d){let d=Math.pow(2,8*c)-1;K(this,a,b,c,d,0)}let e=c-1,f=1;for(this[b+e]=255&a;--e>=0&&(f*=256);)this[b+e]=a/f&255;return b+c},"writeUIntBE"),g.prototype.writeUint8=g.prototype.writeUInt8=di(function(a,b,c){return a*=1,b>>>=0,c||K(this,a,b,1,255,0),this[b]=255&a,b+1},"writeUInt8"),g.prototype.writeUint16LE=g.prototype.writeUInt16LE=di(function(a,b,c){return a*=1,b>>>=0,c||K(this,a,b,2,65535,0),this[b]=255&a,this[b+1]=a>>>8,b+2},"writeUInt16LE"),g.prototype.writeUint16BE=g.prototype.writeUInt16BE=di(function(a,b,c){return a*=1,b>>>=0,c||K(this,a,b,2,65535,0),this[b]=a>>>8,this[b+1]=255&a,b+2},"writeUInt16BE"),g.prototype.writeUint32LE=g.prototype.writeUInt32LE=di(function(a,b,c){return a*=1,b>>>=0,c||K(this,a,b,4,0xffffffff,0),this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=255&a,b+4},"writeUInt32LE"),g.prototype.writeUint32BE=g.prototype.writeUInt32BE=di(function(a,b,c){return a*=1,b>>>=0,c||K(this,a,b,4,0xffffffff,0),this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a,b+4},"writeUInt32BE"),di(L,"wrtBigUInt64LE"),di(M,"wrtBigUInt64BE"),g.prototype.writeBigUInt64LE=af(di(function(a,b=0){return L(this,a,b,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64LE")),g.prototype.writeBigUInt64BE=af(di(function(a,b=0){return M(this,a,b,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64BE")),g.prototype.writeIntLE=di(function(a,b,c,d){if(a*=1,b>>>=0,!d){let d=Math.pow(2,8*c-1);K(this,a,b,c,d-1,-d)}let e=0,f=1,g=0;for(this[b]=255&a;++e<c&&(f*=256);)a<0&&0===g&&0!==this[b+e-1]&&(g=1),this[b+e]=(a/f|0)-g&255;return b+c},"writeIntLE"),g.prototype.writeIntBE=di(function(a,b,c,d){if(a*=1,b>>>=0,!d){let d=Math.pow(2,8*c-1);K(this,a,b,c,d-1,-d)}let e=c-1,f=1,g=0;for(this[b+e]=255&a;--e>=0&&(f*=256);)a<0&&0===g&&0!==this[b+e+1]&&(g=1),this[b+e]=(a/f|0)-g&255;return b+c},"writeIntBE"),g.prototype.writeInt8=di(function(a,b,c){return a*=1,b>>>=0,c||K(this,a,b,1,127,-128),a<0&&(a=255+a+1),this[b]=255&a,b+1},"writeInt8"),g.prototype.writeInt16LE=di(function(a,b,c){return a*=1,b>>>=0,c||K(this,a,b,2,32767,-32768),this[b]=255&a,this[b+1]=a>>>8,b+2},"writeInt16LE"),g.prototype.writeInt16BE=di(function(a,b,c){return a*=1,b>>>=0,c||K(this,a,b,2,32767,-32768),this[b]=a>>>8,this[b+1]=255&a,b+2},"writeInt16BE"),g.prototype.writeInt32LE=di(function(a,b,c){return a*=1,b>>>=0,c||K(this,a,b,4,0x7fffffff,-0x80000000),this[b]=255&a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24,b+4},"writeInt32LE"),g.prototype.writeInt32BE=di(function(a,b,c){return a*=1,b>>>=0,c||K(this,a,b,4,0x7fffffff,-0x80000000),a<0&&(a=0xffffffff+a+1),this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a,b+4},"writeInt32BE"),g.prototype.writeBigInt64LE=af(di(function(a,b=0){return L(this,a,b,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64LE")),g.prototype.writeBigInt64BE=af(di(function(a,b=0){return M(this,a,b,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64BE")),di(N,"checkIEEE754"),di(O,"writeFloat"),g.prototype.writeFloatLE=di(function(a,b,c){return O(this,a,b,!0,c)},"writeFloatLE"),g.prototype.writeFloatBE=di(function(a,b,c){return O(this,a,b,!1,c)},"writeFloatBE"),di(P,"writeDouble"),g.prototype.writeDoubleLE=di(function(a,b,c){return P(this,a,b,!0,c)},"writeDoubleLE"),g.prototype.writeDoubleBE=di(function(a,b,c){return P(this,a,b,!1,c)},"writeDoubleBE"),g.prototype.copy=di(function(a,b,c,d){if(!g.isBuffer(a))throw TypeError("argument should be a Buffer");if(c||(c=0),d||0===d||(d=this.length),b>=a.length&&(b=a.length),b||(b=0),d>0&&d<c&&(d=c),d===c||0===a.length||0===this.length)return 0;if(b<0)throw RangeError("targetStart out of bounds");if(c<0||c>=this.length)throw RangeError("Index out of range");if(d<0)throw RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),a.length-b<d-c&&(d=a.length-b+c);let e=d-c;return this===a&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(b,c,d):Uint8Array.prototype.set.call(a,this.subarray(c,d),b),e},"copy"),g.prototype.fill=di(function(a,b,c,d){let e;if("string"==typeof a){if("string"==typeof b?(d=b,b=0,c=this.length):"string"==typeof c&&(d=c,c=this.length),void 0!==d&&"string"!=typeof d)throw TypeError("encoding must be a string");if("string"==typeof d&&!g.isEncoding(d))throw TypeError("Unknown encoding: "+d);if(1===a.length){let b=a.charCodeAt(0);("utf8"===d&&b<128||"latin1"===d)&&(a=b)}}else"number"==typeof a?a&=255:"boolean"==typeof a&&(a=Number(a));if(b<0||this.length<b||this.length<c)throw RangeError("Out of range index");if(c<=b)return this;if(b>>>=0,c=void 0===c?this.length:c>>>0,a||(a=0),"number"==typeof a)for(e=b;e<c;++e)this[e]=a;else{let f=g.isBuffer(a)?a:g.from(a,d),h=f.length;if(0===h)throw TypeError('The value "'+a+'" is invalid for argument "value"');for(e=0;e<c-b;++e)this[e+b]=f[e%h]}return this},"fill");var Q={};function R(a,b,c){var d;Q[a]=(di(d=class extends c{constructor(){super(),Object.defineProperty(this,"message",{value:b.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${a}]`,this.stack,delete this.name}get code(){return a}set code(a){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:a,writable:!0})}toString(){return`${this.name} [${a}]: ${this.message}`}},"NodeError"),d)}function S(a){let b="",c=a.length,d=+("-"===a[0]);for(;c>=d+4;c-=3)b=`_${a.slice(c-3,c)}${b}`;return`${a.slice(0,c)}${b}`}function T(a,b,c){V(b,"offset"),(void 0===a[b]||void 0===a[b+c])&&W(b,a.length-(c+1))}function U(a,b,c,d,e,f){if(a>c||a<b){let d="bigint"==typeof b?"n":"",e;throw e=f>3?0===b||b===BigInt(0)?`>= 0${d} and < 2${d} ** ${(f+1)*8}${d}`:`>= -(2${d} ** ${(f+1)*8-1}${d}) and \
< 2 ** ${(f+1)*8-1}${d}`:`>= ${b}${d} and <= ${c}${d}`,new Q.ERR_OUT_OF_RANGE("value",e,a)}T(d,e,f)}function V(a,b){if("number"!=typeof a)throw new Q.ERR_INVALID_ARG_TYPE(b,"number",a)}function W(a,b,c){throw Math.floor(a)!==a?(V(a,c),new Q.ERR_OUT_OF_RANGE(c||"offset","an integer",a)):b<0?new Q.ERR_BUFFER_OUT_OF_BOUNDS:new Q.ERR_OUT_OF_RANGE(c||"offset",`>= ${+!!c} and <= ${b}`,a)}di(R,"E"),R("ERR_BUFFER_OUT_OF_BOUNDS",function(a){return a?`${a} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),R("ERR_INVALID_ARG_TYPE",function(a,b){return`The "${a}" argum\
ent must be of type number. Received type ${typeof b}`},TypeError),R("ERR_OUT_OF_RANGE",function(a,b,c){let d=`The value of "${a}" is out of range.`,e=c;return Number.isInteger(c)&&Math.abs(c)>0x100000000?e=S(String(c)):"bigint"==typeof c&&(e=String(c),(c>BigInt(2)**BigInt(32)||c<-(BigInt(2)**BigInt(32)))&&(e=S(e)),e+="n"),d+=` It\
 must be ${b}. Received ${e}`},RangeError),di(S,"addNumericalSeparator"),di(T,"checkBounds"),di(U,"checkIntBI"),di(V,"validateNumber"),di(W,"boundsError");var X=/[^+/0-9A-Za-z-_]/g;function Y(a){if((a=(a=a.split("=")[0]).trim().replace(X,"")).length<2)return"";for(;a.length%4!=0;)a+="=";return a}function Z(a,b){b=b||1/0;let c,d=a.length,e=null,f=[];for(let g=0;g<d;++g){if((c=a.charCodeAt(g))>55295&&c<57344){if(!e){if(c>56319||g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(c<56320){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=(e-55296<<10|c-56320)+65536}else e&&(b-=3)>-1&&f.push(239,191,189);if(e=null,c<128){if((b-=1)<0)break;f.push(c)}else if(c<2048){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(c<65536){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else if(c<1114112){if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}else throw Error("Invalid code point")}return f}function $(a){let b=[];for(let c=0;c<a.length;++c)b.push(255&a.charCodeAt(c));return b}function _(a,b){let c,d,e=[];for(let f=0;f<a.length&&!((b-=2)<0);++f)d=(c=a.charCodeAt(f))>>8,e.push(c%256),e.push(d);return e}function aa(a){return b.toByteArray(Y(a))}function ab(a,b,c,d){let e;for(e=0;e<d&&!(e+c>=b.length||e>=a.length);++e)b[e+c]=a[e];return e}function ac(a,b){return a instanceof b||null!=a&&null!=a.constructor&&null!=a.constructor.name&&a.constructor.name===b.name}function ad(a){return a!=a}di(Y,"base64clean"),di(Z,"utf8ToBytes"),di($,"asciiToBytes"),di(_,"utf16leToBytes"),di(aa,"base64ToBytes"),di(ab,"blitBuffer"),di(ac,"isInstance"),di(ad,"numberIsNaN");var ae=function(){let a="0123456789abcdef",b=Array(256);for(let c=0;c<16;++c){let d=16*c;for(let e=0;e<16;++e)b[d+e]=a[c]+a[e]}return b}();function af(a){return typeof BigInt>"u"?ag:a}function ag(){throw Error("BigInt not supported")}di(af,"defineBigIntMethod"),di(ag,"BufferBigIntNotDefined")}),du=dj(()=>{c7=globalThis,c8=globalThis.setImmediate??(a=>setTimeout(a,0)),globalThis.clearImmediate??(a=>clearTimeout(a)),(c9=globalThis.crypto??{}).subtle??(c9.subtle={}),da="function"==typeof globalThis.Buffer&&"function"==typeof globalThis.Buffer.allocUnsafe?globalThis.Buffer:dt().Buffer,(db=globalThis.process??{}).env??(db.env={});try{db.nextTick(()=>{})}catch{let a=Promise.resolve();db.nextTick=a.then.bind(a)}}),dv=dk((a,b)=>{du();var c,d="object"==typeof Reflect?Reflect:null,e=d&&"function"==typeof d.apply?d.apply:di(function(a,b,c){return Function.prototype.apply.call(a,b,c)},"ReflectApply");function f(a){console&&console.warn&&console.warn(a)}c=d&&"function"==typeof d.ownKeys?d.ownKeys:Object.getOwnPropertySymbols?di(function(a){return Object.getOwnPropertyNames(a).concat(Object.getOwnPropertySymbols(a))},"ReflectOwnKeys"):di(function(a){return Object.getOwnPropertyNames(a)},"ReflectOwnKeys"),di(f,"ProcessEmitWarning");var g=Number.isNaN||di(function(a){return a!=a},"NumberIsNaN");function h(){h.init.call(this)}di(h,"EventEmitter"),b.exports=h,b.exports.once=t,h.EventEmitter=h,h.prototype._events=void 0,h.prototype._eventsCount=0,h.prototype._maxListeners=void 0;var i=10;function j(a){if("function"!=typeof a)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof a)}function k(a){return void 0===a._maxListeners?h.defaultMaxListeners:a._maxListeners}function l(a,b,c,d){var e,g,h;if(j(c),void 0===(g=a._events)?(g=a._events=Object.create(null),a._eventsCount=0):(void 0!==g.newListener&&(a.emit("newListener",b,c.listener?c.listener:c),g=a._events),h=g[b]),void 0===h)h=g[b]=c,++a._eventsCount;else if("function"==typeof h?h=g[b]=d?[c,h]:[h,c]:d?h.unshift(c):h.push(c),(e=k(a))>0&&h.length>e&&!h.warned){h.warned=!0;var i=Error("Possible EventEmitter memory leak detected. "+h.length+" "+String(b)+" listeners added. Use emitter.setMaxListeners() to increase limit");i.name="MaxListenersExceededWarning",i.emitter=a,i.type=b,i.count=h.length,f(i)}return a}function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function n(a,b,c){var d={fired:!1,wrapFn:void 0,target:a,type:b,listener:c},e=m.bind(d);return e.listener=c,d.wrapFn=e,e}function o(a,b,c){var d=a._events;if(void 0===d)return[];var e=d[b];return void 0===e?[]:"function"==typeof e?c?[e.listener||e]:[e]:c?s(e):q(e,e.length)}function p(a){var b=this._events;if(void 0!==b){var c=b[a];if("function"==typeof c)return 1;if(void 0!==c)return c.length}return 0}function q(a,b){for(var c=Array(b),d=0;d<b;++d)c[d]=a[d];return c}function r(a,b){for(;b+1<a.length;b++)a[b]=a[b+1];a.pop()}function s(a){for(var b=Array(a.length),c=0;c<b.length;++c)b[c]=a[c].listener||a[c];return b}function t(a,b){return new Promise(function(c,d){function e(c){a.removeListener(b,f),d(c)}function f(){"function"==typeof a.removeListener&&a.removeListener("error",e),c([].slice.call(arguments))}di(e,"errorListener"),di(f,"resolver"),v(a,b,f,{once:!0}),"error"!==b&&u(a,e,{once:!0})})}function u(a,b,c){"function"==typeof a.on&&v(a,"error",b,c)}function v(a,b,c,d){if("function"==typeof a.on)d.once?a.once(b,c):a.on(b,c);else if("function"==typeof a.addEventListener)a.addEventListener(b,di(function e(f){d.once&&a.removeEventListener(b,e),c(f)},"wrapListener"));else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof a)}di(j,"checkListener"),Object.defineProperty(h,"defaultMaxListeners",{enumerable:!0,get:di(function(){return i},"get"),set:di(function(a){if("number"!=typeof a||a<0||g(a))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+a+".");i=a},"set")}),h.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},h.prototype.setMaxListeners=di(function(a){if("number"!=typeof a||a<0||g(a))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+a+".");return this._maxListeners=a,this},"setMaxListeners"),di(k,"_getMaxListeners"),h.prototype.getMaxListeners=di(function(){return k(this)},"getMaxListeners"),h.prototype.emit=di(function(a){for(var b=[],c=1;c<arguments.length;c++)b.push(arguments[c]);var d="error"===a,f=this._events;if(void 0!==f)d=d&&void 0===f.error;else if(!d)return!1;if(d){if(b.length>0&&(g=b[0]),g instanceof Error)throw g;var g,h=Error("Unhandled error."+(g?" ("+g.message+")":""));throw h.context=g,h}var i=f[a];if(void 0===i)return!1;if("function"==typeof i)e(i,this,b);else for(var j=i.length,k=q(i,j),c=0;c<j;++c)e(k[c],this,b);return!0},"emit"),di(l,"_addListener"),h.prototype.addListener=di(function(a,b){return l(this,a,b,!1)},"addListener"),h.prototype.on=h.prototype.addListener,h.prototype.prependListener=di(function(a,b){return l(this,a,b,!0)},"prependListener"),di(m,"onceWrapper"),di(n,"_onceWrap"),h.prototype.once=di(function(a,b){return j(b),this.on(a,n(this,a,b)),this},"once"),h.prototype.prependOnceListener=di(function(a,b){return j(b),this.prependListener(a,n(this,a,b)),this},"prependOnceListener"),h.prototype.removeListener=di(function(a,b){var c,d,e,f,g;if(j(b),void 0===(d=this._events)||void 0===(c=d[a]))return this;if(c===b||c.listener===b)0==--this._eventsCount?this._events=Object.create(null):(delete d[a],d.removeListener&&this.emit("removeListener",a,c.listener||b));else if("function"!=typeof c){for(e=-1,f=c.length-1;f>=0;f--)if(c[f]===b||c[f].listener===b){g=c[f].listener,e=f;break}if(e<0)return this;0===e?c.shift():r(c,e),1===c.length&&(d[a]=c[0]),void 0!==d.removeListener&&this.emit("removeListener",a,g||b)}return this},"removeListener"),h.prototype.off=h.prototype.removeListener,h.prototype.removeAllListeners=di(function(a){var b,c,d;if(void 0===(c=this._events))return this;if(void 0===c.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==c[a]&&(0==--this._eventsCount?this._events=Object.create(null):delete c[a]),this;if(0==arguments.length){var e,f=Object.keys(c);for(d=0;d<f.length;++d)"removeListener"!==(e=f[d])&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(b=c[a]))this.removeListener(a,b);else if(void 0!==b)for(d=b.length-1;d>=0;d--)this.removeListener(a,b[d]);return this},"removeAllListeners"),di(o,"_listeners"),h.prototype.listeners=di(function(a){return o(this,a,!0)},"listeners"),h.prototype.rawListeners=di(function(a){return o(this,a,!1)},"rawListeners"),h.listenerCount=function(a,b){return"function"==typeof a.listenerCount?a.listenerCount(b):p.call(a,b)},h.prototype.listenerCount=p,di(p,"listenerCount"),h.prototype.eventNames=di(function(){return this._eventsCount>0?c(this._events):[]},"eventNames"),di(q,"arrayClone"),di(r,"spliceOne"),di(s,"unwrapListeners"),di(t,"once"),di(u,"addErrorHandlerIfEventEmitter"),di(v,"eventTargetAgnosticAddListener")}),dw={};dl(dw,{default:()=>dx});var dx,dy=dj(()=>{du(),dx={}});function dz(a){let b=0x6a09e667,c=0xbb67ae85,d=0x3c6ef372,e=0xa54ff53a,f=0x510e527f,g=0x9b05688c,h=0x1f83d9ab,i=0x5be0cd19,j=0,k=0,l=[0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2],m=di((a,b)=>a>>>b|a<<32-b,"rrot"),n=new Uint32Array(64),o=new Uint8Array(64),p=di(()=>{for(let a=0,b=0;a<16;a++,b+=4)n[a]=o[b]<<24|o[b+1]<<16|o[b+2]<<8|o[b+3];for(let a=16;a<64;a++){let b=m(n[a-15],7)^m(n[a-15],18)^n[a-15]>>>3,c=m(n[a-2],17)^m(n[a-2],19)^n[a-2]>>>10;n[a]=n[a-16]+b+n[a-7]+c|0}let a=b,j=c,p=d,q=e,r=f,s=g,t=h,u=i;for(let b=0;b<64;b++){let c=u+(m(r,6)^m(r,11)^m(r,25))+(r&s^~r&t)+l[b]+n[b]|0,d=(m(a,2)^m(a,13)^m(a,22))+(a&j^a&p^j&p)|0;u=t,t=s,s=r,r=q+c|0,q=p,p=j,j=a,a=c+d|0}b=b+a|0,c=c+j|0,d=d+p|0,e=e+q|0,f=f+r|0,g=g+s|0,h=h+t|0,i=i+u|0,k=0},"process"),q=di(a=>{"string"==typeof a&&(a=new TextEncoder().encode(a));for(let b=0;b<a.length;b++)o[k++]=a[b],64===k&&p();j+=a.length},"add"),r=di(()=>{if(o[k++]=128,64==k&&p(),k+8>64){for(;k<64;)o[k++]=0;p()}for(;k<58;)o[k++]=0;let a=8*j;o[k++]=a/0x10000000000&255,o[k++]=a/0x100000000&255,o[k++]=a>>>24,o[k++]=a>>>16&255,o[k++]=a>>>8&255,o[k++]=255&a,p();let l=new Uint8Array(32);return l[0]=b>>>24,l[1]=b>>>16&255,l[2]=b>>>8&255,l[3]=255&b,l[4]=c>>>24,l[5]=c>>>16&255,l[6]=c>>>8&255,l[7]=255&c,l[8]=d>>>24,l[9]=d>>>16&255,l[10]=d>>>8&255,l[11]=255&d,l[12]=e>>>24,l[13]=e>>>16&255,l[14]=e>>>8&255,l[15]=255&e,l[16]=f>>>24,l[17]=f>>>16&255,l[18]=f>>>8&255,l[19]=255&f,l[20]=g>>>24,l[21]=g>>>16&255,l[22]=g>>>8&255,l[23]=255&g,l[24]=h>>>24,l[25]=h>>>16&255,l[26]=h>>>8&255,l[27]=255&h,l[28]=i>>>24,l[29]=i>>>16&255,l[30]=i>>>8&255,l[31]=255&i,l},"digest");return void 0===a?{add:q,digest:r}:(q(a),r())}var dA,dB,dC=dj(()=>{du(),di(dz,"sha256")}),dD=dj(()=>{du(),di(dA=class a{constructor(){dq(this,"_dataLength",0),dq(this,"_bufferLength",0),dq(this,"_state",new Int32Array(4)),dq(this,"_buffer",new ArrayBuffer(68)),dq(this,"_buffer8"),dq(this,"_buffer32"),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashByteArray(a,b=!1){return this.onePassHasher.start().appendByteArray(a).end(b)}static hashStr(a,b=!1){return this.onePassHasher.start().appendStr(a).end(b)}static hashAsciiStr(a,b=!1){return this.onePassHasher.start().appendAsciiStr(a).end(b)}static _hex(b){let c=a.hexChars,d=a.hexOut,e,f,g,h;for(h=0;h<4;h+=1)for(f=8*h,e=b[h],g=0;g<8;g+=2)d[f+1+g]=c.charAt(15&e),e>>>=4,d[f+0+g]=c.charAt(15&e),e>>>=4;return d.join("")}static _md5cycle(a,b){let c=a[0],d=a[1],e=a[2],f=a[3];c+=(d&e|~d&f)+b[0]-0x28955b88|0,f+=((c=(c<<7|c>>>25)+d|0)&d|~c&e)+b[1]-0x173848aa|0,e+=((f=(f<<12|f>>>20)+c|0)&c|~f&d)+b[2]+0x242070db|0,d+=((e=(e<<17|e>>>15)+f|0)&f|~e&c)+b[3]-0x3e423112|0,c+=((d=(d<<22|d>>>10)+e|0)&e|~d&f)+b[4]-0xa83f051|0,f+=((c=(c<<7|c>>>25)+d|0)&d|~c&e)+b[5]+0x4787c62a|0,e+=((f=(f<<12|f>>>20)+c|0)&c|~f&d)+b[6]-0x57cfb9ed|0,d+=((e=(e<<17|e>>>15)+f|0)&f|~e&c)+b[7]-0x2b96aff|0,c+=((d=(d<<22|d>>>10)+e|0)&e|~d&f)+b[8]+0x698098d8|0,f+=((c=(c<<7|c>>>25)+d|0)&d|~c&e)+b[9]-0x74bb0851|0,e+=((f=(f<<12|f>>>20)+c|0)&c|~f&d)+b[10]-42063|0,d+=((e=(e<<17|e>>>15)+f|0)&f|~e&c)+b[11]-0x76a32842|0,c+=((d=(d<<22|d>>>10)+e|0)&e|~d&f)+b[12]+0x6b901122|0,f+=((c=(c<<7|c>>>25)+d|0)&d|~c&e)+b[13]-0x2678e6d|0,e+=((f=(f<<12|f>>>20)+c|0)&c|~f&d)+b[14]-0x5986bc72|0,d+=((e=(e<<17|e>>>15)+f|0)&f|~e&c)+b[15]+0x49b40821|0,c+=((d=(d<<22|d>>>10)+e|0)&f|e&~f)+b[1]-0x9e1da9e|0,f+=((c=(c<<5|c>>>27)+d|0)&e|d&~e)+b[6]-0x3fbf4cc0|0,e+=((f=(f<<9|f>>>23)+c|0)&d|c&~d)+b[11]+0x265e5a51|0,d+=((e=(e<<14|e>>>18)+f|0)&c|f&~c)+b[0]-0x16493856|0,c+=((d=(d<<20|d>>>12)+e|0)&f|e&~f)+b[5]-0x29d0efa3|0,f+=((c=(c<<5|c>>>27)+d|0)&e|d&~e)+b[10]+0x2441453|0,e+=((f=(f<<9|f>>>23)+c|0)&d|c&~d)+b[15]-0x275e197f|0,d+=((e=(e<<14|e>>>18)+f|0)&c|f&~c)+b[4]-0x182c0438|0,c+=((d=(d<<20|d>>>12)+e|0)&f|e&~f)+b[9]+0x21e1cde6|0,f+=((c=(c<<5|c>>>27)+d|0)&e|d&~e)+b[14]-0x3cc8f82a|0,e+=((f=(f<<9|f>>>23)+c|0)&d|c&~d)+b[3]-0xb2af279|0,d+=((e=(e<<14|e>>>18)+f|0)&c|f&~c)+b[8]+0x455a14ed|0,c+=((d=(d<<20|d>>>12)+e|0)&f|e&~f)+b[13]-0x561c16fb|0,f+=((c=(c<<5|c>>>27)+d|0)&e|d&~e)+b[2]-0x3105c08|0,e+=((f=(f<<9|f>>>23)+c|0)&d|c&~d)+b[7]+0x676f02d9|0,d+=((e=(e<<14|e>>>18)+f|0)&c|f&~c)+b[12]-0x72d5b376|0,c+=((d=(d<<20|d>>>12)+e|0)^e^f)+b[5]-378558|0,f+=((c=(c<<4|c>>>28)+d|0)^d^e)+b[8]-0x788e097f|0,e+=((f=(f<<11|f>>>21)+c|0)^c^d)+b[11]+0x6d9d6122|0,d+=((e=(e<<16|e>>>16)+f|0)^f^c)+b[14]-0x21ac7f4|0,c+=((d=(d<<23|d>>>9)+e|0)^e^f)+b[1]-0x5b4115bc|0,f+=((c=(c<<4|c>>>28)+d|0)^d^e)+b[4]+0x4bdecfa9|0,e+=((f=(f<<11|f>>>21)+c|0)^c^d)+b[7]-0x944b4a0|0,d+=((e=(e<<16|e>>>16)+f|0)^f^c)+b[10]-0x41404390|0,c+=((d=(d<<23|d>>>9)+e|0)^e^f)+b[13]+0x289b7ec6|0,f+=((c=(c<<4|c>>>28)+d|0)^d^e)+b[0]-0x155ed806|0,e+=((f=(f<<11|f>>>21)+c|0)^c^d)+b[3]-0x2b10cf7b|0,d+=((e=(e<<16|e>>>16)+f|0)^f^c)+b[6]+0x4881d05|0,c+=((d=(d<<23|d>>>9)+e|0)^e^f)+b[9]-0x262b2fc7|0,f+=((c=(c<<4|c>>>28)+d|0)^d^e)+b[12]-0x1924661b|0,e+=((f=(f<<11|f>>>21)+c|0)^c^d)+b[15]+0x1fa27cf8|0,d+=((e=(e<<16|e>>>16)+f|0)^f^c)+b[2]-0x3b53a99b|0,d=(d<<23|d>>>9)+e|0,c+=(e^(d|~f))+b[0]-0xbd6ddbc|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[7]+0x432aff97|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[14]-0x546bdc59|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[5]-0x36c5fc7|0,d=(d<<21|d>>>11)+e|0,c+=(e^(d|~f))+b[12]+0x655b59c3|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[3]-0x70f3336e|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[10]-1051523|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[1]-0x7a7ba22f|0,d=(d<<21|d>>>11)+e|0,c+=(e^(d|~f))+b[8]+0x6fa87e4f|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[15]-0x1d31920|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[6]-0x5cfebcec|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[13]+0x4e0811a1|0,d=(d<<21|d>>>11)+e|0,c+=(e^(d|~f))+b[4]-0x8ac817e|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[11]-0x42c50dcb|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[2]+0x2ad7d2bb|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[9]-0x14792c6f|0,d=(d<<21|d>>>11)+e|0,a[0]=c+a[0]|0,a[1]=d+a[1]|0,a[2]=e+a[2]|0,a[3]=f+a[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(a.stateIdentity),this}appendStr(b){let c=this._buffer8,d=this._buffer32,e=this._bufferLength,f,g;for(g=0;g<b.length;g+=1){if((f=b.charCodeAt(g))<128)c[e++]=f;else if(f<2048)c[e++]=(f>>>6)+192,c[e++]=63&f|128;else if(f<55296||f>56319)c[e++]=(f>>>12)+224,c[e++]=f>>>6&63|128,c[e++]=63&f|128;else{if((f=(f-55296)*1024+(b.charCodeAt(++g)-56320)+65536)>1114111)throw Error("Unicode standard supports code points up to U+10FFFF");c[e++]=(f>>>18)+240,c[e++]=f>>>12&63|128,c[e++]=f>>>6&63|128,c[e++]=63&f|128}e>=64&&(this._dataLength+=64,a._md5cycle(this._state,d),e-=64,d[0]=d[16])}return this._bufferLength=e,this}appendAsciiStr(b){let c=this._buffer8,d=this._buffer32,e=this._bufferLength,f,g=0;for(;;){for(f=Math.min(b.length-g,64-e);f--;)c[e++]=b.charCodeAt(g++);if(e<64)break;this._dataLength+=64,a._md5cycle(this._state,d),e=0}return this._bufferLength=e,this}appendByteArray(b){let c=this._buffer8,d=this._buffer32,e=this._bufferLength,f,g=0;for(;;){for(f=Math.min(b.length-g,64-e);f--;)c[e++]=b[g++];if(e<64)break;this._dataLength+=64,a._md5cycle(this._state,d),e=0}return this._bufferLength=e,this}getState(){let a=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[a[0],a[1],a[2],a[3]]}}setState(a){let b=a.buffer,c=a.state,d=this._state,e;for(this._dataLength=a.length,this._bufferLength=a.buflen,d[0]=c[0],d[1]=c[1],d[2]=c[2],d[3]=c[3],e=0;e<b.length;e+=1)this._buffer8[e]=b.charCodeAt(e)}end(b=!1){let c=this._bufferLength,d=this._buffer8,e=this._buffer32,f=(c>>2)+1;this._dataLength+=c;let g=8*this._dataLength;if(d[c]=128,d[c+1]=d[c+2]=d[c+3]=0,e.set(a.buffer32Identity.subarray(f),f),c>55&&(a._md5cycle(this._state,e),e.set(a.buffer32Identity)),g<=0xffffffff)e[14]=g;else{let a=g.toString(16).match(/(.*?)(.{0,8})$/);if(null===a)return;let b=parseInt(a[2],16),c=parseInt(a[1],16)||0;e[14]=b,e[15]=c}return a._md5cycle(this._state,e),b?this._state:a._hex(this._state)}},"Md5"),dq(dA,"stateIdentity",new Int32Array([0x67452301,-0x10325477,-0x67452302,0x10325476])),dq(dA,"buffer32Identity",new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),dq(dA,"hexChars","0123456789abcdef"),dq(dA,"hexOut",[]),dq(dA,"onePassHasher",new dA),dB=dA}),dE={};function dF(a){return c9.getRandomValues(da.alloc(a))}function dG(a){if("sha256"===a)return{update:di(function(a){return{digest:di(function(){return da.from(dz(a))},"digest")}},"update")};if("md5"===a)return{update:di(function(a){return{digest:di(function(){return"string"==typeof a?dB.hashStr(a):dB.hashByteArray(a)},"digest")}},"update")};throw Error(`Hash type '${a}' not supported`)}function dH(a,b){if("sha256"!==a)throw Error(`Only sha256 is supported (requested: '${a}')`);return{update:di(function(a){return{digest:di(function(){"string"==typeof b&&(b=new TextEncoder().encode(b)),"string"==typeof a&&(a=new TextEncoder().encode(a));let c=b.length;if(c>64)b=dz(b);else if(c<64){let a=new Uint8Array(64);a.set(b),b=a}let d=new Uint8Array(64),e=new Uint8Array(64);for(let a=0;a<64;a++)d[a]=54^b[a],e[a]=92^b[a];let f=new Uint8Array(a.length+64);f.set(d,0),f.set(a,64);let g=new Uint8Array(96);return g.set(e,0),g.set(dz(f),64),da.from(dz(g))},"digest")}},"update")}}dl(dE,{createHash:()=>dG,createHmac:()=>dH,randomBytes:()=>dF});var dI=dj(()=>{du(),dC(),dD(),di(dF,"randomBytes"),di(dG,"createHash"),di(dH,"createHmac")}),dJ=dk(a=>{du(),a.parse=function(a,b){return new c(a,b).parse()};var b=class a{constructor(a,b){this.source=a,this.transform=b||d,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var a=this.source[this.position++];return"\\"===a?{value:this.source[this.position++],escaped:!0}:{value:a,escaped:!1}}record(a){this.recorded.push(a)}newEntry(a){var b;(this.recorded.length>0||a)&&("NULL"!==(b=this.recorded.join(""))||a||(b=null),null!==b&&(b=this.transform(b)),this.entries.push(b),this.recorded=[])}consumeDimensions(){if("["===this.source[0])for(;!this.isEof()&&"="!==this.nextCharacter().value;);}parse(b){var c,d,e;for(this.consumeDimensions();!this.isEof();)if("{"!==(c=this.nextCharacter()).value||e){if("}"!==c.value||e)'"'!==c.value||c.escaped?","!==c.value||e?this.record(c.value):this.newEntry():(e&&this.newEntry(!0),e=!e);else if(this.dimension--,!this.dimension&&(this.newEntry(),b))return this.entries}else this.dimension++,this.dimension>1&&(d=new a(this.source.substr(this.position-1),this.transform),this.entries.push(d.parse(!0)),this.position+=d.position-2);if(0!==this.dimension)throw Error("array dimension not balanced");return this.entries}};di(b,"ArrayParser");var c=b;function d(a){return a}di(d,"identity")}),dK=dk((a,b)=>{du();var c=dJ();b.exports={create:di(function(a,b){return{parse:di(function(){return c.parse(a,b)},"parse")}},"create")}}),dL=dk((a,b)=>{du();var c=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,d=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,e=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,f=/^-?infinity$/;function g(a){var b=d.exec(a);if(b){var c=parseInt(b[1],10);b[4]&&(c=i(c));var e=new Date(c,parseInt(b[2],10)-1,b[3]);return j(c)&&e.setFullYear(c),e}}function h(a){if(a.endsWith("+00"))return 0;var b=e.exec(a.split(" ")[1]);if(b){var c=b[1];return"Z"===c?0:(3600*parseInt(b[2],10)+60*parseInt(b[3]||0,10)+parseInt(b[4]||0,10))*("-"===c?-1:1)*1e3}}function i(a){return-(a-1)}function j(a){return a>=0&&a<100}b.exports=di(function(a){if(f.test(a))return Number(a.replace("i","I"));var b=c.exec(a);if(!b)return g(a)||null;var d=!!b[8],e=parseInt(b[1],10);d&&(e=i(e));var k=parseInt(b[2],10)-1,l=b[3],m=parseInt(b[4],10),n=parseInt(b[5],10),o=parseInt(b[6],10),p=b[7];p=p?1e3*parseFloat(p):0;var q,r=h(a);return null!=r?(q=new Date(Date.UTC(e,k,l,m,n,o,p)),j(e)&&q.setUTCFullYear(e),0!==r&&q.setTime(q.getTime()-r)):(q=new Date(e,k,l,m,n,o,p),j(e)&&q.setFullYear(e)),q},"parseDate"),di(g,"getDate"),di(h,"timeZoneOffset"),di(i,"bcYearToNegativeYear"),di(j,"is0To99")}),dM=dk((a,b)=>{du(),b.exports=d;var c=Object.prototype.hasOwnProperty;function d(a){for(var b=1;b<arguments.length;b++){var d=arguments[b];for(var e in d)c.call(d,e)&&(a[e]=d[e])}return a}di(d,"extend")}),dN=dk((a,b)=>{du();var c=dM();function d(a){if(!(this instanceof d))return new d(a);c(this,n(a))}b.exports=d,di(d,"PostgresInterval");var e=["seconds","minutes","hours","days","months","years"];d.prototype.toPostgres=function(){var a=e.filter(this.hasOwnProperty,this);return this.milliseconds&&0>a.indexOf("seconds")&&a.push("seconds"),0===a.length?"0":a.map(function(a){var b=this[a]||0;return"seconds"===a&&this.milliseconds&&(b=(b+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),b+" "+a},this).join(" ")};var f={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},g=["years","months","days"],h=["hours","minutes","seconds"];d.prototype.toISOString=d.prototype.toISO=function(){return"P"+g.map(a,this).join("")+"T"+h.map(a,this).join("");function a(a){var b=this[a]||0;return"seconds"===a&&this.milliseconds&&(b=(b+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),b+f[a]}};var i="([+-]?\\d+)",j=new RegExp([i+"\\s+years?",i+"\\s+mons?",i+"\\s+days?","([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?"].map(function(a){return"("+a+")?"}).join("\\s*")),k={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},l=["hours","minutes","seconds","milliseconds"];function m(a){return parseInt(a+"000000".slice(a.length),10)/1e3}function n(a){if(!a)return{};var b=j.exec(a),c="-"===b[8];return Object.keys(k).reduce(function(a,d){var e=b[k[d]];return e&&(e="milliseconds"===d?m(e):parseInt(e,10))&&(c&&~l.indexOf(d)&&(e*=-1),a[d]=e),a},{})}di(m,"parseMilliseconds"),di(n,"parse")}),dO=dk((a,b)=>{du(),b.exports=di(function(a){if(/^\\x/.test(a))return new da(a.substr(2),"hex");for(var b="",c=0;c<a.length;)if("\\"!==a[c])b+=a[c],++c;else if(/[0-7]{3}/.test(a.substr(c+1,3)))b+=String.fromCharCode(parseInt(a.substr(c+1,3),8)),c+=4;else{for(var d=1;c+d<a.length&&"\\"===a[c+d];)d++;for(var e=0;e<Math.floor(d/2);++e)b+="\\";c+=2*Math.floor(d/2)}return new da(b,"binary")},"parseBytea")}),dP=dk((a,b)=>{du();var c=dJ(),d=dK(),e=dL(),f=dN(),g=dO();function h(a){return di(function(b){return null===b?b:a(b)},"nullAllowed")}function i(a){return null===a?a:"TRUE"===a||"t"===a||"true"===a||"y"===a||"yes"===a||"on"===a||"1"===a}function j(a){return a?c.parse(a,i):null}function k(a){return parseInt(a,10)}function l(a){return a?c.parse(a,h(k)):null}function m(a){return a?c.parse(a,h(function(a){return u(a).trim()})):null}di(h,"allowNull"),di(i,"parseBool"),di(j,"parseBoolArray"),di(k,"parseBaseTenInt"),di(l,"parseIntegerArray"),di(m,"parseBigIntegerArray");var n=di(function(a){return a?d.create(a,function(a){return null!==a&&(a=w(a)),a}).parse():null},"parsePointArray"),o=di(function(a){return a?d.create(a,function(a){return null!==a&&(a=parseFloat(a)),a}).parse():null},"parseFloatArray"),p=di(function(a){return a?d.create(a).parse():null},"parseStringArray"),q=di(function(a){return a?d.create(a,function(a){return null!==a&&(a=e(a)),a}).parse():null},"parseDateArray"),r=di(function(a){return a?d.create(a,function(a){return null!==a&&(a=f(a)),a}).parse():null},"parseIntervalArray"),s=di(function(a){return a?c.parse(a,h(g)):null},"parseByteAArray"),t=di(function(a){return parseInt(a,10)},"parseInteger"),u=di(function(a){var b=String(a);return/^\d+$/.test(b)?b:a},"parseBigInteger"),v=di(function(a){return a?c.parse(a,h(JSON.parse)):null},"parseJsonArray"),w=di(function(a){return"("!==a[0]?null:{x:parseFloat((a=a.substring(1,a.length-1).split(","))[0]),y:parseFloat(a[1])}},"parsePoint"),x=di(function(a){if("<"!==a[0]&&"("!==a[1])return null;for(var b="(",c="",d=!1,e=2;e<a.length-1;e++){if(d||(b+=a[e]),")"===a[e]){d=!0;continue}d&&","!==a[e]&&(c+=a[e])}var f=w(b);return f.radius=parseFloat(c),f},"parseCircle");b.exports={init:di(function(a){a(20,u),a(21,t),a(23,t),a(26,t),a(700,parseFloat),a(701,parseFloat),a(16,i),a(1082,e),a(1114,e),a(1184,e),a(600,w),a(651,p),a(718,x),a(1e3,j),a(1001,s),a(1005,l),a(1007,l),a(1028,l),a(1016,m),a(1017,n),a(1021,o),a(1022,o),a(1231,o),a(1014,p),a(1015,p),a(1008,p),a(1009,p),a(1040,p),a(1041,p),a(1115,q),a(1182,q),a(1185,q),a(1186,f),a(1187,r),a(17,g),a(114,JSON.parse.bind(JSON)),a(3802,JSON.parse.bind(JSON)),a(199,v),a(3807,v),a(3907,p),a(2951,p),a(791,p),a(1183,p),a(1270,p)},"init")}}),dQ=dk((a,b)=>{function c(a){var b=a.readInt32BE(0),c=a.readUInt32BE(4),d="";b<0&&(b=~b+(0===c),c=~c+1>>>0,d="-");var e,f,g,h,i,j,k="";if(e=b%1e6,b=b/1e6>>>0,c=(f=0x100000000*e+c)/1e6>>>0,g=""+(f-1e6*c),0===c&&0===b)return d+g+k;for(h="",i=6-g.length,j=0;j<i;j++)h+="0";if(k=h+g+k,e=b%1e6,b=b/1e6>>>0,c=(f=0x100000000*e+c)/1e6>>>0,g=""+(f-1e6*c),0===c&&0===b)return d+g+k;for(h="",i=6-g.length,j=0;j<i;j++)h+="0";if(k=h+g+k,e=b%1e6,b=b/1e6>>>0,c=(f=0x100000000*e+c)/1e6>>>0,g=""+(f-1e6*c),0===c&&0===b)return d+g+k;for(h="",i=6-g.length,j=0;j<i;j++)h+="0";return k=h+g+k,d+(g=""+(f=0x100000000*(e=b%1e6)+c)%1e6)+k}du(),di(c,"readInt8"),b.exports=c}),dR=dk((a,b)=>{du();var c=dQ(),d=di(function(a,b,c,d,e){c=c||0,d=d||!1,e=e||function(a,b,c){return a*Math.pow(2,c)+b};var f=c>>3,g=di(function(a){return d?255&~a:a},"inv"),h=255,i=8-c%8;b<i&&(h=255<<8-b&255,i=b),c&&(h>>=c%8);var j=0;c%8+b>=8&&(j=e(0,g(a[f])&h,i));for(var k=b+c>>3,l=f+1;l<k;l++)j=e(j,g(a[l]),8);var m=(b+c)%8;return m>0&&(j=e(j,g(a[k])>>8-m,m)),j},"parseBits"),e=di(function(a,b,c){var e=Math.pow(2,c-1)-1,f=d(a,1),g=d(a,c,1);if(0===g)return 0;var h=1,i=d(a,b,c+1,!1,di(function(a,b,c){0===a&&(a=1);for(var d=1;d<=c;d++)h/=2,(b&1<<c-d)>0&&(a+=h);return a},"parsePrecisionBits"));return g==Math.pow(2,c+1)-1?0===i?0===f?1/0:-1/0:NaN:(0===f?1:-1)*Math.pow(2,g-e)*i},"parseFloatFromBits"),f=di(function(a){return 1==d(a,1)?-1*(d(a,15,1,!0)+1):d(a,15,1)},"parseInt16"),g=di(function(a){return 1==d(a,1)?-1*(d(a,31,1,!0)+1):d(a,31,1)},"parseInt32"),h=di(function(a){return e(a,23,8)},"parseFloat32"),i=di(function(a){return e(a,52,11)},"parseFloat64"),j=di(function(a){var b=d(a,16,32);if(49152==b)return NaN;for(var c=Math.pow(1e4,d(a,16,16)),e=0,f=d(a,16),g=0;g<f;g++)e+=d(a,16,64+16*g)*c,c/=1e4;var h=Math.pow(10,d(a,16,48));return(0===b?1:-1)*Math.round(e*h)/h},"parseNumeric"),k=di(function(a,b){var c=d(b,1),e=d(b,63,1),f=new Date((0===c?1:-1)*e/1e3+9466848e5);return a||f.setTime(f.getTime()+6e4*f.getTimezoneOffset()),f.usec=e%1e3,f.getMicroSeconds=function(){return this.usec},f.setMicroSeconds=function(a){this.usec=a},f.getUTCMicroSeconds=function(){return this.usec},f},"parseDate"),l=di(function(a){for(var b=d(a,32),c=(d(a,32,32),d(a,32,64)),e=96,f=[],g=0;g<b;g++)f[g]=d(a,32,e),e+=64;var h=di(function(b){var c,f=d(a,32,e);return(e+=32,0xffffffff==f)?null:23==b||20==b?(c=d(a,8*f,e),e+=8*f,c):25==b?a.toString(this.encoding,e>>3,(e+=f<<3)>>3):void console.log("ERROR: ElementType not implemented: "+b)},"parseElement"),i=di(function(a,b){var c,d=[];if(a.length>1){var e=a.shift();for(c=0;c<e;c++)d[c]=i(a,b);a.unshift(e)}else for(c=0;c<a[0];c++)d[c]=h(b);return d},"parse");return i(f,c)},"parseArray"),m=di(function(a){return a.toString("utf8")},"parseText"),n=di(function(a){return null===a?null:d(a,8)>0},"parseBool");b.exports={init:di(function(a){a(20,c),a(21,f),a(23,g),a(26,g),a(1700,j),a(700,h),a(701,i),a(16,n),a(1114,k.bind(null,!1)),a(1184,k.bind(null,!0)),a(1e3,l),a(1007,l),a(1016,l),a(1008,l),a(1009,l),a(25,m)},"init")}}),dS=dk((a,b)=>{du(),b.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}}),dT=dk(a=>{du();var b=dP(),c=dR(),d=dK(),e=dS();a.getTypeParser=h,a.setTypeParser=i,a.arrayParser=d,a.builtins=e;var f={text:{},binary:{}};function g(a){return String(a)}function h(a,b){return f[b=b||"text"]&&f[b][a]||g}function i(a,b,c){"function"==typeof b&&(c=b,b="text"),f[b][a]=c}di(g,"noParse"),di(h,"getTypeParser"),di(i,"setTypeParser"),b.init(function(a,b){f.text[a]=b}),c.init(function(a,b){f.binary[a]=b})}),dU=dk((a,b)=>{du(),b.exports={host:"localhost",user:"win32"===db.platform?db.env.USERNAME:db.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var c=dT(),d=c.getTypeParser(20,"text"),e=c.getTypeParser(1016,"text");b.exports.__defineSetter__("parseInt8",function(a){c.setTypeParser(20,"text",a?c.getTypeParser(23,"text"):d),c.setTypeParser(1016,"text",a?c.getTypeParser(1007,"text"):e)})}),dV=dk((a,b)=>{du();var c=(dI(),dp(dE)),d=dU();function e(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'}function f(a){for(var b="{",c=0;c<a.length;c++)c>0&&(b+=","),null===a[c]||typeof a[c]>"u"?b+="NULL":Array.isArray(a[c])?b+=f(a[c]):a[c]instanceof da?b+="\\\\x"+a[c].toString("hex"):b+=e(g(a[c]));return b+"}"}di(e,"escapeElement"),di(f,"arrayString");var g=di(function(a,b){if(null==a)return null;if(a instanceof da)return a;if(ArrayBuffer.isView(a)){var c=da.from(a.buffer,a.byteOffset,a.byteLength);return c.length===a.byteLength?c:c.slice(a.byteOffset,a.byteOffset+a.byteLength)}return a instanceof Date?d.parseInputDatesAsUTC?k(a):j(a):Array.isArray(a)?f(a):"object"==typeof a?h(a,b):a.toString()},"prepareValue");function h(a,b){if(a&&"function"==typeof a.toPostgres){if(-1!==(b=b||[]).indexOf(a))throw Error('circular reference detected while preparing "'+a+'" for query');return b.push(a),g(a.toPostgres(g),b)}return JSON.stringify(a)}function i(a,b){for(a=""+a;a.length<b;)a="0"+a;return a}function j(a){var b=-a.getTimezoneOffset(),c=a.getFullYear(),d=c<1;d&&(c=Math.abs(c)+1);var e=i(c,4)+"-"+i(a.getMonth()+1,2)+"-"+i(a.getDate(),2)+"T"+i(a.getHours(),2)+":"+i(a.getMinutes(),2)+":"+i(a.getSeconds(),2)+"."+i(a.getMilliseconds(),3);return b<0?(e+="-",b*=-1):e+="+",e+=i(Math.floor(b/60),2)+":"+i(b%60,2),d&&(e+=" BC"),e}function k(a){var b=a.getUTCFullYear(),c=b<1;c&&(b=Math.abs(b)+1);var d=i(b,4)+"-"+i(a.getUTCMonth()+1,2)+"-"+i(a.getUTCDate(),2)+"T"+i(a.getUTCHours(),2)+":"+i(a.getUTCMinutes(),2)+":"+i(a.getUTCSeconds(),2)+"."+i(a.getUTCMilliseconds(),3);return d+="+00:00",c&&(d+=" BC"),d}function l(a,b,c){return a="string"==typeof a?{text:a}:a,b&&("function"==typeof b?a.callback=b:a.values=b),c&&(a.callback=c),a}di(h,"prepareObject"),di(i,"pad"),di(j,"dateToString"),di(k,"dateToStringUTC"),di(l,"normalizeQueryConfig");var m=di(function(a){return c.createHash("md5").update(a,"utf-8").digest("hex")},"md5"),n=di(function(a,b,c){var d=m(b+a);return"md5"+m(da.concat([da.from(d),c]))},"postgresMd5PasswordHash");b.exports={prepareValue:di(function(a){return g(a)},"prepareValueWrapper"),normalizeQueryConfig:l,postgresMd5PasswordHash:n,md5:m}}),dW=dk((a,b)=>{du();var c=(dI(),dp(dE));function d(a){if(-1===a.indexOf("SCRAM-SHA-256"))throw Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");let b=c.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:b,response:"n,,n=*,r="+b,message:"SASLInitialResponse"}}function e(a,b,c){if("SASLInitialResponse"!==a.message)throw Error("SASL: Last message was not SASLInitialResponse");if("string"!=typeof b)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if("string"!=typeof c)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let d=j(c);if(d.nonce.startsWith(a.clientNonce)){if(d.nonce.length===a.clientNonce.length)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");var e=o(b,da.from(d.salt,"base64"),d.iteration),f=n(e,"Client Key"),g=m(f),h="n=*,r="+a.clientNonce,i="r="+d.nonce+",s="+d.salt+",i="+d.iteration,k="c=biws,r="+d.nonce,p=h+","+i+","+k,q=l(f,n(g,p)).toString("base64"),r=n(e,"Server Key"),s=n(r,p);a.message="SASLResponse",a.serverSignature=s.toString("base64"),a.response=k+",p="+q}function f(a,b){if("SASLResponse"!==a.message)throw Error("SASL: Last message was not SASLResponse");if("string"!=typeof b)throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:c}=k(b);if(c!==a.serverSignature)throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}function g(a){if("string"!=typeof a)throw TypeError("SASL: text must be a string");return a.split("").map((b,c)=>a.charCodeAt(c)).every(a=>a>=33&&a<=43||a>=45&&a<=126)}function h(a){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(a)}function i(a){if("string"!=typeof a)throw TypeError("SASL: attribute pairs text must be a string");return new Map(a.split(",").map(a=>{if(!/^.=/.test(a))throw Error("SASL: Invalid attribute pair entry");return[a[0],a.substring(2)]}))}function j(a){let b=i(a),c=b.get("r");if(c){if(!g(c))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let d=b.get("s");if(d){if(!h(d))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let e=b.get("i");if(e){if(!/^[1-9][0-9]*$/.test(e))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");return{nonce:c,salt:d,iteration:parseInt(e,10)}}function k(a){let b=i(a).get("v");if(b){if(!h(b))throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:b}}function l(a,b){if(!da.isBuffer(a))throw TypeError("first argument must be a Buffer");if(!da.isBuffer(b))throw TypeError("second argument must be a Buffer");if(a.length!==b.length)throw Error("Buffer lengths must match");if(0===a.length)throw Error("Buffers cannot be empty");return da.from(a.map((c,d)=>a[d]^b[d]))}function m(a){return c.createHash("sha256").update(a).digest()}function n(a,b){return c.createHmac("sha256",a).update(b).digest()}function o(a,b,c){for(var d=n(a,da.concat([b,da.from([0,0,0,1])])),e=d,f=0;f<c-1;f++)e=l(e,d=n(a,d));return e}di(d,"startSession"),di(e,"continueSession"),di(f,"finalizeSession"),di(g,"isPrintableChars"),di(h,"isBase64"),di(i,"parseAttributePairs"),di(j,"parseServerFirstMessage"),di(k,"parseServerFinalMessage"),di(l,"xorBuffers"),di(m,"sha256"),di(n,"hmacSha256"),di(o,"Hi"),b.exports={startSession:d,continueSession:e,finalizeSession:f}}),dX={};function dY(...a){return a.join("/")}dl(dX,{join:()=>dY});var dZ=dj(()=>{du(),di(dY,"join")}),d$={};function d_(a,b){b(Error("No filesystem"))}dl(d$,{stat:()=>d_});var d0=dj(()=>{du(),di(d_,"stat")}),d1={};dl(d1,{default:()=>d2});var d2,d3=dj(()=>{du(),d2={}}),d4={};dl(d4,{StringDecoder:()=>d6});var d5,d6,d7=dj(()=>{du(),di(d5=class{constructor(a){dq(this,"td"),this.td=new TextDecoder(a)}write(a){return this.td.decode(a,{stream:!0})}end(a){return this.td.decode(a)}},"StringDecoder"),d6=d5}),d8=dk((a,b)=>{du();var{Transform:c}=(d3(),dp(d1)),{StringDecoder:d}=(d7(),dp(d4)),e=Symbol("last"),f=Symbol("decoder");function g(a,b,c){let d;if(this.overflow){if(1===(d=this[f].write(a).split(this.matcher)).length)return c();d.shift(),this.overflow=!1}else this[e]+=this[f].write(a),d=this[e].split(this.matcher);this[e]=d.pop();for(let a=0;a<d.length;a++)try{i(this,this.mapper(d[a]))}catch(a){return c(a)}(this.overflow=this[e].length>this.maxLength,this.overflow&&!this.skipOverflow)?c(Error("maximum buffer reached")):c()}function h(a){if(this[e]+=this[f].end(),this[e])try{i(this,this.mapper(this[e]))}catch(b){return a(b)}a()}function i(a,b){void 0!==b&&a.push(b)}function j(a){return a}function k(a,b,i){switch(a=a||/\r?\n/,b=b||j,i=i||{},arguments.length){case 1:"function"==typeof a?(b=a,a=/\r?\n/):"object"!=typeof a||a instanceof RegExp||a[Symbol.split]||(i=a,a=/\r?\n/);break;case 2:"function"==typeof a?(i=b,b=a,a=/\r?\n/):"object"==typeof b&&(i=b,b=j)}(i=Object.assign({},i)).autoDestroy=!0,i.transform=g,i.flush=h,i.readableObjectMode=!0;let k=new c(i);return k[e]="",k[f]=new d("utf8"),k.matcher=a,k.mapper=b,k.maxLength=i.maxLength,k.skipOverflow=i.skipOverflow||!1,k.overflow=!1,k._destroy=function(a,b){this._writableState.errorEmitted=!1,b(a)},k}di(g,"transform"),di(h,"flush"),di(i,"push"),di(j,"noop"),di(k,"split"),b.exports=k}),d9=dk((a,b)=>{du();var c=(dZ(),dp(dX)),d=(d3(),dp(d1)).Stream,e=d8(),f=(dy(),dp(dw)),g="win32"===db.platform,h=db.stderr;function i(a){return(61440&a)==32768}di(i,"isRegFile");var j=["host","port","database","user","password"],k=j.length,l=j[k-1];function m(){if(h instanceof d&&!0===h.writable){var a=Array.prototype.slice.call(arguments).concat(`
`);h.write(f.format.apply(f,a))}}di(m,"warn"),Object.defineProperty(b.exports,"isWin",{get:di(function(){return g},"get"),set:di(function(a){g=a},"set")}),b.exports.warnTo=function(a){var b=h;return h=a,b},b.exports.getFileName=function(a){var b=a||db.env;return b.PGPASSFILE||(g?c.join(b.APPDATA||"./","postgresql","pgpass.conf"):c.join(b.HOME||"./",".pgpass"))},b.exports.usePgPass=function(a,b){return!Object.prototype.hasOwnProperty.call(db.env,"PGPASSWORD")&&(!!g||(b=b||"<unkn>",i(a.mode)?!(63&a.mode)||(m('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',b),!1):(m('WARNING: password file "%s" is not a plain file',b),!1)))};var n=b.exports.match=function(a,b){return j.slice(0,-1).reduce(function(c,d,e){return 1==e&&Number(a[d]||5432)===Number(b[d])?c&&!0:c&&("*"===b[d]||b[d]===a[d])},!0)};b.exports.getPassword=function(a,b,c){var d,f=b.pipe(e());function g(b){var c=o(b);c&&p(c)&&n(a,c)&&(d=c[l],f.end())}di(g,"onLine");var h=di(function(){b.destroy(),c(d)},"onEnd"),i=di(function(a){b.destroy(),m("WARNING: error on reading file: %s",a),c(void 0)},"onErr");b.on("error",i),f.on("data",g).on("end",h).on("error",i)};var o=b.exports.parseLine=function(a){if(a.length<11||a.match(/^\s+#/))return null;for(var b="",c="",d=0,e=0,f={},g=di(function(b,c,d){var e=a.substring(c,d);Object.hasOwnProperty.call(db.env,"PGPASS_NO_DEESCAPE")||(e=e.replace(/\\([:\\])/g,"$1")),f[j[b]]=e},"addToObj"),h=0;h<a.length-1;h+=1){if(b=a.charAt(h+1),c=a.charAt(h),d==k-1){g(d,e);break}h>=0&&":"==b&&"\\"!==c&&(g(d,e,h+1),e=h+2,d+=1)}return f=Object.keys(f).length===k?f:null},p=b.exports.isValidEntry=function(a){for(var b={0:function(a){return a.length>0},1:function(a){return"*"===a||isFinite(a=Number(a))&&a>0&&a<0x20000000000000&&Math.floor(a)===a},2:function(a){return a.length>0},3:function(a){return a.length>0},4:function(a){return a.length>0}},c=0;c<j.length;c+=1)if(!(0,b[c])(a[j[c]]||""))return!1;return!0}}),ea=dk((a,b)=>{du(),dZ(),dp(dX);var c=(d0(),dp(d$)),d=d9();b.exports=function(a,b){var e=d.getFileName();c.stat(e,function(f,g){if(f||!d.usePgPass(g,e))return b(void 0);var h=c.createReadStream(e);d.getPassword(a,h,b)})},b.exports.warnTo=d.warnTo}),eb=dk((a,b)=>{du();var c=dT();function d(a){this._types=a||c,this.text={},this.binary={}}di(d,"TypeOverrides"),d.prototype.getOverrides=function(a){switch(a){case"text":return this.text;case"binary":return this.binary;default:return{}}},d.prototype.setTypeParser=function(a,b,c){"function"==typeof b&&(c=b,b="text"),this.getOverrides(b)[a]=c},d.prototype.getTypeParser=function(a,b){return b=b||"text",this.getOverrides(b)[a]||this._types.getTypeParser(a,b)},b.exports=d}),ec={};dl(ec,{default:()=>ed});var ed,ee=dj(()=>{du(),ed={}}),ef={};function eg(a,b=!1){let{protocol:c}=new URL(a),{username:d,password:e,host:f,hostname:g,port:h,pathname:i,search:j,searchParams:k,hash:l}=new URL("http:"+a.substring(c.length));e=decodeURIComponent(e),d=decodeURIComponent(d),i=decodeURIComponent(i);let m=d+":"+e,n=b?Object.fromEntries(k.entries()):j;return{href:a,protocol:c,auth:m,username:d,password:e,host:f,hostname:g,port:h,pathname:i,search:j,query:n,hash:l}}dl(ef,{parse:()=>eg});var eh=dj(()=>{du(),di(eg,"parse")}),ei=dk((a,b)=>{du();var c=(eh(),dp(ef)),d=(d0(),dp(d$));function e(a){if("/"===a.charAt(0)){var b=a.split(" ");return{host:b[0],database:b[1]}}var e=c.parse(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(a)?encodeURI(a).replace(/\%25(\d\d)/g,"%$1"):a,!0),b=e.query;for(var f in b)Array.isArray(b[f])&&(b[f]=b[f][b[f].length-1]);var g=(e.auth||":").split(":");if(b.user=g[0],b.password=g.splice(1).join(":"),b.port=e.port,"socket:"==e.protocol)return b.host=decodeURI(e.pathname),b.database=e.query.db,b.client_encoding=e.query.encoding,b;b.host||(b.host=e.hostname);var h=e.pathname;if(!b.host&&h&&/^%2f/i.test(h)){var i=h.split("/");b.host=decodeURIComponent(i[0]),h=i.splice(1).join("/")}switch(h&&"/"===h.charAt(0)&&(h=h.slice(1)||null),b.database=h&&decodeURI(h),("true"===b.ssl||"1"===b.ssl)&&(b.ssl=!0),"0"===b.ssl&&(b.ssl=!1),(b.sslcert||b.sslkey||b.sslrootcert||b.sslmode)&&(b.ssl={}),b.sslcert&&(b.ssl.cert=d.readFileSync(b.sslcert).toString()),b.sslkey&&(b.ssl.key=d.readFileSync(b.sslkey).toString()),b.sslrootcert&&(b.ssl.ca=d.readFileSync(b.sslrootcert).toString()),b.sslmode){case"disable":b.ssl=!1;break;case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":b.ssl.rejectUnauthorized=!1}return b}di(e,"parse"),b.exports=e,e.parse=e}),ej=dk((a,b)=>{du();var c=(ee(),dp(ec)),d=dU(),e=ei().parse,f=di(function(a,b,c){return void 0===c?c=db.env["PG"+a.toUpperCase()]:!1===c||(c=db.env[c]),b[a]||c||d[a]},"val"),g=di(function(){switch(db.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return d.ssl},"readSSLConfigFromEnvironment"),h=di(function(a){return"'"+(""+a).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},"quoteParamValue"),i=di(function(a,b,c){var d=b[c];null!=d&&a.push(c+"="+h(d))},"add"),j=class{constructor(a){(a="string"==typeof a?e(a):a||{}).connectionString&&(a=Object.assign({},a,e(a.connectionString))),this.user=f("user",a),this.database=f("database",a),void 0===this.database&&(this.database=this.user),this.port=parseInt(f("port",a),10),this.host=f("host",a),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:f("password",a)}),this.binary=f("binary",a),this.options=f("options",a),this.ssl=typeof a.ssl>"u"?g():a.ssl,"string"==typeof this.ssl&&"true"===this.ssl&&(this.ssl=!0),"no-verify"===this.ssl&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=f("client_encoding",a),this.replication=f("replication",a),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=f("application_name",a,"PGAPPNAME"),this.fallback_application_name=f("fallback_application_name",a,!1),this.statement_timeout=f("statement_timeout",a,!1),this.lock_timeout=f("lock_timeout",a,!1),this.idle_in_transaction_session_timeout=f("idle_in_transaction_session_timeout",a,!1),this.query_timeout=f("query_timeout",a,!1),void 0===a.connectionTimeoutMillis?this.connect_timeout=db.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(a.connectionTimeoutMillis/1e3),!1===a.keepAlive?this.keepalives=0:!0===a.keepAlive&&(this.keepalives=1),"number"==typeof a.keepAliveInitialDelayMillis&&(this.keepalives_idle=Math.floor(a.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(a){var b=[];i(b,this,"user"),i(b,this,"password"),i(b,this,"port"),i(b,this,"application_name"),i(b,this,"fallback_application_name"),i(b,this,"connect_timeout"),i(b,this,"options");var d="object"==typeof this.ssl?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(i(b,d,"sslmode"),i(b,d,"sslca"),i(b,d,"sslkey"),i(b,d,"sslcert"),i(b,d,"sslrootcert"),this.database&&b.push("dbname="+h(this.database)),this.replication&&b.push("replication="+h(this.replication)),this.host&&b.push("host="+h(this.host)),this.isDomainSocket)return a(null,b.join(" "));this.client_encoding&&b.push("client_encoding="+h(this.client_encoding)),c.lookup(this.host,function(c,d){return c?a(c,null):(b.push("hostaddr="+h(d)),a(null,b.join(" ")))})}};di(j,"ConnectionParameters"),b.exports=j}),ek=dk((a,b)=>{du();var c=dT(),d=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,e=class{constructor(a,b){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=b,this.RowCtor=null,this.rowAsArray="array"===a,this.rowAsArray&&(this.parseRow=this._parseRowAsArray)}addCommandComplete(a){var b;(b=a.text?d.exec(a.text):d.exec(a.command))&&(this.command=b[1],b[3]?(this.oid=parseInt(b[2],10),this.rowCount=parseInt(b[3],10)):b[2]&&(this.rowCount=parseInt(b[2],10)))}_parseRowAsArray(a){for(var b=Array(a.length),c=0,d=a.length;c<d;c++){var e=a[c];null!==e?b[c]=this._parsers[c](e):b[c]=null}return b}parseRow(a){for(var b={},c=0,d=a.length;c<d;c++){var e=a[c],f=this.fields[c].name;null!==e?b[f]=this._parsers[c](e):b[f]=null}return b}addRow(a){this.rows.push(a)}addFields(a){this.fields=a,this.fields.length&&(this._parsers=Array(a.length));for(var b=0;b<a.length;b++){var d=a[b];this._types?this._parsers[b]=this._types.getTypeParser(d.dataTypeID,d.format||"text"):this._parsers[b]=c.getTypeParser(d.dataTypeID,d.format||"text")}}};di(e,"Result"),b.exports=e}),el=dk((a,b)=>{du();var{EventEmitter:c}=dv(),d=ek(),e=dV(),f=class extends c{constructor(a,b,c){super(),a=e.normalizeQueryConfig(a,b,c),this.text=a.text,this.values=a.values,this.rows=a.rows,this.types=a.types,this.name=a.name,this.binary=a.binary,this.portal=a.portal||"",this.callback=a.callback,this._rowMode=a.rowMode,db.domain&&a.callback&&(this.callback=db.domain.bind(a.callback)),this._result=new d(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){return!!this.name||!!this.rows||!!this.text&&!!this.values&&this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new d(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(a){this._checkForMultirow(),this._result.addFields(a.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(a){let b;if(!this._canceledDueToError){try{b=this._result.parseRow(a.fields)}catch(a){this._canceledDueToError=a;return}this.emit("row",b,this._result),this._accumulateRows&&this._result.addRow(b)}}handleCommandComplete(a,b){this._checkForMultirow(),this._result.addCommandComplete(a),this.rows&&b.sync()}handleEmptyQuery(a){this.rows&&a.sync()}handleError(a,b){if(this._canceledDueToError&&(a=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(a);this.emit("error",a)}handleReadyForQuery(a){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,a);if(this.callback)try{this.callback(null,this._results)}catch(a){db.nextTick(()=>{throw a})}this.emit("end",this._results)}submit(a){if("string"!=typeof this.text&&"string"!=typeof this.name)return Error("A query must have either text or a name. Supplying neither is unsupported.");let b=a.parsedStatements[this.name];return this.text&&b&&this.text!==b?Error(`Prepared statements must be \
unique - '${this.name}' was used for a different statement`):this.values&&!Array.isArray(this.values)?Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(a):a.query(this.text),null)}hasBeenParsed(a){return this.name&&a.parsedStatements[this.name]}handlePortalSuspended(a){this._getRows(a,this.rows)}_getRows(a,b){a.execute({portal:this.portal,rows:b}),b?a.flush():a.sync()}prepare(a){this.isPreparedStatement=!0,this.hasBeenParsed(a)||a.parse({text:this.text,name:this.name,types:this.types});try{a.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:e.prepareValue})}catch(b){this.handleError(b,a);return}a.describe({type:"P",name:this.portal||""}),this._getRows(a,this.rows)}handleCopyInResponse(a){a.sendCopyFail("No source stream defined")}handleCopyData(a,b){}};di(f,"Query"),b.exports=f}),em={};function en(a){return 0}dl(em,{Socket:()=>er,isIP:()=>en});var eo,ep,eq,er,es=dj(()=>{du(),eo=dn(dv(),1),di(en,"isIP"),ep=di(a=>a.replace(/^[^.]+\./,"api."),"transformHost"),eq=class a extends eo.EventEmitter{constructor(){super(...arguments),dq(this,"opts",{}),dq(this,"connecting",!1),dq(this,"pending",!0),dq(this,"writable",!0),dq(this,"encrypted",!1),dq(this,"authorized",!1),dq(this,"destroyed",!1),dq(this,"ws",null),dq(this,"writeBuffer"),dq(this,"tlsState",0),dq(this,"tlsRead"),dq(this,"tlsWrite")}static get poolQueryViaFetch(){return a.opts.poolQueryViaFetch??a.defaults.poolQueryViaFetch}static set poolQueryViaFetch(b){a.opts.poolQueryViaFetch=b}static get fetchEndpoint(){return a.opts.fetchEndpoint??a.defaults.fetchEndpoint}static set fetchEndpoint(b){a.opts.fetchEndpoint=b}static get fetchConnectionCache(){return!0}static set fetchConnectionCache(a){console.warn("The `fetchConnectionCache` option is deprecated (now always `true`)")}static get fetchFunction(){return a.opts.fetchFunction??a.defaults.fetchFunction}static set fetchFunction(b){a.opts.fetchFunction=b}static get webSocketConstructor(){return a.opts.webSocketConstructor??a.defaults.webSocketConstructor}static set webSocketConstructor(b){a.opts.webSocketConstructor=b}get webSocketConstructor(){return this.opts.webSocketConstructor??a.webSocketConstructor}set webSocketConstructor(a){this.opts.webSocketConstructor=a}static get wsProxy(){return a.opts.wsProxy??a.defaults.wsProxy}static set wsProxy(b){a.opts.wsProxy=b}get wsProxy(){return this.opts.wsProxy??a.wsProxy}set wsProxy(a){this.opts.wsProxy=a}static get coalesceWrites(){return a.opts.coalesceWrites??a.defaults.coalesceWrites}static set coalesceWrites(b){a.opts.coalesceWrites=b}get coalesceWrites(){return this.opts.coalesceWrites??a.coalesceWrites}set coalesceWrites(a){this.opts.coalesceWrites=a}static get useSecureWebSocket(){return a.opts.useSecureWebSocket??a.defaults.useSecureWebSocket}static set useSecureWebSocket(b){a.opts.useSecureWebSocket=b}get useSecureWebSocket(){return this.opts.useSecureWebSocket??a.useSecureWebSocket}set useSecureWebSocket(a){this.opts.useSecureWebSocket=a}static get forceDisablePgSSL(){return a.opts.forceDisablePgSSL??a.defaults.forceDisablePgSSL}static set forceDisablePgSSL(b){a.opts.forceDisablePgSSL=b}get forceDisablePgSSL(){return this.opts.forceDisablePgSSL??a.forceDisablePgSSL}set forceDisablePgSSL(a){this.opts.forceDisablePgSSL=a}static get disableSNI(){return a.opts.disableSNI??a.defaults.disableSNI}static set disableSNI(b){a.opts.disableSNI=b}get disableSNI(){return this.opts.disableSNI??a.disableSNI}set disableSNI(a){this.opts.disableSNI=a}static get pipelineConnect(){return a.opts.pipelineConnect??a.defaults.pipelineConnect}static set pipelineConnect(b){a.opts.pipelineConnect=b}get pipelineConnect(){return this.opts.pipelineConnect??a.pipelineConnect}set pipelineConnect(a){this.opts.pipelineConnect=a}static get subtls(){return a.opts.subtls??a.defaults.subtls}static set subtls(b){a.opts.subtls=b}get subtls(){return this.opts.subtls??a.subtls}set subtls(a){this.opts.subtls=a}static get pipelineTLS(){return a.opts.pipelineTLS??a.defaults.pipelineTLS}static set pipelineTLS(b){a.opts.pipelineTLS=b}get pipelineTLS(){return this.opts.pipelineTLS??a.pipelineTLS}set pipelineTLS(a){this.opts.pipelineTLS=a}static get rootCerts(){return a.opts.rootCerts??a.defaults.rootCerts}static set rootCerts(b){a.opts.rootCerts=b}get rootCerts(){return this.opts.rootCerts??a.rootCerts}set rootCerts(a){this.opts.rootCerts=a}wsProxyAddrForHost(a,b){let c=this.wsProxy;if(void 0===c)throw Error("No WebSocket proxy is configured. Please see https://github.com/neondatabase/serverless/blob/main/CONFIG.md#wsproxy-string--host-string-port-number--string--string");return"function"==typeof c?c(a,b):`${c}?address=${a}:${b}`}setNoDelay(){return this}setKeepAlive(){return this}ref(){return this}unref(){return this}connect(a,b,c){this.connecting=!0,c&&this.once("connect",c);let d=di(()=>{this.connecting=!1,this.pending=!1,this.emit("connect"),this.emit("ready")},"handleWebSocketOpen"),e=di((a,b=!1)=>{a.binaryType="arraybuffer",a.addEventListener("error",a=>{this.emit("error",a),this.emit("close")}),a.addEventListener("message",a=>{if(0===this.tlsState){let b=da.from(a.data);this.emit("data",b)}}),a.addEventListener("close",()=>{this.emit("close")}),b?d():a.addEventListener("open",d)},"configureWebSocket"),f;try{f=this.wsProxyAddrForHost(b,"string"==typeof a?parseInt(a,10):a)}catch(a){this.emit("error",a),this.emit("close");return}try{let a=(this.useSecureWebSocket?"wss:":"ws:")+"//"+f;if(void 0!==this.webSocketConstructor)this.ws=new this.webSocketConstructor(a),e(this.ws);else try{this.ws=new WebSocket(a),e(this.ws)}catch{this.ws=new __unstable_WebSocket(a),e(this.ws)}}catch(a){fetch((this.useSecureWebSocket?"https:":"http:")+"//"+f,{headers:{Upgrade:"websocket"}}).then(b=>{if(this.ws=b.webSocket,null==this.ws)throw a;this.ws.accept(),e(this.ws,!0)}).catch(a=>{this.emit("error",Error(`All attempts to open a WebSocket to\
 connect to the database failed. Please refer to https://github.com/neondatabase\
/serverless/blob/main/CONFIG.md#websocketconstructor-typeof-websocket--undefined\
. Details: ${a.message}`)),this.emit("close")})}}async startTls(a){if(void 0===this.subtls)throw Error("For Postgres SSL connections, you must set `neonConfig.subtls` to the subtls library. See https://github.com/neondatabase/serverless/blob/main/CONFIG.md for more information.");this.tlsState=1;let b=this.subtls.TrustedCert.fromPEM(this.rootCerts),c=new this.subtls.WebSocketReadQueue(this.ws),d=c.read.bind(c),e=this.rawWrite.bind(this),[f,g]=await this.subtls.startTls(a,b,d,e,{useSNI:!this.disableSNI,expectPreData:this.pipelineTLS?new Uint8Array([83]):void 0});this.tlsRead=f,this.tlsWrite=g,this.tlsState=2,this.encrypted=!0,this.authorized=!0,this.emit("secureConnection",this),this.tlsReadLoop()}async tlsReadLoop(){for(;;){let a=await this.tlsRead();if(void 0===a)break;{let b=da.from(a);this.emit("data",b)}}}rawWrite(a){if(!this.coalesceWrites)return void this.ws.send(a);if(void 0===this.writeBuffer)this.writeBuffer=a,setTimeout(()=>{this.ws.send(this.writeBuffer),this.writeBuffer=void 0},0);else{let b=new Uint8Array(this.writeBuffer.length+a.length);b.set(this.writeBuffer),b.set(a,this.writeBuffer.length),this.writeBuffer=b}}write(a,b="utf8",c=a=>{}){return 0===a.length?c():("string"==typeof a&&(a=da.from(a,b)),0===this.tlsState?(this.rawWrite(a),c()):1===this.tlsState?this.once("secureConnection",()=>{this.write(a,b,c)}):(this.tlsWrite(a),c())),!0}end(a=da.alloc(0),b="utf8",c=()=>{}){return this.write(a,b,()=>{this.ws.close(),c()}),this}destroy(){return this.destroyed=!0,this.end()}},di(eq,"Socket"),dq(eq,"defaults",{poolQueryViaFetch:!1,fetchEndpoint:di(a=>"https://"+ep(a)+"/sql","fetchEndpoint"),fetchConnectionCache:!0,fetchFunction:void 0,webSocketConstructor:void 0,wsProxy:di(a=>a+"/v2","wsProxy"),useSecureWebSocket:!0,forceDisablePgSSL:!0,coalesceWrites:!0,pipelineConnect:"password",subtls:void 0,rootCerts:"",pipelineTLS:!1,disableSNI:!1}),dq(eq,"opts",{}),er=eq}),et=dk(a=>{du(),Object.defineProperty(a,"__esModule",{value:!0}),a.NoticeMessage=a.DataRowMessage=a.CommandCompleteMessage=a.ReadyForQueryMessage=a.NotificationResponseMessage=a.BackendKeyDataMessage=a.AuthenticationMD5Password=a.ParameterStatusMessage=a.ParameterDescriptionMessage=a.RowDescriptionMessage=a.Field=a.CopyResponse=a.CopyDataMessage=a.DatabaseError=a.copyDone=a.emptyQuery=a.replicationStart=a.portalSuspended=a.noData=a.closeComplete=a.bindComplete=a.parseComplete=void 0,a.parseComplete={name:"parseComplete",length:5},a.bindComplete={name:"bindComplete",length:5},a.closeComplete={name:"closeComplete",length:5},a.noData={name:"noData",length:5},a.portalSuspended={name:"portalSuspended",length:5},a.replicationStart={name:"replicationStart",length:4},a.emptyQuery={name:"emptyQuery",length:4},a.copyDone={name:"copyDone",length:4};var b=class extends Error{constructor(a,b,c){super(a),this.length=b,this.name=c}};di(b,"DatabaseError"),a.DatabaseError=b;var c=class{constructor(a,b){this.length=a,this.chunk=b,this.name="copyData"}};di(c,"CopyDataMessage"),a.CopyDataMessage=c;var d=class{constructor(a,b,c,d){this.length=a,this.name=b,this.binary=c,this.columnTypes=Array(d)}};di(d,"CopyResponse"),a.CopyResponse=d;var e=class{constructor(a,b,c,d,e,f,g){this.name=a,this.tableID=b,this.columnID=c,this.dataTypeID=d,this.dataTypeSize=e,this.dataTypeModifier=f,this.format=g}};di(e,"Field"),a.Field=e;var f=class{constructor(a,b){this.length=a,this.fieldCount=b,this.name="rowDescription",this.fields=Array(this.fieldCount)}};di(f,"RowDescriptionMessage"),a.RowDescriptionMessage=f;var g=class{constructor(a,b){this.length=a,this.parameterCount=b,this.name="parameterDescription",this.dataTypeIDs=Array(this.parameterCount)}};di(g,"ParameterDescriptionMessage"),a.ParameterDescriptionMessage=g;var h=class{constructor(a,b,c){this.length=a,this.parameterName=b,this.parameterValue=c,this.name="parameterStatus"}};di(h,"ParameterStatusMessage"),a.ParameterStatusMessage=h;var i=class{constructor(a,b){this.length=a,this.salt=b,this.name="authenticationMD5Password"}};di(i,"AuthenticationMD5Password"),a.AuthenticationMD5Password=i;var j=class{constructor(a,b,c){this.length=a,this.processID=b,this.secretKey=c,this.name="backendKeyData"}};di(j,"BackendKeyDataMessage"),a.BackendKeyDataMessage=j;var k=class{constructor(a,b,c,d){this.length=a,this.processId=b,this.channel=c,this.payload=d,this.name="notification"}};di(k,"NotificationResponseMessage"),a.NotificationResponseMessage=k;var l=class{constructor(a,b){this.length=a,this.status=b,this.name="readyForQuery"}};di(l,"ReadyForQueryMessage"),a.ReadyForQueryMessage=l;var m=class{constructor(a,b){this.length=a,this.text=b,this.name="commandComplete"}};di(m,"CommandCompleteMessage"),a.CommandCompleteMessage=m;var n=class{constructor(a,b){this.length=a,this.fields=b,this.name="dataRow",this.fieldCount=b.length}};di(n,"DataRowMessage"),a.DataRowMessage=n;var o=class{constructor(a,b){this.length=a,this.message=b,this.name="notice"}};di(o,"NoticeMessage"),a.NoticeMessage=o}),eu=dk(a=>{du(),Object.defineProperty(a,"__esModule",{value:!0}),a.Writer=void 0;var b=class{constructor(a=256){this.size=a,this.offset=5,this.headerPosition=0,this.buffer=da.allocUnsafe(a)}ensure(a){if(this.buffer.length-this.offset<a){var b=this.buffer,c=b.length+(b.length>>1)+a;this.buffer=da.allocUnsafe(c),b.copy(this.buffer)}}addInt32(a){return this.ensure(4),this.buffer[this.offset++]=a>>>24&255,this.buffer[this.offset++]=a>>>16&255,this.buffer[this.offset++]=a>>>8&255,this.buffer[this.offset++]=a>>>0&255,this}addInt16(a){return this.ensure(2),this.buffer[this.offset++]=a>>>8&255,this.buffer[this.offset++]=a>>>0&255,this}addCString(a){if(a){var b=da.byteLength(a);this.ensure(b+1),this.buffer.write(a,this.offset,"utf-8"),this.offset+=b}else this.ensure(1);return this.buffer[this.offset++]=0,this}addString(a=""){var b=da.byteLength(a);return this.ensure(b),this.buffer.write(a,this.offset),this.offset+=b,this}add(a){return this.ensure(a.length),a.copy(this.buffer,this.offset),this.offset+=a.length,this}join(a){if(a){this.buffer[this.headerPosition]=a;let b=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(b,this.headerPosition+1)}return this.buffer.slice(5*!a,this.offset)}flush(a){var b=this.join(a);return this.offset=5,this.headerPosition=0,this.buffer=da.allocUnsafe(this.size),b}};di(b,"Writer"),a.Writer=b}),ev=dk(a=>{du(),Object.defineProperty(a,"__esModule",{value:!0}),a.serialize=void 0;var b=eu(),c=new b.Writer,d=di(a=>{for(let b of(c.addInt16(3).addInt16(0),Object.keys(a)))c.addCString(b).addCString(a[b]);c.addCString("client_encoding").addCString("UTF8");var d=c.addCString("").flush(),e=d.length+4;return new b.Writer().addInt32(e).add(d).flush()},"startup"),e=di(()=>{let a=da.allocUnsafe(8);return a.writeInt32BE(8,0),a.writeInt32BE(0x4d2162f,4),a},"requestSsl"),f=di(a=>c.addCString(a).flush(112),"password"),g=di(function(a,b){return c.addCString(a).addInt32(da.byteLength(b)).addString(b),c.flush(112)},"sendSASLInitialResponseMessage"),h=di(function(a){return c.addString(a).flush(112)},"sendSCRAMClientFinalMessage"),i=di(a=>c.addCString(a).flush(81),"query"),j=[],k=di(a=>{let b=a.name||"";b.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",b,b.length),console.error("This can cause conflicts and silent errors executing queries"));let d=a.types||j;for(var e=d.length,f=c.addCString(b).addCString(a.text).addInt16(e),g=0;g<e;g++)f.addInt32(d[g]);return c.flush(80)},"parse"),l=new b.Writer,m=di(function(a,b){for(let d=0;d<a.length;d++){let e=b?b(a[d],d):a[d];null==e?(c.addInt16(0),l.addInt32(-1)):e instanceof da?(c.addInt16(1),l.addInt32(e.length),l.add(e)):(c.addInt16(0),l.addInt32(da.byteLength(e)),l.addString(e))}},"writeValues"),n=di((a={})=>{let b=a.portal||"",d=a.statement||"",e=a.binary||!1,f=a.values||j,g=f.length;return c.addCString(b).addCString(d),c.addInt16(g),m(f,a.valueMapper),c.addInt16(g),c.add(l.flush()),c.addInt16(+!!e),c.flush(66)},"bind"),o=da.from([69,0,0,0,9,0,0,0,0,0]),p=di(a=>{if(!a||!a.portal&&!a.rows)return o;let b=a.portal||"",c=a.rows||0,d=da.byteLength(b),e=4+d+1+4,f=da.allocUnsafe(1+e);return f[0]=69,f.writeInt32BE(e,1),f.write(b,5,"utf-8"),f[d+5]=0,f.writeUInt32BE(c,f.length-4),f},"execute"),q=di((a,b)=>{let c=da.allocUnsafe(16);return c.writeInt32BE(16,0),c.writeInt16BE(1234,4),c.writeInt16BE(5678,6),c.writeInt32BE(a,8),c.writeInt32BE(b,12),c},"cancel"),r=di((a,b)=>{let c=4+da.byteLength(b)+1,d=da.allocUnsafe(1+c);return d[0]=a,d.writeInt32BE(c,1),d.write(b,5,"utf-8"),d[c]=0,d},"cstringMessage"),s=c.addCString("P").flush(68),t=c.addCString("S").flush(68),u=di(a=>a.name?r(68,`${a.type}${a.name||""}`):"P"===a.type?s:t,"describe"),v=di(a=>r(67,`${a.type}${a.name||""}`),"close"),w=di(a=>c.add(a).flush(100),"copyData"),x=di(a=>r(102,a),"copyFail"),y=di(a=>da.from([a,0,0,0,4]),"codeOnlyBuffer"),z=y(72),A=y(83),B=y(88),C=y(99);a.serialize={startup:d,password:f,requestSsl:e,sendSASLInitialResponseMessage:g,sendSCRAMClientFinalMessage:h,query:i,parse:k,bind:n,execute:p,describe:u,close:v,flush:di(()=>z,"flush"),sync:di(()=>A,"sync"),end:di(()=>B,"end"),copyData:w,copyDone:di(()=>C,"copyDone"),copyFail:x,cancel:q}}),ew=dk(a=>{du(),Object.defineProperty(a,"__esModule",{value:!0}),a.BufferReader=void 0;var b=da.allocUnsafe(0),c=class{constructor(a=0){this.offset=a,this.buffer=b,this.encoding="utf-8"}setBuffer(a,b){this.offset=a,this.buffer=b}int16(){let a=this.buffer.readInt16BE(this.offset);return this.offset+=2,a}byte(){let a=this.buffer[this.offset];return this.offset++,a}int32(){let a=this.buffer.readInt32BE(this.offset);return this.offset+=4,a}string(a){let b=this.buffer.toString(this.encoding,this.offset,this.offset+a);return this.offset+=a,b}cstring(){let a=this.offset,b=a;for(;0!==this.buffer[b++];);return this.offset=b,this.buffer.toString(this.encoding,a,b-1)}bytes(a){let b=this.buffer.slice(this.offset,this.offset+a);return this.offset+=a,b}};di(c,"BufferReader"),a.BufferReader=c}),ex=dk(a=>{du(),Object.defineProperty(a,"__esModule",{value:!0}),a.Parser=void 0;var b=et(),c=ew(),d=da.allocUnsafe(0),e=class{constructor(a){if(this.buffer=d,this.bufferLength=0,this.bufferOffset=0,this.reader=new c.BufferReader,a?.mode==="binary")throw Error("Binary mode not supported yet");this.mode=a?.mode||"text"}parse(a,b){this.mergeBuffer(a);let c=this.bufferOffset+this.bufferLength,e=this.bufferOffset;for(;e+5<=c;){let a=this.buffer[e],d=this.buffer.readUInt32BE(e+1),f=1+d;if(f+e<=c)b(this.handlePacket(e+5,a,d,this.buffer)),e+=f;else break}e===c?(this.buffer=d,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=c-e,this.bufferOffset=e)}mergeBuffer(a){if(this.bufferLength>0){let b=this.bufferLength+a.byteLength;if(b+this.bufferOffset>this.buffer.byteLength){let a;if(b<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)a=this.buffer;else{let c=2*this.buffer.byteLength;for(;b>=c;)c*=2;a=da.allocUnsafe(c)}this.buffer.copy(a,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=a,this.bufferOffset=0}a.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=b}else this.buffer=a,this.bufferOffset=0,this.bufferLength=a.byteLength}handlePacket(a,c,d,e){switch(c){case 50:return b.bindComplete;case 49:return b.parseComplete;case 51:return b.closeComplete;case 110:return b.noData;case 115:return b.portalSuspended;case 99:return b.copyDone;case 87:return b.replicationStart;case 73:return b.emptyQuery;case 68:return this.parseDataRowMessage(a,d,e);case 67:return this.parseCommandCompleteMessage(a,d,e);case 90:return this.parseReadyForQueryMessage(a,d,e);case 65:return this.parseNotificationMessage(a,d,e);case 82:return this.parseAuthenticationResponse(a,d,e);case 83:return this.parseParameterStatusMessage(a,d,e);case 75:return this.parseBackendKeyData(a,d,e);case 69:return this.parseErrorMessage(a,d,e,"error");case 78:return this.parseErrorMessage(a,d,e,"notice");case 84:return this.parseRowDescriptionMessage(a,d,e);case 116:return this.parseParameterDescriptionMessage(a,d,e);case 71:return this.parseCopyInMessage(a,d,e);case 72:return this.parseCopyOutMessage(a,d,e);case 100:return this.parseCopyData(a,d,e);default:return new b.DatabaseError("received invalid response: "+c.toString(16),d,"error")}}parseReadyForQueryMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.string(1);return new b.ReadyForQueryMessage(c,e)}parseCommandCompleteMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.cstring();return new b.CommandCompleteMessage(c,e)}parseCopyData(a,c,d){let e=d.slice(a,a+(c-4));return new b.CopyDataMessage(c,e)}parseCopyInMessage(a,b,c){return this.parseCopyMessage(a,b,c,"copyInResponse")}parseCopyOutMessage(a,b,c){return this.parseCopyMessage(a,b,c,"copyOutResponse")}parseCopyMessage(a,c,d,e){this.reader.setBuffer(a,d);let f=0!==this.reader.byte(),g=this.reader.int16(),h=new b.CopyResponse(c,e,f,g);for(let a=0;a<g;a++)h.columnTypes[a]=this.reader.int16();return h}parseNotificationMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int32(),f=this.reader.cstring(),g=this.reader.cstring();return new b.NotificationResponseMessage(c,e,f,g)}parseRowDescriptionMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int16(),f=new b.RowDescriptionMessage(c,e);for(let a=0;a<e;a++)f.fields[a]=this.parseField();return f}parseField(){let a=this.reader.cstring(),c=this.reader.int32(),d=this.reader.int16(),e=this.reader.int32(),f=this.reader.int16(),g=this.reader.int32(),h=0===this.reader.int16()?"text":"binary";return new b.Field(a,c,d,e,f,g,h)}parseParameterDescriptionMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int16(),f=new b.ParameterDescriptionMessage(c,e);for(let a=0;a<e;a++)f.dataTypeIDs[a]=this.reader.int32();return f}parseDataRowMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int16(),f=Array(e);for(let a=0;a<e;a++){let b=this.reader.int32();f[a]=-1===b?null:this.reader.string(b)}return new b.DataRowMessage(c,f)}parseParameterStatusMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.cstring(),f=this.reader.cstring();return new b.ParameterStatusMessage(c,e,f)}parseBackendKeyData(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int32(),f=this.reader.int32();return new b.BackendKeyDataMessage(c,e,f)}parseAuthenticationResponse(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int32(),f={name:"authenticationOk",length:c};switch(e){case 0:break;case 3:8===f.length&&(f.name="authenticationCleartextPassword");break;case 5:if(12===f.length){f.name="authenticationMD5Password";let a=this.reader.bytes(4);return new b.AuthenticationMD5Password(c,a)}break;case 10:let g;f.name="authenticationSASL",f.mechanisms=[];do(g=this.reader.cstring())&&f.mechanisms.push(g);while(g)break;case 11:f.name="authenticationSASLContinue",f.data=this.reader.string(c-8);break;case 12:f.name="authenticationSASLFinal",f.data=this.reader.string(c-8);break;default:throw Error("Unknown authenticationOk message type "+e)}return f}parseErrorMessage(a,c,d,e){this.reader.setBuffer(a,d);let f={},g=this.reader.string(1);for(;"\0"!==g;)f[g]=this.reader.cstring(),g=this.reader.string(1);let h=f.M,i="notice"===e?new b.NoticeMessage(c,h):new b.DatabaseError(h,c,e);return i.severity=f.S,i.code=f.C,i.detail=f.D,i.hint=f.H,i.position=f.P,i.internalPosition=f.p,i.internalQuery=f.q,i.where=f.W,i.schema=f.s,i.table=f.t,i.column=f.c,i.dataType=f.d,i.constraint=f.n,i.file=f.F,i.line=f.L,i.routine=f.R,i}};di(e,"Parser"),a.Parser=e}),ey=dk(a=>{du(),Object.defineProperty(a,"__esModule",{value:!0}),a.DatabaseError=a.serialize=a.parse=void 0;var b=et();Object.defineProperty(a,"DatabaseError",{enumerable:!0,get:di(function(){return b.DatabaseError},"get")});var c=ev();Object.defineProperty(a,"serialize",{enumerable:!0,get:di(function(){return c.serialize},"get")});var d=ex();function e(a,b){let c=new d.Parser;return a.on("data",a=>c.parse(a,b)),new Promise(b=>a.on("end",()=>b()))}di(e,"parse"),a.parse=e}),ez={};function eA({socket:a,servername:b}){return a.startTls(b),a}dl(ez,{connect:()=>eA});var eB=dj(()=>{du(),di(eA,"connect")}),eC=dk((a,b)=>{du();var c=(es(),dp(em)),d=dv().EventEmitter,{parse:e,serialize:f}=ey(),g=f.flush(),h=f.sync(),i=f.end(),j=class extends d{constructor(a){super(),a=a||{},this.stream=a.stream||new c.Socket,this._keepAlive=a.keepAlive,this._keepAliveInitialDelayMillis=a.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=a.ssl||!1,this._ending=!1,this._emitMessage=!1;var b=this;this.on("newListener",function(a){"message"===a&&(b._emitMessage=!0)})}connect(a,b){var d=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(a,b),this.stream.once("connect",function(){d._keepAlive&&d.stream.setKeepAlive(!0,d._keepAliveInitialDelayMillis),d.emit("connect")});let e=di(function(a){d._ending&&("ECONNRESET"===a.code||"EPIPE"===a.code)||d.emit("error",a)},"reportStreamError");if(this.stream.on("error",e),this.stream.on("close",function(){d.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(a){switch(a.toString("utf8")){case"S":break;case"N":return d.stream.end(),d.emit("error",Error("The server does not support SSL connections"));default:return d.stream.end(),d.emit("error",Error("There was an error establishing an SSL connection"))}var f=(eB(),dp(ez));let g={socket:d.stream};!0!==d.ssl&&(Object.assign(g,d.ssl),"key"in d.ssl&&(g.key=d.ssl.key)),0===c.isIP(b)&&(g.servername=b);try{d.stream=f.connect(g)}catch(a){return d.emit("error",a)}d.attachListeners(d.stream),d.stream.on("error",e),d.emit("sslconnect")})}attachListeners(a){a.on("end",()=>{this.emit("end")}),e(a,a=>{var b="error"===a.name?"errorMessage":a.name;this._emitMessage&&this.emit("message",a),this.emit(b,a)})}requestSsl(){this.stream.write(f.requestSsl())}startup(a){this.stream.write(f.startup(a))}cancel(a,b){this._send(f.cancel(a,b))}password(a){this._send(f.password(a))}sendSASLInitialResponseMessage(a,b){this._send(f.sendSASLInitialResponseMessage(a,b))}sendSCRAMClientFinalMessage(a){this._send(f.sendSCRAMClientFinalMessage(a))}_send(a){return!!this.stream.writable&&this.stream.write(a)}query(a){this._send(f.query(a))}parse(a){this._send(f.parse(a))}bind(a){this._send(f.bind(a))}execute(a){this._send(f.execute(a))}flush(){this.stream.writable&&this.stream.write(g)}sync(){this._ending=!0,this._send(g),this._send(h)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){return(this._ending=!0,this._connecting&&this.stream.writable)?this.stream.write(i,()=>{this.stream.end()}):void this.stream.end()}close(a){this._send(f.close(a))}describe(a){this._send(f.describe(a))}sendCopyFromChunk(a){this._send(f.copyData(a))}endCopyFrom(){this._send(f.copyDone())}sendCopyFail(a){this._send(f.copyFail(a))}};di(j,"Connection"),b.exports=j}),eD=dk((a,b)=>{du();var c=dv().EventEmitter,d=(dy(),dp(dw),dV()),e=dW(),f=ea(),g=eb(),h=ej(),i=el(),j=dU(),k=eC(),l=class extends c{constructor(a){super(),this.connectionParameters=new h(a),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var b=a||{};this._Promise=b.Promise||c7.Promise,this._types=new g(b.types),this._ending=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=b.connection||new k({stream:b.stream,ssl:this.connectionParameters.ssl,keepAlive:b.keepAlive||!1,keepAliveInitialDelayMillis:b.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=b.binary||j.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=b.connectionTimeoutMillis||0}_errorAllQueries(a){let b=di(b=>{db.nextTick(()=>{b.handleError(a,this.connection)})},"enqueueError");this.activeQuery&&(b(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(b),this.queryQueue.length=0}_connect(a){var b=this,c=this.connection;if(this._connectionCallback=a,this._connecting||this._connected){let b=Error("Client has already been connected. You cannot reuse a client.");db.nextTick(()=>{a(b)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{c._ending=!0,c.stream.destroy(Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&0===this.host.indexOf("/")?c.connect(this.host+"/.s.PGSQL."+this.port):c.connect(this.port,this.host),c.on("connect",function(){b.ssl?c.requestSsl():c.startup(b.getStartupConf())}),c.on("sslconnect",function(){c.startup(b.getStartupConf())}),this._attachListeners(c),c.once("end",()=>{let a=this._ending?Error("Connection terminated"):Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(a),this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(a):this._handleErrorEvent(a):this._connectionError||this._handleErrorEvent(a)),db.nextTick(()=>{this.emit("end")})})}connect(a){return a?void this._connect(a):new this._Promise((a,b)=>{this._connect(c=>{c?b(c):a()})})}_attachListeners(a){a.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),a.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),a.on("authenticationSASL",this._handleAuthSASL.bind(this)),a.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),a.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),a.on("backendKeyData",this._handleBackendKeyData.bind(this)),a.on("error",this._handleErrorEvent.bind(this)),a.on("errorMessage",this._handleErrorMessage.bind(this)),a.on("readyForQuery",this._handleReadyForQuery.bind(this)),a.on("notice",this._handleNotice.bind(this)),a.on("rowDescription",this._handleRowDescription.bind(this)),a.on("dataRow",this._handleDataRow.bind(this)),a.on("portalSuspended",this._handlePortalSuspended.bind(this)),a.on("emptyQuery",this._handleEmptyQuery.bind(this)),a.on("commandComplete",this._handleCommandComplete.bind(this)),a.on("parseComplete",this._handleParseComplete.bind(this)),a.on("copyInResponse",this._handleCopyInResponse.bind(this)),a.on("copyData",this._handleCopyData.bind(this)),a.on("notification",this._handleNotification.bind(this))}_checkPgPass(a){let b=this.connection;"function"==typeof this.password?this._Promise.resolve().then(()=>this.password()).then(c=>{if(void 0!==c){if("string"!=typeof c)return void b.emit("error",TypeError("Password must be a string"));this.connectionParameters.password=this.password=c}else this.connectionParameters.password=this.password=null;a()}).catch(a=>{b.emit("error",a)}):null!==this.password?a():f(this.connectionParameters,b=>{void 0!==b&&(this.connectionParameters.password=this.password=b),a()})}_handleAuthCleartextPassword(a){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(a){this._checkPgPass(()=>{let b=d.postgresMd5PasswordHash(this.user,this.password,a.salt);this.connection.password(b)})}_handleAuthSASL(a){this._checkPgPass(()=>{this.saslSession=e.startSession(a.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)})}_handleAuthSASLContinue(a){e.continueSession(this.saslSession,this.password,a.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}_handleAuthSASLFinal(a){e.finalizeSession(this.saslSession,a.data),this.saslSession=null}_handleBackendKeyData(a){this.processID=a.processID,this.secretKey=a.secretKey}_handleReadyForQuery(a){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:b}=this;this.activeQuery=null,this.readyForQuery=!0,b&&b.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(a){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(a);this.emit("error",a)}}_handleErrorEvent(a){if(this._connecting)return this._handleErrorWhileConnecting(a);this._queryable=!1,this._errorAllQueries(a),this.emit("error",a)}_handleErrorMessage(a){if(this._connecting)return this._handleErrorWhileConnecting(a);let b=this.activeQuery;b?(this.activeQuery=null,b.handleError(a,this.connection)):this._handleErrorEvent(a)}_handleRowDescription(a){this.activeQuery.handleRowDescription(a)}_handleDataRow(a){this.activeQuery.handleDataRow(a)}_handlePortalSuspended(a){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(a){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(a){this.activeQuery.handleCommandComplete(a,this.connection)}_handleParseComplete(a){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(a){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(a){this.activeQuery.handleCopyData(a,this.connection)}_handleNotification(a){this.emit("notification",a)}_handleNotice(a){this.emit("notice",a)}getStartupConf(){var a=this.connectionParameters,b={user:a.user,database:a.database},c=a.application_name||a.fallback_application_name;return c&&(b.application_name=c),a.replication&&(b.replication=""+a.replication),a.statement_timeout&&(b.statement_timeout=String(parseInt(a.statement_timeout,10))),a.lock_timeout&&(b.lock_timeout=String(parseInt(a.lock_timeout,10))),a.idle_in_transaction_session_timeout&&(b.idle_in_transaction_session_timeout=String(parseInt(a.idle_in_transaction_session_timeout,10))),a.options&&(b.options=a.options),b}cancel(a,b){if(a.activeQuery===b){var c=this.connection;this.host&&0===this.host.indexOf("/")?c.connect(this.host+"/.s.PGSQL."+this.port):c.connect(this.port,this.host),c.on("connect",function(){c.cancel(a.processID,a.secretKey)})}else -1!==a.queryQueue.indexOf(b)&&a.queryQueue.splice(a.queryQueue.indexOf(b),1)}setTypeParser(a,b,c){return this._types.setTypeParser(a,b,c)}getTypeParser(a,b){return this._types.getTypeParser(a,b)}escapeIdentifier(a){return'"'+a.replace(/"/g,'""')+'"'}escapeLiteral(a){for(var b=!1,c="'",d=0;d<a.length;d++){var e=a[d];"'"===e?c+=e+e:"\\"===e?(c+=e+e,b=!0):c+=e}return c+="'",!0===b&&(c=" E"+c),c}_pulseQueryQueue(){if(!0===this.readyForQuery)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let a=this.activeQuery.submit(this.connection);a&&db.nextTick(()=>{this.activeQuery.handleError(a,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(a,b,c){var d,e,f,g,h;if(null==a)throw TypeError("Client was passed a null or undefined query");return"function"==typeof a.submit?(f=a.query_timeout||this.connectionParameters.query_timeout,e=d=a,"function"==typeof b&&(d.callback=d.callback||b)):(f=this.connectionParameters.query_timeout,(d=new i(a,b,c)).callback||(e=new this._Promise((a,b)=>{d.callback=(c,d)=>c?b(c):a(d)}))),f&&(h=d.callback,g=setTimeout(()=>{var a=Error("Query read timeout");db.nextTick(()=>{d.handleError(a,this.connection)}),h(a),d.callback=()=>{};var b=this.queryQueue.indexOf(d);b>-1&&this.queryQueue.splice(b,1),this._pulseQueryQueue()},f),d.callback=(a,b)=>{clearTimeout(g),h(a,b)}),this.binary&&!d.binary&&(d.binary=!0),d._result&&!d._result._types&&(d._result._types=this._types),this._queryable?this._ending?db.nextTick(()=>{d.handleError(Error("Client was closed and is not queryable"),this.connection)}):(this.queryQueue.push(d),this._pulseQueryQueue()):db.nextTick(()=>{d.handleError(Error("Client has encountered a connection error and is not queryable"),this.connection)}),e}ref(){this.connection.ref()}unref(){this.connection.unref()}end(a){if(this._ending=!0,!this.connection._connecting)if(!a)return this._Promise.resolve();else a();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),!a)return new this._Promise(a=>{this.connection.once("end",a)});this.connection.once("end",a)}};di(l,"Client"),l.Query=i,b.exports=l}),eE=dk((a,b)=>{du();var c=dv().EventEmitter,d=di(function(){},"NOOP"),e=di((a,b)=>{let c=a.findIndex(b);return -1===c?void 0:a.splice(c,1)[0]},"removeWhere"),f=class{constructor(a,b,c){this.client=a,this.idleListener=b,this.timeoutId=c}};di(f,"IdleItem");var g=class{constructor(a){this.callback=a}};function h(){throw Error("Release called on client which has already been released to the pool.")}function i(a,b){let c,d;return b?{callback:b,result:void 0}:{callback:di(function(a,b){a?c(a):d(b)},"cb"),result:new a(function(a,b){d=a,c=b}).catch(a=>{throw Error.captureStackTrace(a),a})}}function j(a,b){return di(function c(d){d.client=b,b.removeListener("error",c),b.on("error",()=>{a.log("additional client error after disconnection due to error",d)}),a._remove(b),a.emit("error",d,b)},"idleListener")}di(g,"PendingItem"),di(h,"throwOnDoubleRelease"),di(i,"promisify"),di(j,"makeIdleListener");var k=class extends c{constructor(a,b){super(),this.options=Object.assign({},a),null!=a&&"password"in a&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:a.password}),null!=a&&a.ssl&&a.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||b||eM().Client,this.Promise=this.options.Promise||c7.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_pulseQueue(){if(this.log("pulse queue"),this.ended)return void this.log("pulse queue ended");if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(a=>{this._remove(a.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length)return void this.log("no queued requests");if(!this._idle.length&&this._isFull())return;let a=this._pendingQueue.shift();if(this._idle.length){let b=this._idle.pop();clearTimeout(b.timeoutId);let c=b.client;c.ref&&c.ref();let d=b.idleListener;return this._acquireClient(c,a,d,!1)}if(!this._isFull())return this.newClient(a);throw Error("unexpected condition")}_remove(a){let b=e(this._idle,b=>b.client===a);void 0!==b&&clearTimeout(b.timeoutId),this._clients=this._clients.filter(b=>b!==a),a.end(),this.emit("remove",a)}connect(a){if(this.ending){let b=Error("Cannot use a pool after calling end on the pool");return a?a(b):this.Promise.reject(b)}let b=i(this.Promise,a),c=b.result;if(this._isFull()||this._idle.length){if(this._idle.length&&db.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new g(b.callback)),c;let a=di((a,c,d)=>{clearTimeout(f),b.callback(a,c,d)},"queueCallback"),d=new g(a),f=setTimeout(()=>{e(this._pendingQueue,b=>b.callback===a),d.timedOut=!0,b.callback(Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return this._pendingQueue.push(d),c}return this.newClient(new g(b.callback)),c}newClient(a){let b=new this.Client(this.options);this._clients.push(b);let c=j(this,b);this.log("checking client timeout");let e,f=!1;this.options.connectionTimeoutMillis&&(e=setTimeout(()=>{this.log("ending client due to timeout"),f=!0,b.connection?b.connection.stream.destroy():b.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),b.connect(h=>{if(e&&clearTimeout(e),b.on("error",c),h)this.log("client failed to connect",h),this._clients=this._clients.filter(a=>a!==b),f&&(h.message="Connection terminated due to connection timeout"),this._pulseQueue(),a.timedOut||a.callback(h,void 0,d);else{if(this.log("new client connected"),0!==this.options.maxLifetimeSeconds){let a=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(b),-1!==this._idle.findIndex(a=>a.client===b)&&this._acquireClient(b,new g((a,b,c)=>c()),c,!1)},1e3*this.options.maxLifetimeSeconds);a.unref(),b.once("end",()=>clearTimeout(a))}return this._acquireClient(b,a,c,!0)}})}_acquireClient(a,b,c,e){e&&this.emit("connect",a),this.emit("acquire",a),a.release=this._releaseOnce(a,c),a.removeListener("error",c),b.timedOut?e&&this.options.verify?this.options.verify(a,a.release):a.release():e&&this.options.verify?this.options.verify(a,c=>{if(c)return a.release(c),b.callback(c,void 0,d);b.callback(void 0,a,a.release)}):b.callback(void 0,a,a.release)}_releaseOnce(a,b){let c=!1;return d=>{c&&h(),c=!0,this._release(a,b,d)}}_release(a,b,c){let d;if(a.on("error",b),a._poolUseCount=(a._poolUseCount||0)+1,this.emit("release",c,a),c||this.ending||!a._queryable||a._ending||a._poolUseCount>=this.options.maxUses){a._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(a),this._pulseQueue();return}if(this._expired.has(a)){this.log("remove expired client"),this._expired.delete(a),this._remove(a),this._pulseQueue();return}this.options.idleTimeoutMillis&&(d=setTimeout(()=>{this.log("remove idle client"),this._remove(a)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&d.unref()),this.options.allowExitOnIdle&&a.unref(),this._idle.push(new f(a,b,d)),this._pulseQueue()}query(a,b,c){if("function"==typeof a){let b=i(this.Promise,a);return c8(function(){return b.callback(Error("Passing a function as the first parameter to pool.query is not supported"))}),b.result}"function"==typeof b&&(c=b,b=void 0);let d=i(this.Promise,c);return c=d.callback,this.connect((d,e)=>{if(d)return c(d);let f=!1,g=di(a=>{f||(f=!0,e.release(a),c(a))},"onError");e.once("error",g),this.log("dispatching query");try{e.query(a,b,(a,b)=>{if(this.log("query dispatched"),e.removeListener("error",g),!f)return f=!0,e.release(a),a?c(a):c(void 0,b)})}catch(a){return e.release(a),c(a)}}),d.result}end(a){if(this.log("ending"),this.ending){let b=Error("Called end on pool more than once");return a?a(b):this.Promise.reject(b)}this.ending=!0;let b=i(this.Promise,a);return this._endCallback=b.callback,this._pulseQueue(),b.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((a,b)=>a+ +!!this._expired.has(b),0)}get totalCount(){return this._clients.length}};di(k,"Pool"),b.exports=k}),eF={};dl(eF,{default:()=>eG});var eG,eH=dj(()=>{du(),eG={}}),eI=dk((a,b)=>{b.exports={name:"pg",version:"8.8.0",description:"PostgreSQL client - pure javascript & libpq with the same API",keywords:["database","libpq","pg","postgre","postgres","postgresql","rdbms"],homepage:"https://github.com/brianc/node-postgres",repository:{type:"git",url:"git://github.com/brianc/node-postgres.git",directory:"packages/pg"},author:"Brian Carlson <brian.m.carlson@gmail.com>",main:"./lib",dependencies:{"buffer-writer":"2.0.0","packet-reader":"1.0.0","pg-connection-string":"^2.5.0","pg-pool":"^3.5.2","pg-protocol":"^1.5.0","pg-types":"^2.1.0",pgpass:"1.x"},devDependencies:{async:"2.6.4",bluebird:"3.5.2",co:"4.6.0","pg-copy-streams":"0.3.0"},peerDependencies:{"pg-native":">=3.0.1"},peerDependenciesMeta:{"pg-native":{optional:!0}},scripts:{test:"make test-all"},files:["lib","SPONSORS.md"],license:"MIT",engines:{node:">= 8.0.0"},gitHead:"c99fb2c127ddf8d712500db2c7b9a5491a178655"}}),eJ=dk((a,b)=>{du();var c=dv().EventEmitter,d=(dy(),dp(dw)),e=dV(),f=b.exports=function(a,b,d){c.call(this),a=e.normalizeQueryConfig(a,b,d),this.text=a.text,this.values=a.values,this.name=a.name,this.callback=a.callback,this.state="new",this._arrayMode="array"===a.rowMode,this._emitRowEvents=!1,this.on("newListener",(function(a){"row"===a&&(this._emitRowEvents=!0)}).bind(this))};d.inherits(f,c);var g={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};f.prototype.handleError=function(a){var b=this.native.pq.resultErrorFields();if(b)for(var c in b)a[g[c]||c]=b[c];this.callback?this.callback(a):this.emit("error",a),this.state="error"},f.prototype.then=function(a,b){return this._getPromise().then(a,b)},f.prototype.catch=function(a){return this._getPromise().catch(a)},f.prototype._getPromise=function(){return this._promise||(this._promise=new Promise((function(a,b){this._once("end",a),this._once("error",b)}).bind(this))),this._promise},f.prototype.submit=function(a){this.state="running";var b=this;this.native=a.native,a.native.arrayMode=this._arrayMode;var c=di(function(c,d,e){if(a.native.arrayMode=!1,c8(function(){b.emit("_done")}),c)return b.handleError(c);b._emitRowEvents&&(e.length>1?d.forEach((a,c)=>{a.forEach(a=>{b.emit("row",a,e[c])})}):d.forEach(function(a){b.emit("row",a,e)})),b.state="end",b.emit("end",e),b.callback&&b.callback(null,e)},"after");if(db.domain&&(c=db.domain.bind(c)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var d=(this.values||[]).map(e.prepareValue);if(a.namedQueries[this.name]){if(this.text&&a.namedQueries[this.name]!==this.text){let a=Error(`Pre\
pared statements must be unique - '${this.name}' was used for a different statem\
ent`);return c(a)}return a.native.execute(this.name,d,c)}return a.native.prepare(this.name,this.text,d.length,function(e){return e?c(e):(a.namedQueries[b.name]=b.text,b.native.execute(b.name,d,c))})}if(this.values){if(!Array.isArray(this.values)){let a=Error("Query values must be an array");return c(a)}var f=this.values.map(e.prepareValue);a.native.query(this.text,f,c)}else a.native.query(this.text,c)}}),eK=dk((a,b)=>{du();var c=(eH(),dp(eF)),d=eb(),e=(eI(),dv().EventEmitter),f=(dy(),dp(dw)),g=ej(),h=eJ(),i=b.exports=function(a){e.call(this),a=a||{},this._Promise=a.Promise||c7.Promise,this._types=new d(a.types),this.native=new c({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var b=this.connectionParameters=new g(a);this.user=b.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:b.password}),this.database=b.database,this.host=b.host,this.port=b.port,this.namedQueries={}};i.Query=h,f.inherits(i,e),i.prototype._errorAllQueries=function(a){let b=di(b=>{db.nextTick(()=>{b.native=this.native,b.handleError(a)})},"enqueueError");this._hasActiveQuery()&&(b(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(b),this._queryQueue.length=0},i.prototype._connect=function(a){var b=this;this._connecting?db.nextTick(()=>a(Error("Client has already been connected. You cannot reuse a client."))):(this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(c,d){if(c)return a(c);b.native.connect(d,function(c){if(c)return b.native.end(),a(c);b._connected=!0,b.native.on("error",function(a){b._queryable=!1,b._errorAllQueries(a),b.emit("error",a)}),b.native.on("notification",function(a){b.emit("notification",{channel:a.relname,payload:a.extra})}),b.emit("connect"),b._pulseQueryQueue(!0),a()})}))},i.prototype.connect=function(a){return a?void this._connect(a):new this._Promise((a,b)=>{this._connect(c=>{c?b(c):a()})})},i.prototype.query=function(a,b,c){var d,e,f,g,i;if(null==a)throw TypeError("Client was passed a null or undefined query");if("function"==typeof a.submit)f=a.query_timeout||this.connectionParameters.query_timeout,e=d=a,"function"==typeof b&&(a.callback=b);else if(f=this.connectionParameters.query_timeout,!(d=new h(a,b,c)).callback){let a,b;e=new this._Promise((c,d)=>{a=c,b=d}),d.callback=(c,d)=>c?b(c):a(d)}return f&&(i=d.callback,g=setTimeout(()=>{var a=Error("Query read timeout");db.nextTick(()=>{d.handleError(a,this.connection)}),i(a),d.callback=()=>{};var b=this._queryQueue.indexOf(d);b>-1&&this._queryQueue.splice(b,1),this._pulseQueryQueue()},f),d.callback=(a,b)=>{clearTimeout(g),i(a,b)}),this._queryable?this._ending?(d.native=this.native,db.nextTick(()=>{d.handleError(Error("Client was closed and is not queryable"))})):(this._queryQueue.push(d),this._pulseQueryQueue()):(d.native=this.native,db.nextTick(()=>{d.handleError(Error("Client has encountered a connection error and is not queryable"))})),e},i.prototype.end=function(a){var b,c=this;return this._ending=!0,this._connected||this.once("connect",this.end.bind(this,a)),a||(b=new this._Promise(function(b,c){a=di(a=>a?c(a):b(),"cb")})),this.native.end(function(){c._errorAllQueries(Error("Connection terminated")),db.nextTick(()=>{c.emit("end"),a&&a()})}),b},i.prototype._hasActiveQuery=function(){return this._activeQuery&&"error"!==this._activeQuery.state&&"end"!==this._activeQuery.state},i.prototype._pulseQueryQueue=function(a){if(this._connected&&!this._hasActiveQuery()){var b=this._queryQueue.shift();if(!b){a||this.emit("drain");return}this._activeQuery=b,b.submit(this);var c=this;b.once("_done",function(){c._pulseQueryQueue()})}},i.prototype.cancel=function(a){this._activeQuery===a?this.native.cancel(function(){}):-1!==this._queryQueue.indexOf(a)&&this._queryQueue.splice(this._queryQueue.indexOf(a),1)},i.prototype.ref=function(){},i.prototype.unref=function(){},i.prototype.setTypeParser=function(a,b,c){return this._types.setTypeParser(a,b,c)},i.prototype.getTypeParser=function(a,b){return this._types.getTypeParser(a,b)}}),eL=dk((a,b)=>{du(),b.exports=eK()}),eM=dk((a,b)=>{du();var c=eD(),d=dU(),e=eC(),f=eE(),{DatabaseError:g}=ey(),h=di(a=>{var b;return di(b=class extends f{constructor(b){super(b,a)}},"BoundPool"),b},"poolFactory"),i=di(function(a){this.defaults=d,this.Client=a,this.Query=this.Client.Query,this.Pool=h(this.Client),this._pools=[],this.Connection=e,this.types=dT(),this.DatabaseError=g},"PG");"u">typeof db.env.NODE_PG_FORCE_NATIVE?b.exports=new i(eL()):(b.exports=new i(c),Object.defineProperty(b.exports,"native",{configurable:!0,enumerable:!1,get(){var a=null;try{a=new i(eL())}catch(a){if("MODULE_NOT_FOUND"!==a.code)throw a}return Object.defineProperty(b.exports,"native",{value:a}),a}}))});du();var eN=dn(eM());es(),du(),eh(),es();var eO=dn(dV()),eP=class extends Error{constructor(){super(...arguments),dq(this,"name","NeonDbError"),dq(this,"severity"),dq(this,"code"),dq(this,"detail"),dq(this,"hint"),dq(this,"position"),dq(this,"internalPosition"),dq(this,"internalQuery"),dq(this,"where"),dq(this,"schema"),dq(this,"table"),dq(this,"column"),dq(this,"dataType"),dq(this,"constraint"),dq(this,"file"),dq(this,"line"),dq(this,"routine"),dq(this,"sourceError")}};di(eP,"NeonDbError");var eQ="transaction() expects an array of queries, or a function returning an array of queries",eR=["severity","code","detail","hint","position","internalPosition","internalQuery","where","schema","table","column","dataType","constraint","file","line","routine"];function eS(a,{arrayMode:b,fullResults:c,fetchOptions:d,isolationLevel:e,readOnly:f,deferrable:g,queryCallback:h,resultCallback:i}={}){let j;if(!a)throw Error("No database connection string was provided to `neon()`. Perhaps an environment variable has not been set?");try{j=eg(a)}catch{throw Error("Database connection string provided to `neon()` is not a valid URL. Connection string: "+String(a))}let{protocol:k,username:l,password:m,hostname:n,port:o,pathname:p}=j;if("postgres:"!==k&&"postgresql:"!==k||!l||!m||!n||!p)throw Error("Database connection string format for `neon()` should be: postgresql://user:password@host.tld/dbname?option=value");function q(a,...b){let c,d;if("string"==typeof a)c=a,d=b[1],b=b[0]??[];else{c="";for(let d=0;d<a.length;d++)c+=a[d],d<b.length&&(c+="$"+(d+1))}let e={query:c,params:b=b.map(a=>(0,eO.prepareValue)(a))};return h&&h(e),eT(r,e,d)}async function r(h,j,k){let l,{fetchEndpoint:m,fetchFunction:p}=er,q="function"==typeof m?m(n,o):m,r=Array.isArray(h)?{queries:h}:h,s=d??{},t=b??!1,u=c??!1,v=e,w=f,x=g;void 0!==k&&(void 0!==k.fetchOptions&&(s={...s,...k.fetchOptions}),void 0!==k.arrayMode&&(t=k.arrayMode),void 0!==k.fullResults&&(u=k.fullResults),void 0!==k.isolationLevel&&(v=k.isolationLevel),void 0!==k.readOnly&&(w=k.readOnly),void 0!==k.deferrable&&(x=k.deferrable)),void 0===j||Array.isArray(j)||void 0===j.fetchOptions||(s={...s,...j.fetchOptions});let y={"Neon-Connection-String":a,"Neon-Raw-Text-Output":"true","Neon-Array-Mode":"true"};Array.isArray(h)&&(void 0!==v&&(y["Neon-Batch-Isolation-Level"]=v),void 0!==w&&(y["Neon-Batch-Read-Only"]=String(w)),void 0!==x&&(y["Neon-Batch-Deferrable"]=String(x)));try{l=await (p??fetch)(q,{method:"POST",body:JSON.stringify(r),headers:y,...s})}catch(b){let a=new eP(`Error connecting to database: ${b.message}`);throw a.sourceError=b,a}if(l.ok){let a=await l.json();if(Array.isArray(h)){let b=a.results;if(!Array.isArray(b))throw new eP("Neon internal error: unexpected result format");return b.map((a,b)=>{let c=j[b]??{};return eU(a,{arrayMode:c.arrayMode??t,fullResults:c.fullResults??u,parameterizedQuery:h[b],resultCallback:i})})}{let b=j??{};return eU(a,{arrayMode:b.arrayMode??t,fullResults:b.fullResults??u,parameterizedQuery:h,resultCallback:i})}}{let{status:a}=l;if(400===a){let a=await l.json(),b=new eP(a.message);for(let c of eR)b[c]=a[c]??void 0;throw b}{let b=await l.text();throw new eP(`Server error (HTTP status ${a}): ${b}`)}}}return di(q,"resolve"),q.transaction=async(a,b)=>{if("function"==typeof a&&(a=a(q)),!Array.isArray(a))throw Error(eQ);return a.forEach(a=>{if("NeonQueryPromise"!==a[Symbol.toStringTag])throw Error(eQ)}),r(a.map(a=>a.parameterizedQuery),a.map(a=>a.opts??{}),b)},di(r,"execute"),q}function eT(a,b,c){return{[Symbol.toStringTag]:"NeonQueryPromise",parameterizedQuery:b,opts:c,then:di((d,e)=>a(b,c).then(d,e),"then"),catch:di(d=>a(b,c).catch(d),"catch"),finally:di(d=>a(b,c).finally(d),"finally")}}function eU(a,{arrayMode:b,fullResults:c,parameterizedQuery:d,resultCallback:e}){let f=a.fields.map(a=>a.name),g=a.fields.map(a=>eW.types.getTypeParser(a.dataTypeID)),h=!0===b?a.rows.map(a=>a.map((a,b)=>null===a?null:g[b](a))):a.rows.map(a=>Object.fromEntries(a.map((a,b)=>[f[b],null===a?null:g[b](a)])));return e&&e(d,a,h,{arrayMode:b,fullResults:c}),c?(a.viaNeonFetch=!0,a.rowAsArray=b,a.rows=h,a):h}di(eS,"neon"),di(eT,"createNeonQueryPromise"),di(eU,"processQueryResult");var eV=dn(ej()),eW=dn(eM()),eX=class extends eN.Client{constructor(a){super(a),this.config=a}get neonConfig(){return this.connection.stream}connect(a){let{neonConfig:b}=this;b.forceDisablePgSSL&&(this.ssl=this.connection.ssl=!1),this.ssl&&b.useSecureWebSocket&&console.warn("SSL is enabled for both Postgres (e.g. ?sslmode=require in the connection string + forceDisablePgSSL = false) and the WebSocket tunnel (useSecureWebSocket = true). Double encryption will increase latency and CPU usage. It may be appropriate to disable SSL in the Postgres connection parameters or set forceDisablePgSSL = true.");let c=this.config?.host!==void 0||this.config?.connectionString!==void 0||void 0!==db.env.PGHOST,d=db.env.USER??db.env.USERNAME;if(!c&&"localhost"===this.host&&this.user===d&&this.database===d&&null===this.password)throw Error(`No datab\
ase host or connection string was set, and key parameters have default values (h\
ost: localhost, user: ${d}, db: ${d}, password: null). Is an environment variabl\
e missing? Alternatively, if you intended to connect with these parameters, plea\
se set the host to 'localhost' explicitly.`);let e=super.connect(a),f=b.pipelineTLS&&this.ssl,g="password"===b.pipelineConnect;if(!f&&!b.pipelineConnect)return e;let h=this.connection;if(f&&h.on("connect",()=>h.stream.emit("data","S")),g){h.removeAllListeners("authenticationCleartextPassword"),h.removeAllListeners("readyForQuery"),h.once("readyForQuery",()=>h.on("readyForQuery",this._handleReadyForQuery.bind(this)));let a=this.ssl?"sslconnect":"connect";h.on(a,()=>{this._handleAuthCleartextPassword(),this._handleReadyForQuery()})}return e}async _handleAuthSASLContinue(a){let b=this.saslSession,c=this.password,d=a.data;if("SASLInitialResponse"!==b.message||"string"!=typeof c||"string"!=typeof d)throw Error("SASL: protocol error");let e=Object.fromEntries(d.split(",").map(a=>{if(!/^.=/.test(a))throw Error("SASL: Invalid attribute pair entry");return[a[0],a.substring(2)]})),f=e.r,g=e.s,h=e.i;if(!f||!/^[!-+--~]+$/.test(f))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing/unprintable");if(!g||!/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(g))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing/not base64");if(!h||!/^[1-9][0-9]*$/.test(h))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: missing/invalid iteration count");if(!f.startsWith(b.clientNonce))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");if(f.length===b.clientNonce.length)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short");let i=parseInt(h,10),j=da.from(g,"base64"),k=new TextEncoder,l=k.encode(c),m=await c9.subtle.importKey("raw",l,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=new Uint8Array(await c9.subtle.sign("HMAC",m,da.concat([j,da.from([0,0,0,1])]))),o=n;for(var p=0;p<i-1;p++)n=new Uint8Array(await c9.subtle.sign("HMAC",m,n)),o=da.from(o.map((a,b)=>o[b]^n[b]));let q=o,r=await c9.subtle.importKey("raw",q,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),s=new Uint8Array(await c9.subtle.sign("HMAC",r,k.encode("Client Key"))),t=await c9.subtle.digest("SHA-256",s),u="n=*,r="+b.clientNonce,v="r="+f+",s="+g+",i="+i,w="c=biws,r="+f,x=u+","+v+","+w,y=await c9.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var z=new Uint8Array(await c9.subtle.sign("HMAC",y,k.encode(x))),A=da.from(s.map((a,b)=>s[b]^z[b])).toString("base64");let B=await c9.subtle.importKey("raw",q,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),C=await c9.subtle.sign("HMAC",B,k.encode("Server Key")),D=await c9.subtle.importKey("raw",C,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var E=da.from(await c9.subtle.sign("HMAC",D,k.encode(x)));b.message="SASLResponse",b.serverSignature=E.toString("base64"),b.response=w+",p="+A,this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}};function eY(a,b){let c,d;return b?{callback:b,result:void 0}:{callback:di(function(a,b){a?c(a):d(b)},"cb"),result:new a(function(a,b){d=a,c=b})}}if(di(eX,"NeonClient"),di(eY,"promisify"),di(class extends eN.Pool{constructor(){super(...arguments),dq(this,"Client",eX),dq(this,"hasFetchUnsupportedListeners",!1)}on(a,b){return"error"!==a&&(this.hasFetchUnsupportedListeners=!0),super.on(a,b)}query(a,b,c){if(!er.poolQueryViaFetch||this.hasFetchUnsupportedListeners||"function"==typeof a)return super.query(a,b,c);"function"==typeof b&&(c=b,b=void 0);let d=eY(this.Promise,c);c=d.callback;try{let d=new eV.default(this.options),e=encodeURIComponent,f=encodeURI,g=`postgresql://${e(d.user)}:${e(d.password)}@${e(d.host)}/${f(d.database)}`,h="string"==typeof a?a:a.text,i=b??a.values??[];eS(g,{fullResults:!0,arrayMode:"array"===a.rowMode})(h,i).then(a=>c(void 0,a)).catch(a=>c(a))}catch(a){c(a)}return d.result}},"NeonPool"),eW.ClientBase,eW.Connection,eW.DatabaseError,eW.Query,eW.defaults,eW.types,!process.env.POSTGRES_URL)throw Error("Varivel de ambiente POSTGRES_URL no definida.");let eZ=eS(process.env.POSTGRES_URL),e$=a=>({id:String(a.id),generationDate:a.generation_date,title:a.title,rawContent:a.raw_content,formattedContent:a.formatted_content,published:a.published,keywords:Array.isArray(a.keywords)?a.keywords:"string"==typeof a.keywords?a.keywords.split(",").map(a=>a.trim()):[],metaDescription:a.meta_description||""});async function e_(){try{await eZ`
      CREATE TABLE IF NOT EXISTS articles (
        id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
        generation_date TIMESTAMPTZ NOT NULL,
        title TEXT NOT NULL,
        raw_content TEXT NOT NULL,
        formatted_content TEXT,
        published BOOLEAN NOT NULL DEFAULT false,
        keywords TEXT[],
        meta_description TEXT
      );
    `,console.log(" Tabela 'articles' verificada ou criada com sucesso.")}catch(a){throw console.error(" Falha na configurao do banco de dados:",a),Error("Falha ao configurar a tabela do banco de dados.")}}async function e0(a){try{let{generationDate:b,title:c,rawContent:d,formattedContent:e,published:f,keywords:g,metaDescription:h}=a,i=await eZ`
      INSERT INTO articles (
        generation_date, title, raw_content, formatted_content, published, keywords, meta_description
      )
      VALUES (
        ${b},
        ${c},
        ${d},
        ${e||""},
        ${f??!1},
        ${Array.isArray(g)?g:[g]},
        ${h||""}
      )
      RETURNING *;
    `;if(0===i.length)throw Error("Falha ao salvar o artigo, nenhum resultado retornado.");return console.log(` Artigo salvo com sucesso (ID: ${i[0].id})`),e$(i[0])}catch(a){throw console.error(" Erro ao salvar artigo:",a),Error("Falha ao salvar o artigo.")}}async function e1(a){try{let b=await eZ`SELECT * FROM articles WHERE id = ${a} LIMIT 1;`;if(0===b.length)return null;return e$(b[0])}catch(a){throw console.error(" Erro ao buscar artigo por ID:",a),Error("Falha ao buscar o artigo.")}}async function e2(a,b){try{let c=Object.keys(b);if(0===c.length)return;let d=c.map((a,b)=>{let c=a.replace(/([A-Z])/g,"_$1").toLowerCase();return`${c} = $${b+1}`}),e=Object.values(b),f=`
      UPDATE articles
      SET ${d.join(", ")}
      WHERE id = $${c.length+1}
      RETURNING *;
    `;await eZ(f,...e,a),console.log(` Artigo ${a} atualizado (${c.join(", ")})`)}catch(a){throw console.error(" Erro ao atualizar artigo:",a),Error("Falha ao atualizar o artigo.")}}async function e3(){try{return(await eZ`SELECT * FROM articles ORDER BY generation_date DESC;`).map(e$)}catch(a){throw console.error(" Erro ao buscar artigos:",a),Error("Falha ao buscar os artigos.")}}async function e4(a,b,c){try{let d=await bw(a,b,c),f=await bx(d),{keywords:g,metaDescription:h}=await by(d,c),i={title:a,rawContent:d,formattedContent:f,generationDate:new Date().toISOString(),published:!1,keywords:g,metaDescription:h},j=await e0(i);return(0,e.revalidatePath)("/dashboard/history"),{...j,published:!0}}catch(a){throw console.error(" Erro em generateAndSaveArticleAction:",a),Error(`Falha ao gerar e salvar o artigo: ${a instanceof Error?a.message:String(a)}`)}}async function e5(a){try{let b={title:a.title,rawContent:a.content,formattedContent:"",generationDate:new Date().toISOString(),published:!1,keywords:[""],metaDescription:""},c=await e0(b);return console.log(` Rascunho salvo com ID: ${c.id}`),(0,e.revalidatePath)("/dashboard/history"),c}catch(a){throw console.error(" Erro ao salvar rascunho:",a),Error("Falha ao salvar rascunho.")}}async function e6(a){try{return await e1(a)}catch(a){return console.error(" Erro ao buscar artigo:",a),null}}async function e7(a,b){try{await e2(a,{formattedContent:b}),console.log(` HTML atualizado com sucesso para o artigo ${a}`),(0,e.revalidatePath)("/dashboard/history")}catch(a){throw console.error(" Erro ao atualizar HTML:",a),Error("Falha ao atualizar o HTML do artigo.")}}async function e8(a,b){try{await e2(a,{keywords:b.keywords,metaDescription:b.metaDescription,published:!0,generationDate:new Date().toISOString()}),console.log(` SEO atualizado e artigo ${a} publicado com sucesso.`),(0,e.revalidatePath)("/dashboard/history")}catch(a){throw console.error(" Erro ao atualizar SEO:",a),Error("Falha ao atualizar SEO do artigo.")}}async function e9(){try{return await e_(),await e3()}catch(a){return console.error(" Erro em getArticlesAction:",a),[]}}(0,a.i(13095).ensureServerEntryExports)([e4,e5,e6,e7,e8,e9]),(0,d.registerServerReference)(e4,"70f12876fc0e134895d97a7ded794efaca2a696c9b",null),(0,d.registerServerReference)(e5,"40beaf35ecbbfb8886c6be979c13bf3516a379c0e5",null),(0,d.registerServerReference)(e6,"400e61989097eb8b9f68c780e0d03ac63cfdf09c02",null),(0,d.registerServerReference)(e7,"600f1d6fd2e8bc63d9f50ada752da9b53c4faada57",null),(0,d.registerServerReference)(e8,"60b3884135d67f03b04d28d68149fff07fc9729e4b",null),(0,d.registerServerReference)(e9,"00fe0019f97a45ff59a91728708b782e5fa671df37",null),a.s(["generateAndSaveArticleAction",()=>e4,"getArticleById",()=>e6,"getArticlesAction",()=>e9,"saveArticleDraft",()=>e5,"updateArticleHtml",()=>e7,"updateArticleSeo",()=>e8],56004)}];

//# sourceMappingURL=_8a8a6451._.js.map