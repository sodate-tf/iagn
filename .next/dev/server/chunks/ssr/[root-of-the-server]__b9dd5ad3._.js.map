{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows/Documents/AIGP/aigp/services/geminiService.ts"],"sourcesContent":["import { GoogleGenAI, Type } from \"@google/genai\";\n\n// ‚úÖ Checagem da chave de API\nif (!process.env.GEMINI_API_KEY) {\n  console.error(\"‚ùå [GeminiService] Vari√°vel de ambiente GEMINI_API_KEY n√£o configurada!\");\n} else {\n  console.log(\"‚úÖ [GeminiService] GEMINI_API_KEY detectada com sucesso.\");\n}\n\nconst ai = new GoogleGenAI({ apiKey: process.env.GEMINI_API_KEY as string });\n\n// ‚úÖ URL e chave de autentica√ß√£o da API remota\nconst REMOTE_API_URL = process.env.REMOTE_POST_URL || \"https://www.iatioben.com.br/api/remote-post\";\nconst REMOTE_API_KEY = process.env.REMOTE_POST_API_KEY;\n\n// ====================================================================\n// üïäÔ∏è 1. Cria√ß√£o do artigo jornal√≠stico (texto bruto)\n// ====================================================================\nexport const writeNewsArticle = async (topic: string, language: string, focusKeywords: string): Promise<string> => {\n  console.log(\"üïäÔ∏è [writeNewsArticle] Iniciando gera√ß√£o do artigo...\");\n  console.log(`[writeNewsArticle] Tema: ${topic}`);\n  console.log(`[writeNewsArticle] Idioma: ${language}`);\n  console.log(`[writeNewsArticle] Palavras-chave: ${focusKeywords}`);\n\n  try {\n    const prompt = `\nVoc√™ √© um jornalista cat√≥lico de aproximadamente 25 anos, com um dom especial para contar hist√≥rias inspiradoras sobre os Santos da Igreja Cat√≥lica. \nVoc√™ escreve para o Blog Tio Ben ‚Äî um blog cat√≥lico jovem e envolvente, que busca evangelizar e inspirar seus leitores atrav√©s da vida dos Santos. \n\nSeu estilo √© leve, natural e empolgante ‚Äî como um amigo que sabe muito sobre a f√© e compartilha hist√≥rias de forma calorosa e verdadeira. \nN√£o use g√≠rias ou express√µes populares demais, mas evite tamb√©m a linguagem excessivamente formal. \nSeu texto deve soar aut√™ntico, humano e profundamente cat√≥lico. \n\nüîé **Fontes e Verdade Doutrinal:**\n- Suas refer√™ncias principais s√£o documentos e fontes oficiais da Igreja Cat√≥lica, especialmente o site do Vaticano (vatican.va), o Missal Romano e o Diret√≥rio dos Santos.\n- Nunca invente fatos. Se n√£o houver informa√ß√£o sobre algum aspecto, apenas omita. \n- Toda a narrativa deve estar em plena comunh√£o com o Magist√©rio e a Tradi√ß√£o da Igreja.\n\nü™î **Estrutura do Artigo (SEO e Conte√∫do):**\nO artigo deve ter:\n1. **T√≠tulo** criativo e inspirador.\n2. **Subt√≠tulo** curto e cativante.\n3. **Se√ß√£o do Dia de Celebra√ß√£o** ‚Äî contendo a **Liturgia do Dia** (1¬™ Leitura, 2¬™ Leitura ‚Äî se houver ‚Äî, Salmo e Evangelho).\n4. **Introdu√ß√£o envolvente**, que desperte a curiosidade do leitor e o conecte espiritualmente com o Santo.\n5. **Corpo do texto** dividido em se√ß√µes com subt√≠tulos claros:\n   - üåç *Origem e nascimento*: onde e quando nasceu, contexto hist√≥rico.\n   - ‚úùÔ∏è *Caminho de f√© e miss√£o*: principais fatos da vida, voca√ß√£o, virtudes.\n   - üôè *Milagres e testemunhos*: fatos reconhecidos pela Igreja ou pela tradi√ß√£o.\n   - üìÖ *Dia de celebra√ß√£o*: data lit√∫rgica e sentido espiritual.\n   - üïäÔ∏è *Padroeiro e devo√ß√µes*: se for padroeiro de algo, explique com clareza.\n   - üìñ *Ora√ß√£o ao Santo* (caso exista oficialmente na tradi√ß√£o).\n   - üí° *Li√ß√£o de vida*: o que sua hist√≥ria ensina para os crist√£os de hoje, especialmente os jovens.\n6. **Conclus√£o inspiradora**, que motive o leitor a buscar uma vida mais santa e pr√≥xima de Deus.\n\n‚ú® **Recursos estil√≠sticos:**\n- Use **emojis** com modera√ß√£o para dar leveza e simpatia ao texto (ex: üôè, ‚úùÔ∏è, üåπ, üìñ, üí°, üïäÔ∏è).\n- Use **listas e t√≥picos** quando fizer sentido.\n- Destaque palavras-chave importantes com **negrito**.\n- Os subt√≠tulos devem ser marcados com '##' (Markdown) para SEO e clareza visual.\n- O texto deve ter uma **densidade equilibrada de palavras-chave** e uma **meta description natural**.\n\nüß† **SEO e Palavras-chave:**\nDurante a escrita, tente incorporar de forma natural e relevante as seguintes palavras-chave: ${focusKeywords}. \nN√£o force a inclus√£o se n√£o parecer natural; priorize a fluidez e o sentido espiritual do texto.\n\nüì∞ **Instru√ß√£o de Escrita:**\nEscreva um artigo cativante e detalhado sobre \"${topic}\". \nO artigo deve ter um t√≠tulo claro, uma introdu√ß√£o envolvente, subt√≠tulos tem√°ticos, corpo bem estruturado e uma conclus√£o edificante. \nO tom deve ser inspirador e pr√≥ximo, adequado para jovens cat√≥licos que buscam crescer na f√©. \nO idioma do artigo deve ser: ${language}. \nCome√ße o texto direto, n√£o fa√ßa nenhum coment√°rio de como voc√™ entendeu e que vai escrever, apenas inicie o post \n`;\n;\n\n    console.log(\"‚úçÔ∏è [writeNewsArticle] Enviando prompt para o modelo gemini-2.5-pro...\");\n\n    const response = await ai.models.generateContent({\n      model: \"gemini-2.5-pro\",\n      contents: [{ parts: [{ text: prompt }] }],\n    });\n\n    console.log(\"‚úÖ [writeNewsArticle] Artigo gerado com sucesso.\");\n    return response.text;\n  } catch (error) {\n    console.error(\"‚ùå [writeNewsArticle] Erro:\", error);\n    throw new Error(\"Falha ao gerar o artigo de not√≠cia pela IA.\");\n  }\n};\n\n// ====================================================================\n// üé® 2. Convers√£o para HTML sem√¢ntico\n// ====================================================================\nexport const formatArticleToHtml = async (articleText: string): Promise<string> => {\n  console.log(\"üé® [formatArticleToHtml] Iniciando formata√ß√£o do artigo...\");\n  console.log(\"[formatArticleToHtml] Tamanho do texto recebido:\", articleText.length);\n\n  try {\n    const prompt = `\nVoc√™ √© um assistente editorial e web designer cat√≥lico especializado em formata√ß√£o de artigos para o Blog Tio Ben. \nSeu papel √© receber um texto em linguagem natural ‚Äî uma mat√©ria sobre a vida de um santo ‚Äî e convert√™-la em um artigo HTML completo, elegante e semanticamente otimizado para SEO e responsividade.\n\nO texto da mat√©ria chega no seguinte par√¢metro:  \n${articleText}\n\n‚öúÔ∏è **Contexto:**\nO artigo original foi escrito por outro agente (um jornalista cat√≥lico) e j√° segue as tradi√ß√µes da Igreja e o tom espiritual do Blog Tio Ben. \nSua tarefa N√ÉO √© reescrever o conte√∫do, mas format√°-lo em HTML conforme o modelo abaixo, adaptando t√≠tulos, subt√≠tulos e se√ß√µes com estrutura sem√¢ntica e estiliza√ß√£o coerente com TailwindCSS, conforme o padr√£o do site.\n\n---\n\nüß± **ESTRUTURA BASE (modelo obrigat√≥rio):**\nO HTML deve sempre seguir este esqueleto principal:\n\n<article class=\"post-santo max-w-3xl mx-auto p-4 sm lg bg-white font-sans text-gray-800 leading-relaxed min-h-screen\">\n\n  <!-- üîç Bloco SEO: Data da Celebra√ß√£o e Link para Liturgia -->\n  <section id=\"data-celebracao\" class=\"mb-8 p-4 bg-indigo-50 border border-indigo-100 rounded-lg\">\n    <h1 class=\"text-3xl font-extrabold text-indigo-700 mb-2\">[Nome do Santo] ‚Äì [Data de Celebra√ß√£o]</h1>\n    <p class=\"text-gray-700 text-base mb-3\">\n      No dia <time datetime=\"[aaaa-mm-dd]\">[data por extenso]</time>, a Igreja celebra \n      <strong class=\"text-indigo-600\">[Nome do Santo]</strong>. \n      [Breve resumo sobre o santo e o significado do dia.]\n      Acompanhe tamb√©m a \n      <a href=\"https://www.iatioben.com.br/liturgia-diaria/[dd-mm-yyyy]\" \n         class=\"text-indigo-600 font-semibold hover:underline\" \n         target=\"_blank\" \n         rel=\"noopener noreferrer\">\n        Liturgia Di√°ria de [data]\n      </a>.\n    </p>\n  </section>\n\n  <header class=\"mb-10 border-b border-indigo-200 pb-4\">\n    <h2 class=\"text-3xl sm font-extrabold text-indigo-700 mb-2 leading-tight\">[T√≠tulo principal do artigo]</h2>\n    <p class=\"introducao text-lg text-gray-600 italic\">[Par√°grafo introdut√≥rio]</p>\n  </header>\n\n  <!-- Se√ß√µes tem√°ticas -->\n  <section id=\"[slug-secao]\" aria-labelledby=\"[titulo-secao]\" class=\"mb-10 pt-4 border-b border-gray-100 pb-6\">\n    <h3 id=\"[titulo-secao]\" class=\"dia-liturgia text-2xl font-bold text-gray-900 mb-3 sm\">\n      <span class=\"text-indigo-500 mr-2\">[emoji]</span> [T√≠tulo da se√ß√£o]\n    </h3>\n    <p class=\"mb-4\">[Par√°grafo 1]</p>\n    <p class=\"mb-4\">[Par√°grafo 2]</p>\n  </section>\n\n  <!-- Se√ß√µes finais -->\n  <section id=\"resumo-seo\" aria-labelledby=\"titulo-resumo\" class=\"resumo-post p-5 border border-indigo-100 rounded-lg mb-10 bg-indigo-50\">\n    <h3 id=\"titulo-resumo\" class=\"text-xl font-bold text-indigo-700 mb-3\">‚ú® Ficha T√©cnica (SEO)</h3>\n    <ul class=\"lista-resumo space-y-2 text-sm\">\n      <li><strong class=\"font-semibold text-gray-700\">Tema central:</strong> [resumo do tema]</li>\n      <li><strong class=\"font-semibold text-gray-700\">Foco:</strong> [descri√ß√£o resumida do foco]</li>\n    </ul>\n  </section>\n\n  <footer class=\"rodape-post mt-10 pt-6 border-t border-gray-200\">\n    <h3 class=\"chamada-acao text-xl font-bold text-gray-900 mb-3\">üîó Conecte F√© e Humanismo</h3>\n    <p class=\"text-gray-600\">\n      Inspire-se em <strong class=\"text-indigo-600\">[Nome do Santo]</strong> e viva sua f√© com coragem, esperan√ßa e amor.\n    </p>\n  </footer>\n</article>\n\n---\n\nüß© **INSTRU√á√ïES DE CONVERS√ÉO E FORMATA√á√ÉO:**\n\n1. Use o conte√∫do recebido em \\`${articleText}\\` para preencher todas as se√ß√µes do modelo.\n2. Identifique automaticamente introdu√ß√£o, corpo e conclus√£o e distribua em se√ß√µes coerentes.\n3. Utilize **emojis tem√°ticos cat√≥licos** nos t√≠tulos (üë∂üïäÔ∏èüìñüí°üåü‚ù§Ô∏èüôèüìÖ).\n4. Gere **IDs sem√¢nticos** para cada se√ß√£o (ex: infancia-formacao, milagres, legado, oracao, li√ß√£o-de-vida etc.).\n5. As classes Tailwind devem ser **mantidas exatamente como no modelo.**\n6. O HTML deve ser **responsivo, mobile first e semanticamente estruturado.**\n7. Todos os links externos devem usar **target=\"_blank\" e rel=\"noopener noreferrer\".**\n8. Formate datas com o atributo \\`datetime=\"yyyy-mm-dd\"\\`.\n9. Destaque termos importantes com **<strong>** e **<em>**.\n10. Crie uma se√ß√£o **\"Ficha T√©cnica (SEO)\"** ao final com resumo e foco do texto.\n\n---\n\nüîó **LINKS DE CONTEXTO INTELIGENTES (IA Tio Ben):**\nDurante a formata√ß√£o, **identifique express√µes, nomes ou fatos que possam despertar curiosidade** e converta-os em links que direcionem para a pesquisa na IA Tio Ben.  \nUse o formato:\n\n<a href=\"https://www.iatioben.com.br/?texto=[texto%20codificado]\" \n   class=\"text-indigo-600 hover:underline font-medium\" \n   target=\"_blank\" \n   rel=\"noopener noreferrer\">\n   [express√£o clic√°vel]\n</a>\n\nExemplo:  \nTransforme ‚ÄúConc√≠lio Vaticano II‚Äù em  \n<a href=\"https://www.iatioben.com.br/?texto=Conc√≠lio%20Vaticano%20II\" ...>Conc√≠lio Vaticano II</a>\n\nCrie **entre 3 e 5 links** desse tipo por artigo, de forma natural e fluida, sem quebrar o contexto.\n\n---\n\n‚öôÔ∏è **Boas pr√°ticas de SEO:**\n- T√≠tulo principal √∫nico e envolvente (\\`<h1>\\`).  \n- Subt√≠tulos hier√°rquicos (\\`<h2>\\`, \\`<h3>\\`).  \n- Tags sem√¢nticas corretas (\\`<strong>\\`, \\`<em>\\`, \\`<time>\\`, \\`<a>\\`).  \n- Estrutura HTML limpa e validada.  \n- Par√°grafos curtos e escane√°veis.  \n- Palavras-chave mantidas naturalmente.\n\n---\n\nüß≠ **Instru√ß√£o final:**\nReceba o conte√∫do no par√¢metro \\`${articleText}\\` e retorne **somente o HTML final completo e formatado** no padr√£o acima, pronto para publica√ß√£o no site www.iatioben.com.br.  \nN√£o adicione explica√ß√µes nem coment√°rios ‚Äî apenas gere o HTML final.\n`;\n\n\n    const response = await ai.models.generateContent({\n      model: \"gemini-2.5-flash\",\n      contents: [{ parts: [{ text: prompt }] }],\n    });\n\n    let htmlContent = response.text || \"\";\n    if (htmlContent.startsWith(\"```html\")) htmlContent = htmlContent.slice(7);\n    if (htmlContent.endsWith(\"```\")) htmlContent = htmlContent.slice(0, -3);\n\n    console.log(\"‚úÖ [formatArticleToHtml] HTML gerado com sucesso. Tamanho:\", htmlContent.length);\n    return htmlContent.trim();\n  } catch (error) {\n    console.error(\"‚ùå [formatArticleToHtml] Erro ao gerar HTML:\", error);\n    throw new Error(\"Falha ao formatar o artigo para HTML.\");\n  }\n};\n\n// ====================================================================\n// üîç 3. Extra√ß√£o de metadados SEO\n// ====================================================================\nexport const analyzeSeoAndExtractMetadata = async (\n  articleText: string,\n  focusKeywords: string\n): Promise<{ keywords: string[]; metaDescription: string }> => {\n  console.log(\"üîç [analyzeSeoAndExtractMetadata] Iniciando an√°lise SEO...\");\n\n  try {\n    const prompt = `\nVoc√™ √© um editor cat√≥lico do Blog Tio Ben, respons√°vel por revisar artigos espirituais sobre a vida dos Santos e otimizar seu conte√∫do para SEO ‚Äî sem jamais perder o tom humano, devocional e inspirador do texto original.\n\nüïäÔ∏è Sua miss√£o √© analisar o artigo abaixo e gerar um **objeto JSON** com duas chaves:\n- \"keywords\": uma lista com 5 a 10 palavras-chave que melhor representam o artigo e sua espiritualidade, valorizando temas cat√≥licos e express√µes de f√©.\n- \"metaDescription\": uma breve descri√ß√£o (m√°x. 160 caracteres) que resuma a ess√™ncia do artigo de forma cativante, fiel √† mensagem e ao estilo do texto, como se fosse o resumo que aparece no Google.  \n  Ela deve soar natural, acolhedora e levemente po√©tica ‚Äî como uma frase que desperta f√© e curiosidade, sem parecer comercial.\n\nü™î Dicas de estilo:\n- Mantenha o mesmo tom usado no artigo: devocional, alegre, pr√≥ximo e cheio de esperan√ßa.\n- Prefira frases que transmitam luz, f√©, virtude e exemplo de vida.\n- N√£o use linguagem t√©cnica ou publicit√°ria.\n- Inspire o leitor a clicar, mas sem perder a rever√™ncia e autenticidade.\n\nPalavras-chave foco do blog: ${focusKeywords}\n\nüì∞ Artigo a analisar:\n---\n${articleText}\n---\n\nRetorne **somente o JSON** no formato:\n{\n  \"keywords\": [\"palavra1\", \"palavra2\", ...],\n  \"metaDescription\": \"texto descritivo cativante\"\n}\n`;\n\n\n    const response = await ai.models.generateContent({\n      model: \"gemini-2.5-flash\",\n      contents: [{ parts: [{ text: prompt }] }],\n      config: {\n        responseMimeType: \"application/json\",\n        responseSchema: {\n          type: Type.OBJECT,\n          properties: {\n            keywords: { type: Type.ARRAY, items: { type: Type.STRING } },\n            metaDescription: { type: Type.STRING },\n          },\n        },\n      },\n    });\n\n    const result = JSON.parse(response.text);\n    console.log(\"‚úÖ [analyzeSeoAndExtractMetadata] SEO extra√≠do:\", result);\n    return {\n      keywords: result.keywords || [],\n      metaDescription: result.metaDescription || \"\",\n    };\n  } catch (error) {\n    console.error(\"‚ùå [analyzeSeoAndExtractMetadata] Erro SEO:\", error);\n    return { keywords: [], metaDescription: \"N√£o foi poss√≠vel gerar a meta descri√ß√£o.\" };\n  }\n};\n\n// ====================================================================\n// üöÄ 4. Fluxo completo: gerar ‚Üí formatar ‚Üí analisar ‚Üí publicar remotamente\n// ====================================================================\nexport const generateAndPublishArticle = async (\n  topic: string,\n  language: string,\n  focusKeywords: string,\n  categoryId: string,\n  categoryName = \"Santos\"\n): Promise<void> => {\n  console.log(\"üöÄ [generateAndPublishArticle] Iniciando pipeline completo...\");\n  try {\n    // 1Ô∏è‚É£ Gera o artigo textual\n    const articleText = await writeNewsArticle(topic, language, focusKeywords);\n\n    // 2Ô∏è‚É£ Converte para HTML\n    const htmlArticle = await formatArticleToHtml(articleText);\n\n    // 3Ô∏è‚É£ Extrai SEO\n    const { keywords, metaDescription } = await analyzeSeoAndExtractMetadata(articleText, focusKeywords);\n\n    // 4Ô∏è‚É£ Prepara os dados para envio remoto\n    const slug = topic\n      .toLowerCase()\n      .normalize(\"NFD\")\n      .replace(/[\\u0300-\\u036f]/g, \"\")\n      .replace(/[^\\w\\s-]/g, \"\")\n      .replace(/[\\s_-]+/g, \"-\")\n      .replace(/^-+|-+$/g, \"\");\n\n    const DEFAULT_CATEGORY_ID = \"ba7adc02-de35-4405-b3f3-7391947d6281\";\n    const DEFAULT_CATEGORY_NAME = \"Santos\"; // ou \"Not√≠cias\", conforme sua estrutura\n\n    const payload = {\n      title: topic,\n      slug,\n      content: htmlArticle,      \n       categoryId: DEFAULT_CATEGORY_ID, // ‚úÖ Categoria fixa v√°lida no Neon\n      categoryName: DEFAULT_CATEGORY_NAME,\n      keywords: keywords.join(\", \"),\n      metaDescription,\n      publishDate: new Date().toISOString(),\n      isActive: true,\n    };\n\n    console.log(\"üì¶ [generateAndPublishArticle] Payload preparado:\", payload);\n\n    if (!REMOTE_API_URL || !REMOTE_API_KEY) {\n      console.warn(\"‚ö†Ô∏è [generateAndPublishArticle] Configura√ß√£o remota ausente, pulando publica√ß√£o.\");\n      return;\n    }\n\n    // 5Ô∏è‚É£ Envia para o outro site\n    console.log(`üåç [generateAndPublishArticle] Enviando para ${REMOTE_API_URL} ...`);\n\n    const res = await fetch(REMOTE_API_URL, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"x-api-key\": REMOTE_API_KEY!,\n      },\n      body: JSON.stringify(payload),\n    });\n\n    const result = await res.json();\n    if (!res.ok) throw new Error(`Falha na publica√ß√£o remota: ${result.message}`);\n\n    console.log(\"‚úÖ [generateAndPublishArticle] Post publicado com sucesso:\", result);\n  } catch (error) {\n    console.error(\"‚ùå [generateAndPublishArticle] Erro geral:\", error);\n    throw error;\n  }\n};\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 470, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows/Documents/AIGP/aigp/services/db.ts"],"sourcesContent":["import { neon, neonConfig } from \"@neondatabase/serverless\";\nimport { ArtigoNoticia } from \"../types\";\n\n// üîß Melhora performance e cache de conex√£o no ambiente serverless\nneonConfig.fetchConnectionCache = true;\n\nif (!process.env.POSTGRES_URL) {\n  throw new Error(\"Vari√°vel de ambiente POSTGRES_URL n√£o definida.\");\n}\n\nconst sql = neon(process.env.POSTGRES_URL);\n\n/* =========================================================\n   üîπ Fun√ß√£o auxiliar para mapear o resultado\n   ========================================================= */\nconst mapRowToArticle = (row: any): ArtigoNoticia => ({\n  id: String(row.id),\n  generationDate: row.generation_date,\n  title: row.title,\n  rawContent: row.raw_content,\n  formattedContent: row.formatted_content || \"\",\n  published: row.published,\n  keywords: Array.isArray(row.keywords)\n    ? row.keywords\n    : typeof row.keywords === \"string\"\n    ? row.keywords.split(\",\").map((k: string) => k.trim())\n    : [],\n  metaDescription: row.meta_description || \"\",\n});\n\n/* =========================================================\n   üèóÔ∏è Cria√ß√£o da tabela\n   ========================================================= */\nexport async function setupDatabase() {\n  try {\n    await sql`\n      CREATE TABLE IF NOT EXISTS articles (\n        id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n        generation_date TIMESTAMPTZ NOT NULL,\n        title TEXT NOT NULL,\n        raw_content TEXT NOT NULL,\n        formatted_content TEXT,\n        published BOOLEAN NOT NULL DEFAULT false,\n        keywords TEXT[],\n        meta_description TEXT\n      );\n    `;\n    console.log(\"‚úÖ Tabela 'articles' verificada/criada com sucesso.\");\n  } catch (error) {\n    console.error(\"‚ùå Falha na configura√ß√£o do banco de dados:\", error);\n    throw new Error(\"Falha ao configurar a tabela do banco de dados.\");\n  }\n}\n\n/* =========================================================\n   üíæ Inserir artigo completo\n   ========================================================= */\nexport async function saveArticle(article: Omit<ArtigoNoticia, \"id\">): Promise<ArtigoNoticia> {\n  try {\n    const result = await sql`\n      INSERT INTO articles (\n        generation_date, title, raw_content, formatted_content, published, keywords, meta_description\n      )\n      VALUES (\n        ${article.generationDate},\n        ${article.title},\n        ${article.rawContent},\n        ${article.formattedContent || \"\"},\n        ${article.published ?? false},\n        ${Array.isArray(article.keywords) ? article.keywords : [article.keywords]},\n        ${article.metaDescription || \"\"}\n      )\n      RETURNING *;\n    `;\n\n    const row = Array.isArray(result) ? result[0] : (result as any);\n    console.log(`üíæ Artigo salvo com sucesso (ID: ${row.id})`);\n    return mapRowToArticle(row);\n  } catch (error) {\n    console.error(\"‚ùå Erro ao salvar artigo:\", error);\n    throw new Error(\"Falha ao salvar o artigo.\");\n  }\n}\n\n/* =========================================================\n   ‚úèÔ∏è Salvar rascunho inicial (pr√©-formata√ß√£o)\n   ========================================================= */\nexport async function saveArticleDraft(data: {\n  title: string;\n  content: string;\n  language: string;\n}): Promise<{ id: string }> {\n  try {\n    const result = await sql`\n      INSERT INTO articles (generation_date, title, raw_content, formatted_content, published)\n      VALUES (NOW(), ${data.title}, ${data.content}, '', false)\n      RETURNING id;\n    `;\n\n    const row = Array.isArray(result) ? result[0] : (result as any);\n    console.log(`üìù Rascunho salvo com ID: ${row.id}`);\n    return { id: String(row.id) };\n  } catch (error) {\n    console.error(\"‚ùå Erro ao salvar rascunho:\", error);\n    throw new Error(\"Falha ao salvar o rascunho do artigo.\");\n  }\n}\n\n/* =========================================================\n   üîç Buscar artigo por ID\n   ========================================================= */\nexport async function getArticleById(id: string | number) {\n  try {\n    const result = await sql`SELECT * FROM articles WHERE id = ${id} LIMIT 1;`;\n    const row = Array.isArray(result) ? result[0] : (result as any);\n    if (!row) return null;\n\n    console.log(\"## retorno do select\");\n    console.log(row);\n    return mapRowToArticle(row);\n  } catch (error) {\n    console.error(\"‚ùå Erro ao buscar artigo:\", error);\n    throw new Error(\"Falha ao buscar o artigo por ID.\");\n  }\n}\n\n/* =========================================================\n   ü™Ñ Atualizar artigo gen√©rico\n   ========================================================= */\nexport async function updateArticle(id: string, data: Partial<ArtigoNoticia>): Promise<void> {\n  try {\n    const keys = Object.keys(data);\n    if (keys.length === 0) return;\n\n    // Monta os campos dinamicamente\n    const setClause = keys\n      .map((key, i) => `${key.replace(/([A-Z])/g, \"_$1\").toLowerCase()} = $${i + 1}`)\n      .join(\", \");\n    const values = Object.values(data);\n\n    const query = `\n      UPDATE articles\n      SET ${setClause}\n      WHERE id = $${keys.length + 1};\n    `;\n\n    await sql(query, [...values, id]);\n    console.log(`üìù Artigo ${id} atualizado (${keys.join(\", \")})`);\n  } catch (error) {\n    console.error(\"‚ùå Erro ao atualizar artigo:\", error);\n    throw new Error(\"Falha ao atualizar o artigo.\");\n  }\n}\n\n/* =========================================================\n   üß± Atualizar apenas o HTML\n   ========================================================= */\nexport async function updateArticleHtml(id: string | number, html: string) {\n  try {\n    const result = await sql`\n      UPDATE articles\n      SET formatted_content = ${html}\n      WHERE id = ${id}\n      RETURNING id, title, formatted_content;\n    `;\n\n    // Normaliza para garantir compatibilidade\n    const row = Array.isArray(result) ? result[0] : (result as any);\n    if (!row) throw new Error(`Nenhum artigo retornado ap√≥s o update (ID ${id}).`);\n\n    console.log(`‚úÖ HTML atualizado com sucesso para o artigo ID ${id}.`);\n    return {\n      id: String(row.id),\n      title: row.title,\n      formattedContent: row.formatted_content,\n    };\n  } catch (error) {\n    console.error(\"‚ùå Erro ao atualizar o artigo:\", error);\n    throw new Error(\"Falha ao atualizar o artigo.\");\n  }\n}\n\n/* =========================================================\n   üìã Buscar todos os artigos\n   ========================================================= */\nexport async function getArticles(): Promise<ArtigoNoticia[]> {\n  try {\n    const result = await sql`SELECT * FROM articles ORDER BY generation_date DESC;`;\n    const rows = Array.isArray(result) ? result : (result ? [result] : []);\n    return rows.map(mapRowToArticle);\n  } catch (error) {\n    console.error(\"‚ùå Erro ao buscar artigos:\", error);\n    throw new Error(\"Falha ao buscar os artigos.\");\n  }\n}\n\n/* =========================================================\n   üóëÔ∏è Excluir artigo\n   ========================================================= */\nexport async function deleteArticle(id: string): Promise<void> {\n  try {\n    await sql`DELETE FROM articles WHERE id = ${id};`;\n    console.log(`üóëÔ∏è Artigo ${id} removido com sucesso.`);\n  } catch (error) {\n    console.error(\"‚ùå Erro ao excluir artigo:\", error);\n    throw new Error(\"Falha ao excluir o artigo.\");\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 654, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows/Documents/AIGP/aigp/app/actions.ts"],"sourcesContent":["\"use server\";\n\nimport { revalidatePath } from \"next/cache\";\nimport * as geminiService from \"../services/geminiService\";\nimport * as dbService from \"../services/db\";\nimport { ArtigoNoticia } from \"../types\";\n\n/* =========================================================\n   üîπ MODO COMPLETO (para compatibilidade retroativa)\n   ========================================================= */\nexport async function generateAndSaveArticleAction(\n  topic: string,\n  language: string,\n  focusKeywords: string\n): Promise<ArtigoNoticia> {\n  try {\n    // üß† Etapa 1: IA Escritora\n    const rawContent = await geminiService.writeNewsArticle(topic, language, focusKeywords);\n\n    // üé® Etapa 2: IA Formatadora\n    const formattedContent = await geminiService.formatArticleToHtml(rawContent);\n\n    // üîç Etapa 3: IA de SEO\n    const { keywords, metaDescription } = await geminiService.analyzeSeoAndExtractMetadata(rawContent, focusKeywords);\n\n    // üíæ Etapa 4: Salvar tudo no banco\n    const articleToSave: Omit<ArtigoNoticia, \"id\"> = {\n      title: topic,\n      rawContent,\n      formattedContent,\n      generationDate: new Date().toISOString(),\n      published: false,\n      keywords,\n      metaDescription,\n    };\n\n    const savedArticle = await dbService.saveArticle(articleToSave);\n\n    // üîÅ Revalida hist√≥rico no dashboard\n    revalidatePath(\"/dashboard/history\");\n\n    return { ...savedArticle, published: true };\n  } catch (error) {\n    console.error(\"‚ùå Erro em generateAndSaveArticleAction:\", error);\n    throw new Error(`Falha ao gerar e salvar o artigo: ${error instanceof Error ? error.message : String(error)}`);\n  }\n}\n\n/* =========================================================\n   üîπ MODO MODULAR (para pipeline dividido)\n   ========================================================= */\n\n/** 1Ô∏è‚É£ Gera o texto base e salva como rascunho */\nexport async function saveArticleDraft(data: {\n  title: string;\n  content: string;\n  language: string;\n  focusKeywords: string;\n  status?: string;\n}) {\n  try {\n    const articleToSave: Omit<ArtigoNoticia, \"id\"> = {\n      title: data.title,\n      rawContent: data.content,\n      formattedContent: \"\",\n      generationDate: new Date().toISOString(),\n      published: false,\n      keywords: [\"\"],\n      metaDescription: \"\",\n    };\n\n    const saved = await dbService.saveArticle(articleToSave);\n    console.log(`‚úÖ Rascunho salvo com ID: ${saved.id}`);\n    revalidatePath(\"/dashboard/history\");\n    return saved;\n  } catch (error) {\n    console.error(\"‚ùå Erro ao salvar rascunho:\", error);\n    throw new Error(\"Falha ao salvar rascunho.\");\n  }\n}\n\n/** 2Ô∏è‚É£ Busca artigo pelo ID */\nexport async function getArticleById(id: string): Promise<ArtigoNoticia | null> {\n  try {\n    const article = await dbService.getArticleById(id);\n    return article;\n  } catch (error) {\n    console.error(\"‚ùå Erro ao buscar artigo:\", error);\n    return null;\n  }\n}\n\n/** 3Ô∏è‚É£ Atualiza HTML formatado */\nexport async function updateArticleHtml(id: string, formattedContent: string) {\n  try {\n    await dbService.updateArticle(id, { formattedContent });\n    console.log(`üé® HTML atualizado com sucesso para o artigo ${id}`);\n    revalidatePath(\"/dashboard/history\");\n  } catch (error) {\n    console.error(\"‚ùå Erro ao atualizar HTML:\", error);\n    throw new Error(\"Falha ao atualizar o HTML do artigo.\");\n  }\n}\n\n/** 4Ô∏è‚É£ Atualiza dados de SEO e marca como publicado */\n\nexport async function updateArticleSeo(\n  id: string,\n  data: { keywords: string[] | string; metaDescription: string; status?: string }\n) {\n  try {\n    // üß† Garante que keywords sempre ser√° um array de strings\n    let keywords: string[];\n\n    if (Array.isArray(data.keywords)) {\n      keywords = data.keywords;\n    } else if (typeof data.keywords === \"string\") {\n      keywords = data.keywords.split(\",\").map((k) => k.trim());\n    } else {\n      keywords = [];\n    }\n\n    const metaDescription = data.metaDescription || \"\";\n\n    await dbService.updateArticle(id, {\n      keywords,\n      metaDescription,\n      published: true,\n      generationDate: new Date().toISOString(),\n    });\n\n    console.log(`üîç SEO atualizado e artigo ${id} publicado com sucesso.`);\n    revalidatePath(\"/dashboard/history\");\n  } catch (error: any) {\n    console.error(\"‚ùå Erro ao atualizar SEO:\", error);\n    throw new Error(\n      error?.message || \"Falha ao atualizar os dados de SEO do artigo.\"\n    );\n  }\n}\n\n\n\n/* =========================================================\n   üîπ LISTAGEM (inalterada)\n   ========================================================= */\nexport async function getArticlesAction(): Promise<ArtigoNoticia[]> {\n  try {\n    await dbService.setupDatabase(); // garante tabela\n    const articles = await dbService.getArticles();\n    return articles;\n  } catch (error) {\n    console.error(\"‚ùå Erro em getArticlesAction:\", error);\n    return [];\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 804, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Windows/Documents/AIGP/aigp/.next-internal/server/app/dashboard/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {generateAndSaveArticleAction as '706f4b7a5ed7f1fae5ee8764b8d255b14b6a91c300'} from 'ACTIONS_MODULE0'\nexport {getArticlesAction as '00121f9c30c5223351207fd8b448259ca46c676c50'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA","debugId":null}}]
}